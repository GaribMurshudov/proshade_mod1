<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ProSHADE: src/proshade/ProSHADE_data.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ProSHADE
   &#160;<span id="projectnumber">0.7.4 (SEP 2020) - EXPERIMENTAL</span>
   </div>
   <div id="projectbrief">Protein Shape Detection</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_pro_s_h_a_d_e__data_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ProSHADE_data.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_pro_s_h_a_d_e__data_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//==================================================== ProSHADE</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_pro_s_h_a_d_e__data_8hpp.html">ProSHADE_data.hpp</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//==================================================== Gemmi PDB output - this cannot be with the rest of includes for some stb_sprintf library related reasons ...</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#define GEMMI_WRITE_IMPLEMENTATION</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;gemmi/to_pdb.hpp&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5e165ed8ecee7e07762aec7ac5890848">   39</a></span>&#160;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5e165ed8ecee7e07762aec7ac5890848">ProSHADE_internal_data::ProSHADE_data::ProSHADE_data</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// ... Variables regarding input file</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a>                                    = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4052e498b4650f62bfe5ff37ed959292">fileType</a>                                    = ProSHADE_internal_io::UNKNOWN;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// ... Variables regarding map</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>                                 = NULL;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// ... Variables regarding map information</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>                                    = 0.0;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>                                    = 0.0;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>                                    = 0.0;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">aAngle</a>                                      = 0.0;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9dbcec9f32eb76625d7aa59d8c2701d9">bAngle</a>                                      = 0.0;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e2f99f00dd05198b508633cf7f6f080">cAngle</a>                                      = 0.0;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>                                 = 0;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>                                 = 0;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>                                 = 0;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">xGridIndices</a>                                = 0;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">yGridIndices</a>                                = 0;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">zGridIndices</a>                                = 0;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">xAxisOrder</a>                                  = 1;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">yAxisOrder</a>                                  = 2;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">zAxisOrder</a>                                  = 3;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a>                                 = 0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a>                                 = 0;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a>                                 = 0;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a68aa68499f39a2f8aa2638fe6d51b36d">comMovX</a>                                     = 0.0;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0df3ae9fa8c4dafac3c8c3a6145a5a27">comMovY</a>                                     = 0.0;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4e23fd6cc4e931df9ec8b10c81ef38fb">comMovZ</a>                                     = 0.0;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">xCom</a>                                        = 0.0;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">yCom</a>                                        = 0.0;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">zCom</a>                                        = 0.0;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// ... Variables regarding original input values (i.e. these do not change with ProSHADE manipulations)</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ae6821c27e7facf63839c9fc678c9c7">xDimSizeOriginal</a>                            = 0.0;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7855424ca5d51853c7fc665ecb9b935b">yDimSizeOriginal</a>                            = 0.0;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a530ad7e3396cbcbc1814051031070a8b">zDimSizeOriginal</a>                            = 0.0;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9598e9a38546e3bf260bc09c0c9366a2">xDimIndicesOriginal</a>                         = 0;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ef18126c2c24edc9b6be06e0591127f">yDimIndicesOriginal</a>                         = 0;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ea6522b99cf1ac72199c9eeccd30742">zDimIndicesOriginal</a>                         = 0;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a43f1c4682016759ea2e24c5903dbe444">xAxisOriginOriginal</a>                         = 0;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a53cffdab0d66cb88884ec4f46c19a5ff">yAxisOriginOriginal</a>                         = 0;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aed1c8e0ffb847b093a736c5156f86e9b">zAxisOriginOriginal</a>                         = 0;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2a3fdf194eca61b1ccfa5bdd2f586e0b">originalMapXCom</a>                             = 0.0;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a64323b4117a11f0971cb0d24ec95c64c">originalMapYCom</a>                             = 0.0;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac00197ab71e3353cb2884be0e51d6cd3">originalMapZCom</a>                             = 0.0;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a06231fd4288194cc7c6ed0270f0b2920">mapPostRotXCom</a>                              = 0.0;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a202119c89869d7731298723b9bb5ba4a">mapPostRotYCom</a>                              = 0.0;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbb1c295e5bf73636984b7ae890d07">mapPostRotZCom</a>                              = 0.0;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// ... Variables regarding iterator positions</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>                                       = 0;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>                                       = 0;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>                                       = 0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>                                         = 0;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>                                         = 0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>                                         = 0;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// ... Variables regarding SH mapping spheres</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>                                   = std::vector&lt;proshade_single&gt; ( );</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>                                   = 0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>                                     = NULL;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>                          = NULL;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94b04108aa1a9406eb3c5eb61749140b">rotSphericalHarmonics</a>                       = NULL;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a>                                = 0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// ... Variables regarding shape distance computations</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>                                 = NULL;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>                                   = NULL;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">so3Coeffs</a>                                   = NULL;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a33312dd4333617b460628e4db4bf41fc">so3CoeffsInverse</a>                            = NULL;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">wignerMatrices</a>                              = NULL;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d266289b137b48132f1456fd8fc43ea">integrationWeight</a>                           = 0.0;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ed9b0a765739d89104eca2c1875dd4">maxCompBand</a>                                 = 0;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37f26ac4bc76e4f4c5da77dd0eace56e">translationMap</a>                              = NULL;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// ... Control variables</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac57d606fdb59d54bd3f9249941402b12">isEmpty</a>                                     = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a79b967d04959f83ae13b12b368caaf18">  152</a></span>&#160;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5e165ed8ecee7e07762aec7ac5890848">ProSHADE_internal_data::ProSHADE_data::ProSHADE_data</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::string strName, <span class="keywordtype">double</span> *mapVals, <span class="keywordtype">int</span> len, proshade_single xDmSz, proshade_single yDmSz, proshade_single zDmSz, proshade_unsign xDmInd, proshade_unsign yDmInd, proshade_unsign zDmInd, proshade_signed xFr, proshade_signed yFr, proshade_signed zFr, proshade_signed xT, proshade_signed yT, proshade_signed zT, proshade_unsign inputO )</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// ... Variables regarding input file</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    this-&gt;fileName                                    = strName;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    this-&gt;fileType                                    = ProSHADE_internal_io::MAP;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// ... Variables regarding map</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    this-&gt;internalMap                                 = NULL;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// ... Variables regarding map information</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    this-&gt;xDimSize                                    = xDmSz;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    this-&gt;yDimSize                                    = yDmSz;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    this-&gt;zDimSize                                    = zDmSz;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    this-&gt;aAngle                                      = 90.0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    this-&gt;bAngle                                      = 90.0;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    this-&gt;cAngle                                      = 90.0;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    this-&gt;xDimIndices                                 = xDmInd;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    this-&gt;yDimIndices                                 = yDmInd;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    this-&gt;zDimIndices                                 = zDmInd;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    this-&gt;xGridIndices                                = xDmInd;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    this-&gt;yGridIndices                                = yDmInd;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    this-&gt;zGridIndices                                = zDmInd;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    this-&gt;xAxisOrder                                  = 1;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    this-&gt;yAxisOrder                                  = 2;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    this-&gt;zAxisOrder                                  = 3;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    this-&gt;xAxisOrigin                                 = xFr;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    this-&gt;yAxisOrigin                                 = yFr;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    this-&gt;zAxisOrigin                                 = zFr;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    this-&gt;comMovX                                     = 0.0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    this-&gt;comMovY                                     = 0.0;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    this-&gt;comMovZ                                     = 0.0;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    this-&gt;xCom                                        = 0.0;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    this-&gt;yCom                                        = 0.0;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    this-&gt;zCom                                        = 0.0;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// ... Variables regarding original input values (i.e. these do not change with ProSHADE manipulations)</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    this-&gt;xDimSizeOriginal                            = 0.0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    this-&gt;yDimSizeOriginal                            = 0.0;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    this-&gt;zDimSizeOriginal                            = 0.0;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    this-&gt;xDimIndicesOriginal                         = 0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    this-&gt;yDimIndicesOriginal                         = 0;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    this-&gt;zDimIndicesOriginal                         = 0;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    this-&gt;xAxisOriginOriginal                         = 0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    this-&gt;yAxisOriginOriginal                         = 0;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    this-&gt;zAxisOriginOriginal                         = 0;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    this-&gt;originalMapXCom                             = 0.0;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    this-&gt;originalMapYCom                             = 0.0;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    this-&gt;originalMapZCom                             = 0.0;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    this-&gt;mapPostRotXCom                              = 0.0;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    this-&gt;mapPostRotYCom                              = 0.0;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    this-&gt;mapPostRotZCom                              = 0.0;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// ... Variables regarding iterator positions</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    this-&gt;xFrom                                       = xFr;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    this-&gt;yFrom                                       = yFr;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    this-&gt;zFrom                                       = zFr;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    this-&gt;xTo                                         = xT;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    this-&gt;yTo                                         = yT;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    this-&gt;zTo                                         = zT;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// ... Variables regarding SH mapping spheres</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    this-&gt;spherePos                                   = std::vector&lt;proshade_single&gt; ( );</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    this-&gt;noSpheres                                   = 0;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    this-&gt;spheres                                     = NULL;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    this-&gt;sphericalHarmonics                          = NULL;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    this-&gt;rotSphericalHarmonics                       = NULL;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    this-&gt;maxShellBand                                = 0;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// ... Variables regarding shape distance computations</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    this-&gt;rrpMatrices                                 = NULL;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    this-&gt;eMatrices                                   = NULL;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    this-&gt;so3Coeffs                                   = NULL;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    this-&gt;so3CoeffsInverse                            = NULL;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    this-&gt;wignerMatrices                              = NULL;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    this-&gt;integrationWeight                           = 0.0;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    this-&gt;maxCompBand                                 = 0;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    this-&gt;translationMap                              = NULL;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// ... Control variables</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    this-&gt;isEmpty                                     = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    this-&gt;inputOrder                                  = inputO;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">//================================================ Sanity checks</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( len ) != ( xDmInd * yDmInd * zDmInd ) )</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Structure class input map has wrong dimensions.&quot;</span>, <span class="stringliteral">&quot;EP00044&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied map array size has different dimensions to\n                    : the required map dimensions.&quot;</span> );</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span> ( ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( xT - xFr ) != <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( xDmInd - 1 ) ) ||</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;         ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( yT - yFr ) != <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( yDmInd - 1 ) ) ||</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;         ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( zT - zFr ) != <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( zDmInd - 1 ) ) )</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Structure class input dimensions not in line with map\n                    : to/from indices.&quot;</span>, <span class="stringliteral">&quot;EP00045&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied map information does not add up. The\n                    : dimensions are not in line with the indexing start/stop\n                    : position distances and therefore proper map indexing\n                    : cannot be done. Please check the input values.&quot;</span> );</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">//================================================ Allocate the map memory</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    this-&gt;internalMap                                 = <span class="keyword">new</span> proshade_double [this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;internalMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">//================================================ Copy the values into the map</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    proshade_unsign arrPos                            = 0;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign xIt = 0; xIt &lt; this-&gt;xDimIndices; xIt++ )</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign yIt = 0; yIt &lt; this-&gt;yDimIndices; yIt++ )</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign zIt = 0; zIt &lt; this-&gt;zDimIndices; zIt++ )</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                arrPos                                = zIt + this-&gt;zDimIndices * ( yIt + this-&gt;yDimIndices * xIt );</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                this-&gt;internalMap[arrPos]             = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( mapVals[arrPos] );</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a485495727d37abd66295bab95d368438">  276</a></span>&#160;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a485495727d37abd66295bab95d368438">ProSHADE_internal_data::ProSHADE_data::~ProSHADE_data</a> ( )</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;{</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">//================================================ Release the internal map</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;internalMap != NULL )</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keyword">delete</span>[] this-&gt;internalMap;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">//================================================ Release the sphere mapping</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;spheres != NULL )</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; this-&gt;noSpheres; iter++ )</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;spheres[iter] != NULL )</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                <span class="keyword">delete</span> this-&gt;spheres[iter];</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                this-&gt;spheres[iter]                   = NULL;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keyword">delete</span>[] this-&gt;spheres;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">//================================================ Release the spherical harmonics</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;sphericalHarmonics != NULL )</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; this-&gt;noSpheres; iter++ )</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;sphericalHarmonics[iter] != NULL )</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                <span class="keyword">delete</span>[] this-&gt;sphericalHarmonics[iter];</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                this-&gt;sphericalHarmonics[iter]        = NULL;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keyword">delete</span>[] this-&gt;sphericalHarmonics;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">//================================================ Release the rotated spherical harmonics</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;rotSphericalHarmonics != NULL )</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; this-&gt;noSpheres; iter++ )</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;rotSphericalHarmonics[iter] != NULL )</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                <span class="keyword">delete</span>[] this-&gt;rotSphericalHarmonics[iter];</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                this-&gt;rotSphericalHarmonics[iter]     = NULL;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keyword">delete</span>[] this-&gt;rotSphericalHarmonics;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">//================================================ Release the RRP matrices (pre-computation for the energy levels descriptor)</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;rrpMatrices != NULL )</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign bwIt = 0; bwIt &lt; this-&gt;maxShellBand; bwIt++ )</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;rrpMatrices[bwIt] != NULL )</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign shIt = 0; shIt &lt; this-&gt;noSpheres; shIt++ )</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    <span class="keywordflow">if</span> ( this-&gt;rrpMatrices[bwIt][shIt] != NULL )</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                        <span class="keyword">delete</span>[] this-&gt;rrpMatrices[bwIt][shIt];</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                    }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                <span class="keyword">delete</span>[] this-&gt;rrpMatrices[bwIt];</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keyword">delete</span>[] this-&gt;rrpMatrices;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">//================================================ Release the E matrices</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;eMatrices != NULL )</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign bandIter = 0; bandIter &lt; this-&gt;maxCompBand; bandIter++ )</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;eMatrices[bandIter] != NULL )</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign band2Iter = 0; band2Iter &lt; static_cast&lt;proshade_unsign&gt; ( ( bandIter * 2 ) + 1 ); band2Iter++ )</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    <span class="keywordflow">if</span> ( this-&gt;eMatrices[bandIter][band2Iter] != NULL )</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                    {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                        <span class="keyword">delete</span>[] this-&gt;eMatrices[bandIter][band2Iter];</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                    }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                <span class="keyword">delete</span>[] this-&gt;eMatrices[bandIter];</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keyword">delete</span>[] this-&gt;eMatrices;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">//================================================ Release SOFT and inverse SOFT coefficients</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;so3Coeffs != NULL )</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keyword">delete</span>[] this-&gt;so3Coeffs;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;so3CoeffsInverse != NULL )</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keyword">delete</span>[] this-&gt;so3CoeffsInverse;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">//================================================ Release Wigner matrices</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;wignerMatrices != NULL )</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign bandIter = 1; bandIter &lt; this-&gt;maxCompBand; bandIter++ )</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;wignerMatrices[bandIter] != NULL )</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign order1Iter = 0; order1Iter &lt; ( (bandIter * 2) + 1 ); order1Iter++ )</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                    <span class="keywordflow">if</span> ( this-&gt;wignerMatrices[bandIter][order1Iter] != NULL )</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                    {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                        <span class="keyword">delete</span>[] this-&gt;wignerMatrices[bandIter][order1Iter];</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                    }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                <span class="keyword">delete</span>[] this-&gt;wignerMatrices[bandIter];</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keyword">delete</span>[] wignerMatrices;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">//================================================ Release translation map</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;translationMap != NULL )</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keyword">delete</span>[] this-&gt;translationMap;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;}</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59f2f2ce1bfdb90432c5a29600fdd9e6">  419</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59f2f2ce1bfdb90432c5a29600fdd9e6">ProSHADE_internal_data::ProSHADE_data::readInStructure</a> ( std::string fName, proshade_unsign inputO, <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;{</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting to read the structure: &quot;</span> + fName );</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">//================================================ Check if instance is empty</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">if</span> ( !this-&gt;isEmpty )</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Structure data class not empty.&quot;</span>, <span class="stringliteral">&quot;E000005&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;Attempted to read in structure into a ProSHADE_data\n                    : object which already does have structure read in\n                    : i.e. &quot;</span> + this-&gt;fileName );</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">//================================================ Save the filename</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    this-&gt;fileName                                    = fName;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">//================================================ Check what is the input format</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    this-&gt;fileType                                    = <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a63ae2cc7f413d224e5d651ed579e9afb">ProSHADE_internal_io::figureDataType</a> ( this-&gt;fileName );</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">//================================================ Save input order</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    this-&gt;inputOrder                                  = inputO;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">//================================================ Decide how to proceed</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">switch</span> ( this-&gt;fileType )</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="keywordflow">case</span> ProSHADE_internal_io::UNKNOWN:</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Unknown file type.&quot;</span>, <span class="stringliteral">&quot;E000006&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;When attempting to read the file\n                    : &quot;</span> + this-&gt;fileName + <span class="stringliteral">&quot;\n                    : the file extension was determined as unknown. This could\n                    : mean either that the file does not exist, or that it is\n                    : not one of the supported extensions.&quot;</span> );</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">case</span> ProSHADE_internal_io::PDB:</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            this-&gt;readInPDB                           ( settings );</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">case</span> ProSHADE_internal_io::MAP:</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            this-&gt;readInMAP                           ( settings );</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">//================================================ This structure is now full</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    this-&gt;isEmpty                                     = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Structure read in successfully.&quot;</span> );</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    return ;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;}</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a07fb6e354dcd90dc70f8b4fa8bba0c33">  473</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a07fb6e354dcd90dc70f8b4fa8bba0c33">ProSHADE_internal_data::ProSHADE_data::readInMAP</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;{</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">//================================================ Open the file</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    gemmi::Ccp4&lt;float&gt; map;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    map.read_ccp4                                     ( gemmi::MaybeGzipped ( this-&gt;fileName.c_str() ) );</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">//================================================ Read in the axes starting points before it is modified by the gemmi set-up</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a107ae7dc23e1a2d64c05106a009beba1">ProSHADE_internal_io::readInMapHeaderFroms</a>        ( &amp;map, &amp;this-&gt;xFrom, &amp;this-&gt;yFrom, &amp;this-&gt;zFrom );</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">//================================================ Convert to XYZ and create complete map, if need be</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    map.setup                                         ( gemmi::GridSetup::ReorderOnly, NAN );</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">//================================================ Read in the rest of the map file header</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a9677e06f0781855b9046aab1b3638831">ProSHADE_internal_io::readInMapHeader</a>             ( &amp;map,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                                        &amp;this-&gt;xDimIndices,  &amp;this-&gt;yDimIndices,  &amp;this-&gt;zDimIndices,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                                        &amp;this-&gt;xDimSize,     &amp;this-&gt;yDimSize,     &amp;this-&gt;zDimSize,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                                        &amp;this-&gt;aAngle,       &amp;this-&gt;bAngle,       &amp;this-&gt;cAngle,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                                                        &amp;this-&gt;xFrom,        &amp;this-&gt;yFrom,        &amp;this-&gt;zFrom,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                                        &amp;this-&gt;xAxisOrigin,  &amp;this-&gt;yAxisOrigin,  &amp;this-&gt;zAxisOrigin,</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                                        &amp;this-&gt;xAxisOrder,   &amp;this-&gt;yAxisOrder,   &amp;this-&gt;zAxisOrder,</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                                        &amp;this-&gt;xGridIndices, &amp;this-&gt;yGridIndices, &amp;this-&gt;zGridIndices );</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">//================================================ Save the map density to ProSHADE variable</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#ad93f9644c5b132193b4ddd282f50abce">ProSHADE_internal_io::readInMapData</a>               ( &amp;map, this-&gt;internalMap, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, this-&gt;xAxisOrder, this-&gt;yAxisOrder, this-&gt;zAxisOrder );</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">//================================================ Set resolution if need be</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a> &lt; 0.0 )</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3e7f4174b62aa402a1f6d3becd8e9dd5">setResolution</a>                       ( std::min ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;xDimSize ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;xDimIndices ),</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                                                        std::min ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;yDimSize ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;yDimIndices ),</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                                                                   <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;zDimSize ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) ) ) * 2.0 );</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">//================================================ Set iterators from and to</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    this-&gt;figureIndexStartStop                        ( );</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">//================================================ If specific resolution is requested, make sure the map has it</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab61d2183930ea26b3d49e7662052e83b">changeMapResolution</a> || settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4f49a4f2263aa12ccb1737f8dc32c9ac">changeMapResolutionTriLinear</a> )</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        this-&gt;reSampleMap                             ( settings );</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;}</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abd1c1b3588308f775da5c8aeba3f3e78">  526</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abd1c1b3588308f775da5c8aeba3f3e78">ProSHADE_internal_data::ProSHADE_data::readInPDB</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;{</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">//================================================ Set resolution if need be</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a> &lt; 0.0 )</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3e7f4174b62aa402a1f6d3becd8e9dd5">setResolution</a>                       ( 8.0 );</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">//================================================ Open PDB file for reading</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    gemmi::Structure pdbFile                          = gemmi::read_structure ( gemmi::MaybeGzipped ( this-&gt;fileName ) );</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">//================================================ Change B-factors if need be</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3cac1bd635aabf3a3370fc26dfa0f49a">pdbBFactorNewVal</a> &gt;= 0.0 )</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a9cf227397ba62db3394d6e404006df97">ProSHADE_internal_mapManip::changePDBBFactors</a> ( &amp;pdbFile, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3cac1bd635aabf3a3370fc26dfa0f49a">pdbBFactorNewVal</a> );</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">//================================================ Find the ranges</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    proshade_single xF, xT, yF, yT, zF, zT;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a053e8acecc88aad289d6a06a678d9ac4">ProSHADE_internal_mapManip::determinePDBRanges</a>    ( pdbFile, &amp;xF, &amp;xT, &amp;yF, &amp;yT, &amp;zF, &amp;zT );</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">//================================================ Move ranges to have all FROM values 20</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    proshade_single xMov                              = 20.0 - xF;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    proshade_single yMov                              = 20.0 - yF;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    proshade_single zMov                              = 20.0 - zF;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#af2bbc07d56beb9ba0b45c2ac1a8a0a0b">ProSHADE_internal_mapManip::movePDBForMapCalc</a>     ( &amp;pdbFile, xMov, yMov, zMov );</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">//================================================ Set the angstrom sizes</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    this-&gt;xDimSize                                    = xT - xF + 40.0;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    this-&gt;yDimSize                                    = yT - yF + 40.0;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    this-&gt;zDimSize                                    = zT - zF + 40.0;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">//================================================ Generate map from nicely placed atoms (cell size will be range + 40)</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#afe43c82995777c05000cf92091c10b9c">ProSHADE_internal_mapManip::generateMapFromPDB</a>    ( pdbFile, this-&gt;internalMap, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a>, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, &amp;this-&gt;xTo, &amp;this-&gt;yTo, &amp;this-&gt;zTo );</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">//================================================ Set the internal variables to correct values</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    this-&gt;setPDBMapValues                             ( );</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">//================================================ Move map back to the original PDB location</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">ProSHADE_internal_mapManip::moveMapByIndices</a>      ( &amp;xMov, &amp;yMov, &amp;zMov, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize,</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                                                        &amp;this-&gt;xFrom, &amp;this-&gt;xTo, &amp;this-&gt;yFrom, &amp;this-&gt;yTo, &amp;this-&gt;zFrom, &amp;this-&gt;zTo,</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                                                        &amp;this-&gt;xAxisOrigin, &amp;this-&gt;yAxisOrigin, &amp;this-&gt;zAxisOrigin );</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>      ( this-&gt;internalMap, xMov, yMov, zMov, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize,</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                                                        this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices );</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="comment">//================================================ If specific resolution is requested, make sure the map has it</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab61d2183930ea26b3d49e7662052e83b">changeMapResolution</a> || settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4f49a4f2263aa12ccb1737f8dc32c9ac">changeMapResolutionTriLinear</a> )</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        this-&gt;reSampleMap                             ( settings );</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;}</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30edd2928e423198704adb955989960b">  586</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30edd2928e423198704adb955989960b">ProSHADE_internal_data::ProSHADE_data::setPDBMapValues</a> ( <span class="keywordtype">void</span> )</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;{</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">//================================================ Set starts to 0 </span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    this-&gt;xFrom                                       = 0;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    this-&gt;yFrom                                       = 0;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    this-&gt;zFrom                                       = 0;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="comment">//================================================ Set angles to 90 degrees</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    this-&gt;aAngle                                      = 90.0;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    this-&gt;bAngle                                      = 90.0;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    this-&gt;cAngle                                      = 90.0;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="comment">//================================================ Set dimension sizes in indices</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    this-&gt;xDimIndices                                 = this-&gt;xTo;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    this-&gt;yDimIndices                                 = this-&gt;yTo;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    this-&gt;zDimIndices                                 = this-&gt;zTo;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">//================================================ Set grid indexing to cell indexing</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    this-&gt;xGridIndices                                = this-&gt;xDimIndices;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    this-&gt;yGridIndices                                = this-&gt;yDimIndices;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    this-&gt;zGridIndices                                = this-&gt;zDimIndices;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">//================================================ Set axis order</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    this-&gt;xAxisOrder                                  = 1;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    this-&gt;yAxisOrder                                  = 2;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    this-&gt;zAxisOrder                                  = 3;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">//================================================ Set origin to the first index</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    this-&gt;xAxisOrigin                                 = this-&gt;xFrom;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    this-&gt;yAxisOrigin                                 = this-&gt;yFrom;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    this-&gt;zAxisOrigin                                 = this-&gt;zFrom;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    return ;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;}</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a476092aa08dff20d64a895e7b2227b2e">  627</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a476092aa08dff20d64a895e7b2227b2e">ProSHADE_internal_data::ProSHADE_data::figureIndexStartStop</a> ( <span class="keywordtype">void</span> )</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;{</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="comment">//================================================ Set ends to origin + size - 1</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    this-&gt;xTo                                         = this-&gt;xFrom + this-&gt;xDimIndices - 1;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    this-&gt;yTo                                         = this-&gt;yFrom + this-&gt;yDimIndices - 1;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    this-&gt;zTo                                         = this-&gt;zFrom + this-&gt;zDimIndices - 1;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    return ;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;}</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a81e6aab30488052e6bdd9b339e8124d8">  649</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a81e6aab30488052e6bdd9b339e8124d8">ProSHADE_internal_data::ProSHADE_data::writeMap</a> ( std::string fName, std::string title, <span class="keywordtype">int</span> mode )</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;{</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">//================================================ Create and prepare new Grid gemmi object</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    gemmi::Grid&lt;float&gt; mapData;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    mapData.set_unit_cell                             ( this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, this-&gt;aAngle, this-&gt;bAngle, this-&gt;cAngle );</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    mapData.set_size_without_checking                 ( this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices );</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    mapData.axis_order                                = gemmi::AxisOrder::XYZ;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    mapData.spacegroup                                = &amp;gemmi::get_spacegroup_p1();</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="comment">//================================================ Create and prepare new Ccp4 gemmi object</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    gemmi::Ccp4&lt;float&gt; map;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    map.grid                                          = mapData;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    map.prepare_ccp4_header                           ( mode );</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">//================================================ Fill in the header</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a2e438f3d348e3e065f798031d5a33d09">ProSHADE_internal_io::writeOutMapHeader</a>           ( &amp;map,</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                                        this-&gt;xDimIndices,  this-&gt;yDimIndices,  this-&gt;zDimIndices,</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                                                        this-&gt;xDimSize,     this-&gt;yDimSize,     this-&gt;zDimSize,</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                                                        this-&gt;aAngle,       this-&gt;bAngle,       this-&gt;cAngle,</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                                                        this-&gt;xFrom,        this-&gt;yFrom,        this-&gt;zFrom,</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                                                        this-&gt;xAxisOrigin,  this-&gt;yAxisOrigin,  this-&gt;zAxisOrigin,</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                                                        this-&gt;xAxisOrder,   this-&gt;yAxisOrder,   this-&gt;zAxisOrder,</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                                                        this-&gt;xGridIndices, this-&gt;yGridIndices, this-&gt;zGridIndices,</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                                        title, mode );</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">//================================================ Copy internal map to grid</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    proshade_unsign arrPos                            = 0;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign uIt = 0; uIt &lt; this-&gt;xDimIndices; uIt++ )</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign vIt = 0; vIt &lt; this-&gt;yDimIndices; vIt++ )</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign wIt = 0; wIt &lt; this-&gt;zDimIndices; wIt++ )</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                arrPos                                = wIt + this-&gt;zDimIndices * ( vIt + this-&gt;yDimIndices * uIt );</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                map.grid.set_value                    ( uIt, vIt, wIt, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span> ( this-&gt;internalMap[arrPos] ) );</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">//================================================ Update the statistics in the header</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    map.update_ccp4_header                            ( mode, <span class="keyword">true</span> );</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">//================================================ Write out the map</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    map.write_ccp4_map                                ( fName );</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    return ;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;}</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a88bff2522448a45b6dbfbe71f414601a">  712</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a88bff2522448a45b6dbfbe71f414601a">ProSHADE_internal_data::ProSHADE_data::writePdb</a> ( std::string fName, proshade_double euA, proshade_double euB, proshade_double euG, proshade_double transX, proshade_double transY, proshade_double transZ )</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;{</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="comment">//================================================ Check for co-ordinate origin</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">if</span> ( !<a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#abc5e6a82b6b44e3666abfc190dc0bc64">ProSHADE_internal_io::isFilePDB</a> ( this-&gt;fileName ) )</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Cannot write co-ordinate file if the input file did not contain co-ordinates.&quot;</span>, <span class="stringliteral">&quot;EP00047&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;You have called the WritePDB function on structure which\n                    : was created by reading in a map. This is not allowed as\n                    : ProSHADE cannot create co-ordinates from map file.&quot;</span> );</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">//================================================ Open PDB file for reading</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    gemmi::Structure pdbFile                          = gemmi::read_structure ( gemmi::MaybeGzipped ( this-&gt;fileName ) );</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="comment">//================================================ If the map was rotated, do the same for the co-ordinates, making sure we take into account the rotation centre of the map</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordflow">if</span> ( ( euA != 0.0 ) || ( euB != 0.0 ) || ( euG != 0.0 ) )</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="comment">//============================================ Save original PDB COM position</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        proshade_double xCOMOriginal = 0.0, yCOMOriginal = 0.0, zCOMOriginal = 0.0;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a99fe02ef9da6b17ab51f1d82a32f02b9">ProSHADE_internal_mapManip::findPDBCOMValues</a>  ( pdbFile, &amp;xCOMOriginal, &amp;yCOMOriginal, &amp;zCOMOriginal );</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="comment">//============================================ Compute the rotation centre for the co-ordinates</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        proshade_double xRotPos                       = ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;xDimIndicesOriginal / 2 ) - this-&gt;xAxisOriginOriginal ) *</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                                                          ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;xDimIndicesOriginal - 1 ) / this-&gt;xDimSizeOriginal ) ) -</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                                                        (this-&gt;originalMapXCom - xCOMOriginal);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        proshade_double yRotPos                       = ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;yDimIndicesOriginal / 2 ) - this-&gt;yAxisOriginOriginal ) *</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                                                          ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;yDimIndicesOriginal - 1 ) / this-&gt;yDimSizeOriginal ) ) -</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                                                        (this-&gt;originalMapYCom - yCOMOriginal);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        proshade_double zRotPos                       = ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;zDimIndicesOriginal / 2 ) - this-&gt;zAxisOriginOriginal ) *</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                                                          ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;zDimIndicesOriginal - 1 ) / this-&gt;zDimSizeOriginal ) ) -</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                                                        (this-&gt;originalMapZCom - zCOMOriginal);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="comment">//============================================ Rotate the co-ordinates</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a4dd26d899d4e4291fefcfe0c9ffddc1b">ProSHADE_internal_mapManip::rotatePDBCoordinates</a> ( &amp;pdbFile, euA, euB, euG, xRotPos, yRotPos, zRotPos );</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="comment">//============================================ Compute the after rotation PDB COM position</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        proshade_double xCOMRotated = 0.0, yCOMRotated = 0.0, zCOMRotated = 0.0;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a99fe02ef9da6b17ab51f1d82a32f02b9">ProSHADE_internal_mapManip::findPDBCOMValues</a>  ( pdbFile, &amp;xCOMRotated, &amp;yCOMRotated, &amp;zCOMRotated );</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="comment">//============================================ Compute the after rotation position correction</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        proshade_double xPDBTrans                     = ( xCOMRotated - xCOMOriginal ) + ( this-&gt;mapPostRotXCom - this-&gt;originalMapXCom );</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        proshade_double yPDBTrans                     = ( yCOMRotated - yCOMOriginal ) + ( this-&gt;mapPostRotYCom - this-&gt;originalMapYCom );</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        proshade_double zPDBTrans                     = ( zCOMRotated - zCOMOriginal ) + ( this-&gt;mapPostRotZCom - this-&gt;originalMapZCom );</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="comment">//============================================ Correct the co-ordinate position after rotation</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a3892495503aa80bbb294574ee9a94e1d">ProSHADE_internal_mapManip::translatePDBCoordinates</a> ( &amp;pdbFile, xPDBTrans, yPDBTrans, zPDBTrans );</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">//================================================ Translate by required translation and the map centering (if applied)</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a3892495503aa80bbb294574ee9a94e1d">ProSHADE_internal_mapManip::translatePDBCoordinates</a> ( &amp;pdbFile, this-&gt;comMovX + transX, this-&gt;comMovY + transY, this-&gt;comMovZ + transZ );</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="comment">//================================================ Write the PDB file</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    std::ofstream outCoOrdFile;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    outCoOrdFile.open                                 ( fName.c_str() );</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">if</span> ( outCoOrdFile.is_open() )</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        gemmi::PdbWriteOptions opt;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        write_pdb                                     ( pdbFile, outCoOrdFile, opt );</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        std::stringstream hlpMessage;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        hlpMessage &lt;&lt; <span class="stringliteral">&quot;Failed to open the PDB file &quot;</span> &lt;&lt; fName &lt;&lt; <span class="stringliteral">&quot; for output.&quot;</span>;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( hlpMessage.str().c_str(), <span class="stringliteral">&quot;EP00048&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;ProSHADE has failed to open the PDB output file. This is\n                    : likely caused by either not having the write privileges\n                    : to the required output path, or by making a mistake in\n                    : the path.&quot;</span> );</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    outCoOrdFile.close                                ( );</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    return ;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;}</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00790"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aac87b1a87f32a742ea2b41014dac5f7b">  790</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aac87b1a87f32a742ea2b41014dac5f7b">ProSHADE_internal_data::ProSHADE_data::writeMask</a> ( std::string fName, proshade_double* mask )</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;{</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="comment">//================================================ Allocate the memory</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    proshade_double* hlpMap                           = <span class="keyword">new</span> proshade_double[this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( hlpMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="comment">//================================================ Copy original map and over-write with the mask</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        hlpMap[iter]                                  = this-&gt;internalMap[iter];</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        this-&gt;internalMap[iter]                       = mask[iter];</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="comment">//================================================ Write out the mask</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    this-&gt;writeMap                                    ( fName );</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="comment">//================================================ Copy the original map values back</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        this-&gt;internalMap[iter]                       = hlpMap[iter];</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keyword">delete</span>[] hlpMap;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    return ;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;}</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa67115a6b234764c958899863fb60b54">  827</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa67115a6b234764c958899863fb60b54">ProSHADE_internal_data::ProSHADE_data::invertMirrorMap</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;{</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map inversion.&quot;</span> );</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    proshade_signed arrayPos, invPos;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="comment">//================================================ Create helper map</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    proshade_double* hlpMap                           = <span class="keyword">new</span> proshade_double [this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( hlpMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="comment">//================================================ Save map values to the helper map</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        hlpMap[iter]                                  = this-&gt;internalMap[iter];</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">//================================================ Invert the values</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed xIt = 0; xIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;xDimIndices ); xIt++ )</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed yIt = 0; yIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;yDimIndices ); yIt++ )</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed zIt = 0; zIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;zDimIndices ); zIt++ )</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                <span class="comment">//==================================== Var init</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                arrayPos                              = zIt + this-&gt;zDimIndices * ( yIt + this-&gt;yDimIndices * xIt );</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                invPos                                = ( (this-&gt;zDimIndices-1) - zIt ) + this-&gt;zDimIndices * ( ( (this-&gt;yDimIndices-1) - yIt ) + this-&gt;yDimIndices * ( (this-&gt;xDimIndices-1) - xIt ) );</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                <span class="comment">//==================================== And save</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                this-&gt;internalMap[invPos]             = hlpMap[arrayPos];</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            }</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keyword">delete</span>[] hlpMap;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Map inversion completed.&quot;</span> );</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    return ;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;}</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a255bdb77824ce0fddc2454d5823219e1">  881</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a255bdb77824ce0fddc2454d5823219e1">ProSHADE_internal_data::ProSHADE_data::normaliseMap</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;{</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map normalisation.&quot;</span> );</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="comment">//================================================ Initialise vector of map values</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    std::vector&lt;proshade_double&gt; mapVals              ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices, 0.0 );</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">//================================================ Get all map values</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        mapVals.at(iter)                              = this-&gt;internalMap[iter];</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    }</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="comment">//================================================ Get mean and sd</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    proshade_double* meanSD                           = <span class="keyword">new</span> proshade_double[2];</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a8a7c6330e101fb6d729aaf6f545db9c8">ProSHADE_internal_maths::vectorMeanAndSD</a>          ( &amp;mapVals, meanSD );</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="comment">//================================================ Normalise the values</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        this-&gt;internalMap[iter]                       = ( this-&gt;internalMap[iter] - meanSD[0] ) / meanSD[1];</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    }</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="comment">//================================================ Clear the vector</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    mapVals.clear                                     ( );</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keyword">delete</span>[] meanSD;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Map normalisation completed.&quot;</span> );</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    return ;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;}</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0122be830893f5d82bab742be54d1ee7">  928</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0122be830893f5d82bab742be54d1ee7">ProSHADE_internal_data::ProSHADE_data::maskMap</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;{</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Computing mask.&quot;</span> );</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">//================================================ Initialise the blurred map</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    proshade_double* blurredMap                       = <span class="keyword">new</span> proshade_double[this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( blurredMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="comment">//================================================ Compute blurred map</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#afdac8ed8f140bdcd289ee666b61789d4">ProSHADE_internal_mapManip::blurSharpenMap</a>        ( this-&gt;internalMap, blurredMap, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices,</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                                                        this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a51c87d0b415c8eaa517dbb9b5496e7e9">blurFactor</a> );</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="comment">//================================================ Compute mask from blurred map and save it into the original map</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a42699d52d1be0d24e58deea4e25439bf">ProSHADE_internal_mapManip::getMaskFromBlurr</a>      ( blurredMap, this-&gt;internalMap, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7c96697585083a53f83556e70e4faca8">maskingThresholdIQRs</a> );</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="comment">//================================================ Print the mask if need be</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a29445fb6221eed35a32147814a3f58d5">saveMask</a> ) {  <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#affb17d9099f0b85b3af04a78d5c670f4">maskFileName</a> == <span class="stringliteral">&quot;&quot;</span> ) { this-&gt;writeMask ( <span class="stringliteral">&quot;proshade_mask.map&quot;</span>, blurredMap ); } <span class="keywordflow">else</span> { std::stringstream ss; ss &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#affb17d9099f0b85b3af04a78d5c670f4">maskFileName</a> &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; this-&gt;inputOrder &lt;&lt; <span class="stringliteral">&quot;.map&quot;</span>; this-&gt;writeMask ( ss.str(), blurredMap ); } }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keyword">delete</span>[] blurredMap;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Mask computed.&quot;</span> );</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    return ;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;}</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac0dc9f3ed79cc98719e6b727bb8bb982">  968</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac0dc9f3ed79cc98719e6b727bb8bb982">ProSHADE_internal_data::ProSHADE_data::getReBoxBoundaries</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, proshade_signed*&amp; ret )</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;{</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Finding new boundaries.&quot;</span> );</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">//================================================ If same bounds as first one are required, test if possible and return these instead</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a1f0d2cb45fee521ddb2d0bc30beff3ec">useSameBounds</a> &amp;&amp; ( this-&gt;inputOrder != 0 ) )</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 6; iter++ ) { ret[iter] = settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa3e24ef5a66fa7204a2ba9c27f2f12b9">forceBounds</a>[iter]; }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    }</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="comment">//================================================ In this case, bounds need to be found de novo</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="comment">//============================================ Find the non-zero bounds</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a26c8be8b50be424bb35d3f6f39aa9aff">ProSHADE_internal_mapManip::getNonZeroBounds</a>  ( this-&gt;internalMap, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices,</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                                                        this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, ret );</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <span class="comment">//============================================ Add the extra space</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a7c88b1152378beca4ccee251f2fb5e06">ProSHADE_internal_mapManip::addExtraBoundSpace</a> ( this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices,</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                                                         this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a633435d4c8a7fd6533016c00ad9ba791">boundsExtraSpace</a> );</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="comment">//============================================ Beautify boundaries</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ae273430e12dd5bce08cf29c7689800dd">ProSHADE_internal_mapManip::beautifyBoundaries</a> ( ret, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a827e3241fa6401027e0526fffb8b281d">boundsSimilarityThreshold</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a> );</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <span class="comment">//============================================ Report function results</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        std::stringstream ssHlp;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        ssHlp &lt;&lt; <span class="stringliteral">&quot;New boundaries are: &quot;</span> &lt;&lt; ret[1] - ret[0] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; ret[3] - ret[2] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; ret[5] - ret[4] + 1;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, ssHlp.str() );</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="comment">//============================================ If need be, save boundaries to be used for all other structure</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a1f0d2cb45fee521ddb2d0bc30beff3ec">useSameBounds</a> &amp;&amp; ( this-&gt;inputOrder == 0 ) )</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 6; iter++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa3e24ef5a66fa7204a2ba9c27f2f12b9">forceBounds</a>[iter] = ret[iter]; }</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        }</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    }</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;New boundaries determined.&quot;</span> );</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    return ;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;}</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a503ffea1b18c7bdf8e784d7fa5bb1d78"> 1024</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a503ffea1b18c7bdf8e784d7fa5bb1d78">ProSHADE_internal_data::ProSHADE_data::getReBoxBoundariesPy</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, <span class="keywordtype">int</span>* reBoxBounds, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;{</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Finding new boundaries.&quot;</span> );</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="comment">//================================================ Initialise internal variables</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    proshade_signed* ret                              = NULL;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    ret                                               = <span class="keyword">new</span> proshade_signed[6];</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( ret, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="comment">//================================================ If same bounds as first one are required, test if possible and return these instead</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a1f0d2cb45fee521ddb2d0bc30beff3ec">useSameBounds</a> &amp;&amp; ( this-&gt;inputOrder != 0 ) )</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    {</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 6; iter++ ) { ret[iter] = settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa3e24ef5a66fa7204a2ba9c27f2f12b9">forceBounds</a>[iter]; }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="comment">//================================================ In this case, bounds need to be found de novo</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="comment">//============================================ Find the non-zero bounds</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a26c8be8b50be424bb35d3f6f39aa9aff">ProSHADE_internal_mapManip::getNonZeroBounds</a> ( this-&gt;internalMap, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, ret );</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="comment">//============================================ Add the extra space</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a7c88b1152378beca4ccee251f2fb5e06">ProSHADE_internal_mapManip::addExtraBoundSpace</a> ( this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a633435d4c8a7fd6533016c00ad9ba791">boundsExtraSpace</a> );</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="comment">//============================================ Beautify boundaries</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ae273430e12dd5bce08cf29c7689800dd">ProSHADE_internal_mapManip::beautifyBoundaries</a> ( ret, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a827e3241fa6401027e0526fffb8b281d">boundsSimilarityThreshold</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a> );</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="comment">//============================================ Report function results</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        std::stringstream ssHlp;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        ssHlp &lt;&lt; <span class="stringliteral">&quot;New boundaries are: &quot;</span> &lt;&lt; ret[1] - ret[0] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; ret[3] - ret[2] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; ret[5] - ret[4] + 1;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, ssHlp.str() );</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="comment">//============================================ If need be, save boundaries to be used for all other structure</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a1f0d2cb45fee521ddb2d0bc30beff3ec">useSameBounds</a> &amp;&amp; ( this-&gt;inputOrder == 0 ) )</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 6; iter++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa3e24ef5a66fa7204a2ba9c27f2f12b9">forceBounds</a>[iter] = ret[iter]; }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    }</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="comment">//================================================ Copy internal to output array</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    reBoxBounds[0]                                    = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( ret[0] );</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    reBoxBounds[1]                                    = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( ret[1] );</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    reBoxBounds[2]                                    = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( ret[2] );</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    reBoxBounds[3]                                    = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( ret[3] );</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    reBoxBounds[4]                                    = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( ret[4] );</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    reBoxBounds[5]                                    = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( ret[5] );</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keyword">delete</span>[] ret;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;New boundaries determined.&quot;</span> );</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    return ;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;}</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3349a7f6ffecc3ffd4e09192eb919248"> 1093</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3349a7f6ffecc3ffd4e09192eb919248">ProSHADE_internal_data::ProSHADE_data::createNewMapFromBounds</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_data</a>*&amp; newStr, proshade_signed* newBounds )</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;{</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Creating new structure according to the new  bounds.&quot;</span> );</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">//================================================ Fill in basic info</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a>                                  = <span class="stringliteral">&quot;N/A&quot;</span>;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4052e498b4650f62bfe5ff37ed959292">fileType</a>                                  = ProSHADE_internal_io::MAP;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="comment">//================================================ Fill in new structure values</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>                               = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( newBounds[1] ) - <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( newBounds[0] ) + 1;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>                               = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( newBounds[3] ) - <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( newBounds[2] ) + 1;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>                               = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( newBounds[5] ) - <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( newBounds[4] ) + 1;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">aAngle</a>                                    = this-&gt;aAngle;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9dbcec9f32eb76625d7aa59d8c2701d9">bAngle</a>                                    = this-&gt;aAngle;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e2f99f00dd05198b508633cf7f6f080">cAngle</a>                                    = this-&gt;aAngle;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>                                  = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ) * ( this-&gt;xDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimIndices ) );</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>                                  = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * ( this-&gt;yDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) );</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>                                  = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( this-&gt;zDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) );</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">xGridIndices</a>                              = newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">yGridIndices</a>                              = newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">zGridIndices</a>                              = newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">xAxisOrder</a>                                = this-&gt;xAxisOrder;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">yAxisOrder</a>                                = this-&gt;yAxisOrder;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">zAxisOrder</a>                                = this-&gt;zAxisOrder;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            </div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a>                               = this-&gt;xAxisOrigin + newBounds[0];</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a>                               = this-&gt;yAxisOrigin + newBounds[2];</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a>                               = this-&gt;zAxisOrigin + newBounds[4];</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>                                     = this-&gt;xFrom + newBounds[0];</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>                                     = this-&gt;yFrom + newBounds[2];</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>                                     = this-&gt;zFrom + newBounds[4];</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>                                       = this-&gt;xTo - ( (this-&gt;xDimIndices-1) - newBounds[1] );</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>                                       = this-&gt;yTo - ( (this-&gt;yDimIndices-1) - newBounds[3] );</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>                                       = this-&gt;zTo - ( (this-&gt;zDimIndices-1) - newBounds[5] );</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    </div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="comment">//================================================ Allocate new structure map</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>                               = <span class="keyword">new</span> proshade_double[newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="comment">//================================================ Copy the map</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a2c857c8f26f99695e7de52025f590205">ProSHADE_internal_mapManip::copyMapByBounds</a>       ( newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>,</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                                                        this-&gt;xFrom, this-&gt;yFrom, this-&gt;zFrom, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>,</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                                                        this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, this-&gt;internalMap );</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;New structure created.&quot;</span> );</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    return ;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    </div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;}</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af0ef7edd1c46d88512bc65e448a84a4c"> 1165</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af0ef7edd1c46d88512bc65e448a84a4c">ProSHADE_internal_data::ProSHADE_data::createNewMapFromBoundsPy</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_data</a>* newStr, <span class="keywordtype">int</span>* newBounds, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;{</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Creating new structure according to the new  bounds.&quot;</span> );</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="comment">//================================================ Fill in basic info</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a>                                  = <span class="stringliteral">&quot;N/A&quot;</span>;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4052e498b4650f62bfe5ff37ed959292">fileType</a>                                  = ProSHADE_internal_io::MAP;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="comment">//================================================ Fill in new structure values</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>                               = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( newBounds[1] ) - <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( newBounds[0] ) + 1;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>                               = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( newBounds[3] ) - <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( newBounds[2] ) + 1;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>                               = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( newBounds[5] ) - <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( newBounds[4] ) + 1;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">aAngle</a>                                    = this-&gt;aAngle;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9dbcec9f32eb76625d7aa59d8c2701d9">bAngle</a>                                    = this-&gt;aAngle;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e2f99f00dd05198b508633cf7f6f080">cAngle</a>                                    = this-&gt;aAngle;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            </div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>                                  = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ) * ( this-&gt;xDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimIndices ) );</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>                                  = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * ( this-&gt;yDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) );</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>                                  = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( this-&gt;zDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) );</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;            </div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">xGridIndices</a>                              = newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">yGridIndices</a>                              = newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">zGridIndices</a>                              = newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            </div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">xAxisOrder</a>                                = this-&gt;xAxisOrder;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">yAxisOrder</a>                                = this-&gt;yAxisOrder;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">zAxisOrder</a>                                = this-&gt;zAxisOrder;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a>                               = this-&gt;xAxisOrigin + newBounds[0];</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a>                               = this-&gt;yAxisOrigin + newBounds[2];</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a>                               = this-&gt;zAxisOrigin + newBounds[4];</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>                                     = this-&gt;xFrom + newBounds[0];</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>                                     = this-&gt;yFrom + newBounds[2];</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>                                     = this-&gt;zFrom + newBounds[4];</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>                                       = this-&gt;xTo - ( (this-&gt;xDimIndices-1) - newBounds[1] );</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>                                       = this-&gt;yTo - ( (this-&gt;yDimIndices-1) - newBounds[3] );</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>                                       = this-&gt;zTo - ( (this-&gt;zDimIndices-1) - newBounds[5] );</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="comment">//================================================ Allocate new structure map</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>                               = <span class="keyword">new</span> proshade_double[newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="comment">//================================================ Copy the map</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a2c857c8f26f99695e7de52025f590205">ProSHADE_internal_mapManip::copyMapByBounds</a>       ( newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>,</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                                                        this-&gt;xFrom, this-&gt;yFrom, this-&gt;zFrom, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>,</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                                                        this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, this-&gt;internalMap );</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;New structure created.&quot;</span> );</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    return ;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;}</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160; </div>
<div class="line"><a name="l01231"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab573ea90a16991a06a77c5343328b060"> 1231</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab573ea90a16991a06a77c5343328b060">ProSHADE_internal_data::ProSHADE_data::reSampleMap</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;{</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="comment">//================================================ Initialise the return variable</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    proshade_single* changeVals                       = <span class="keyword">new</span> proshade_single[6];</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="comment">//================================================ Now re-sample the map</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab61d2183930ea26b3d49e7662052e83b">changeMapResolution</a> )</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    {</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ac311071faa65db4dfc1886d2a6de78ef">ProSHADE_internal_mapManip::reSampleMapToResolutionFourier</a> ( this-&gt;internalMap, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a>, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices,</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                                                                     this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, changeVals );</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4f49a4f2263aa12ccb1737f8dc32c9ac">changeMapResolutionTriLinear</a> )</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        {</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Requested both Fourier-space and real-space map re-sampling. Defaulting to only Fourier space re-samplling.&quot;</span>, <span class="stringliteral">&quot;WM00049&quot;</span> );</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        }</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    }</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4f49a4f2263aa12ccb1737f8dc32c9ac">changeMapResolutionTriLinear</a> &amp;&amp; !settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab61d2183930ea26b3d49e7662052e83b">changeMapResolution</a> )</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a5db74cc13dd4b64cf0a8377ed078b47c">ProSHADE_internal_mapManip::reSampleMapToResolutionTrilinear</a> ( this-&gt;internalMap, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a>, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices,</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                                                                       this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, changeVals );</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160; </div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    }</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="comment">//================================================ Set the internal values to reflect the new map size</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    this-&gt;xDimIndices                                += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[0] );</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    this-&gt;yDimIndices                                += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[1] );</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    this-&gt;zDimIndices                                += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[2] );</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            </div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    this-&gt;xGridIndices                                = this-&gt;xDimIndices;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    this-&gt;yGridIndices                                = this-&gt;yDimIndices;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    this-&gt;zGridIndices                                = this-&gt;zDimIndices;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    this-&gt;xTo                                        += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[0] );</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    this-&gt;yTo                                        += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[1] );</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    this-&gt;zTo                                        += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[2] );</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    this-&gt;xDimSize                                    = changeVals[3];</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    this-&gt;yDimSize                                    = changeVals[4];</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    this-&gt;zDimSize                                    = changeVals[5];</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="comment">//================================================ Figure how much the new map moved</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    proshade_single xMov                              = -( ( this-&gt;xFrom * ( this-&gt;xDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimIndices - changeVals[0] ) ) ) -</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                                                           ( this-&gt;xFrom * ( this-&gt;xDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimIndices ) ) ) );</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    proshade_single yMov                              = -( ( this-&gt;yFrom * ( this-&gt;yDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimIndices - changeVals[1] ) ) ) -</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                                                           ( this-&gt;yFrom * ( this-&gt;yDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) ) ) );</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    proshade_single zMov                              = -( ( this-&gt;zFrom * ( this-&gt;zDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimIndices - changeVals[2] ) ) ) -</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                                                           ( this-&gt;zFrom * ( this-&gt;zDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) ) ) );</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160; </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="comment">//================================================ Move by indices (this should be sufficient)</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">ProSHADE_internal_mapManip::moveMapByIndices</a>      ( &amp;xMov, &amp;yMov, &amp;zMov, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, &amp;this-&gt;xFrom, &amp;this-&gt;xTo,</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                                                        &amp;this-&gt;yFrom, &amp;this-&gt;yTo, &amp;this-&gt;zFrom, &amp;this-&gt;zTo, &amp;this-&gt;xAxisOrigin, &amp;this-&gt;yAxisOrigin, &amp;this-&gt;zAxisOrigin );</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    </div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>      ( this-&gt;internalMap, xMov, yMov, zMov, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize,</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                                                        this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices );</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keyword">delete</span>[] changeVals;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    return ;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;}</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01303"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a80ff45ef40549fb6a1d80b70865fc807"> 1303</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a80ff45ef40549fb6a1d80b70865fc807">ProSHADE_internal_data::ProSHADE_data::centreMapOnCOM</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;{</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Centering map onto its COM.&quot;</span> );</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    proshade_unsign arrPos                            = 0;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    proshade_single xCOM                              = 0.0;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    proshade_single yCOM                              = 0.0;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    proshade_single zCOM                              = 0.0;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    proshade_single totDens                           = 0.0;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    </div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="comment">//================================================ Find the COM location</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign xIt = 0; xIt &lt; this-&gt;xDimIndices; xIt++ )</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    {</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign yIt = 0; yIt &lt; this-&gt;yDimIndices; yIt++ )</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign zIt = 0; zIt &lt; this-&gt;zDimIndices; zIt++ )</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            {</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                <span class="comment">//==================================== Get index</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                arrPos                                = zIt + this-&gt;zDimIndices * ( yIt + this-&gt;yDimIndices * xIt );</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                </div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                <span class="comment">//==================================== Get COM</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                <span class="keywordflow">if</span> ( this-&gt;internalMap[arrPos] &gt; 0.0 )</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                {</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                    xCOM                             += <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;internalMap[arrPos] * xIt );</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                    yCOM                             += <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;internalMap[arrPos] * yIt );</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                    zCOM                             += <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;internalMap[arrPos] * zIt );</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                    totDens                          += <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;internalMap[arrPos] );</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                }</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            }</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        }</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    }</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    xCOM                                             /= totDens;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    yCOM                                             /= totDens;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    zCOM                                             /= totDens;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    </div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="comment">//================================================ Find distance from COM to map centre in Angstroms</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    proshade_single xDist                             = ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimIndices / 2.0 ) - xCOM ) * <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimSize / this-&gt;xDimIndices );</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    proshade_single yDist                             = ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimIndices / 2.0 ) - yCOM ) * <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimSize / this-&gt;yDimIndices );</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    proshade_single zDist                             = ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimIndices / 2.0 ) - zCOM ) * <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimSize / this-&gt;zDimIndices );</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="comment">//================================================ Save COM movement</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    this-&gt;comMovX                                     = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( xDist );</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    this-&gt;comMovY                                     = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( yDist );</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    this-&gt;comMovZ                                     = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( zDist );</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="comment">//================================================ Move the map within the box</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>      ( this-&gt;internalMap, xDist, yDist, zDist, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices );</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Map centered.&quot;</span> );</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    return ;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    </div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;}</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7a402c710af1af5fabf7505848dad047"> 1369</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7a402c710af1af5fabf7505848dad047">ProSHADE_internal_data::ProSHADE_data::addExtraSpace</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;{</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot;Adding extra &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">addExtraSpace</a> &lt;&lt; <span class="stringliteral">&quot; angstroms.&quot;</span>;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1,  hlpSS.str() );</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    </div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="comment">//================================================ Figure how much indices need to change</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    proshade_unsign xAddIndices                       = <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">addExtraSpace</a> / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimSize / this-&gt;xDimIndices ) );</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    proshade_unsign yAddIndices                       = <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">addExtraSpace</a> / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimSize / this-&gt;yDimIndices ) );</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    proshade_unsign zAddIndices                       = <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">addExtraSpace</a> / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimSize / this-&gt;zDimIndices ) );</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="comment">//================================================ Update internal data variables</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    this-&gt;xDimSize                                   += <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( 2 * xAddIndices ) * <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimSize / this-&gt;xDimIndices );</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    this-&gt;yDimSize                                   += <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( 2 * yAddIndices ) * <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimSize / this-&gt;yDimIndices );</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    this-&gt;zDimSize                                   += <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( 2 * zAddIndices ) * <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimSize / this-&gt;zDimIndices );</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            </div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    this-&gt;xDimIndices                                += 2 * xAddIndices;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    this-&gt;yDimIndices                                += 2 * yAddIndices;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    this-&gt;zDimIndices                                += 2 * zAddIndices;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;            </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    this-&gt;xGridIndices                                = this-&gt;xDimIndices;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    this-&gt;yGridIndices                                = this-&gt;yDimIndices;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    this-&gt;zGridIndices                                = this-&gt;zDimIndices;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;            </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    this-&gt;xAxisOrigin                                -= xAddIndices;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    this-&gt;yAxisOrigin                                -= yAddIndices;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    this-&gt;zAxisOrigin                                -= zAddIndices;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    this-&gt;xFrom                                      -= xAddIndices;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    this-&gt;yFrom                                      -= yAddIndices;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    this-&gt;zFrom                                      -= zAddIndices;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;            </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    this-&gt;xTo                                        += xAddIndices;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    this-&gt;yTo                                        += yAddIndices;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    this-&gt;zTo                                        += zAddIndices;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    </div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="comment">//================================================ Allocate new map</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    proshade_double* newMap                           = <span class="keyword">new</span> proshade_double[this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( newMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="comment">//================================================ Set new map to zeroes</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    {</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        newMap[iter]                                  = 0.0;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    }</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    </div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="comment">//================================================ Update the map</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    proshade_unsign newMapIndex, oldMapIndex;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign xIt = 0; xIt &lt; (this-&gt;xDimIndices - xAddIndices); xIt++ )</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <span class="comment">//============================================ Check if point is applicable</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        <span class="keywordflow">if</span> ( xIt &lt; xAddIndices ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        </div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign yIt = 0; yIt &lt; (this-&gt;yDimIndices - yAddIndices); yIt++ )</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        {</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            <span class="comment">//======================================== Check if point is applicable</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;            <span class="keywordflow">if</span> ( yIt &lt; yAddIndices ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign zIt = 0; zIt &lt; (this-&gt;zDimIndices - zAddIndices); zIt++ )</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                <span class="comment">//==================================== Check if point is applicable</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                <span class="keywordflow">if</span> ( zIt &lt; zAddIndices ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                <span class="comment">//==================================== Var init</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                newMapIndex                           = zIt + this-&gt;zDimIndices * ( yIt + this-&gt;yDimIndices * xIt );</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                oldMapIndex                           = (zIt - zAddIndices) + (this-&gt;zDimIndices - ( 2 * zAddIndices ) ) * ( (yIt - yAddIndices) + (this-&gt;yDimIndices - ( 2 * yAddIndices ) ) * (xIt - xAddIndices) );</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                newMap[newMapIndex]                   = this-&gt;internalMap[oldMapIndex];</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            }</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        }</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    }</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    </div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="comment">//================================================ Copy new to old</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keyword">delete</span>[] this-&gt;internalMap;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    this-&gt;internalMap                                 = <span class="keyword">new</span> proshade_double[this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;internalMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    {</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        this-&gt;internalMap[iter]                       = newMap[iter];</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    }</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    </div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="keyword">delete</span>[] newMap;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Extra space added.&quot;</span> );</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    </div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    return ;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;}</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160; </div>
<div class="line"><a name="l01472"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afcb4202e9ffea1b99c59f73faf06d899"> 1472</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afcb4202e9ffea1b99c59f73faf06d899">ProSHADE_internal_data::ProSHADE_data::processInternalMap</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;{</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="comment">//================================================ Invert map</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0d205c102e722997ab1f0953f76a288a">invertMap</a> ) { this-&gt;invertMirrorMap ( settings ); }</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map inversion (mirror image) not requested.&quot;</span> ); }</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <span class="comment">//================================================ Normalise map</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0d796061e73e8635f75fc6921b98ad66">normaliseMap</a> ) { this-&gt;normaliseMap ( settings ); }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map normalisation not requested.&quot;</span> ); }</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="comment">//================================================ Compute mask</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="comment">//if ( settings-&gt;maskMap ) { if ( settings-&gt;useCorrelationMasking ) { this-&gt;maskMapCorrelation ( settings ); } else { this-&gt;maskMap ( settings ); } }</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7c941c912cd17ad86057b8d7a15b9a21">maskMap</a> ) { this-&gt;maskMap ( settings ); }</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Masking not requested.&quot;</span> ); }</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160; </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="comment">//================================================ Centre map</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a37c9037721c1ad28ad6421a31dbcd8d8">moveToCOM</a> ) { this-&gt;centreMapOnCOM ( settings ); }</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map centering not requested.&quot;</span> ); }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="comment">//================================================ Add extra space</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">addExtraSpace</a> != 0.0 ) { this-&gt;addExtraSpace ( settings ); }</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Extra space not requested.&quot;</span> ); }</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="comment">//================================================ Remove phase, if required</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">if</span> ( !settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2019a6bae1b3e6f7d8805ae2734b769e">usePhase</a> ) { this-&gt;removePhaseInormation ( settings ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Phase information removed from the data.&quot;</span> ); }</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Phase information retained in the data.&quot;</span> ); }</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    </div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="comment">//================================================ Compute and save the original map values</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    this-&gt;setOriginalMapValues                        ( );</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    </div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    return ;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;}</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; </div>
<div class="line"><a name="l01516"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a188b648a0ad28b598d682ca14f288dc4"> 1516</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a188b648a0ad28b598d682ca14f288dc4">ProSHADE_internal_data::ProSHADE_data::getSpherePositions</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;{</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="comment">//================================================ Check the current settings value is set to auto</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;spherePos.size() != 0 )</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    {</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        std::stringstream hlpSS;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;The sphere distances were determined as &quot;</span> &lt;&lt; this-&gt;spherePos.at(0);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 1; iter &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;spherePos.size() ); iter++ ) { hlpSS &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; this-&gt;spherePos.at(iter); }</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot; Angstroms.&quot;</span>;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, hlpSS.str() );</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        return ;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    }</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    </div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="comment">//================================================ Find maximum diagonal</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    proshade_unsign maxDim                            = std::max ( this-&gt;xDimSize, std::max ( this-&gt;yDimSize, this-&gt;zDimSize ) );</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    proshade_unsign minDim                            = std::min ( this-&gt;xDimSize, std::min ( this-&gt;yDimSize, this-&gt;zDimSize ) );</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    proshade_unsign midDim                            = 0;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    <span class="keywordflow">if</span>      ( ( this-&gt;xDimSize &lt; maxDim ) &amp;&amp; ( this-&gt;xDimSize &gt; minDim ) ) { midDim = this-&gt;xDimSize; }</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ( this-&gt;yDimSize &lt; maxDim ) &amp;&amp; ( this-&gt;yDimSize &gt; minDim ) ) { midDim = this-&gt;yDimSize; }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keywordflow">else</span>                                                                   { midDim = this-&gt;zDimSize; }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    proshade_single maxDiag                           = std::sqrt ( std::pow ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( maxDim ), 2.0 ) +</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                                                                    std::pow ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( midDim ), 2.0 ) );</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="comment">//================================================ Set between the points</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="keywordflow">for</span> ( proshade_single iter = 0.5; ( iter * settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42e4b11981a2d3a518cb3c70e5470fb2">maxSphereDists</a> ) &lt; ( maxDiag / 2.0 ); iter += 1.0 )</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    {</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a2d19df22d740c51de6edafbf679ae3fd">ProSHADE_internal_misc::addToSingleVector</a>     ( &amp;this-&gt;spherePos, ( iter * settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42e4b11981a2d3a518cb3c70e5470fb2">maxSphereDists</a> ) );</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="comment">//================================================ Save the number of spheres</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    this-&gt;noSpheres                                   = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( this-&gt;spherePos.size() );</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot;The sphere distances were determined as &quot;</span> &lt;&lt; this-&gt;spherePos.at(0);</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 1; iter &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;spherePos.size() ); iter++ ) { hlpSS &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; this-&gt;spherePos.at(iter); }</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot; Angstroms.&quot;</span>;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, hlpSS.str() );</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    </div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    return ;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160; </div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;}</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160; </div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; </div>
<div class="line"><a name="l01570"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a56bfcfacedabd84ec54aa2843d59e014"> 1570</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a56bfcfacedabd84ec54aa2843d59e014">ProSHADE_internal_data::ProSHADE_data::mapToSpheres</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;{</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting sphere mapping procedure.&quot;</span> );</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    </div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="comment">//================================================ Determine spherical harmonics variables</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a46e32d9d122118fa08fd4f051f37e506">determineAllSHValues</a>                    ( this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices );</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Sphere settings determined.&quot;</span> );</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    </div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="comment">//================================================ Find number of spheres supported</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    this-&gt;getSpherePositions                          ( settings );</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Sphere positions obtained.&quot;</span> );</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    </div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <span class="comment">//================================================ Create sphere objects and map the density</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    this-&gt;spheres                                     = <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html">ProSHADE_internal_spheres::ProSHADE_sphere</a>* [ this-&gt;noSpheres ];</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;spherePos.size() ); iter++ )</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        ss &lt;&lt; <span class="stringliteral">&quot;Now mapping sphere &quot;</span> &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot; .&quot;</span>;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, ss.str() );</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        </div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        this-&gt;spheres[iter]                           = <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html">ProSHADE_internal_spheres::ProSHADE_sphere</a> ( this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices,</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                                                                                                         this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, iter,</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                                                                                                        &amp;this-&gt;spherePos, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2f1e4debc49664de8842d1b42be74d2d">progressiveSphereMapping</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a8324ed7ec9c19df21511f117df80ab11">maxBandwidth</a>,</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                                                                                                         this-&gt;internalMap, &amp;this-&gt;maxShellBand );</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    }</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Sphere mapping procedure completed.&quot;</span> );</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    </div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    return ;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    </div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;}</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160; </div>
<div class="line"><a name="l01613"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23f9a5f8f6fb7cf0f0324bc1d83d6090"> 1613</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23f9a5f8f6fb7cf0f0324bc1d83d6090">ProSHADE_internal_data::ProSHADE_data::computeSphericalHarmonics</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;{</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting spherical harmonics decomposition.&quot;</span> );</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    </div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="comment">//================================================ Initialise memory</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    this-&gt;sphericalHarmonics                          = <span class="keyword">new</span> proshade_complex* [this-&gt;noSpheres];</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;sphericalHarmonics, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; this-&gt;noSpheres; iter++ )</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    {</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        this-&gt;sphericalHarmonics[iter]                = <span class="keyword">new</span> proshade_complex [(this-&gt;spheres[iter]-&gt;getLocalBandwidth() * 2) * (this-&gt;spheres[iter]-&gt;getLocalBandwidth() * 2)];</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( this-&gt;sphericalHarmonics[iter], __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    }</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    </div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="comment">//================================================ Compute the spherical harmonics</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; this-&gt;noSpheres; iter++ )</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        ss &lt;&lt; <span class="stringliteral">&quot;Now decomposing sphere &quot;</span> &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot;. &quot;</span> &lt;&lt; <span class="stringliteral">&quot;( Band is: &quot;</span> &lt;&lt; this-&gt;spheres[iter]-&gt;getLocalBandwidth() &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, ss.str() );</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        </div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        <span class="comment">//============================================ Compute</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__spherical_harmonics.html#a3fa7caeb0d21183a39d7cca2d889c437">ProSHADE_internal_sphericalHarmonics::computeSphericalHarmonics</a> ( this-&gt;spheres[iter]-&gt;getLocalBandwidth(), this-&gt;spheres[iter]-&gt;getMappedData(), this-&gt;sphericalHarmonics[iter] );</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    }</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    </div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Spherical harmonics decomposition complete.&quot;</span> );</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    </div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    return ;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    </div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;}</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160; </div>
<div class="line"><a name="l01656"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af60532f379f5f3549a598aeb504fe311"> 1656</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af60532f379f5f3549a598aeb504fe311">ProSHADE_internal_data::ProSHADE_data::detectSymmetryInStructure</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* axes )</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;{</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    std::vector&lt; proshade_double* &gt; CSyms;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    </div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="comment">//================================================ Was any particular symmetry requested?</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;&quot;</span> )</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    {</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <span class="comment">//============================================ Run the symmetry detection functions for C, D, T, O and I symmetries</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        CSyms                                         = this-&gt;getCyclicSymmetriesList ( settings );</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        std::vector&lt; proshade_double* &gt; DSyms         = this-&gt;getDihedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        std::vector&lt; proshade_double* &gt; ISyms         = this-&gt;getIcosahedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        std::vector&lt; proshade_double* &gt; OSyms; std::vector&lt; proshade_double* &gt; TSyms;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <span class="keywordflow">if</span> ( ISyms.size() &lt; 31 ) {  OSyms = this-&gt;getOctahedralSymmetriesList ( settings, &amp;CSyms ); <span class="keywordflow">if</span> ( OSyms.size() &lt; 13 ) { TSyms = this-&gt;getTetrahedralSymmetriesList ( settings, &amp;CSyms ); } }</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        <span class="comment">//============================================ Decide on recommended symmetry</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        this-&gt;saveRecommendedSymmetry                 ( settings, &amp;CSyms, &amp;DSyms, &amp;TSyms, &amp;OSyms, &amp;ISyms, axes );</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    }</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    </div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;C&quot;</span> )</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    {</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        <span class="comment">//============================================ Run only the C symmetry detection and search for requested fold</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        CSyms                                         = this-&gt;getCyclicSymmetriesList ( settings );</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        this-&gt;saveRequestedSymmetryC                  ( settings, &amp;CSyms, axes );</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    }</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    </div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;D&quot;</span> )</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    {</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;        <span class="comment">//============================================ Run only the D symmetry detection and search for requested fold</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        CSyms                                         = this-&gt;getCyclicSymmetriesList ( settings );</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        std::vector&lt; proshade_double* &gt; DSyms         = this-&gt;getDihedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        this-&gt;saveRequestedSymmetryD                  ( settings, &amp;DSyms, axes );</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    }</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    </div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;T&quot;</span> )</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    {</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        <span class="comment">//============================================ Run only the T symmetry detection and search for requested fold</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        CSyms                                         = this-&gt;getCyclicSymmetriesList ( settings );</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        std::vector&lt; proshade_double* &gt; TSyms         = this-&gt;getTetrahedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        <span class="keywordflow">if</span> ( TSyms.size() == 7 )              { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a> ( <span class="stringliteral">&quot;T&quot;</span> ); <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( TSyms.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( TSyms.at(it) ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, TSyms.at(it) ); } }</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        <span class="keywordflow">else</span>                                  { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a> ( <span class="stringliteral">&quot;&quot;</span> ); }</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    }</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    </div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;O&quot;</span> )</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        <span class="comment">//============================================ Run only the O symmetry detection and search for requested fold</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        CSyms                                         = this-&gt;getCyclicSymmetriesList ( settings );</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        std::vector&lt; proshade_double* &gt; OSyms         = this-&gt;getOctahedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="keywordflow">if</span> ( OSyms.size() == 13 )             { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a> ( <span class="stringliteral">&quot;O&quot;</span> ); <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( OSyms.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( OSyms.at(it) ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, OSyms.at(it) ); } }</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        <span class="keywordflow">else</span>                                  { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a> ( <span class="stringliteral">&quot;&quot;</span> ); }</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    }</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    </div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;I&quot;</span> )</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    {</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="comment">//============================================ Run only the T symmetry detection and search for requested fold</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        CSyms                                         = this-&gt;getCyclicSymmetriesList ( settings );</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        std::vector&lt; proshade_double* &gt; ISyms         = this-&gt;getIcosahedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <span class="keywordflow">if</span> ( ISyms.size() == 31 )             { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a> ( <span class="stringliteral">&quot;I&quot;</span> ); <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( ISyms.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( ISyms.at(it) ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, ISyms.at(it) ); } }</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <span class="keywordflow">else</span>                                  { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a> ( <span class="stringliteral">&quot;&quot;</span> ); }</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    }</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    </div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="keywordflow">if</span> ( ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;C&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;D&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;T&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;O&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;I&quot;</span> ) )</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    {</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Requested symmetry supplied, but not recognised.&quot;</span>, <span class="stringliteral">&quot;ES00032&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;There are only the following value allowed for the\n                    : symmetry type request: \&quot;C\&quot;, \&quot;D\&quot;, \&quot;T\&quot;, \&quot;O\&quot; and \&quot;I\&quot;. Any\n                    : other value will result in this error.&quot;</span> );</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    }</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160; </div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( CSyms.size() ); it++ ) { <span class="keyword">delete</span>[] CSyms.at(it); }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    </div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    return ;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    </div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;}</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160; </div>
<div class="line"><a name="l01740"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3c589f8f2165cb1ad080b306dc0cbc25"> 1740</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3c589f8f2165cb1ad080b306dc0cbc25">ProSHADE_internal_data::ProSHADE_data::detectSymmetryInStructurePython</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;{</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    std::vector&lt; proshade_double* &gt; axes;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    </div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="comment">//================================================ Run the algorithm</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    this-&gt;detectSymmetryInStructure                   ( settings, &amp;axes );</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    </div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    return ;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    </div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;}</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae8df7d1c2855263e0c0d73a5474001e1"> 1762</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae8df7d1c2855263e0c0d73a5474001e1">ProSHADE_internal_data::ProSHADE_data::findBestCScore</a> ( std::vector&lt; proshade_double* &gt;* CSym, proshade_unsign* symInd )</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;{</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <span class="keywordflow">if</span> ( CSym-&gt;size() == 0 ) { *symInd = 0; <span class="keywordflow">return</span> ( 0.0 ); }</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    </div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="comment">//================================================ Sort the vector</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    std::sort                                         ( CSym-&gt;begin(), CSym-&gt;end(), <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a2e915d310892aea124046acd14db4a84">ProSHADE_internal_misc::sortSymHlpInv</a> );</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    </div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">//================================================ Initalise variables</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    proshade_double ret                               = CSym-&gt;at(0)[5];</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;   *symInd                                            = 0;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    proshade_double frac                              = 0.0;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="comment">//================================================ Check all other axes</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign ind = 1; ind &lt; static_cast&lt;proshade_unsign&gt;( CSym-&gt;size() ); ind++ )</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    {</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        <span class="comment">//============================================ If higher fold than already leading one (do not care for lower fold and lower average height axes)</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        <span class="keywordflow">if</span> ( CSym-&gt;at(ind)[0] &gt; CSym-&gt;at(*symInd)[0] )</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        {</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            <span class="comment">//======================================== How much higher fold is it? Also, adding some protection against large syms supported only by a subset and a minimum requirement.</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            frac                                      = std::max ( std::min ( ( CSym-&gt;at(*symInd)[0] / CSym-&gt;at(ind)[0] ) * 1.5, 0.9 ), 0.6 );</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;            </div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;            <span class="comment">//======================================== Check if the new is &quot;better&quot; according to this criteria.</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            <span class="keywordflow">if</span> ( ( CSym-&gt;at(*symInd)[5] * frac ) &lt; CSym-&gt;at(ind)[5] )</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;            {</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                <span class="comment">//==================================== And it is! Save and try next one.</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;               *symInd                                = ind;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                ret                                   = CSym-&gt;at(ind)[5];</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            }</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        }</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    }</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    </div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    </div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;}</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160; </div>
<div class="line"><a name="l01808"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac9989eaf9779a857f9c9e709bc0f3cf7"> 1808</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac9989eaf9779a857f9c9e709bc0f3cf7">ProSHADE_internal_data::ProSHADE_data::findBestDScore</a> ( std::vector&lt; proshade_double* &gt;* DSym, proshade_unsign* symInd )</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;{</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="comment">//================================================ Sort the vector</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    std::sort                                         ( DSym-&gt;begin(), DSym-&gt;end(), <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ab0d38ce581c60d246fcf62ed05235e7f">ProSHADE_internal_misc::sortDSymHlpInv</a> );</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="comment">//================================================ Initalise variables</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    proshade_double ret                               = 0.0;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    proshade_double frac                              = 0.0;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="keywordflow">if</span> ( DSym-&gt;size() &gt; 0 )</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    {</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        ret                                           = ( ( DSym-&gt;at(0)[0] * DSym-&gt;at(0)[5] ) + ( DSym-&gt;at(0)[6] * DSym-&gt;at(0)[11] ) ) / ( DSym-&gt;at(0)[0] + DSym-&gt;at(0)[6] );</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;       *symInd                                        = 0;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    }</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <span class="keywordflow">else</span> { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160; </div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <span class="comment">//================================================ Check all other axes</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign ind = 1; ind &lt; static_cast&lt;proshade_unsign&gt;( DSym-&gt;size() ); ind++ )</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    {</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        <span class="comment">//============================================ If higher fold than already leading one (do not care for lower fold and lower average height axes)</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        <span class="keywordflow">if</span> ( ( DSym-&gt;at(ind)[0] + DSym-&gt;at(ind)[6] ) &gt; ( DSym-&gt;at(*symInd)[0] + DSym-&gt;at(*symInd)[6] ) )</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        {</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;            <span class="comment">//======================================== How much higher fold is it? Also, adding some protection against large syms supported only by a subset and a minimum requirement.</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            frac                                      = std::max ( std::min ( ( ( DSym-&gt;at(*symInd)[0] + DSym-&gt;at(*symInd)[6] ) / ( DSym-&gt;at(ind)[0] + DSym-&gt;at(ind)[6] ) ) * 1.5, 0.9 ), 0.6 );</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            </div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            <span class="comment">//======================================== Check if the new is &quot;better&quot; according to this criteria.</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;            <span class="keywordflow">if</span> ( ( ( ( DSym-&gt;at(*symInd)[0] * DSym-&gt;at(*symInd)[5] ) + ( DSym-&gt;at(*symInd)[6] * DSym-&gt;at(*symInd)[11] ) ) / ( DSym-&gt;at(*symInd)[0] + DSym-&gt;at(*symInd)[6] ) * frac ) &lt; ( ( DSym-&gt;at(ind)[0] * DSym-&gt;at(ind)[5] ) + ( DSym-&gt;at(ind)[6] * DSym-&gt;at(ind)[11] ) ) / ( DSym-&gt;at(ind)[0] + DSym-&gt;at(ind)[6] ) )</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;            {</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                <span class="comment">//==================================== And it is! Save and try next one.</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;               *symInd                                = ind;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                ret                                   = ( ( DSym-&gt;at(ind)[0] * DSym-&gt;at(ind)[5] ) + ( DSym-&gt;at(ind)[6] * DSym-&gt;at(ind)[11] ) ) / ( DSym-&gt;at(ind)[0] + DSym-&gt;at(ind)[6] );</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;            }</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        }</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    }</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160; </div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    </div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;}</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160; </div>
<div class="line"><a name="l01855"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa794c34ad9811fc68861bdeb132eaa1a"> 1855</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa794c34ad9811fc68861bdeb132eaa1a">ProSHADE_internal_data::ProSHADE_data::findTScore</a> ( std::vector&lt; proshade_double* &gt;* TSym )</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;{</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    proshade_double ret                               = 0.0;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    proshade_double foldSum                           = 0.0;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160; </div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="comment">//================================================ Check the T symmetry for being complete</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="keywordflow">if</span> ( TSym-&gt;size() == 7 )</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    {</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        <span class="comment">//============================================ Compute the weighted fold</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( TSym-&gt;size() ); cIt++ )</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        {</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            ret                                      += TSym-&gt;at(cIt)[0] * TSym-&gt;at(cIt)[5];</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;            foldSum                                  += TSym-&gt;at(cIt)[0];</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        }</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        </div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        <span class="comment">//============================================ Weight</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        ret                                          /= foldSum;</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    }</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    </div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    </div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;}</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160; </div>
<div class="line"><a name="l01888"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedc04d6abaeebd3a2e8b26fb956d1996"> 1888</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedc04d6abaeebd3a2e8b26fb956d1996">ProSHADE_internal_data::ProSHADE_data::findOScore</a> ( std::vector&lt; proshade_double* &gt;* OSym )</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;{</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    proshade_double ret                               = 0.0;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    proshade_double foldSum                           = 0.0;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    </div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="comment">//================================================ Check the O symmetry for being complete</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="keywordflow">if</span> ( OSym-&gt;size() == 13 )</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    {</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        <span class="comment">//============================================ Compute the weighted fold</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( OSym-&gt;size() ); cIt++ )</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        {</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;            ret                                      += OSym-&gt;at(cIt)[0] * OSym-&gt;at(cIt)[5];</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;            foldSum                                  += OSym-&gt;at(cIt)[0];</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        }</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        </div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        <span class="comment">//============================================ Weight</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        ret                                          /= foldSum;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    }</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    </div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    </div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;}</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160; </div>
<div class="line"><a name="l01921"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a69c32bcbcdc6b5f58dc4659141b34fcd"> 1921</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a69c32bcbcdc6b5f58dc4659141b34fcd">ProSHADE_internal_data::ProSHADE_data::findIScore</a> ( std::vector&lt; proshade_double* &gt;* ISym )</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;{</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    proshade_double ret                               = 0.0;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    proshade_double foldSum                           = 0.0;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    </div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    <span class="comment">//================================================ Check the T symmetry for being complete</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <span class="keywordflow">if</span> ( ISym-&gt;size() == 31 )</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    {</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        <span class="comment">//============================================ Compute the weighted fold</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( ISym-&gt;size() ); cIt++ )</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        {</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;            ret                                      += ISym-&gt;at(cIt)[0] * ISym-&gt;at(cIt)[5];</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            foldSum                                  += ISym-&gt;at(cIt)[0];</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        }</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="comment">//============================================ Weight</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        ret                                          /= foldSum;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    }</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    </div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;}</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160; </div>
<div class="line"><a name="l01960"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b62761850d8560e6f8c52a2249fe7b7"> 1960</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b62761850d8560e6f8c52a2249fe7b7">ProSHADE_internal_data::ProSHADE_data::saveRecommendedSymmetry</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* CSym, std::vector&lt; proshade_double* &gt;* DSym, std::vector&lt; proshade_double* &gt;* TSym, std::vector&lt; proshade_double* &gt;* OSym, std::vector&lt; proshade_double* &gt;* ISym, std::vector&lt; proshade_double* &gt;* axes )</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;{</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    proshade_double cScore = 0.0, dScore = 0.0, tScore = 0.0, oScore = 0.0, iScore = 0.0;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    proshade_unsign bestCIndex, bestDIndex;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="comment">//================================================ Find a score for each input symmetry type.</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    cScore                                            = this-&gt;findBestCScore ( CSym, &amp;bestCIndex );</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    dScore                                            = this-&gt;findBestDScore ( DSym, &amp;bestDIndex );</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    tScore                                            = this-&gt;findTScore     ( TSym );</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    oScore                                            = this-&gt;findOScore     ( OSym );</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    iScore                                            = this-&gt;findIScore     ( ISym );</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160; </div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="comment">//================================================ Find the best available score</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    proshade_double bestWeightedScore                 = std::max ( cScore, std::max ( dScore * 2.0, std::max ( tScore * 3.0, std::max ( oScore * 4.0, iScore * 5.0 ) ) ) );</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <span class="comment">//================================================ No score? Well, no symmetry.</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keywordflow">if</span> ( bestWeightedScore &lt; 0.05 ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a> ( <span class="stringliteral">&quot;&quot;</span> ); <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    </div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="keywordflow">if</span> ( bestWeightedScore == cScore )</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    {</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;C&quot;</span> );</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( CSym-&gt;at(bestCIndex)[0] );</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a>                 ( CSym-&gt;at(bestCIndex) );</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at(bestCIndex) );</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        </div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        <span class="comment">//============================================ Warn if resolution does not really support this fold</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        <span class="keywordflow">if</span> ( ( ( 360.0 / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( CSym-&gt;at(bestCIndex)[0] ) ) - ( 360.0 / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( CSym-&gt;at(bestCIndex)[0] + 1 ) ) ) &lt;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;             ( 360.0 / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a8324ed7ec9c19df21511f117df80ab11">maxBandwidth</a> * 4.0 ) ) )</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        {</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            std::stringstream hlpSS;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            hlpSS &lt;&lt; <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Reporting symmetry C&quot;</span> &lt;&lt; CSym-&gt;at(bestCIndex)[0] &lt;&lt; <span class="stringliteral">&quot;, however, the grid sampling does not provide reasonable accuracy for symmetry with such high fold and therefore ProSHADE cannot responsibly claim this symmetry to be correct. It is suggested that the grid sampling is increased for more accurate symmetry detection. (Set higher resolution using -r).&quot;</span>;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, hlpSS.str(), <span class="stringliteral">&quot;WS00054&quot;</span> );</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        }</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    }</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="keywordflow">if</span> ( bestWeightedScore == dScore * 2.0 )</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    {</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;D&quot;</span> );</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( std::max ( DSym-&gt;at(bestDIndex)[0], DSym-&gt;at(bestDIndex)[6] ) );</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a>                 ( DSym-&gt;at(bestDIndex) );</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a>                 ( &amp;DSym-&gt;at(bestDIndex)[6] );</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, DSym-&gt;at(bestDIndex) );</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, &amp;DSym-&gt;at(bestDIndex)[6] );</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        </div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        <span class="comment">//============================================ Warn if resolution does not really support this fold</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        <span class="keywordflow">if</span> ( ( ( 360.0 / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( std::max ( DSym-&gt;at(bestDIndex)[0], DSym-&gt;at(bestDIndex)[6] ) ) ) - ( 360.0 / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( std::max ( DSym-&gt;at(bestDIndex)[0], DSym-&gt;at(bestDIndex)[6] ) + 1 ) ) ) &lt;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;             ( 360.0 / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a8324ed7ec9c19df21511f117df80ab11">maxBandwidth</a> * 4.0 ) ) )</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        {</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;            std::stringstream hlpSS;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;            hlpSS &lt;&lt; <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Reporting symmetry D&quot;</span> &lt;&lt; std::max ( DSym-&gt;at(bestDIndex)[0], DSym-&gt;at(bestDIndex)[6] ) &lt;&lt; <span class="stringliteral">&quot;, however, the grid sampling does not provide reasonable accuracy for symmetry with such high fold and therefore ProSHADE cannot responsibly claim this symmetry to be correct. It is suggested that the grid sampling is increased for more accurate symmetry detection. (Set higher resolution using -r).&quot;</span>;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, hlpSS.str(), <span class="stringliteral">&quot;WS00054&quot;</span> );</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        }</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    }</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="keywordflow">if</span> ( bestWeightedScore == tScore * 3.0 )</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    {</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;T&quot;</span> );</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( TSym-&gt;size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( TSym-&gt;at(it) ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, TSym-&gt;at(it) ); }</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    }</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="keywordflow">if</span> ( bestWeightedScore == oScore * 4.0 )</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    {</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;O&quot;</span> );</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( OSym-&gt;size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( OSym-&gt;at(it) ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, OSym-&gt;at(it) ); }</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    }</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="keywordflow">if</span> ( bestWeightedScore == iScore * 5.0 )</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    {</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;I&quot;</span> );</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( ISym-&gt;size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( ISym-&gt;at(it) ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, ISym-&gt;at(it) ); }</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    }</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    </div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    return ;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    </div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;}</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; </div>
<div class="line"><a name="l02049"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a599a8fa1d6d780a45a2d772413bc778e"> 2049</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a599a8fa1d6d780a45a2d772413bc778e">ProSHADE_internal_data::ProSHADE_data::saveRequestedSymmetryC</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* CSym, std::vector&lt; proshade_double* &gt;* axes )</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;{</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    proshade_unsign bestIndex                         = 0;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    proshade_double highestSym                        = 0.0;</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <span class="comment">//================================================ Search for best fold</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( CSym-&gt;size() ); iter++ )</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    {</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        <span class="comment">//============================================ Check if it is tbe correct fold</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;        <span class="keywordflow">if</span> ( CSym-&gt;at(iter)[0] != settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6dc170d9826bad9ce4a2c31a033f7f6a">requestedSymmetryFold</a> ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        </div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        <span class="comment">//============================================ If correct, is it the highest found?</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        <span class="keywordflow">if</span> ( CSym-&gt;at(iter)[5] &gt; highestSym )</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        {</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;            highestSym                                = CSym-&gt;at(iter)[5];</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;            bestIndex                                 = iter;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;        }</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    }</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    </div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    <span class="comment">//================================================ Found?</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="keywordflow">if</span> ( highestSym  &gt; 0.0 )</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    {</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;C&quot;</span> );</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( CSym-&gt;at(bestIndex)[0] );</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a>                 ( CSym-&gt;at(bestIndex) );</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at(bestIndex) );</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    }</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    {</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    }</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    </div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    return ;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    </div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;}</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; </div>
<div class="line"><a name="l02099"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a97c84fea7b9b77f73d3f15730751e070"> 2099</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a97c84fea7b9b77f73d3f15730751e070">ProSHADE_internal_data::ProSHADE_data::saveRequestedSymmetryD</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* DSym, std::vector&lt; proshade_double* &gt;* axes )</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;{</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    proshade_unsign bestIndex                         = 0;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    proshade_double highestSym                        = 0.0;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <span class="comment">//================================================ Search for best fold</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( DSym-&gt;size() ); iter++ )</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    {</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;        <span class="comment">//============================================ Check if it is tbe correct fold</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;        <span class="keywordflow">if</span> ( std::max ( DSym-&gt;at(iter)[0], DSym-&gt;at(iter)[6] ) != settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6dc170d9826bad9ce4a2c31a033f7f6a">requestedSymmetryFold</a> ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160; </div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        <span class="comment">//============================================ If correct, is it the highest found?</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;        <span class="keywordflow">if</span> ( ( DSym-&gt;at(iter)[5] + DSym-&gt;at(iter)[11] ) &gt; highestSym )</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        {</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;            highestSym                                = ( DSym-&gt;at(iter)[5] + DSym-&gt;at(iter)[11] );</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;            bestIndex                                 = iter;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;        }</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    }</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    </div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <span class="comment">//================================================ Found?</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    <span class="keywordflow">if</span> ( highestSym  &gt; 0.0 )</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    {</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;D&quot;</span> );</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( std::max ( DSym-&gt;at(bestIndex)[0], DSym-&gt;at(bestIndex)[6] ) );</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a>                 ( DSym-&gt;at(bestIndex) );</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a>                 ( &amp;DSym-&gt;at(bestIndex)[6] );</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes,  DSym-&gt;at(bestIndex) );</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, &amp;DSym-&gt;at(bestIndex)[6] );</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    }</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    {</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    }</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    </div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    return ;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    </div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;}</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160; </div>
<div class="line"><a name="l02147"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a576bfe808729a1a224ac12263709b8dd"> 2147</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a576bfe808729a1a224ac12263709b8dd">ProSHADE_internal_data::ProSHADE_data::deepCopyMap</a> ( proshade_double*&amp; saveTo, proshade_unsign verbose )</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;{</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <span class="keywordflow">if</span> ( saveTo != NULL )</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    {</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( verbose, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! The deep copy pointer is not set to NULL. Cannot proceed and returning unmodified pointer.&quot;</span>, <span class="stringliteral">&quot;WB00040&quot;</span> );</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;        return ;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    }</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    </div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="comment">//================================================ Allocate the memory</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    saveTo                                            = <span class="keyword">new</span> proshade_double[this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    </div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="comment">//================================================ Check memory allocation</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( saveTo, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    </div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="comment">//================================================ Copy internal map to the new pointer</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    {</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;        saveTo[iter]                                  = this-&gt;internalMap[iter];</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    }</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    </div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    return ;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    </div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;}</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160; </div>
<div class="line"><a name="l02179"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abea2d62360b17cddca155816d3e485e8"> 2179</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abea2d62360b17cddca155816d3e485e8">ProSHADE_internal_data::ProSHADE_data::reportSymmetryResults</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;{</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="comment">//================================================ Improve this!</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac39560ba9aca9053753c158fb2adb9de">recommendedSymmetryType</a> == <span class="stringliteral">&quot;&quot;</span> )</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    {</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, <span class="stringliteral">&quot;Did not detect any symmetry!&quot;</span> );</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    }</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    {</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;        std::stringstream ssHlp;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        ssHlp &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Detected &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac39560ba9aca9053753c158fb2adb9de">recommendedSymmetryType</a> &lt;&lt; <span class="stringliteral">&quot; symmetry with fold &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac8e62cc8dbd40265e51143c8207b6638">recommendedSymmetryFold</a> &lt;&lt; <span class="stringliteral">&quot; .&quot;</span>;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, ssHlp.str() );</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        </div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() &gt; 0 )</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        {</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            ssHlp.clear(); ssHlp.str ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;            ssHlp &lt;&lt; <span class="stringliteral">&quot;  Fold       X           Y          Z           Angle        Height&quot;</span>;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, ssHlp.str() );</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;        }</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign symIt = 0; symIt &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() ); symIt++ )</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;        {</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            ssHlp.clear(); ssHlp.str ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;            ssHlp &lt;&lt; std::showpos &lt;&lt; std::fixed &lt;&lt; std::setprecision(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[0] &lt;&lt; std::setprecision(5) &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[1] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[2] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[3] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[4] &lt;&lt; <span class="stringliteral">&quot;      &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[5];</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, ssHlp.str() );</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        }</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    }</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    </div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    return ;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    </div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;}</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; </div>
<div class="line"><a name="l02217"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2f217ec7b422627bd636743759579adf"> 2217</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2f217ec7b422627bd636743759579adf">ProSHADE_internal_data::ProSHADE_data::setOriginalMapValues</a> ()</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;{</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <span class="comment">//================================================ Compute and save the COM</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    this-&gt;findMapCOM                                  ( );</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    this-&gt;originalMapXCom                             = this-&gt;xCom;</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    this-&gt;originalMapYCom                             = this-&gt;yCom;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    this-&gt;originalMapZCom                             = this-&gt;zCom;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    </div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="comment">//================================================ Save the original sizes</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    this-&gt;xDimSizeOriginal                            = this-&gt;xDimSize;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    this-&gt;yDimSizeOriginal                            = this-&gt;yDimSize;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    this-&gt;zDimSizeOriginal                            = this-&gt;zDimSize;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    </div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    <span class="comment">//================================================ Save the original index counts</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    this-&gt;xDimIndicesOriginal                         = this-&gt;xDimIndices;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    this-&gt;yDimIndicesOriginal                         = this-&gt;yDimIndices;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    this-&gt;zDimIndicesOriginal                         = this-&gt;zDimIndices;</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    </div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    <span class="comment">//================================================ Save the original axis origins</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    this-&gt;xAxisOriginOriginal                         = this-&gt;xAxisOrigin;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    this-&gt;yAxisOriginOriginal                         = this-&gt;yAxisOrigin;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    this-&gt;zAxisOriginOriginal                         = this-&gt;zAxisOrigin;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    </div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    return ;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    </div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;}</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160; </div>
<div class="line"><a name="l02249"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aec21925052446f1c154eb7285acf7bb4"> 2249</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aec21925052446f1c154eb7285acf7bb4">ProSHADE_internal_data::ProSHADE_data::findMapCOM</a> ( )</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;{</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    this-&gt;xCom                                        = 0.0;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    this-&gt;yCom                                        = 0.0;</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    this-&gt;zCom                                        = 0.0;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    proshade_double totNonZeroPoints                  = 0.0;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    proshade_signed mapIt                             = 0;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    </div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="comment">//================================================ Compute COM from 0 ; 0 ; 0</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed xIt = 0; xIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;xDimIndices ); xIt++ )</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    {</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed yIt = 0; yIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;yDimIndices ); yIt++ )</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;        {</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed zIt = 0; zIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;zDimIndices ); zIt++ )</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;            {</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                <span class="comment">//==================================== Find map index</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                mapIt                                 = zIt  + this-&gt;zDimIndices * ( yIt  + this-&gt;yDimIndices * xIt  );</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                </div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                <span class="comment">//==================================== Use only positive density</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;                <span class="keywordflow">if</span> ( this-&gt;internalMap[mapIt] &lt;= 0.0 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                </div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                <span class="comment">//==================================== Compute Index COM</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                this-&gt;xCom                           += this-&gt;internalMap[mapIt] * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( xIt + 1 );</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                this-&gt;yCom                           += this-&gt;internalMap[mapIt] * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( yIt + 1 );</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;                this-&gt;zCom                           += this-&gt;internalMap[mapIt] * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( zIt + 1 );</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;                totNonZeroPoints                     += this-&gt;internalMap[mapIt];</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;            }</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;        }</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    }</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    </div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    this-&gt;xCom                                       /= totNonZeroPoints;</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    this-&gt;yCom                                       /= totNonZeroPoints;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    this-&gt;zCom                                       /= totNonZeroPoints;</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    </div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    <span class="comment">//================================================ Convert to real world</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;    this-&gt;xCom                                        = ( (this-&gt;xCom-1) - this-&gt;xAxisOrigin ) * ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;xDimIndices - 1 ) / this-&gt;xDimSize );</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    this-&gt;yCom                                        = ( (this-&gt;yCom-1) - this-&gt;yAxisOrigin ) * ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;yDimIndices - 1 ) / this-&gt;yDimSize );</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;    this-&gt;zCom                                        = ( (this-&gt;zCom-1) - this-&gt;zAxisOrigin ) * ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;zDimIndices - 1 ) / this-&gt;zDimSize );</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    </div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    return ;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;}</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160; </div>
<div class="line"><a name="l02297"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef"> 2297</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">ProSHADE_internal_data::ProSHADE_data::getMaxSpheres</a> ( )</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;{</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;noSpheres );</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;}</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160; </div>
<div class="line"><a name="l02308"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afe04510c67e9dc9c19efaef8463b6e6e"> 2308</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afe04510c67e9dc9c19efaef8463b6e6e">ProSHADE_internal_data::ProSHADE_data::getMapValue</a> ( proshade_unsign pos )</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;{</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;internalMap[pos] );</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;}</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160; </div>
<div class="line"><a name="l02318"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd"> 2318</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">ProSHADE_internal_data::ProSHADE_data::getMaxBand</a> ( )</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;{</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;maxShellBand );</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;}</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160; </div>
<div class="line"><a name="l02328"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa35ae5ccd9d4b22bcc028f609cd1c3e"> 2328</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa35ae5ccd9d4b22bcc028f609cd1c3e">ProSHADE_internal_data::ProSHADE_data::getRRPValue</a> ( proshade_unsign band, proshade_unsign sh1, proshade_unsign sh2 )</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;{</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;rrpMatrices[band][sh1][sh2] );</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;}</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160; </div>
<div class="line"><a name="l02344"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ada8e6f27f49afc3a0ee17758ce9e7594"> 2344</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ada8e6f27f49afc3a0ee17758ce9e7594">ProSHADE_internal_data::ProSHADE_data::shellBandExists</a> ( proshade_unsign shell, proshade_unsign bandVal )</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;{</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;spheres[shell]-&gt;getLocalBandwidth( ) &gt;= bandVal )</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    {</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        <span class="keywordflow">return</span>                                        ( <span class="keyword">true</span> );</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    }</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    {</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        <span class="keywordflow">return</span>                                        ( <span class="keyword">false</span> );</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    }</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;}</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160; </div>
<div class="line"><a name="l02364"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5919acc2f26efcf373db47ed96eadc38"> 2364</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5919acc2f26efcf373db47ed96eadc38">ProSHADE_internal_data::ProSHADE_data::removePhaseInormation</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;{</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Centering map onto its COM.&quot;</span> );</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    </div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    <span class="comment">//================================================ Copy map for processing</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    fftw_complex* mapCoeffs                           = <span class="keyword">new</span> fftw_complex[this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;    fftw_complex* pattersonMap                        = <span class="keyword">new</span> fftw_complex[this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    </div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    <span class="comment">//================================================ Check memory allocation</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( mapCoeffs, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( pattersonMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    </div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    <span class="comment">//================================================ Copy data to mask</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; (this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices); iter++ )</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    {</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;        pattersonMap[iter][0]                         = this-&gt;internalMap[iter];</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;        pattersonMap[iter][1]                         = 0.0;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    }</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    </div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    <span class="comment">//================================================ Prepare FFTW plans</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    fftw_plan forward                                 = fftw_plan_dft_3d ( this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices,</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;                                                                           pattersonMap, mapCoeffs, FFTW_FORWARD,  FFTW_ESTIMATE );</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    fftw_plan inverse                                 = fftw_plan_dft_3d ( this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices,</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;                                                                           mapCoeffs, pattersonMap, FFTW_BACKWARD, FFTW_ESTIMATE );</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    </div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    <span class="comment">//================================================ Run forward Fourier</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    fftw_execute                                      ( forward );</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    </div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    <span class="comment">//================================================ Remove the phase</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a167f7a9dbd061752d2a099181090a3b8">ProSHADE_internal_mapManip::removeMapPhase</a>        ( mapCoeffs, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices );</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    </div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <span class="comment">//================================================ Run inverse Fourier</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    fftw_execute                                      ( inverse );</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    </div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    <span class="comment">//================================================ Save the results</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    proshade_signed mapIt, patIt, patX, patY, patZ;</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed xIt = 0; xIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;xDimIndices ); xIt++ )</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    {</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed yIt = 0; yIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;yDimIndices ); yIt++ )</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;        {</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed zIt = 0; zIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;zDimIndices ); zIt++ )</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;            {</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;                <span class="comment">//==================================== Centre patterson map</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;                patX = xIt - ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( this-&gt;xDimIndices ) / 2 ); <span class="keywordflow">if</span> ( patX &lt; 0 ) { patX += this-&gt;xDimIndices; }</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;                patY = yIt - ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) / 2 ); <span class="keywordflow">if</span> ( patY &lt; 0 ) { patY += this-&gt;yDimIndices; }</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;                patZ = zIt - ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) / 2 ); <span class="keywordflow">if</span> ( patZ &lt; 0 ) { patZ += this-&gt;zDimIndices; }</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;                </div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;                <span class="comment">//==================================== Find indices</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;                mapIt                                 = zIt  + this-&gt;zDimIndices * ( yIt  + this-&gt;yDimIndices * xIt  );</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;                patIt                                 = patZ + this-&gt;zDimIndices * ( patY + this-&gt;yDimIndices * patX );</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;                </div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;                <span class="comment">//==================================== Copy</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;                this-&gt;internalMap[mapIt]              = pattersonMap[patIt][0];</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;            }</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;        }</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    }</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    </div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    <span class="keyword">delete</span>[] pattersonMap;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="keyword">delete</span>[] mapCoeffs;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    </div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    <span class="comment">//================================================ Delete FFTW plans</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    fftw_destroy_plan                                 ( forward );</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    fftw_destroy_plan                                 ( inverse );</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    </div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Phase information removed.&quot;</span> );</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    </div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    return ;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    </div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;}</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160; </div>
<div class="line"><a name="l02442"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5c0df68cd21b4f56abd1008065ca3573"> 2442</a></span>&#160;proshade_double* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5c0df68cd21b4f56abd1008065ca3573">ProSHADE_internal_data::ProSHADE_data::getRealSphHarmValue</a> ( proshade_unsign band, proshade_unsign order, proshade_unsign shell )</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;{</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;sphericalHarmonics[shell][seanindex ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( order ) - <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( band ),</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;                                                                                                     band,</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;                                                                                                     this-&gt;spheres[shell]-&gt;getLocalBandwidth() )][0] );</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    </div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;}</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160; </div>
<div class="line"><a name="l02455"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae8444b6c9ca3207d32bbf2a68c7b610"> 2455</a></span>&#160;proshade_double* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae8444b6c9ca3207d32bbf2a68c7b610">ProSHADE_internal_data::ProSHADE_data::getImagSphHarmValue</a> ( proshade_unsign band, proshade_unsign order, proshade_unsign shell )</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;{</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;sphericalHarmonics[shell][seanindex ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( order ) - <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( band ),</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;                                                                                                     band,</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                                                                                                     this-&gt;spheres[shell]-&gt;getLocalBandwidth() )][1] );</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    </div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;}</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160; </div>
<div class="line"><a name="l02468"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23620b34a604aca7db4d8b21f6d2d09a"> 2468</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23620b34a604aca7db4d8b21f6d2d09a">ProSHADE_internal_data::ProSHADE_data::getAnySphereRadius</a> ( proshade_unsign shell )</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;{</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;spheres[shell]-&gt;getShellRadius() );</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    </div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;}</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160; </div>
<div class="line"><a name="l02479"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa150cfc5715420cf3d2e28c8af3631c4"> 2479</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa150cfc5715420cf3d2e28c8af3631c4">ProSHADE_internal_data::ProSHADE_data::getIntegrationWeight</a>  ( <span class="keywordtype">void</span> )</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;{</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;integrationWeight );</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    </div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;}</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160; </div>
<div class="line"><a name="l02491"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a898b48c1135e7a37f64f55e2367f0391"> 2491</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a898b48c1135e7a37f64f55e2367f0391">ProSHADE_internal_data::ProSHADE_data::getShellBandwidth</a> ( proshade_unsign shell )</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;{</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;spheres[shell]-&gt;getLocalBandwidth ( ) );</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    </div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;}</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160; </div>
<div class="line"><a name="l02503"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3be93c3f8e860afc435750fa1c6c01d7"> 2503</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3be93c3f8e860afc435750fa1c6c01d7">ProSHADE_internal_data::ProSHADE_data::getSpherePosValue</a> ( proshade_unsign shell )</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;{</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;spherePos.at(shell) );</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    </div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;}</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160; </div>
<div class="line"><a name="l02515"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94a73f81ba80621f5f52173e91bb47f7"> 2515</a></span>&#160;proshade_complex** <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94a73f81ba80621f5f52173e91bb47f7">ProSHADE_internal_data::ProSHADE_data::getEMatrixByBand</a> ( proshade_unsign band )</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;{</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;eMatrices[band] );</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    </div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;}</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160; </div>
<div class="line"><a name="l02530"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab053362f9dc5422244ccfbafd9f00ff8"> 2530</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab053362f9dc5422244ccfbafd9f00ff8">ProSHADE_internal_data::ProSHADE_data::getEMatrixValue</a> ( proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double* valueReal, proshade_double* valueImag )</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;{</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    <span class="comment">//================================================ Set pointer</span></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;   *valueReal                                         = this-&gt;eMatrices[band][order1][order2][0];</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;   *valueImag                                         = this-&gt;eMatrices[band][order1][order2][1];</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    </div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;    return ;</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    </div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;}</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160; </div>
<div class="line"><a name="l02545"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be"> 2545</a></span>&#160;proshade_complex* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">ProSHADE_internal_data::ProSHADE_data::getInvSO3Coeffs</a> ( )</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;{</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;so3CoeffsInverse );</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    </div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;}</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160; </div>
<div class="line"><a name="l02556"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae5c9c45b0db1e6a9eeef2ba292fbbcc3"> 2556</a></span>&#160;proshade_complex* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae5c9c45b0db1e6a9eeef2ba292fbbcc3">ProSHADE_internal_data::ProSHADE_data::getSO3Coeffs</a> ( )</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;{</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;so3Coeffs );</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    </div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;}</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160; </div>
<div class="line"><a name="l02567"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6cc2b8e179a137adda234e0ba0f9d27b"> 2567</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6cc2b8e179a137adda234e0ba0f9d27b">ProSHADE_internal_data::ProSHADE_data::getComparisonBand</a> ( )</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;{</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;maxCompBand );</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    </div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;}</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160; </div>
<div class="line"><a name="l02582"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5999f7181bd3509454966f8271ac39d6"> 2582</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5999f7181bd3509454966f8271ac39d6">ProSHADE_internal_data::ProSHADE_data::getWignerMatrixValue</a> ( proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double* valueReal, proshade_double* valueImag )</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;{</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    <span class="comment">//================================================ Set pointer</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    *valueReal                                        = this-&gt;wignerMatrices[band][order1][order2][0];</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;    *valueImag                                        = this-&gt;wignerMatrices[band][order1][order2][1];</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    </div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    return ;</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    </div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;}</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160; </div>
<div class="line"><a name="l02597"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185"> 2597</a></span>&#160;proshade_single <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">ProSHADE_internal_data::ProSHADE_data::getXDimSize</a> ( )</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;{</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;xDimSize );</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;}</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160; </div>
<div class="line"><a name="l02607"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51"> 2607</a></span>&#160;proshade_single <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">ProSHADE_internal_data::ProSHADE_data::getYDimSize</a> ( )</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;{</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;yDimSize );</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;}</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160; </div>
<div class="line"><a name="l02617"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970"> 2617</a></span>&#160;proshade_single <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">ProSHADE_internal_data::ProSHADE_data::getZDimSize</a> ( )</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;{</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;zDimSize );</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;}</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160; </div>
<div class="line"><a name="l02627"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1"> 2627</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">ProSHADE_internal_data::ProSHADE_data::getXDim</a> ( )</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;{</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;xDimIndices );</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;}</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160; </div>
<div class="line"><a name="l02637"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19"> 2637</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">ProSHADE_internal_data::ProSHADE_data::getYDim</a> ( )</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;{</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;yDimIndices );</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;}</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160; </div>
<div class="line"><a name="l02647"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d"> 2647</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">ProSHADE_internal_data::ProSHADE_data::getZDim</a> ( )</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;{</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;zDimIndices );</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;}</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160; </div>
<div class="line"><a name="l02657"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4c89c860da1836b30a9b2889d3e873ed"> 2657</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4c89c860da1836b30a9b2889d3e873ed">ProSHADE_internal_data::ProSHADE_data::getXFromPtr</a> ( )</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;{</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;xFrom );</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;}</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160; </div>
<div class="line"><a name="l02667"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f0d929d1e013cdd23e956d94b7a40da"> 2667</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f0d929d1e013cdd23e956d94b7a40da">ProSHADE_internal_data::ProSHADE_data::getYFromPtr</a> ( )</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;{</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;yFrom );</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;}</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160; </div>
<div class="line"><a name="l02677"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afbbcec01a6ee7701e3b1d0e61730fadf"> 2677</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afbbcec01a6ee7701e3b1d0e61730fadf">ProSHADE_internal_data::ProSHADE_data::getZFromPtr</a> ( )</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;{</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;zFrom );</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;}</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160; </div>
<div class="line"><a name="l02687"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#adf61c328db45fcd7692d13a8cde5e092"> 2687</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#adf61c328db45fcd7692d13a8cde5e092">ProSHADE_internal_data::ProSHADE_data::getXToPtr</a> ( )</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;{</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;xTo );</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;}</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160; </div>
<div class="line"><a name="l02697"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac859cbd21b93b9d2ed5f119f4ee57f3f"> 2697</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac859cbd21b93b9d2ed5f119f4ee57f3f">ProSHADE_internal_data::ProSHADE_data::getYToPtr</a> ( )</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;{</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;yTo );</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;}</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160; </div>
<div class="line"><a name="l02707"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a68eb739dd4846a1dd48032eb2cc3f49c"> 2707</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a68eb739dd4846a1dd48032eb2cc3f49c">ProSHADE_internal_data::ProSHADE_data::getZToPtr</a> ( )</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;{</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;zTo );</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;}</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160; </div>
<div class="line"><a name="l02717"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a1405b3974697f41c4a73da0cb52a32"> 2717</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a1405b3974697f41c4a73da0cb52a32">ProSHADE_internal_data::ProSHADE_data::getXAxisOrigin</a> ( )</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;{</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;xAxisOrigin );</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;}</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160; </div>
<div class="line"><a name="l02727"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a298bc9a6aae624a091cd97b842a6b618"> 2727</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a298bc9a6aae624a091cd97b842a6b618">ProSHADE_internal_data::ProSHADE_data::getYAxisOrigin</a> ( )</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;{</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;yAxisOrigin );</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;}</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160; </div>
<div class="line"><a name="l02737"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aeb0242051835b508e9af193dc40a697c"> 2737</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aeb0242051835b508e9af193dc40a697c">ProSHADE_internal_data::ProSHADE_data::getZAxisOrigin</a> ( )</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;{</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;zAxisOrigin );</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;}</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160; </div>
<div class="line"><a name="l02747"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1bb8bf1e357cc25f68fe93554e44715d"> 2747</a></span>&#160;proshade_double*&amp; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1bb8bf1e357cc25f68fe93554e44715d">ProSHADE_internal_data::ProSHADE_data::getInternalMap</a> ( )</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;{</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;internalMap );</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;}</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160; </div>
<div class="line"><a name="l02757"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae27a3e92905ca9d5f9a32c4eaacc64ae"> 2757</a></span>&#160;proshade_complex* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae27a3e92905ca9d5f9a32c4eaacc64ae">ProSHADE_internal_data::ProSHADE_data::getTranslationFnPointer</a> ( <span class="keywordtype">void</span> )</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;{</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;translationMap );</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;}</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160; </div>
<div class="line"><a name="l02767"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e7b1d5d4164ea7a6fda53c57ac979f4"> 2767</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e7b1d5d4164ea7a6fda53c57ac979f4">ProSHADE_internal_data::ProSHADE_data::setIntegrationWeight</a> ( proshade_double intW )</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;{</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;    this-&gt;integrationWeight                           = intW;</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    </div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;    return ;</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    </div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;}</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160; </div>
<div class="line"><a name="l02781"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a737ee01d968fef7ae1094847a0271033"> 2781</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a737ee01d968fef7ae1094847a0271033">ProSHADE_internal_data::ProSHADE_data::setIntegrationWeightCumul</a> ( proshade_double intW )</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;{</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    this-&gt;integrationWeight                          += intW;</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    </div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;    return ;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;    </div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;}</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160; </div>
<div class="line"><a name="l02798"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5af5c8c3b18275e65ae4ebacd9877c"> 2798</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5af5c8c3b18275e65ae4ebacd9877c">ProSHADE_internal_data::ProSHADE_data::setEMatrixValue</a> ( proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_complex val )</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;{</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;    this-&gt;eMatrices[band][order1][order2][0]          = val[0];</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    this-&gt;eMatrices[band][order1][order2][1]          = val[1];</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;    </div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;    return ;</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    </div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;}</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160; </div>
<div class="line"><a name="l02816"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb19c915cebcef22c085cc6619cc472"> 2816</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb19c915cebcef22c085cc6619cc472">ProSHADE_internal_data::ProSHADE_data::normaliseEMatrixValue</a> ( proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double normF )</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;{</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    this-&gt;eMatrices[band][order1][order2][0]         /= normF;</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;    this-&gt;eMatrices[band][order1][order2][1]         /= normF;</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    </div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    return ;</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    </div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;}</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160; </div>
<div class="line"><a name="l02832"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5e27540622190be41ce78157c0807e"> 2832</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5e27540622190be41ce78157c0807e">ProSHADE_internal_data::ProSHADE_data::setSO3CoeffValue</a> ( proshade_unsign position, proshade_complex val )</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;{</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    this-&gt;so3Coeffs[position][0]                      = val[0];</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    this-&gt;so3Coeffs[position][1]                      = val[1];</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;    </div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    return ;</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    </div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;}</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160; </div>
<div class="line"><a name="l02850"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab3aa4cdcd7cc9b458d7618077dfaab02"> 2850</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab3aa4cdcd7cc9b458d7618077dfaab02">ProSHADE_internal_data::ProSHADE_data::setWignerMatrixValue</a> ( proshade_complex val, proshade_unsign band, proshade_unsign order1, proshade_unsign order2 )</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;{</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;    this-&gt;wignerMatrices[band][order1][order2][0]     = val[0];</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    this-&gt;wignerMatrices[band][order1][order2][1]     = val[1];</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    </div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    return ;</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    </div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;}</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160; </div>
<div class="line"><a name="l02865"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a76a78596f27299a14bf29335772126"> 2865</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a76a78596f27299a14bf29335772126">ProSHADE_internal_data::ProSHADE_data::getMapArraySizePython</a> ( <span class="keywordtype">void</span> )</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;{</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ) );</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    </div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;}</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160; </div>
<div class="line"><a name="l02877"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a470ffeb3e78c036244c60bb4baa04aee"> 2877</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a470ffeb3e78c036244c60bb4baa04aee">ProSHADE_internal_data::ProSHADE_data::getMapPython</a> ( <span class="keywordtype">double</span> *mapArrayPython, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;{</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    {</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;        mapArrayPython[iter]                          = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;internalMap[iter] );</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    }</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    </div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    return ;</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    </div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;}</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160; </div>
<div class="line"><a name="l02895"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a256d60cfbd0f53316aa98a4a2eb8e999"> 2895</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a256d60cfbd0f53316aa98a4a2eb8e999">ProSHADE_internal_data::ProSHADE_data::setMapPython</a> ( <span class="keywordtype">double</span> *mapChangedInPython, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;{</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    {</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;        this-&gt;internalMap[iter]                       = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( mapChangedInPython[iter] );</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    }</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;    </div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    return ;</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    </div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;}</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160; </div>
<div class="line"><a name="l02913"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab90d22f3a1f38cb17243b7191ff1bdcd"> 2913</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab90d22f3a1f38cb17243b7191ff1bdcd">ProSHADE_internal_data::ProSHADE_data::setNewMapPython</a> ( <span class="keywordtype">double</span> *mapChangedInPython, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;{</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    <span class="comment">//================================================ Delete the old map data</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    <span class="keyword">delete</span>[] this-&gt;internalMap;</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;    this-&gt;internalMap                                 = NULL;</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    </div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    <span class="comment">//================================================ Allocate new map space</span></div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    this-&gt;internalMap                                 = <span class="keyword">new</span> proshade_double [this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;internalMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    </div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;    {</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        this-&gt;internalMap[iter]                       = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( mapChangedInPython[iter] );</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;    }</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    </div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;    return ;</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;    </div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;}</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160; </div>
<div class="line"><a name="l02941"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac8904f5a5f12c02e17e23dd595aa7770"> 2941</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac8904f5a5f12c02e17e23dd595aa7770">ProSHADE_internal_data::ProSHADE_data::getRealSphericalHarmonicsForShell</a> ( proshade_unsign shellNo, proshade_signed verbose, <span class="keywordtype">double</span> *sphericalHarmsReal, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;{</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    <span class="keywordflow">if</span> ( shellNo &gt;= this-&gt;noSpheres )</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    {</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( verbose, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Attempted to access shell index outside of the shell range.&quot;</span>, <span class="stringliteral">&quot;WP00043&quot;</span> );</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;        return ;</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;    }</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;    </div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    {</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;        sphericalHarmsReal[iter]                      = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;sphericalHarmonics[shellNo][iter][0] );</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;    }</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;    </div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;    return ;</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    </div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;}</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160; </div>
<div class="line"><a name="l02968"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0ec724aa0f717ee1b81c249930586290"> 2968</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0ec724aa0f717ee1b81c249930586290">ProSHADE_internal_data::ProSHADE_data::getImagSphericalHarmonicsForShell</a> ( proshade_unsign shellNo, proshade_signed verbose, <span class="keywordtype">double</span> *sphericalHarmsImag, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;{</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;    <span class="keywordflow">if</span> ( shellNo &gt;= this-&gt;noSpheres )</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;    {</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( verbose, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Attempted to access shell index outside of the shell range.&quot;</span>, <span class="stringliteral">&quot;WP00043&quot;</span> );</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;        return ;</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;    }</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;    </div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;    {</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;        sphericalHarmsImag[iter]                      = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;sphericalHarmonics[shellNo][iter][1] );</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;    }</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;    </div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;    return ;</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;    </div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;}</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160; </div>
<div class="line"><a name="l02994"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23cb48151973777947efe593cb663ddc"> 2994</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23cb48151973777947efe593cb663ddc">ProSHADE_internal_data::ProSHADE_data::getSphericalHarmonicsLenForShell</a>  ( proshade_unsign shellNo, proshade_signed verbose )</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;{</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;    <span class="keywordflow">if</span> ( shellNo &gt;= this-&gt;noSpheres )</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;    {</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( verbose, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Attempted to access shell index outside of the shell range.&quot;</span>, <span class="stringliteral">&quot;WP00043&quot;</span> );</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;        <span class="keywordflow">return</span>                                        ( 0 );</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    }</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;    </div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( (this-&gt;spheres[shellNo]-&gt;getLocalBandwidth() * 2) * (this-&gt;spheres[shellNo]-&gt;getLocalBandwidth() * 2) ) );</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;}</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160; </div>
<div class="line"><a name="l03014"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2ef40a71dcd34c8b1111e0de484722a2"> 3014</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2ef40a71dcd34c8b1111e0de484722a2">ProSHADE_internal_data::ProSHADE_data::sphericalHarmonicsIndex</a> ( proshade_signed order, proshade_signed band, proshade_signed shell )</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;{</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( seanindex ( order, band, this-&gt;spheres[shell]-&gt;getLocalBandwidth() ) ) );</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;}</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160; </div>
<div class="line"><a name="l03027"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa757f9d32ebe20435661599652fd30fa"> 3027</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa757f9d32ebe20435661599652fd30fa">ProSHADE_internal_data::ProSHADE_data::getRealEMatrixValuesForLM</a> ( proshade_signed band, proshade_signed order1, <span class="keywordtype">double</span> *eMatsLMReal, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;{</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    {</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;        eMatsLMReal[iter]                             = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;eMatrices[band][order1][iter][0] );</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;    }</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;    </div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;    return ;</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;    </div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;}</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160; </div>
<div class="line"><a name="l03047"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b08a8b6f9569c06cd183c924e6e80de"> 3047</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b08a8b6f9569c06cd183c924e6e80de">ProSHADE_internal_data::ProSHADE_data::getImagEMatrixValuesForLM</a> ( proshade_signed band, proshade_signed order1, <span class="keywordtype">double</span> *eMatsLMImag, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;{</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    {</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;        eMatsLMImag[iter]                             = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;eMatrices[band][order1][iter][1] );</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    }</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;    </div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    return ;</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;    </div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;}</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160; </div>
<div class="line"><a name="l03065"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30eac0ab5b69c1b7190d6e56571ba8b8"> 3065</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30eac0ab5b69c1b7190d6e56571ba8b8">ProSHADE_internal_data::ProSHADE_data::getRealSO3Coeffs</a> ( <span class="keywordtype">double</span> *so3CoefsReal, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;{</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;    {</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;        so3CoefsReal[iter]                            = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;so3Coeffs[iter][0] );</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;    }</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;    </div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;    return ;</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;    </div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;}</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160; </div>
<div class="line"><a name="l03083"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4b76352faa0915b1fef943fe139de5a6"> 3083</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4b76352faa0915b1fef943fe139de5a6">ProSHADE_internal_data::ProSHADE_data::getImagSO3Coeffs</a> ( <span class="keywordtype">double</span> *so3CoefsImag, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;{</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    {</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;        so3CoefsImag[iter]                            = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;so3Coeffs[iter][1] );</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    }</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;    </div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;    return ;</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;    </div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;}</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160; </div>
<div class="line"><a name="l03105"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9f6ba75b25e201466929bfd4df75688d"> 3105</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9f6ba75b25e201466929bfd4df75688d">ProSHADE_internal_data::ProSHADE_data::so3CoeffsArrayIndex</a> ( proshade_signed order1, proshade_signed order2, proshade_signed band )</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;{</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( so3CoefLoc ( order1, order2, band, this-&gt;getMaxBand() ) ) );</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;}</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160; </div>
<div class="line"><a name="l03116"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8bc5fbad1079d42bfa73913a9e2df619"> 3116</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8bc5fbad1079d42bfa73913a9e2df619">ProSHADE_internal_data::ProSHADE_data::getRealRotFunction</a> ( <span class="keywordtype">double</span> *rotFunReal, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;{</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;    {</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        rotFunReal[iter]                              = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;so3CoeffsInverse[iter][0] );</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    }</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;    </div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;    return ;</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;    </div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;}</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160; </div>
<div class="line"><a name="l03134"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b063d1ca2ebed239029bad6250cf376"> 3134</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b063d1ca2ebed239029bad6250cf376">ProSHADE_internal_data::ProSHADE_data::getImagRotFunction</a> ( <span class="keywordtype">double</span> *rotFunImag, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;{</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;    {</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;        rotFunImag[iter]                              = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;so3CoeffsInverse[iter][1] );</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;    }</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;    </div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;    return ;</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;    </div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;}</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160; </div>
<div class="line"><a name="l03152"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94cce09895dc9f41d4b9a429ccf638e8"> 3152</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94cce09895dc9f41d4b9a429ccf638e8">ProSHADE_internal_data::ProSHADE_data::getRealTranslationFunction</a> ( <span class="keywordtype">double</span> *trsFunReal, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;{</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    {</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;        trsFunReal[iter]                              = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;translationMap[iter][0] );</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;    }</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;    </div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;    return ;</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;    </div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;}</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160; </div>
<div class="line"><a name="l03170"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a97766b6a74aee4c364c1fd8efd6478ff"> 3170</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a97766b6a74aee4c364c1fd8efd6478ff">ProSHADE_internal_data::ProSHADE_data::getImagTranslationFunction</a> ( <span class="keywordtype">double</span> *trsFunImag, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;{</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;    {</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        trsFunImag[iter]                              = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;translationMap[iter][1] );</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;    }</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;    </div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;    return ;</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;    </div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;}</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160; </div>
<div class="line"><a name="l03191"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a688bac56d3c483bd99c0ff7d63cf7602"> 3191</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a688bac56d3c483bd99c0ff7d63cf7602">ProSHADE_internal_data::ProSHADE_data::getRotMatrixFromRotFunInds</a> ( proshade_signed aI, proshade_signed bI, proshade_signed gI, <span class="keywordtype">double</span> *rotMat, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;{</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;    <span class="comment">//================================================ Get Euler angles</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;    proshade_double eA, eB, eG;</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#acf6c5376edac98e54ef0e418cd05d706">ProSHADE_internal_maths::getEulerZXZFromSOFTPosition</a> ( this-&gt;getMaxBand(), aI, bI, gI, &amp;eA, &amp;eB, &amp;eG );</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;    </div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    <span class="comment">//================================================ Prepare internal rotation matrix memory</span></div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    proshade_double* rMat                             = NULL;</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;    rMat                                              = <span class="keyword">new</span> proshade_double[9];</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rMat, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;    </div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    <span class="comment">//================================================ Convert to rotation matrix</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a> ( eA, eB, eG, rMat );</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;    </div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;    <span class="comment">//================================================ Copy to output</span></div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;    {</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;        rotMat[iter]                                  = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( rMat[iter] );</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;    }</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;    </div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    <span class="comment">//================================================ Release internal memory</span></div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;    <span class="keyword">delete</span>[] rMat;</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;    </div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;    return ;</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;    </div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;}</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160; </div>
<div class="line"><a name="l03223"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5add825ce8d5e5d9f598f6912f07aff"> 3223</a></span>&#160;std::string <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5add825ce8d5e5d9f598f6912f07aff">ProSHADE_internal_data::ProSHADE_data::getRecommendedSymmetryType</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;{</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;    <span class="keywordflow">return</span>                                            ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac39560ba9aca9053753c158fb2adb9de">recommendedSymmetryType</a> );</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;    </div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;}</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160; </div>
<div class="line"><a name="l03234"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e1bd5bd5a3fd12691a1d83735c13250"> 3234</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e1bd5bd5a3fd12691a1d83735c13250">ProSHADE_internal_data::ProSHADE_data::getRecommendedSymmetryFold</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;{</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;    <span class="keywordflow">return</span>                                            ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac8e62cc8dbd40265e51143c8207b6638">recommendedSymmetryFold</a> );</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;    </div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;}</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160; </div>
<div class="line"><a name="l03246"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aaf62d97762dce15f956066d15e048c48"> 3246</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aaf62d97762dce15f956066d15e048c48">ProSHADE_internal_data::ProSHADE_data::getNoSymmetryAxes</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;{</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() ) );</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;}</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160; </div>
<div class="line"><a name="l03258"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0662f17e733fb6c1a16f04b273f8b7a5"> 3258</a></span>&#160;std::vector&lt; std::string &gt; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0662f17e733fb6c1a16f04b273f8b7a5">ProSHADE_internal_data::ProSHADE_data::getSymmetryAxis</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, proshade_unsign axisNo )</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;{</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;    <span class="comment">//================================================ Sanity checks</span></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;    <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() ) &lt;= axisNo )</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;    {</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Requested symmetry index does not exist. Returning empty vector.&quot;</span>, <span class="stringliteral">&quot;WS00039&quot;</span> );</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;        <span class="keywordflow">return</span>                                        ( std::vector&lt; std::string &gt; ( ) );</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;    }</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;    </div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;    std::vector&lt; std::string &gt; ret;</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    </div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;    <span class="comment">//================================================ Input the axis data as strings</span></div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;    std::stringstream ssHlp;</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[0];</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;    </div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[1];</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;    </div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[2];</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;    </div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[3];</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;    </div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[4];</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;    </div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[5];</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;    </div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;    </div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a64323b4117a11f0971cb0d24ec95c64c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a64323b4117a11f0971cb0d24ec95c64c">ProSHADE_internal_data::ProSHADE_data::originalMapYCom</a></div><div class="ttdeci">proshade_double originalMapYCom</div><div class="ttdoc">The COM of the first map to be loaded/computed without any furhter changes being reflacted along the ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00095">ProSHADE_data.hpp:95</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a8324ed7ec9c19df21511f117df80ab11"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a8324ed7ec9c19df21511f117df80ab11">ProSHADE_settings::maxBandwidth</a></div><div class="ttdeci">proshade_unsign maxBandwidth</div><div class="ttdoc">The bandwidth of spherical harmonics decomposition for the largest sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00103">ProSHADE_settings.hpp:103</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a7c88b1152378beca4ccee251f2fb5e06"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a7c88b1152378beca4ccee251f2fb5e06">ProSHADE_internal_mapManip::addExtraBoundSpace</a></div><div class="ttdeci">void addExtraBoundSpace(proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed *&amp;bounds, proshade_single extraSpace)</div><div class="ttdoc">This function takes a set of bounds and adds a given number of Angstroms to them.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00914">ProSHADE_mapManip.cpp:914</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a23f9a5f8f6fb7cf0f0324bc1d83d6090"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23f9a5f8f6fb7cf0f0324bc1d83d6090">ProSHADE_internal_data::ProSHADE_data::computeSphericalHarmonics</a></div><div class="ttdeci">void computeSphericalHarmonics(ProSHADE_settings *settings)</div><div class="ttdoc">This function computes the spherical harmonics decomposition for the whole structure.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01613">ProSHADE_data.cpp:1613</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ac39560ba9aca9053753c158fb2adb9de"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ac39560ba9aca9053753c158fb2adb9de">ProSHADE_settings::recommendedSymmetryType</a></div><div class="ttdeci">std::string recommendedSymmetryType</div><div class="ttdoc">The symmetry type that ProSHADE finds the best fitting for the structure. Possible values are &quot;&quot; for ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00169">ProSHADE_settings.hpp:169</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a94a73f81ba80621f5f52173e91bb47f7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94a73f81ba80621f5f52173e91bb47f7">ProSHADE_internal_data::ProSHADE_data::getEMatrixByBand</a></div><div class="ttdeci">proshade_complex ** getEMatrixByBand(proshade_unsign band)</div><div class="ttdoc">This function allows access to E matrix for a particular band.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02515">ProSHADE_data.cpp:2515</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac8904f5a5f12c02e17e23dd595aa7770"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac8904f5a5f12c02e17e23dd595aa7770">ProSHADE_internal_data::ProSHADE_data::getRealSphericalHarmonicsForShell</a></div><div class="ttdeci">void getRealSphericalHarmonicsForShell(proshade_unsign shellNo, proshade_signed verbose, double *sphericalHarmsReal, int len)</div><div class="ttdoc">This function fills a given array with the real parts of the spherical harmonics values for a given s...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02941">ProSHADE_data.cpp:2941</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2ef40a71dcd34c8b1111e0de484722a2"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2ef40a71dcd34c8b1111e0de484722a2">ProSHADE_internal_data::ProSHADE_data::sphericalHarmonicsIndex</a></div><div class="ttdeci">int sphericalHarmonicsIndex(proshade_signed order, proshade_signed band, proshade_signed shell)</div><div class="ttdoc">This function gets the spherical harmonics array index for a particular spherical harmonics band and ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03014">ProSHADE_data.cpp:3014</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae9b0d5959b0f461b3b89ffeb059400fa"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">ProSHADE_internal_data::ProSHADE_data::fileName</a></div><div class="ttdeci">std::string fileName</div><div class="ttdoc">This is the original file from which the data were obtained.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00052">ProSHADE_data.hpp:52</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a14980cdf619bcda026b9aad282c2064b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">ProSHADE_internal_data::ProSHADE_data::zFrom</a></div><div class="ttdeci">proshade_signed zFrom</div><div class="ttdoc">This is the starting index along the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00104">ProSHADE_data.hpp:104</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aceb7facd99379a000035ce35263577d5"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">ProSHADE_internal_data::ProSHADE_data::xDimIndices</a></div><div class="ttdeci">proshade_unsign xDimIndices</div><div class="ttdoc">This is the size of the map cell x dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00065">ProSHADE_data.hpp:65</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_af4d641d62864e4adf67c1365b0960970"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">ProSHADE_internal_data::ProSHADE_data::getZDimSize</a></div><div class="ttdeci">proshade_single getZDimSize(void)</div><div class="ttdoc">This function allows access to the map size in angstroms along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02617">ProSHADE_data.cpp:2617</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a530ad7e3396cbcbc1814051031070a8b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a530ad7e3396cbcbc1814051031070a8b">ProSHADE_internal_data::ProSHADE_data::zDimSizeOriginal</a></div><div class="ttdeci">proshade_single zDimSizeOriginal</div><div class="ttdoc">This is the size of the map cell z dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00087">ProSHADE_data.hpp:87</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a8a7c6330e101fb6d729aaf6f545db9c8"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a8a7c6330e101fb6d729aaf6f545db9c8">ProSHADE_internal_maths::vectorMeanAndSD</a></div><div class="ttdeci">void vectorMeanAndSD(std::vector&lt; proshade_double &gt; *vec, proshade_double *&amp;ret)</div><div class="ttdoc">Function to get vector mean and standard deviation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00121">ProSHADE_maths.cpp:121</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3349a7f6ffecc3ffd4e09192eb919248"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3349a7f6ffecc3ffd4e09192eb919248">ProSHADE_internal_data::ProSHADE_data::createNewMapFromBounds</a></div><div class="ttdeci">void createNewMapFromBounds(ProSHADE_settings *settings, ProSHADE_data *&amp;newStr, proshade_signed *newBounds)</div><div class="ttdoc">This function creates a new structure from the calling structure and new bounds values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01093">ProSHADE_data.cpp:1093</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a46e32d9d122118fa08fd4f051f37e506"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a46e32d9d122118fa08fd4f051f37e506">ProSHADE_settings::determineAllSHValues</a></div><div class="ttdeci">void determineAllSHValues(proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim)</div><div class="ttdoc">This function determines all the required values for spherical harmonics computation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l01209">ProSHADE.cpp:1209</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_abc5e6a82b6b44e3666abfc190dc0bc64"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#abc5e6a82b6b44e3666abfc190dc0bc64">ProSHADE_internal_io::isFilePDB</a></div><div class="ttdeci">bool isFilePDB(std::string fName)</div><div class="ttdoc">Function determining if the input data type is PDB.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00032">ProSHADE_io.cpp:32</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aedb2ba02e77d5795077df91b2578ab29"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">ProSHADE_internal_data::ProSHADE_data::xGridIndices</a></div><div class="ttdeci">proshade_unsign xGridIndices</div><div class="ttdoc">As far as I know, this is identical to the xDimIndices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00068">ProSHADE_data.hpp:68</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a37f26ac4bc76e4f4c5da77dd0eace56e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37f26ac4bc76e4f4c5da77dd0eace56e">ProSHADE_internal_data::ProSHADE_data::translationMap</a></div><div class="ttdeci">proshade_complex * translationMap</div><div class="ttdoc">This is where the translation map will be held, if at all used.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00125">ProSHADE_data.hpp:125</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a603841095e16abd0492dfc6db052fda7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">ProSHADE_internal_data::ProSHADE_data::xAxisOrder</a></div><div class="ttdeci">proshade_unsign xAxisOrder</div><div class="ttdoc">This is the order of the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00071">ProSHADE_data.hpp:71</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ab90d22f3a1f38cb17243b7191ff1bdcd"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab90d22f3a1f38cb17243b7191ff1bdcd">ProSHADE_internal_data::ProSHADE_data::setNewMapPython</a></div><div class="ttdeci">void setNewMapPython(double *mapChangedInPython, int len)</div><div class="ttdoc">This function takes an array, deletes old map, allocates a new map and fills the internal map values ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02913">ProSHADE_data.cpp:2913</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a94b04108aa1a9406eb3c5eb61749140b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94b04108aa1a9406eb3c5eb61749140b">ProSHADE_internal_data::ProSHADE_data::rotSphericalHarmonics</a></div><div class="ttdeci">proshade_complex ** rotSphericalHarmonics</div><div class="ttdoc">A set of rotated spherical harmonics values arrays for each sphere, used only if map rotation is requ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00114">ProSHADE_data.hpp:114</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac0dc9f3ed79cc98719e6b727bb8bb982"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac0dc9f3ed79cc98719e6b727bb8bb982">ProSHADE_internal_data::ProSHADE_data::getReBoxBoundaries</a></div><div class="ttdeci">void getReBoxBoundaries(ProSHADE_settings *settings, proshade_signed *&amp;ret)</div><div class="ttdoc">This function finds the boundaries enclosing positive map values and adds some extra space.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00968">ProSHADE_data.cpp:968</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a69c32bcbcdc6b5f58dc4659141b34fcd"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a69c32bcbcdc6b5f58dc4659141b34fcd">ProSHADE_internal_data::ProSHADE_data::findIScore</a></div><div class="ttdeci">proshade_double findIScore(std::vector&lt; proshade_double * &gt; *ISym)</div><div class="ttdoc">This function takes the list of icosahedral axes and returns a score for deciding whether I symmetry ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01921">ProSHADE_data.cpp:1921</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a6cc2b8e179a137adda234e0ba0f9d27b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6cc2b8e179a137adda234e0ba0f9d27b">ProSHADE_internal_data::ProSHADE_data::getComparisonBand</a></div><div class="ttdeci">proshade_unsign getComparisonBand(void)</div><div class="ttdoc">This function allows access to the maximum band for the comparison.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02567">ProSHADE_data.cpp:2567</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8e1bd5bd5a3fd12691a1d83735c13250"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e1bd5bd5a3fd12691a1d83735c13250">ProSHADE_internal_data::ProSHADE_data::getRecommendedSymmetryFold</a></div><div class="ttdeci">proshade_unsign getRecommendedSymmetryFold(ProSHADE_settings *settings)</div><div class="ttdoc">This function simply returns the detected recommended symmetry fold.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03234">ProSHADE_data.cpp:3234</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5f934f331c4d3bc7c0a6f63486b2f90e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">ProSHADE_internal_data::ProSHADE_data::sphericalHarmonics</a></div><div class="ttdeci">proshade_complex ** sphericalHarmonics</div><div class="ttdoc">A set of spherical harmonics values arrays for each sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00113">ProSHADE_data.hpp:113</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3e7b1d5d4164ea7a6fda53c57ac979f4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e7b1d5d4164ea7a6fda53c57ac979f4">ProSHADE_internal_data::ProSHADE_data::setIntegrationWeight</a></div><div class="ttdeci">void setIntegrationWeight(proshade_double intW)</div><div class="ttdoc">This function allows setting the integration weight for the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02767">ProSHADE_data.cpp:2767</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8e2f99f00dd05198b508633cf7f6f080"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e2f99f00dd05198b508633cf7f6f080">ProSHADE_internal_data::ProSHADE_data::cAngle</a></div><div class="ttdeci">proshade_single cAngle</div><div class="ttdoc">This is the angle c of the map cell in degrees.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00064">ProSHADE_data.hpp:64</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a33312dd4333617b460628e4db4bf41fc"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a33312dd4333617b460628e4db4bf41fc">ProSHADE_internal_data::ProSHADE_data::so3CoeffsInverse</a></div><div class="ttdeci">proshade_complex * so3CoeffsInverse</div><div class="ttdoc">The inverse coefficients obtained by inverse SO(3) Fourier Transform (SOFT) - i.e....</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00122">ProSHADE_data.hpp:122</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a97c84fea7b9b77f73d3f15730751e070"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a97c84fea7b9b77f73d3f15730751e070">ProSHADE_internal_data::ProSHADE_data::saveRequestedSymmetryD</a></div><div class="ttdeci">void saveRequestedSymmetryD(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *DSym, std::vector&lt; proshade_double * &gt; *axes)</div><div class="ttdoc">This function takes the D symmetries and searched for the requested symmetry.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02099">ProSHADE_data.cpp:2099</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8a1405b3974697f41c4a73da0cb52a32"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a1405b3974697f41c4a73da0cb52a32">ProSHADE_internal_data::ProSHADE_data::getXAxisOrigin</a></div><div class="ttdeci">proshade_signed * getXAxisOrigin(void)</div><div class="ttdoc">This function allows access to the map X axis origin value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02717">ProSHADE_data.cpp:2717</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aceb19c915cebcef22c085cc6619cc472"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb19c915cebcef22c085cc6619cc472">ProSHADE_internal_data::ProSHADE_data::normaliseEMatrixValue</a></div><div class="ttdeci">void normaliseEMatrixValue(proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double normF)</div><div class="ttdoc">This function allows normalising the E matrix value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02816">ProSHADE_data.cpp:2816</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a668381d94a927275b3d839549475c7da"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">ProSHADE_internal_data::ProSHADE_data::yCom</a></div><div class="ttdeci">proshade_double yCom</div><div class="ttdoc">The COM of the map after processing along the Y-axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00081">ProSHADE_data.hpp:81</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a633435d4c8a7fd6533016c00ad9ba791"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a633435d4c8a7fd6533016c00ad9ba791">ProSHADE_settings::boundsExtraSpace</a></div><div class="ttdeci">proshade_single boundsExtraSpace</div><div class="ttdoc">The number of extra angstroms to be added to all re-boxing bounds just for safety.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00134">ProSHADE_settings.hpp:134</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__exception_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a></div><div class="ttdoc">This class is the representation of ProSHADE exception.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__exceptions_8hpp_source.html#l00036">ProSHADE_exceptions.hpp:37</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a97766b6a74aee4c364c1fd8efd6478ff"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a97766b6a74aee4c364c1fd8efd6478ff">ProSHADE_internal_data::ProSHADE_data::getImagTranslationFunction</a></div><div class="ttdeci">void getImagTranslationFunction(double *trsFunImag, int len)</div><div class="ttdoc">This function fills the input array with the imaginary translation function values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03170">ProSHADE_data.cpp:3170</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ab3aa4cdcd7cc9b458d7618077dfaab02"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab3aa4cdcd7cc9b458d7618077dfaab02">ProSHADE_internal_data::ProSHADE_data::setWignerMatrixValue</a></div><div class="ttdeci">void setWignerMatrixValue(proshade_complex val, proshade_unsign band, proshade_unsign order1, proshade_unsign order2)</div><div class="ttdoc">This function allows setting the Wigner D matrix value by its band, order1 and order2 co-ordinate.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02850">ProSHADE_data.cpp:2850</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a51c87d0b415c8eaa517dbb9b5496e7e9"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a51c87d0b415c8eaa517dbb9b5496e7e9">ProSHADE_settings::blurFactor</a></div><div class="ttdeci">proshade_single blurFactor</div><div class="ttdoc">This is the amount by which B-factors should be increased to create the blurred map for masking.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00123">ProSHADE_settings.hpp:123</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a7c941c912cd17ad86057b8d7a15b9a21"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a7c941c912cd17ad86057b8d7a15b9a21">ProSHADE_settings::maskMap</a></div><div class="ttdeci">bool maskMap</div><div class="ttdoc">Should the map be masked from noise?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00125">ProSHADE_settings.hpp:125</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a6dc170d9826bad9ce4a2c31a033f7f6a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a6dc170d9826bad9ce4a2c31a033f7f6a">ProSHADE_settings::requestedSymmetryFold</a></div><div class="ttdeci">proshade_unsign requestedSymmetryFold</div><div class="ttdoc">The fold of the requested symmetry (only applicable to C and D symmetry types).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00172">ProSHADE_settings.hpp:172</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ab59297b3604ced939e30eaacd2eaaccb"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">ProSHADE_settings::requestedSymmetryType</a></div><div class="ttdeci">std::string requestedSymmetryType</div><div class="ttdoc">The symmetry type requested by the user. Allowed values are C, D, T, O and I.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00171">ProSHADE_settings.hpp:171</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ab053362f9dc5422244ccfbafd9f00ff8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab053362f9dc5422244ccfbafd9f00ff8">ProSHADE_internal_data::ProSHADE_data::getEMatrixValue</a></div><div class="ttdeci">void getEMatrixValue(proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double *valueReal, proshade_double *valueImag)</div><div class="ttdoc">This function allows access to E matrix by knowing the band, order1 and order2 indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02530">ProSHADE_data.cpp:2530</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a51d7b9d87d536ef0c48d820872bc9185"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">ProSHADE_internal_data::ProSHADE_data::getXDimSize</a></div><div class="ttdeci">proshade_single getXDimSize(void)</div><div class="ttdoc">This function allows access to the map size in angstroms along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02597">ProSHADE_data.cpp:2597</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_af60532f379f5f3549a598aeb504fe311"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af60532f379f5f3549a598aeb504fe311">ProSHADE_internal_data::ProSHADE_data::detectSymmetryInStructure</a></div><div class="ttdeci">void detectSymmetryInStructure(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *axes)</div><div class="ttdoc">This function runs the symmetry detection algorithms on this structure and saves the results in the s...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01656">ProSHADE_data.cpp:1656</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1bb8bf1e357cc25f68fe93554e44715d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1bb8bf1e357cc25f68fe93554e44715d">ProSHADE_internal_data::ProSHADE_data::getInternalMap</a></div><div class="ttdeci">proshade_double *&amp; getInternalMap(void)</div><div class="ttdoc">This function allows access to the first map array value address.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02747">ProSHADE_data.cpp:2747</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a></div><div class="ttdoc">This class contains all inputed and derived data for a single structure.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00048">ProSHADE_data.hpp:49</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a411b398b06557387320b56c6b8233fc4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">ProSHADE_internal_data::ProSHADE_data::noSpheres</a></div><div class="ttdeci">proshade_unsign noSpheres</div><div class="ttdoc">The number of spheres with map projected onto them.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00111">ProSHADE_data.hpp:111</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae477e3c0d7b866e6069d8603950afe51"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">ProSHADE_internal_data::ProSHADE_data::getYDimSize</a></div><div class="ttdeci">proshade_single getYDimSize(void)</div><div class="ttdoc">This function allows access to the map size in angstroms along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02607">ProSHADE_data.cpp:2607</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a42699d52d1be0d24e58deea4e25439bf"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a42699d52d1be0d24e58deea4e25439bf">ProSHADE_internal_mapManip::getMaskFromBlurr</a></div><div class="ttdeci">void getMaskFromBlurr(proshade_double *&amp;blurMap, proshade_double *&amp;outMap, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_single noIQRs)</div><div class="ttdoc">Function for computing mask from blurred map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00804">ProSHADE_mapManip.cpp:804</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a20fd31138680dd622058732eba31dca5"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">ProSHADE_internal_data::ProSHADE_data::zDimSize</a></div><div class="ttdeci">proshade_single zDimSize</div><div class="ttdoc">This is the size of the map cell z dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00061">ProSHADE_data.hpp:61</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_af0ef7edd1c46d88512bc65e448a84a4c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af0ef7edd1c46d88512bc65e448a84a4c">ProSHADE_internal_data::ProSHADE_data::createNewMapFromBoundsPy</a></div><div class="ttdeci">void createNewMapFromBoundsPy(ProSHADE_settings *settings, ProSHADE_data *newStr, int *newBounds, int len)</div><div class="ttdoc">This function creates a new structure from the calling structure and new bounds values in Python frie...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01165">ProSHADE_data.cpp:1165</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad5416490eb3eba7539d08a5b324fbadb"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">ProSHADE_internal_data::ProSHADE_data::so3Coeffs</a></div><div class="ttdeci">proshade_complex * so3Coeffs</div><div class="ttdoc">The coefficients obtained by SO(3) Fourier Transform (SOFT), in this case derived from the E matrices...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00121">ProSHADE_data.hpp:121</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2245b15f279de574406204156089e5ef"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">ProSHADE_internal_data::ProSHADE_data::getMaxSpheres</a></div><div class="ttdeci">proshade_unsign getMaxSpheres(void)</div><div class="ttdoc">This function returns the number of spheres which contain the whole object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02297">ProSHADE_data.cpp:2297</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aca5e27540622190be41ce78157c0807e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5e27540622190be41ce78157c0807e">ProSHADE_internal_data::ProSHADE_data::setSO3CoeffValue</a></div><div class="ttdeci">void setSO3CoeffValue(proshade_unsign position, proshade_complex val)</div><div class="ttdoc">This function allows setting the SOFT coefficient values using array position and value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02832">ProSHADE_data.cpp:2832</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a29445fb6221eed35a32147814a3f58d5"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a29445fb6221eed35a32147814a3f58d5">ProSHADE_settings::saveMask</a></div><div class="ttdeci">bool saveMask</div><div class="ttdoc">Should the mask be saved?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00129">ProSHADE_settings.hpp:129</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a7d0a63b2ac89e4f0df85ce5053c6bd87"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">ProSHADE_settings::requestedResolution</a></div><div class="ttdeci">proshade_single requestedResolution</div><div class="ttdoc">The resolution to which the calculations are to be done.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00095">ProSHADE_settings.hpp:95</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_afdac8ed8f140bdcd289ee666b61789d4"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#afdac8ed8f140bdcd289ee666b61789d4">ProSHADE_internal_mapManip::blurSharpenMap</a></div><div class="ttdeci">void blurSharpenMap(proshade_double *&amp;map, proshade_double *&amp;maskedMap, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_single blurringFactor)</div><div class="ttdoc">Function for blurring/sharpening maps.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00704">ProSHADE_mapManip.cpp:704</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2a3fdf194eca61b1ccfa5bdd2f586e0b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2a3fdf194eca61b1ccfa5bdd2f586e0b">ProSHADE_internal_data::ProSHADE_data::originalMapXCom</a></div><div class="ttdeci">proshade_double originalMapXCom</div><div class="ttdoc">The COM of the first map to be loaded/computed without any furhter changes being reflacted along the ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00094">ProSHADE_data.hpp:94</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a688bac56d3c483bd99c0ff7d63cf7602"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a688bac56d3c483bd99c0ff7d63cf7602">ProSHADE_internal_data::ProSHADE_data::getRotMatrixFromRotFunInds</a></div><div class="ttdeci">void getRotMatrixFromRotFunInds(proshade_signed aI, proshade_signed bI, proshade_signed gI, double *rotMat, int len)</div><div class="ttdoc">This function takes rotation function indices, converts them to Euler angles and these to rotation ma...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03191">ProSHADE_data.cpp:3191</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_aaacee048ce8a3489edc77afcb54f0ca0"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">ProSHADE_settings::setDetectedSymmetry</a></div><div class="ttdeci">void setDetectedSymmetry(proshade_double *sym)</div><div class="ttdoc">Sets the final detected symmetry axes information.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l01038">ProSHADE.cpp:1038</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9598e9a38546e3bf260bc09c0c9366a2"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9598e9a38546e3bf260bc09c0c9366a2">ProSHADE_internal_data::ProSHADE_data::xDimIndicesOriginal</a></div><div class="ttdeci">proshade_unsign xDimIndicesOriginal</div><div class="ttdoc">This is the size of the map cell x dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00088">ProSHADE_data.hpp:88</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a94dfbe2867f4e294dbb49284881fcb2a"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a></div><div class="ttdeci">void moveMapByFourier(proshade_double *&amp;map, proshade_single xMov, proshade_single yMov, proshade_single zMov, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed xDim, proshade_signed yDim, proshade_signed zDim)</div><div class="ttdoc">Function for moving map back to original PDB location by using Fourier transformation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00584">ProSHADE_mapManip.cpp:584</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a23620b34a604aca7db4d8b21f6d2d09a"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23620b34a604aca7db4d8b21f6d2d09a">ProSHADE_internal_data::ProSHADE_data::getAnySphereRadius</a></div><div class="ttdeci">proshade_double getAnySphereRadius(proshade_unsign shell)</div><div class="ttdoc">This function allows access to the radius of any particular sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02468">ProSHADE_data.cpp:2468</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a2f1e4debc49664de8842d1b42be74d2d"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a2f1e4debc49664de8842d1b42be74d2d">ProSHADE_settings::progressiveSphereMapping</a></div><div class="ttdeci">bool progressiveSphereMapping</div><div class="ttdoc">If true, each shell will have its own angular resolution dependent on the actual number of map points...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00146">ProSHADE_settings.hpp:146</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a0ec724aa0f717ee1b81c249930586290"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0ec724aa0f717ee1b81c249930586290">ProSHADE_internal_data::ProSHADE_data::getImagSphericalHarmonicsForShell</a></div><div class="ttdeci">void getImagSphericalHarmonicsForShell(proshade_unsign shellNo, proshade_signed verbose, double *sphericalHarmsImag, int len)</div><div class="ttdoc">This function fills a given array with the imaginary parts of the spherical harmonics values for a gi...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02968">ProSHADE_data.cpp:2968</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae5c9c45b0db1e6a9eeef2ba292fbbcc3"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae5c9c45b0db1e6a9eeef2ba292fbbcc3">ProSHADE_internal_data::ProSHADE_data::getSO3Coeffs</a></div><div class="ttdeci">proshade_complex * getSO3Coeffs(void)</div><div class="ttdoc">This function allows access to the SO(3) coefficients array.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02556">ProSHADE_data.cpp:2556</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a42e4b11981a2d3a518cb3c70e5470fb2"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a42e4b11981a2d3a518cb3c70e5470fb2">ProSHADE_settings::maxSphereDists</a></div><div class="ttdeci">proshade_single maxSphereDists</div><div class="ttdoc">The distance between spheres in spherical mapping for the largest sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00110">ProSHADE_settings.hpp:110</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a367d0cd13e3d7a2648488980220ca69b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">ProSHADE_internal_data::ProSHADE_data::maxShellBand</a></div><div class="ttdeci">proshade_unsign maxShellBand</div><div class="ttdoc">The maximum band for any shell of the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00115">ProSHADE_data.hpp:115</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a188b648a0ad28b598d682ca14f288dc4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a188b648a0ad28b598d682ca14f288dc4">ProSHADE_internal_data::ProSHADE_data::getSpherePositions</a></div><div class="ttdeci">void getSpherePositions(ProSHADE_settings *settings)</div><div class="ttdoc">This function determines the sphere positions (radii) for sphere mapping.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01516">ProSHADE_data.cpp:1516</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8a76a78596f27299a14bf29335772126"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a76a78596f27299a14bf29335772126">ProSHADE_internal_data::ProSHADE_data::getMapArraySizePython</a></div><div class="ttdeci">int getMapArraySizePython(void)</div><div class="ttdoc">This function simplyfies Python access to maps - it returns how long the map array is,...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02865">ProSHADE_data.cpp:2865</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa67115a6b234764c958899863fb60b54"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa67115a6b234764c958899863fb60b54">ProSHADE_internal_data::ProSHADE_data::invertMirrorMap</a></div><div class="ttdeci">void invertMirrorMap(ProSHADE_settings *settings)</div><div class="ttdoc">Function for inverting the map to its mirror image.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00827">ProSHADE_data.cpp:827</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_abd9fe573a48f499dd7d1df4f779222f1"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a></div><div class="ttdeci">void getRotationMatrixFromEulerZXZAngles(proshade_double eulerAlpha, proshade_double eulerBeta, proshade_double eulerGamma, proshade_double *matrix)</div><div class="ttdoc">Function to find the rotation matrix from Euler angles (ZXZ convention).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00977">ProSHADE_maths.cpp:977</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3be93c3f8e860afc435750fa1c6c01d7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3be93c3f8e860afc435750fa1c6c01d7">ProSHADE_internal_data::ProSHADE_data::getSpherePosValue</a></div><div class="ttdeci">proshade_double getSpherePosValue(proshade_unsign shell)</div><div class="ttdoc">This function allows access to sphere positions.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02503">ProSHADE_data.cpp:2503</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae8df7d1c2855263e0c0d73a5474001e1"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae8df7d1c2855263e0c0d73a5474001e1">ProSHADE_internal_data::ProSHADE_data::findBestCScore</a></div><div class="ttdeci">proshade_double findBestCScore(std::vector&lt; proshade_double * &gt; *CSym, proshade_unsign *symInd)</div><div class="ttdoc">This function locates the best scoring C symmetry axis, returning the score and best symmetry index.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01762">ProSHADE_data.cpp:1762</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a7c96697585083a53f83556e70e4faca8"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a7c96697585083a53f83556e70e4faca8">ProSHADE_settings::maskingThresholdIQRs</a></div><div class="ttdeci">proshade_single maskingThresholdIQRs</div><div class="ttdoc">Number of inter-quartile ranges from the median to be used for thresholding the blurred map for maski...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00124">ProSHADE_settings.hpp:124</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a2019a6bae1b3e6f7d8805ae2734b769e"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a2019a6bae1b3e6f7d8805ae2734b769e">ProSHADE_settings::usePhase</a></div><div class="ttdeci">bool usePhase</div><div class="ttdoc">If true, the full data will be used, if false, Patterson maps will be used instead and phased data wi...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00107">ProSHADE_settings.hpp:107</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a576bfe808729a1a224ac12263709b8dd"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a576bfe808729a1a224ac12263709b8dd">ProSHADE_internal_data::ProSHADE_data::deepCopyMap</a></div><div class="ttdeci">void deepCopyMap(proshade_double *&amp;saveTo, proshade_unsign verbose)</div><div class="ttdoc">This function copies the internal map into the supplied pointer, which it also allocates.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02147">ProSHADE_data.cpp:2147</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a3892495503aa80bbb294574ee9a94e1d"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a3892495503aa80bbb294574ee9a94e1d">ProSHADE_internal_mapManip::translatePDBCoordinates</a></div><div class="ttdeci">void translatePDBCoordinates(gemmi::Structure *pdbFile, proshade_double transX, proshade_double transY, proshade_double transZ)</div><div class="ttdoc">Function for translating the PDB file co-ordinates by given distances in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00272">ProSHADE_mapManip.cpp:272</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1ae6821c27e7facf63839c9fc678c9c7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ae6821c27e7facf63839c9fc678c9c7">ProSHADE_internal_data::ProSHADE_data::xDimSizeOriginal</a></div><div class="ttdeci">proshade_single xDimSizeOriginal</div><div class="ttdoc">This is the size of the map cell x dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00085">ProSHADE_data.hpp:85</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a107ae7dc23e1a2d64c05106a009beba1"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a107ae7dc23e1a2d64c05106a009beba1">ProSHADE_internal_io::readInMapHeaderFroms</a></div><div class="ttdeci">void readInMapHeaderFroms(gemmi::Ccp4&lt; float &gt; *map, proshade_signed *xFrom, proshade_signed *yFrom, proshade_signed *zFrom)</div><div class="ttdoc">This function parses the CCP4 MAP file header as read in by gemmi from values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00145">ProSHADE_io.cpp:145</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__messages_html_addbb90f2b4199441f60e241ac850daa2"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a></div><div class="ttdeci">void printWarningMessage(proshade_signed verbose, std::string message, std::string warnCode)</div><div class="ttdoc">General stderr message printing (used for warnings).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__messages_8cpp_source.html#l00101">ProSHADE_messages.cpp:101</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa150cfc5715420cf3d2e28c8af3631c4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa150cfc5715420cf3d2e28c8af3631c4">ProSHADE_internal_data::ProSHADE_data::getIntegrationWeight</a></div><div class="ttdeci">proshade_double getIntegrationWeight(void)</div><div class="ttdoc">This function allows access to the integration weight for the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02479">ProSHADE_data.cpp:2479</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a63ae2cc7f413d224e5d651ed579e9afb"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a63ae2cc7f413d224e5d651ed579e9afb">ProSHADE_internal_io::figureDataType</a></div><div class="ttdeci">InputType figureDataType(std::string fName)</div><div class="ttdoc">Function determining input data type.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00291">ProSHADE_io.cpp:291</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a737ee01d968fef7ae1094847a0271033"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a737ee01d968fef7ae1094847a0271033">ProSHADE_internal_data::ProSHADE_data::setIntegrationWeightCumul</a></div><div class="ttdeci">void setIntegrationWeightCumul(proshade_double intW)</div><div class="ttdoc">This function allows setting the cumulative integration weight for the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02781">ProSHADE_data.cpp:2781</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a5db74cc13dd4b64cf0a8377ed078b47c"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a5db74cc13dd4b64cf0a8377ed078b47c">ProSHADE_internal_mapManip::reSampleMapToResolutionTrilinear</a></div><div class="ttdeci">void reSampleMapToResolutionTrilinear(proshade_double *&amp;map, proshade_single resolution, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_single *&amp;corrs)</div><div class="ttdoc">This function re-samples a map to conform to given resolution using tri-linear interpolation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00950">ProSHADE_mapManip.cpp:950</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aed1c8e0ffb847b093a736c5156f86e9b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aed1c8e0ffb847b093a736c5156f86e9b">ProSHADE_internal_data::ProSHADE_data::zAxisOriginOriginal</a></div><div class="ttdeci">proshade_signed zAxisOriginOriginal</div><div class="ttdoc">This is the origin position along the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00093">ProSHADE_data.hpp:93</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html">ProSHADE_internal_spheres::ProSHADE_sphere</a></div><div class="ttdoc">This class contains all inputed and derived data for a single sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spheres_8hpp_source.html#l00048">ProSHADE_spheres.hpp:49</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a0662f17e733fb6c1a16f04b273f8b7a5"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0662f17e733fb6c1a16f04b273f8b7a5">ProSHADE_internal_data::ProSHADE_data::getSymmetryAxis</a></div><div class="ttdeci">std::vector&lt; std::string &gt; getSymmetryAxis(ProSHADE_settings *settings, proshade_unsign axisNo)</div><div class="ttdoc">This function returns a single symmetry axis as a vector of strings from the recommended symmetry axe...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03258">ProSHADE_data.cpp:3258</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_affb17d9099f0b85b3af04a78d5c670f4"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#affb17d9099f0b85b3af04a78d5c670f4">ProSHADE_settings::maskFileName</a></div><div class="ttdeci">std::string maskFileName</div><div class="ttdoc">The filename to which mask should be saved.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00130">ProSHADE_settings.hpp:130</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a82b2d8f8c05da2eccb5561e6455b4d44"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">ProSHADE_internal_data::ProSHADE_data::eMatrices</a></div><div class="ttdeci">proshade_complex *** eMatrices</div><div class="ttdoc">The trace sigma and full rotation function c*conj(c) integral tables.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00119">ProSHADE_data.hpp:119</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a80ff45ef40549fb6a1d80b70865fc807"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a80ff45ef40549fb6a1d80b70865fc807">ProSHADE_internal_data::ProSHADE_data::centreMapOnCOM</a></div><div class="ttdeci">void centreMapOnCOM(ProSHADE_settings *settings)</div><div class="ttdoc">This function shits the map so that its COM is in the centre of the map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01303">ProSHADE_data.cpp:1303</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a4c89c860da1836b30a9b2889d3e873ed"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4c89c860da1836b30a9b2889d3e873ed">ProSHADE_internal_data::ProSHADE_data::getXFromPtr</a></div><div class="ttdeci">proshade_signed * getXFromPtr(void)</div><div class="ttdoc">This function allows access to the map start along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02657">ProSHADE_data.cpp:2657</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a89094c73ae033812d4df0bd846e03442"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">ProSHADE_settings::verbose</a></div><div class="ttdeci">proshade_signed verbose</div><div class="ttdoc">Should the software report on the progress, or just be quiet? Value between -1 (nothing) and 4 (loud)</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00179">ProSHADE_settings.hpp:179</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_ae273430e12dd5bce08cf29c7689800dd"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ae273430e12dd5bce08cf29c7689800dd">ProSHADE_internal_mapManip::beautifyBoundaries</a></div><div class="ttdeci">void beautifyBoundaries(proshade_signed *&amp;bounds, proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_signed boundsDiffThres, proshade_signed verbose)</div><div class="ttdoc">Function for modifying boundaries to a mathematically more pleasant values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01685">ProSHADE_mapManip.cpp:1685</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ab4da4e87f23a07702dcf32470ec740df"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">ProSHADE_internal_data::ProSHADE_data::yDimIndices</a></div><div class="ttdeci">proshade_unsign yDimIndices</div><div class="ttdoc">This is the size of the map cell y dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00066">ProSHADE_data.hpp:66</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a43f1c4682016759ea2e24c5903dbe444"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a43f1c4682016759ea2e24c5903dbe444">ProSHADE_internal_data::ProSHADE_data::xAxisOriginOriginal</a></div><div class="ttdeci">proshade_signed xAxisOriginOriginal</div><div class="ttdoc">This is the origin position along the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00091">ProSHADE_data.hpp:91</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a99fe02ef9da6b17ab51f1d82a32f02b9"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a99fe02ef9da6b17ab51f1d82a32f02b9">ProSHADE_internal_mapManip::findPDBCOMValues</a></div><div class="ttdeci">void findPDBCOMValues(gemmi::Structure pdbFile, proshade_double *xCom, proshade_double *yCom, proshade_double *zCom)</div><div class="ttdoc">This function finds the Centre of Mass for the co-ordinate file.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00127">ProSHADE_mapManip.cpp:127</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9b62761850d8560e6f8c52a2249fe7b7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b62761850d8560e6f8c52a2249fe7b7">ProSHADE_internal_data::ProSHADE_data::saveRecommendedSymmetry</a></div><div class="ttdeci">void saveRecommendedSymmetry(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSym, std::vector&lt; proshade_double * &gt; *DSym, std::vector&lt; proshade_double * &gt; *TSym, std::vector&lt; proshade_double * &gt; *OSym, std::vector&lt; proshade_double * &gt; *ISym, std::vector&lt; proshade_double * &gt; *axes)</div><div class="ttdoc">This function takes all the detected symmetry results and decides on which are to be recommended for ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01960">ProSHADE_data.cpp:1960</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5999f7181bd3509454966f8271ac39d6"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5999f7181bd3509454966f8271ac39d6">ProSHADE_internal_data::ProSHADE_data::getWignerMatrixValue</a></div><div class="ttdeci">void getWignerMatrixValue(proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double *valueReal, proshade_double *valueImag)</div><div class="ttdoc">This function allows access to the Wigner D matrix by knowing the band, order1 and order2 indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02582">ProSHADE_data.cpp:2582</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a898b48c1135e7a37f64f55e2367f0391"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a898b48c1135e7a37f64f55e2367f0391">ProSHADE_internal_data::ProSHADE_data::getShellBandwidth</a></div><div class="ttdeci">proshade_unsign getShellBandwidth(proshade_unsign shell)</div><div class="ttdoc">This function allows access to the bandwidth of a particular shell.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02491">ProSHADE_data.cpp:2491</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3d56e4edf14f91833ddfe8908887b506"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">ProSHADE_internal_data::ProSHADE_data::yGridIndices</a></div><div class="ttdeci">proshade_unsign yGridIndices</div><div class="ttdoc">As far as I know, this is identical to the yDimIndices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00069">ProSHADE_data.hpp:69</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a4f49a4f2263aa12ccb1737f8dc32c9ac"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a4f49a4f2263aa12ccb1737f8dc32c9ac">ProSHADE_settings::changeMapResolutionTriLinear</a></div><div class="ttdeci">bool changeMapResolutionTriLinear</div><div class="ttdoc">Should maps be re-sampled to obtain the required resolution?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00097">ProSHADE_settings.hpp:97</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a470ffeb3e78c036244c60bb4baa04aee"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a470ffeb3e78c036244c60bb4baa04aee">ProSHADE_internal_data::ProSHADE_data::getMapPython</a></div><div class="ttdeci">void getMapPython(double *mapArrayPython, int len)</div><div class="ttdoc">This function takes an array and fills it with the internal map density data. This is necessary for P...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02877">ProSHADE_data.cpp:2877</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a57a45df67d87117582f0810ca9f48695"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">ProSHADE_internal_data::ProSHADE_data::zAxisOrigin</a></div><div class="ttdeci">proshade_signed zAxisOrigin</div><div class="ttdoc">This is the origin position along the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00076">ProSHADE_data.hpp:76</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a4dd26d899d4e4291fefcfe0c9ffddc1b"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a4dd26d899d4e4291fefcfe0c9ffddc1b">ProSHADE_internal_mapManip::rotatePDBCoordinates</a></div><div class="ttdeci">void rotatePDBCoordinates(gemmi::Structure *pdbFile, proshade_double euA, proshade_double euB, proshade_double euG, proshade_double xCom, proshade_double yCom, proshade_double zCom)</div><div class="ttdoc">Function for rotating the PDB file co-ordinates by Euler angles.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00195">ProSHADE_mapManip.cpp:195</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a30edd2928e423198704adb955989960b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30edd2928e423198704adb955989960b">ProSHADE_internal_data::ProSHADE_data::setPDBMapValues</a></div><div class="ttdeci">void setPDBMapValues(void)</div><div class="ttdoc">Function for determining iterator start and stop positions.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00586">ProSHADE_data.cpp:586</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8bc5fbad1079d42bfa73913a9e2df619"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8bc5fbad1079d42bfa73913a9e2df619">ProSHADE_internal_data::ProSHADE_data::getRealRotFunction</a></div><div class="ttdeci">void getRealRotFunction(double *rotFunReal, int len)</div><div class="ttdoc">This function fills the input array with the real rotation function values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03116">ProSHADE_data.cpp:3116</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1ef18126c2c24edc9b6be06e0591127f"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ef18126c2c24edc9b6be06e0591127f">ProSHADE_internal_data::ProSHADE_data::yDimIndicesOriginal</a></div><div class="ttdeci">proshade_unsign yDimIndicesOriginal</div><div class="ttdoc">This is the size of the map cell y dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00089">ProSHADE_data.hpp:89</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3bc44913222e67ab861dd1e5838c1ae1"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">ProSHADE_internal_data::ProSHADE_data::getXDim</a></div><div class="ttdeci">proshade_unsign getXDim(void)</div><div class="ttdoc">This function allows access to the map size in indices along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02627">ProSHADE_data.cpp:2627</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a4e23fd6cc4e931df9ec8b10c81ef38fb"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4e23fd6cc4e931df9ec8b10c81ef38fb">ProSHADE_internal_data::ProSHADE_data::comMovZ</a></div><div class="ttdeci">proshade_double comMovZ</div><div class="ttdoc">How much the map was moved along the X-axis to achieve COM centering.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00079">ProSHADE_data.hpp:79</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__data_8hpp_html"><div class="ttname"><a href="_pro_s_h_a_d_e__data_8hpp.html">ProSHADE_data.hpp</a></div><div class="ttdoc">This is the header file containing internal data representation and manipulation structures and funct...</div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a930e25e9377cf418f6eab71fa2837255"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">ProSHADE_internal_data::ProSHADE_data::zTo</a></div><div class="ttdeci">proshade_signed zTo</div><div class="ttdoc">This is the final index along the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00107">ProSHADE_data.hpp:107</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac40e8210bd69b598a67c6a3e0a9ecf16"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">ProSHADE_internal_data::ProSHADE_data::xTo</a></div><div class="ttdeci">proshade_signed xTo</div><div class="ttdoc">This is the final index along the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00105">ProSHADE_data.hpp:105</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aac87b1a87f32a742ea2b41014dac5f7b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aac87b1a87f32a742ea2b41014dac5f7b">ProSHADE_internal_data::ProSHADE_data::writeMask</a></div><div class="ttdeci">void writeMask(std::string fName, proshade_double *mask)</div><div class="ttdoc">Function for writing out a mask in MRC MAP format.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00790">ProSHADE_data.cpp:790</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5e165ed8ecee7e07762aec7ac5890848"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5e165ed8ecee7e07762aec7ac5890848">ProSHADE_internal_data::ProSHADE_data::ProSHADE_data</a></div><div class="ttdeci">ProSHADE_data(ProSHADE_settings *settings)</div><div class="ttdoc">Constructor for getting empty ProSHADE_data class.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00039">ProSHADE_data.cpp:39</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5d266289b137b48132f1456fd8fc43ea"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d266289b137b48132f1456fd8fc43ea">ProSHADE_internal_data::ProSHADE_data::integrationWeight</a></div><div class="ttdeci">proshade_double integrationWeight</div><div class="ttdoc">The Pearson's c.c. type weighting for the integration.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00120">ProSHADE_data.hpp:120</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a599a8fa1d6d780a45a2d772413bc778e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a599a8fa1d6d780a45a2d772413bc778e">ProSHADE_internal_data::ProSHADE_data::saveRequestedSymmetryC</a></div><div class="ttdeci">void saveRequestedSymmetryC(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSym, std::vector&lt; proshade_double * &gt; *axes)</div><div class="ttdoc">This function takes the C symmetries and searched for the requested symmetry.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02049">ProSHADE_data.cpp:2049</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_afe43c82995777c05000cf92091c10b9c"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#afe43c82995777c05000cf92091c10b9c">ProSHADE_internal_mapManip::generateMapFromPDB</a></div><div class="ttdeci">void generateMapFromPDB(gemmi::Structure pdbFile, proshade_double *&amp;map, proshade_single requestedResolution, proshade_single xCell, proshade_single yCell, proshade_single zCell, proshade_signed *xTo, proshade_signed *yTo, proshade_signed *zTo)</div><div class="ttdoc">This function generates a theoretical map from co-ordinate input files.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00441">ProSHADE_mapManip.cpp:441</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a56bfcfacedabd84ec54aa2843d59e014"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a56bfcfacedabd84ec54aa2843d59e014">ProSHADE_internal_data::ProSHADE_data::mapToSpheres</a></div><div class="ttdeci">void mapToSpheres(ProSHADE_settings *settings)</div><div class="ttdoc">This function simply clusters several other functions which should be called together.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01570">ProSHADE_data.cpp:1570</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2860d3acb4d9e5ec6fca0b58ae33845f"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">ProSHADE_internal_data::ProSHADE_data::xAxisOrigin</a></div><div class="ttdeci">proshade_signed xAxisOrigin</div><div class="ttdoc">This is the origin position along the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00074">ProSHADE_data.hpp:74</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_af8b72cbc56a4f72d0557e01a8101d435"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">ProSHADE_internal_data::ProSHADE_data::rrpMatrices</a></div><div class="ttdeci">proshade_double *** rrpMatrices</div><div class="ttdoc">The energy levels descriptor shell correlation tables.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00118">ProSHADE_data.hpp:118</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a47b4953dae84a5ab54dadd33d7805887"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">ProSHADE_internal_data::ProSHADE_data::yTo</a></div><div class="ttdeci">proshade_signed yTo</div><div class="ttdoc">This is the final index along the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00106">ProSHADE_data.hpp:106</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aff65990df92e49b7636134feb56be8f9"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">ProSHADE_internal_data::ProSHADE_data::xDimSize</a></div><div class="ttdeci">proshade_single xDimSize</div><div class="ttdoc">This is the size of the map cell x dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00059">ProSHADE_data.hpp:59</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_af2bbc07d56beb9ba0b45c2ac1a8a0a0b"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#af2bbc07d56beb9ba0b45c2ac1a8a0a0b">ProSHADE_internal_mapManip::movePDBForMapCalc</a></div><div class="ttdeci">void movePDBForMapCalc(gemmi::Structure *pdbFile, proshade_single xMov, proshade_single yMov, proshade_single zMov)</div><div class="ttdoc">Function for moving co-ordinate atoms to better suit theoretical map computation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00382">ProSHADE_mapManip.cpp:382</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_ab0d38ce581c60d246fcf62ed05235e7f"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#ab0d38ce581c60d246fcf62ed05235e7f">ProSHADE_internal_misc::sortDSymHlpInv</a></div><div class="ttdeci">bool sortDSymHlpInv(const proshade_double *a, const proshade_double *b)</div><div class="ttdoc">This function compares two arrays of the ProSHADE dihedral symmetry list based on combination of axes...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00234">ProSHADE_misc.cpp:234</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3e2a50d383cdba4b6f6f3d1293c4174b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">ProSHADE_internal_data::ProSHADE_data::yAxisOrigin</a></div><div class="ttdeci">proshade_signed yAxisOrigin</div><div class="ttdoc">This is the origin position along the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00075">ProSHADE_data.hpp:75</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_aff0d8344fdd83482e5531eadedaac550"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a></div><div class="ttdeci">void deepCopyAxisToDblPtrVector(std::vector&lt; proshade_double * &gt; *dblPtrVec, proshade_double *axis)</div><div class="ttdoc">Does a deep copy of a double array to a vector of double arrays.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00252">ProSHADE_misc.cpp:252</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aec21925052446f1c154eb7285acf7bb4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aec21925052446f1c154eb7285acf7bb4">ProSHADE_internal_data::ProSHADE_data::findMapCOM</a></div><div class="ttdeci">void findMapCOM()</div><div class="ttdoc">This function finds the centre of mass of the internal map representation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02249">ProSHADE_data.cpp:2249</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9302095b8642b8d5088cf8f1793d1990"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">ProSHADE_internal_data::ProSHADE_data::yAxisOrder</a></div><div class="ttdeci">proshade_unsign yAxisOrder</div><div class="ttdoc">This is the order of the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00072">ProSHADE_data.hpp:72</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5c0df68cd21b4f56abd1008065ca3573"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5c0df68cd21b4f56abd1008065ca3573">ProSHADE_internal_data::ProSHADE_data::getRealSphHarmValue</a></div><div class="ttdeci">proshade_double * getRealSphHarmValue(proshade_unsign band, proshade_unsign order, proshade_unsign shell)</div><div class="ttdoc">This function allows access to the private internal real spherical harmonics values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02442">ProSHADE_data.cpp:2442</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3c589f8f2165cb1ad080b306dc0cbc25"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3c589f8f2165cb1ad080b306dc0cbc25">ProSHADE_internal_data::ProSHADE_data::detectSymmetryInStructurePython</a></div><div class="ttdeci">void detectSymmetryInStructurePython(ProSHADE_settings *settings)</div><div class="ttdoc">This function runs the symmetry detection algorithms on this structure saving the axes in the setting...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01740">ProSHADE_data.cpp:1740</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8aa6fbd67df9911e886f9001a0ef8bc2"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">ProSHADE_internal_data::ProSHADE_data::internalMap</a></div><div class="ttdeci">proshade_double * internalMap</div><div class="ttdoc">The internal map data representation, which may be amended as the run progresses.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00056">ProSHADE_data.hpp:56</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1ea6522b99cf1ac72199c9eeccd30742"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ea6522b99cf1ac72199c9eeccd30742">ProSHADE_internal_data::ProSHADE_data::zDimIndicesOriginal</a></div><div class="ttdeci">proshade_unsign zDimIndicesOriginal</div><div class="ttdoc">This is the size of the map cell z dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00090">ProSHADE_data.hpp:90</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afef6a064a54eb016776cb0879efb0b31"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">ProSHADE_internal_data::ProSHADE_data::xFrom</a></div><div class="ttdeci">proshade_signed xFrom</div><div class="ttdoc">This is the starting index along the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00102">ProSHADE_data.hpp:102</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a81e6aab30488052e6bdd9b339e8124d8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a81e6aab30488052e6bdd9b339e8124d8">ProSHADE_internal_data::ProSHADE_data::writeMap</a></div><div class="ttdeci">void writeMap(std::string fName, std::string title=&quot;Created by ProSHADE and written by GEMMI&quot;, int mode=2)</div><div class="ttdoc">Function for writing out the internal structure representation in MRC MAP format.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00649">ProSHADE_data.cpp:649</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ada8e6f27f49afc3a0ee17758ce9e7594"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ada8e6f27f49afc3a0ee17758ce9e7594">ProSHADE_internal_data::ProSHADE_data::shellBandExists</a></div><div class="ttdeci">bool shellBandExists(proshade_unsign shell, proshade_unsign bandVal)</div><div class="ttdoc">This function checks if particular shell has a particular band.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02344">ProSHADE_data.cpp:2344</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a152b43815a3d3debd4b60751d9c8afdd"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">ProSHADE_internal_data::ProSHADE_data::getMaxBand</a></div><div class="ttdeci">proshade_unsign getMaxBand(void)</div><div class="ttdoc">This function returns the maximum band value for the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02318">ProSHADE_data.cpp:2318</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a23cb48151973777947efe593cb663ddc"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23cb48151973777947efe593cb663ddc">ProSHADE_internal_data::ProSHADE_data::getSphericalHarmonicsLenForShell</a></div><div class="ttdeci">int getSphericalHarmonicsLenForShell(proshade_unsign shellNo, proshade_signed verbose)</div><div class="ttdoc">This function gets the spherical harmonics array length for a particular shell.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02994">ProSHADE_data.cpp:2994</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a0d796061e73e8635f75fc6921b98ad66"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a0d796061e73e8635f75fc6921b98ad66">ProSHADE_settings::normaliseMap</a></div><div class="ttdeci">bool normaliseMap</div><div class="ttdoc">Should the map be normalised to mean 0 sd 1?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00117">ProSHADE_settings.hpp:117</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_afb42ec0cd0f8abb54327c0e2c3025ed1"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">ProSHADE_settings::addExtraSpace</a></div><div class="ttdeci">proshade_single addExtraSpace</div><div class="ttdoc">If this value is non-zero, this many angstroms of empty space will be added to the internal map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00143">ProSHADE_settings.hpp:143</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a26c8be8b50be424bb35d3f6f39aa9aff"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a26c8be8b50be424bb35d3f6f39aa9aff">ProSHADE_internal_mapManip::getNonZeroBounds</a></div><div class="ttdeci">void getNonZeroBounds(proshade_double *map, proshade_signed xDim, proshade_signed yDim, proshade_signed zDim, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed *&amp;ret)</div><div class="ttdoc">Function for finding the map boundaries enclosing positive only values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00857">ProSHADE_mapManip.cpp:857</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a50c884973add562558803a45991bbf19"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">ProSHADE_internal_data::ProSHADE_data::getYDim</a></div><div class="ttdeci">proshade_unsign getYDim(void)</div><div class="ttdoc">This function allows access to the map size in indices along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02637">ProSHADE_data.cpp:2637</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a99ed9b0a765739d89104eca2c1875dd4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ed9b0a765739d89104eca2c1875dd4">ProSHADE_internal_data::ProSHADE_data::maxCompBand</a></div><div class="ttdeci">proshade_unsign maxCompBand</div><div class="ttdoc">The largest comparison band - this variable tells how large arrays will be allocated for the comparis...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00124">ProSHADE_data.hpp:124</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9b08a8b6f9569c06cd183c924e6e80de"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b08a8b6f9569c06cd183c924e6e80de">ProSHADE_internal_data::ProSHADE_data::getImagEMatrixValuesForLM</a></div><div class="ttdeci">void getImagEMatrixValuesForLM(proshade_signed band, proshade_signed order1, double *eMatsLMImag, int len)</div><div class="ttdoc">This function fills the input array with the imaginary E matrix values for particular band and order1...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03047">ProSHADE_data.cpp:3047</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a0122be830893f5d82bab742be54d1ee7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0122be830893f5d82bab742be54d1ee7">ProSHADE_internal_data::ProSHADE_data::maskMap</a></div><div class="ttdeci">void maskMap(ProSHADE_settings *settings)</div><div class="ttdoc">Function for computing the map mask using blurring and X IQRs from median.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00928">ProSHADE_data.cpp:928</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a485495727d37abd66295bab95d368438"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a485495727d37abd66295bab95d368438">ProSHADE_internal_data::ProSHADE_data::~ProSHADE_data</a></div><div class="ttdeci">~ProSHADE_data(void)</div><div class="ttdoc">Destructor for the ProSHADE_data class.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00276">ProSHADE_data.cpp:276</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a></div><div class="ttdoc">This class stores all the settings and is passed to the executive classes instead of a multitude of p...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00085">ProSHADE_settings.hpp:86</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a59fbe922fd7fd7aa5c72ca459e4242d0"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">ProSHADE_internal_data::ProSHADE_data::xCom</a></div><div class="ttdeci">proshade_double xCom</div><div class="ttdoc">The COM of the map after processing along the X-axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00080">ProSHADE_data.hpp:80</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a2c857c8f26f99695e7de52025f590205"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a2c857c8f26f99695e7de52025f590205">ProSHADE_internal_mapManip::copyMapByBounds</a></div><div class="ttdeci">void copyMapByBounds(proshade_signed xFrom, proshade_signed xTo, proshade_signed yFrom, proshade_signed yTo, proshade_signed zFrom, proshade_signed zTo, proshade_signed origXFrom, proshade_signed origYFrom, proshade_signed origZFrom, proshade_signed yDimIndices, proshade_signed zDimIndices, proshade_signed origXDimIndices, proshade_signed origYDimIndices, proshade_signed origZDimIndices, proshade_double *&amp;newMap, proshade_double *origMap)</div><div class="ttdoc">This function copies an old map to a new map with different boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01851">ProSHADE_mapManip.cpp:1851</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a94cce09895dc9f41d4b9a429ccf638e8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94cce09895dc9f41d4b9a429ccf638e8">ProSHADE_internal_data::ProSHADE_data::getRealTranslationFunction</a></div><div class="ttdeci">void getRealTranslationFunction(double *trsFunReal, int len)</div><div class="ttdoc">This function fills the input array with the real translation function values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03152">ProSHADE_data.cpp:3152</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aae8444b6c9ca3207d32bbf2a68c7b610"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae8444b6c9ca3207d32bbf2a68c7b610">ProSHADE_internal_data::ProSHADE_data::getImagSphHarmValue</a></div><div class="ttdeci">proshade_double * getImagSphHarmValue(proshade_unsign band, proshade_unsign order, proshade_unsign shell)</div><div class="ttdoc">This function allows access to the private internal imaginary spherical harmonics values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02455">ProSHADE_data.cpp:2455</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac9989eaf9779a857f9c9e709bc0f3cf7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac9989eaf9779a857f9c9e709bc0f3cf7">ProSHADE_internal_data::ProSHADE_data::findBestDScore</a></div><div class="ttdeci">proshade_double findBestDScore(std::vector&lt; proshade_double * &gt; *DSym, proshade_unsign *symInd)</div><div class="ttdoc">This function locates the best scoring D symmetry axis, returning the score and best symmetry index.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01808">ProSHADE_data.cpp:1808</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9b063d1ca2ebed239029bad6250cf376"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b063d1ca2ebed239029bad6250cf376">ProSHADE_internal_data::ProSHADE_data::getImagRotFunction</a></div><div class="ttdeci">void getImagRotFunction(double *rotFunImag, int len)</div><div class="ttdoc">This function fills the input array with the imaginary rotation function values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03134">ProSHADE_data.cpp:3134</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afcb4202e9ffea1b99c59f73faf06d899"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afcb4202e9ffea1b99c59f73faf06d899">ProSHADE_internal_data::ProSHADE_data::processInternalMap</a></div><div class="ttdeci">void processInternalMap(ProSHADE_settings *settings)</div><div class="ttdoc">This function simply clusters several other functions which should be called together.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01472">ProSHADE_data.cpp:1472</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_ad93f9644c5b132193b4ddd282f50abce"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#ad93f9644c5b132193b4ddd282f50abce">ProSHADE_internal_io::readInMapData</a></div><div class="ttdeci">void readInMapData(gemmi::Ccp4&lt; float &gt; *gemmiMap, proshade_double *&amp;map, proshade_unsign xDimInds, proshade_unsign yDimInds, proshade_unsign zDimInds, proshade_unsign xAxOrder, proshade_unsign yAxOrder, proshade_unsign zAxOrder)</div><div class="ttdoc">This function converts the gemmi Ccp4 object data to ProSHADE internal map representation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00171">ProSHADE_io.cpp:171</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae27a3e92905ca9d5f9a32c4eaacc64ae"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae27a3e92905ca9d5f9a32c4eaacc64ae">ProSHADE_internal_data::ProSHADE_data::getTranslationFnPointer</a></div><div class="ttdeci">proshade_complex * getTranslationFnPointer(void)</div><div class="ttdoc">This function allows access to the translation function through a pointer.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02757">ProSHADE_data.cpp:2757</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a974bbe07f5435f052df4592825ed7aba"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">ProSHADE_settings::setRecommendedSymmetry</a></div><div class="ttdeci">void setRecommendedSymmetry(std::string val)</div><div class="ttdoc">Sets the ProSHADE detected symmetry type.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l00970">ProSHADE.cpp:970</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a668c168ea0037312025b860b9b5be415"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">ProSHADE_internal_data::ProSHADE_data::zCom</a></div><div class="ttdeci">proshade_double zCom</div><div class="ttdoc">The COM of the map after processing along the Z-axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00082">ProSHADE_data.hpp:82</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a31b57e51f48e58828883b04b612dcf55"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">ProSHADE_internal_data::ProSHADE_data::spherePos</a></div><div class="ttdeci">std::vector&lt; proshade_single &gt; spherePos</div><div class="ttdoc">Vector of sphere radii from the centre of the map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00110">ProSHADE_data.hpp:110</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a0d205c102e722997ab1f0953f76a288a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a0d205c102e722997ab1f0953f76a288a">ProSHADE_settings::invertMap</a></div><div class="ttdeci">bool invertMap</div><div class="ttdoc">Should the map be inverted? Only use this if you think you have the wrong hand in your map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00120">ProSHADE_settings.hpp:120</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a034af93b9152fb2db675d5632a4ebc6d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">ProSHADE_internal_data::ProSHADE_data::getZDim</a></div><div class="ttdeci">proshade_unsign getZDim(void)</div><div class="ttdoc">This function allows access to the map size in indices along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02647">ProSHADE_data.cpp:2647</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aedc04d6abaeebd3a2e8b26fb956d1996"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedc04d6abaeebd3a2e8b26fb956d1996">ProSHADE_internal_data::ProSHADE_data::findOScore</a></div><div class="ttdeci">proshade_double findOScore(std::vector&lt; proshade_double * &gt; *OSym)</div><div class="ttdoc">This function takes the list of octahedral axes and returns a score for deciding whether O symmetry s...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01888">ProSHADE_data.cpp:1888</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a167f7a9dbd061752d2a099181090a3b8"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a167f7a9dbd061752d2a099181090a3b8">ProSHADE_internal_mapManip::removeMapPhase</a></div><div class="ttdeci">void removeMapPhase(fftw_complex *&amp;mapCoeffs, proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim)</div><div class="ttdoc">This function removes the phase from reciprocal (frequency) map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01399">ProSHADE_mapManip.cpp:1399</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a827e3241fa6401027e0526fffb8b281d"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a827e3241fa6401027e0526fffb8b281d">ProSHADE_settings::boundsSimilarityThreshold</a></div><div class="ttdeci">proshade_signed boundsSimilarityThreshold</div><div class="ttdoc">Number of indices which can be added just to make sure same size in indices is achieved.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00135">ProSHADE_settings.hpp:135</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a053e8acecc88aad289d6a06a678d9ac4"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a053e8acecc88aad289d6a06a678d9ac4">ProSHADE_internal_mapManip::determinePDBRanges</a></div><div class="ttdeci">void determinePDBRanges(gemmi::Structure pdbFile, proshade_single *xFrom, proshade_single *xTo, proshade_single *yFrom, proshade_single *yTo, proshade_single *zFrom, proshade_single *zTo)</div><div class="ttdoc">Function for finding the PDB file ranges.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00053">ProSHADE_mapManip.cpp:53</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a06231fd4288194cc7c6ed0270f0b2920"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a06231fd4288194cc7c6ed0270f0b2920">ProSHADE_internal_data::ProSHADE_data::mapPostRotXCom</a></div><div class="ttdeci">proshade_double mapPostRotXCom</div><div class="ttdoc">The COM of the rotated map before it is processed in any other way. Along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00097">ProSHADE_data.hpp:97</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ab61d2183930ea26b3d49e7662052e83b"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ab61d2183930ea26b3d49e7662052e83b">ProSHADE_settings::changeMapResolution</a></div><div class="ttdeci">bool changeMapResolution</div><div class="ttdoc">Should maps be re-sampled to obtain the required resolution?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00096">ProSHADE_settings.hpp:96</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afa35ae5ccd9d4b22bcc028f609cd1c3e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa35ae5ccd9d4b22bcc028f609cd1c3e">ProSHADE_internal_data::ProSHADE_data::getRRPValue</a></div><div class="ttdeci">proshade_double getRRPValue(proshade_unsign band, proshade_unsign sh1, proshade_unsign sh2)</div><div class="ttdoc">This function allows access to the priva internal RRP matrices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02328">ProSHADE_data.cpp:2328</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afe04510c67e9dc9c19efaef8463b6e6e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afe04510c67e9dc9c19efaef8463b6e6e">ProSHADE_internal_data::ProSHADE_data::getMapValue</a></div><div class="ttdeci">proshade_double getMapValue(proshade_unsign pos)</div><div class="ttdoc">This function returns the internal map representation value of a particular array position.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02308">ProSHADE_data.cpp:2308</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a4b76352faa0915b1fef943fe139de5a6"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4b76352faa0915b1fef943fe139de5a6">ProSHADE_internal_data::ProSHADE_data::getImagSO3Coeffs</a></div><div class="ttdeci">void getImagSO3Coeffs(double *so3CoefsImag, int len)</div><div class="ttdoc">This function fills the input array with the imaginary SO(3) coefficient values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03083">ProSHADE_data.cpp:3083</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a503ffea1b18c7bdf8e784d7fa5bb1d78"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a503ffea1b18c7bdf8e784d7fa5bb1d78">ProSHADE_internal_data::ProSHADE_data::getReBoxBoundariesPy</a></div><div class="ttdeci">void getReBoxBoundariesPy(ProSHADE_settings *settings, int *reBoxBounds, int len)</div><div class="ttdoc">This function finds the boundaries enclosing positive map values and adds some extra space,...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01024">ProSHADE_data.cpp:1024</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac859cbd21b93b9d2ed5f119f4ee57f3f"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac859cbd21b93b9d2ed5f119f4ee57f3f">ProSHADE_internal_data::ProSHADE_data::getYToPtr</a></div><div class="ttdeci">proshade_signed * getYToPtr(void)</div><div class="ttdoc">This function allows access to the map last position along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02697">ProSHADE_data.cpp:2697</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a37c9037721c1ad28ad6421a31dbcd8d8"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a37c9037721c1ad28ad6421a31dbcd8d8">ProSHADE_settings::moveToCOM</a></div><div class="ttdeci">bool moveToCOM</div><div class="ttdoc">Logical value stating whether the structure should be moved to have its Centre Of Mass (COM) in the m...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00140">ProSHADE_settings.hpp:140</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a07fb6e354dcd90dc70f8b4fa8bba0c33"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a07fb6e354dcd90dc70f8b4fa8bba0c33">ProSHADE_internal_data::ProSHADE_data::readInMAP</a></div><div class="ttdeci">void readInMAP(ProSHADE_settings *settings)</div><div class="ttdoc">Function for reading map data using gemmi library.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00473">ProSHADE_data.cpp:473</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a618fc0fc9ca71ec70500c99c7e6231f4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">ProSHADE_internal_data::ProSHADE_data::wignerMatrices</a></div><div class="ttdeci">proshade_complex *** wignerMatrices</div><div class="ttdoc">These matrices are computed for a particular rotation to be done in spherical harmonics.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00123">ProSHADE_data.hpp:123</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a4052e498b4650f62bfe5ff37ed959292"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4052e498b4650f62bfe5ff37ed959292">ProSHADE_internal_data::ProSHADE_data::fileType</a></div><div class="ttdeci">ProSHADE_internal_io::InputType fileType</div><div class="ttdoc">This is the type of the input file.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00053">ProSHADE_data.hpp:53</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aeb0242051835b508e9af193dc40a697c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aeb0242051835b508e9af193dc40a697c">ProSHADE_internal_data::ProSHADE_data::getZAxisOrigin</a></div><div class="ttdeci">proshade_signed * getZAxisOrigin(void)</div><div class="ttdoc">This function allows access to the map Z axis origin value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02737">ProSHADE_data.cpp:2737</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a2e438f3d348e3e065f798031d5a33d09"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a2e438f3d348e3e065f798031d5a33d09">ProSHADE_internal_io::writeOutMapHeader</a></div><div class="ttdeci">void writeOutMapHeader(gemmi::Ccp4&lt; float &gt; *map, proshade_unsign xDimInds, proshade_unsign yDimInds, proshade_unsign zDimInds, proshade_single xDim, proshade_single yDim, proshade_single zDim, proshade_single aAng, proshade_single bAng, proshade_single cAng, proshade_signed xFrom, proshade_signed yFrom, proshade_signed zFrom, proshade_signed xAxOrigin, proshade_signed yAxOrigin, proshade_signed zAxOrigin, proshade_unsign xAxOrder, proshade_unsign yAxOrder, proshade_unsign zAxOrder, proshade_unsign xGridInds, proshade_unsign yGridInds, proshade_unsign zGridInds, std::string title, int mode)</div><div class="ttdoc">This function parses the CCP4 MAP file header as read in by gemmi.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00241">ProSHADE_io.cpp:241</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a202119c89869d7731298723b9bb5ba4a"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a202119c89869d7731298723b9bb5ba4a">ProSHADE_internal_data::ProSHADE_data::mapPostRotYCom</a></div><div class="ttdeci">proshade_double mapPostRotYCom</div><div class="ttdoc">The COM of the rotated map before it is processed in any other way. Along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00098">ProSHADE_data.hpp:98</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a50df80b02427f9f55a2c7af033a9fb93"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a></div><div class="ttdeci">proshade_signed myRound(proshade_double x)</div><div class="ttdoc">Calls the appropriate version of round function depending on compiler version.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00031">ProSHADE_mapManip.cpp:31</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a7855424ca5d51853c7fc665ecb9b935b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7855424ca5d51853c7fc665ecb9b935b">ProSHADE_internal_data::ProSHADE_data::yDimSizeOriginal</a></div><div class="ttdeci">proshade_single yDimSizeOriginal</div><div class="ttdoc">This is the size of the map cell y dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00086">ProSHADE_data.hpp:86</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a550c839b5ce7b53ccee5e6da1cf001af"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">ProSHADE_internal_data::ProSHADE_data::zAxisOrder</a></div><div class="ttdeci">proshade_unsign zAxisOrder</div><div class="ttdoc">This is the order of the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00073">ProSHADE_data.hpp:73</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ab573ea90a16991a06a77c5343328b060"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab573ea90a16991a06a77c5343328b060">ProSHADE_internal_data::ProSHADE_data::reSampleMap</a></div><div class="ttdeci">void reSampleMap(ProSHADE_settings *settings)</div><div class="ttdoc">This function changes the internal map sampling to conform to particular resolution value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01231">ProSHADE_data.cpp:1231</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a88bff2522448a45b6dbfbe71f414601a"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a88bff2522448a45b6dbfbe71f414601a">ProSHADE_internal_data::ProSHADE_data::writePdb</a></div><div class="ttdeci">void writePdb(std::string fName, proshade_double euA=0.0, proshade_double euB=0.0, proshade_double euG=0.0, proshade_double transX=0.0, proshade_double transY=0.0, proshade_double transZ=0.0)</div><div class="ttdoc">This function writes out the PDB formatted file coresponding to the structure.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00712">ProSHADE_data.cpp:712</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a68aa68499f39a2f8aa2638fe6d51b36d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a68aa68499f39a2f8aa2638fe6d51b36d">ProSHADE_internal_data::ProSHADE_data::comMovX</a></div><div class="ttdeci">proshade_double comMovX</div><div class="ttdoc">How much the map was moved along the X-axis to achieve COM centering.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00077">ProSHADE_data.hpp:77</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_af556836aa9286c1571196de442a6b493"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a></div><div class="ttdeci">void checkMemoryAllocation(chVar checkVar, std::string fileP, unsigned int lineP, std::string funcP, std::string infoP=&quot;This error may occurs when ProSHADE requests memory to be\n                    : allocated to it and this operation fails. This could\n                    : happen when not enough memory is available, either due to\n                    : other processes using a lot of memory, or when the machine\n                    : does not have sufficient memory available. Re-run to see\n                    : if this problem persists.&quot;)</div><div class="ttdoc">Checks if memory was allocated properly.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8hpp_source.html#l00063">ProSHADE_misc.hpp:63</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_adf61c328db45fcd7692d13a8cde5e092"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#adf61c328db45fcd7692d13a8cde5e092">ProSHADE_internal_data::ProSHADE_data::getXToPtr</a></div><div class="ttdeci">proshade_signed * getXToPtr(void)</div><div class="ttdoc">This function allows access to the map last position along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02687">ProSHADE_data.cpp:2687</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5f0d929d1e013cdd23e956d94b7a40da"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f0d929d1e013cdd23e956d94b7a40da">ProSHADE_internal_data::ProSHADE_data::getYFromPtr</a></div><div class="ttdeci">proshade_signed * getYFromPtr(void)</div><div class="ttdoc">This function allows access to the map start along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02667">ProSHADE_data.cpp:2667</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9dbcec9f32eb76625d7aa59d8c2701d9"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9dbcec9f32eb76625d7aa59d8c2701d9">ProSHADE_internal_data::ProSHADE_data::bAngle</a></div><div class="ttdeci">proshade_single bAngle</div><div class="ttdoc">This is the angle b of the map cell in degrees.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00063">ProSHADE_data.hpp:63</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_acf6c5376edac98e54ef0e418cd05d706"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#acf6c5376edac98e54ef0e418cd05d706">ProSHADE_internal_maths::getEulerZXZFromSOFTPosition</a></div><div class="ttdeci">void getEulerZXZFromSOFTPosition(proshade_signed band, proshade_signed x, proshade_signed y, proshade_signed z, proshade_double *eulerAlpha, proshade_double *eulerBeta, proshade_double *eulerGamma)</div><div class="ttdoc">Function to find Euler angles (ZXZ convention) from index position in the inverse SOFT map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00958">ProSHADE_maths.cpp:958</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a53cffdab0d66cb88884ec4f46c19a5ff"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a53cffdab0d66cb88884ec4f46c19a5ff">ProSHADE_internal_data::ProSHADE_data::yAxisOriginOriginal</a></div><div class="ttdeci">proshade_signed yAxisOriginOriginal</div><div class="ttdoc">This is the origin position along the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00092">ProSHADE_data.hpp:92</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa75beee618649d6fd9dc850a5a66a551"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">ProSHADE_internal_data::ProSHADE_data::aAngle</a></div><div class="ttdeci">proshade_single aAngle</div><div class="ttdoc">This is the angle a of the map cell in degrees.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00062">ProSHADE_data.hpp:62</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_abea2d62360b17cddca155816d3e485e8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abea2d62360b17cddca155816d3e485e8">ProSHADE_internal_data::ProSHADE_data::reportSymmetryResults</a></div><div class="ttdeci">void reportSymmetryResults(ProSHADE_settings *settings)</div><div class="ttdoc">This function takes prints the report for symmetry detection.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02179">ProSHADE_data.cpp:2179</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa794c34ad9811fc68861bdeb132eaa1a"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa794c34ad9811fc68861bdeb132eaa1a">ProSHADE_internal_data::ProSHADE_data::findTScore</a></div><div class="ttdeci">proshade_double findTScore(std::vector&lt; proshade_double * &gt; *TSym)</div><div class="ttdoc">This function takes the list of tetrahedral axes and returns a score for deciding whether T symmetry ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01855">ProSHADE_data.cpp:1855</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a476092aa08dff20d64a895e7b2227b2e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a476092aa08dff20d64a895e7b2227b2e">ProSHADE_internal_data::ProSHADE_data::figureIndexStartStop</a></div><div class="ttdeci">void figureIndexStartStop(void)</div><div class="ttdoc">Function for determining iterator start and stop positions.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00627">ProSHADE_data.cpp:627</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac57d606fdb59d54bd3f9249941402b12"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac57d606fdb59d54bd3f9249941402b12">ProSHADE_internal_data::ProSHADE_data::isEmpty</a></div><div class="ttdeci">bool isEmpty</div><div class="ttdoc">This variable stated whether the class contains any information.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00128">ProSHADE_data.hpp:128</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2eb10989a2f8d46b849cdaf8410b68be"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">ProSHADE_internal_data::ProSHADE_data::getInvSO3Coeffs</a></div><div class="ttdeci">proshade_complex * getInvSO3Coeffs(void)</div><div class="ttdoc">This function allows access to the inverse SO(3) coefficients array.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02545">ProSHADE_data.cpp:2545</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_aa3e24ef5a66fa7204a2ba9c27f2f12b9"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#aa3e24ef5a66fa7204a2ba9c27f2f12b9">ProSHADE_settings::forceBounds</a></div><div class="ttdeci">proshade_signed * forceBounds</div><div class="ttdoc">These will be the boundaries to be forced upon the map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00137">ProSHADE_settings.hpp:137</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a42b012ec753ebd1d87a0b6f557e97d1a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">ProSHADE_settings::detectedSymmetry</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; detectedSymmetry</div><div class="ttdoc">The vector of detected symmetry axes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00173">ProSHADE_settings.hpp:173</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5d47aafdd2ec9912225c3c44e2bbc4d8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">ProSHADE_internal_data::ProSHADE_data::yFrom</a></div><div class="ttdeci">proshade_signed yFrom</div><div class="ttdoc">This is the starting index along the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00103">ProSHADE_data.hpp:103</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ac8e62cc8dbd40265e51143c8207b6638"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ac8e62cc8dbd40265e51143c8207b6638">ProSHADE_settings::recommendedSymmetryFold</a></div><div class="ttdeci">proshade_unsign recommendedSymmetryFold</div><div class="ttdoc">The fold of the recommended symmetry C or D type, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00170">ProSHADE_settings.hpp:170</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_ac311071faa65db4dfc1886d2a6de78ef"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ac311071faa65db4dfc1886d2a6de78ef">ProSHADE_internal_mapManip::reSampleMapToResolutionFourier</a></div><div class="ttdeci">void reSampleMapToResolutionFourier(proshade_double *&amp;map, proshade_single resolution, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_single *&amp;corrs)</div><div class="ttdoc">This function re-samples a map to conform to given resolution using Fourier.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01151">ProSHADE_mapManip.cpp:1151</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a298bc9a6aae624a091cd97b842a6b618"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a298bc9a6aae624a091cd97b842a6b618">ProSHADE_internal_data::ProSHADE_data::getYAxisOrigin</a></div><div class="ttdeci">proshade_signed * getYAxisOrigin(void)</div><div class="ttdoc">This function allows access to the map Y axis origin value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02727">ProSHADE_data.cpp:2727</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a2d19df22d740c51de6edafbf679ae3fd"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a2d19df22d740c51de6edafbf679ae3fd">ProSHADE_internal_misc::addToSingleVector</a></div><div class="ttdeci">void addToSingleVector(std::vector&lt; proshade_single &gt; *vecToAddTo, proshade_single elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00055">ProSHADE_misc.cpp:55</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a1f0d2cb45fee521ddb2d0bc30beff3ec"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a1f0d2cb45fee521ddb2d0bc30beff3ec">ProSHADE_settings::useSameBounds</a></div><div class="ttdeci">bool useSameBounds</div><div class="ttdoc">Switch to say that the same boundaries as used for the first should be used for all input maps.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00136">ProSHADE_settings.hpp:136</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad1f180d58f829e2c0fc50569b2425d56"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">ProSHADE_internal_data::ProSHADE_data::zDimIndices</a></div><div class="ttdeci">proshade_unsign zDimIndices</div><div class="ttdoc">This is the size of the map cell z dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00067">ProSHADE_data.hpp:67</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a3cac1bd635aabf3a3370fc26dfa0f49a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a3cac1bd635aabf3a3370fc26dfa0f49a">ProSHADE_settings::pdbBFactorNewVal</a></div><div class="ttdeci">proshade_double pdbBFactorNewVal</div><div class="ttdoc">Change all PDB B-factors to this value (for smooth maps).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00100">ProSHADE_settings.hpp:100</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad5add825ce8d5e5d9f598f6912f07aff"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5add825ce8d5e5d9f598f6912f07aff">ProSHADE_internal_data::ProSHADE_data::getRecommendedSymmetryType</a></div><div class="ttdeci">std::string getRecommendedSymmetryType(ProSHADE_settings *settings)</div><div class="ttdoc">This function simply returns the detected recommended symmetry type.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03223">ProSHADE_data.cpp:3223</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a67d6eadd10e10c0b46f1f2e43df7db99"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">ProSHADE_internal_data::ProSHADE_data::zGridIndices</a></div><div class="ttdeci">proshade_unsign zGridIndices</div><div class="ttdoc">As far as I know, this is identical to the zDimIndices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00070">ProSHADE_data.hpp:70</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a96a407a325278aec10d10a15c480c077"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">ProSHADE_settings::setRecommendedFold</a></div><div class="ttdeci">void setRecommendedFold(proshade_unsign val)</div><div class="ttdoc">Sets the ProSHADE detected symmetry fold.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l00989">ProSHADE.cpp:989</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aaf62d97762dce15f956066d15e048c48"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aaf62d97762dce15f956066d15e048c48">ProSHADE_internal_data::ProSHADE_data::getNoSymmetryAxes</a></div><div class="ttdeci">proshade_unsign getNoSymmetryAxes(ProSHADE_settings *settings)</div><div class="ttdoc">This function returns the number of detected recommended symmetry axes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03246">ProSHADE_data.cpp:3246</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2f217ec7b422627bd636743759579adf"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2f217ec7b422627bd636743759579adf">ProSHADE_internal_data::ProSHADE_data::setOriginalMapValues</a></div><div class="ttdeci">void setOriginalMapValues(void)</div><div class="ttdoc">This function sets the original structure representation value to a set of dedicated variables.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02217">ProSHADE_data.cpp:2217</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aca5af5c8c3b18275e65ae4ebacd9877c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5af5c8c3b18275e65ae4ebacd9877c">ProSHADE_internal_data::ProSHADE_data::setEMatrixValue</a></div><div class="ttdeci">void setEMatrixValue(proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_complex val)</div><div class="ttdoc">This function allows setting the E matrix value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02798">ProSHADE_data.cpp:2798</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa414664dde18320cc52075640590d51d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">ProSHADE_internal_data::ProSHADE_data::spheres</a></div><div class="ttdeci">ProSHADE_internal_spheres::ProSHADE_sphere ** spheres</div><div class="ttdoc">The set of concentric spheres to which the intermal density map has been projected.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00112">ProSHADE_data.hpp:112</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a255bdb77824ce0fddc2454d5823219e1"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a255bdb77824ce0fddc2454d5823219e1">ProSHADE_internal_data::ProSHADE_data::normaliseMap</a></div><div class="ttdeci">void normaliseMap(ProSHADE_settings *settings)</div><div class="ttdoc">Function for normalising the map to mean 0 and sd 1..</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00881">ProSHADE_data.cpp:881</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac00197ab71e3353cb2884be0e51d6cd3"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac00197ab71e3353cb2884be0e51d6cd3">ProSHADE_internal_data::ProSHADE_data::originalMapZCom</a></div><div class="ttdeci">proshade_double originalMapZCom</div><div class="ttdoc">The COM of the first map to be loaded/computed without any furhter changes being reflacted along the ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00096">ProSHADE_data.hpp:96</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__messages_html_a6aa8cdb600cad623409802cfaed494fa"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a></div><div class="ttdeci">void printProgressMessage(proshade_signed verbose, proshade_signed messageLevel, std::string message)</div><div class="ttdoc">General stdout message printing.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__messages_8cpp_source.html#l00070">ProSHADE_messages.cpp:70</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a30eac0ab5b69c1b7190d6e56571ba8b8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30eac0ab5b69c1b7190d6e56571ba8b8">ProSHADE_internal_data::ProSHADE_data::getRealSO3Coeffs</a></div><div class="ttdeci">void getRealSO3Coeffs(double *so3CoefsReal, int len)</div><div class="ttdoc">This function fills the input array with the real SO(3) coefficient values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03065">ProSHADE_data.cpp:3065</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a37b2746ce3f6560446b4eb45ba552084"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">ProSHADE_internal_data::ProSHADE_data::yDimSize</a></div><div class="ttdeci">proshade_single yDimSize</div><div class="ttdoc">This is the size of the map cell y dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00060">ProSHADE_data.hpp:60</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a3e7f4174b62aa402a1f6d3becd8e9dd5"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a3e7f4174b62aa402a1f6d3becd8e9dd5">ProSHADE_settings::setResolution</a></div><div class="ttdeci">void setResolution(proshade_single resolution)</div><div class="ttdoc">Sets the requested resolution in the appropriate variable.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l00318">ProSHADE.cpp:318</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5919acc2f26efcf373db47ed96eadc38"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5919acc2f26efcf373db47ed96eadc38">ProSHADE_internal_data::ProSHADE_data::removePhaseInormation</a></div><div class="ttdeci">void removePhaseInormation(ProSHADE_settings *settings)</div><div class="ttdoc">This function removes phase from the map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02364">ProSHADE_data.cpp:2364</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a256d60cfbd0f53316aa98a4a2eb8e999"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a256d60cfbd0f53316aa98a4a2eb8e999">ProSHADE_internal_data::ProSHADE_data::setMapPython</a></div><div class="ttdeci">void setMapPython(double *mapChangedInPython, int len)</div><div class="ttdoc">This function takes an array and re-writes the internal map value with the argument map values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02895">ProSHADE_data.cpp:2895</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a037825616c60bef58075284449872642"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">ProSHADE_internal_mapManip::moveMapByIndices</a></div><div class="ttdeci">void moveMapByIndices(proshade_single *xMov, proshade_single *yMov, proshade_single *zMov, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed *xFrom, proshade_signed *xTo, proshade_signed *yFrom, proshade_signed *yTo, proshade_signed *zFrom, proshade_signed *zTo, proshade_signed *xOrigin, proshade_signed *yOrigin, proshade_signed *zOrigin)</div><div class="ttdoc">Function for moving map back to original PDB location by changing the indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00536">ProSHADE_mapManip.cpp:536</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a9677e06f0781855b9046aab1b3638831"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a9677e06f0781855b9046aab1b3638831">ProSHADE_internal_io::readInMapHeader</a></div><div class="ttdeci">void readInMapHeader(gemmi::Ccp4&lt; float &gt; *map, proshade_unsign *xDimInds, proshade_unsign *yDimInds, proshade_unsign *zDimInds, proshade_single *xDim, proshade_single *yDim, proshade_single *zDim, proshade_single *aAng, proshade_single *bAng, proshade_single *cAng, proshade_signed *xFrom, proshade_signed *yFrom, proshade_signed *zFrom, proshade_signed *xAxOrigin, proshade_signed *yAxOrigin, proshade_signed *zAxOrigin, proshade_unsign *xAxOrder, proshade_unsign *yAxOrder, proshade_unsign *zAxOrder, proshade_unsign *xGridInds, proshade_unsign *yGridInds, proshade_unsign *zGridInds)</div><div class="ttdoc">This function parses the CCP4 MAP file header as read in by gemmi.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00103">ProSHADE_io.cpp:103</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a59f2f2ce1bfdb90432c5a29600fdd9e6"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59f2f2ce1bfdb90432c5a29600fdd9e6">ProSHADE_internal_data::ProSHADE_data::readInStructure</a></div><div class="ttdeci">void readInStructure(std::string fName, proshade_unsign inputO, ProSHADE_settings *settings)</div><div class="ttdoc">This function initialises the basic ProSHADE_data variables and reads in a single structure.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00419">ProSHADE_data.cpp:419</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a7a402c710af1af5fabf7505848dad047"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7a402c710af1af5fabf7505848dad047">ProSHADE_internal_data::ProSHADE_data::addExtraSpace</a></div><div class="ttdeci">void addExtraSpace(ProSHADE_settings *settings)</div><div class="ttdoc">This function increases the size of the map so that it can add empty space around it.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01369">ProSHADE_data.cpp:1369</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a9cf227397ba62db3394d6e404006df97"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a9cf227397ba62db3394d6e404006df97">ProSHADE_internal_mapManip::changePDBBFactors</a></div><div class="ttdeci">void changePDBBFactors(gemmi::Structure *pdbFile, proshade_double newBFactorValue)</div><div class="ttdoc">Function for changing the PDB B-factor values to a specific single value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00327">ProSHADE_mapManip.cpp:327</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a59fbb1c295e5bf73636984b7ae890d07"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbb1c295e5bf73636984b7ae890d07">ProSHADE_internal_data::ProSHADE_data::mapPostRotZCom</a></div><div class="ttdeci">proshade_double mapPostRotZCom</div><div class="ttdoc">The COM of the rotated map before it is processed in any other way. Along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00099">ProSHADE_data.hpp:99</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa757f9d32ebe20435661599652fd30fa"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa757f9d32ebe20435661599652fd30fa">ProSHADE_internal_data::ProSHADE_data::getRealEMatrixValuesForLM</a></div><div class="ttdeci">void getRealEMatrixValuesForLM(proshade_signed band, proshade_signed order1, double *eMatsLMReal, int len)</div><div class="ttdoc">This function fills the input array with the real E matrix values for particular band and order1 (l a...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03027">ProSHADE_data.cpp:3027</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a0df3ae9fa8c4dafac3c8c3a6145a5a27"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0df3ae9fa8c4dafac3c8c3a6145a5a27">ProSHADE_internal_data::ProSHADE_data::comMovY</a></div><div class="ttdeci">proshade_double comMovY</div><div class="ttdoc">How much the map was moved along the X-axis to achieve COM centering.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00078">ProSHADE_data.hpp:78</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a2e915d310892aea124046acd14db4a84"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a2e915d310892aea124046acd14db4a84">ProSHADE_internal_misc::sortSymHlpInv</a></div><div class="ttdeci">bool sortSymHlpInv(const proshade_double *a, const proshade_double *b)</div><div class="ttdoc">This function compares two arrays of two based on the fifth number, sorting highest first.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00221">ProSHADE_misc.cpp:221</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a60e14917f99e745c35cc400475ad6ca5"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a></div><div class="ttdeci">void addToStringVector(std::vector&lt; std::string &gt; *vecToAddTo, std::string elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00033">ProSHADE_misc.cpp:33</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__spherical_harmonics_html_a3fa7caeb0d21183a39d7cca2d889c437"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__spherical_harmonics.html#a3fa7caeb0d21183a39d7cca2d889c437">ProSHADE_internal_sphericalHarmonics::computeSphericalHarmonics</a></div><div class="ttdeci">void computeSphericalHarmonics(proshade_unsign band, proshade_double *sphereMappedData, proshade_complex *&amp;shArray)</div><div class="ttdoc">This function computes the spherical harmonics of a aingle shell, saving them in supplied pointer.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spherical_harmonics_8cpp_source.html#l00393">ProSHADE_sphericalHarmonics.cpp:393</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_abd1c1b3588308f775da5c8aeba3f3e78"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abd1c1b3588308f775da5c8aeba3f3e78">ProSHADE_internal_data::ProSHADE_data::readInPDB</a></div><div class="ttdeci">void readInPDB(ProSHADE_settings *settings)</div><div class="ttdoc">Function for reading pdb data.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00526">ProSHADE_data.cpp:526</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afbbcec01a6ee7701e3b1d0e61730fadf"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afbbcec01a6ee7701e3b1d0e61730fadf">ProSHADE_internal_data::ProSHADE_data::getZFromPtr</a></div><div class="ttdeci">proshade_signed * getZFromPtr(void)</div><div class="ttdoc">This function allows access to the map start along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02677">ProSHADE_data.cpp:2677</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a68eb739dd4846a1dd48032eb2cc3f49c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a68eb739dd4846a1dd48032eb2cc3f49c">ProSHADE_internal_data::ProSHADE_data::getZToPtr</a></div><div class="ttdeci">proshade_signed * getZToPtr(void)</div><div class="ttdoc">This function allows access to the map last position along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02707">ProSHADE_data.cpp:2707</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9f6ba75b25e201466929bfd4df75688d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9f6ba75b25e201466929bfd4df75688d">ProSHADE_internal_data::ProSHADE_data::so3CoeffsArrayIndex</a></div><div class="ttdeci">int so3CoeffsArrayIndex(proshade_signed order1, proshade_signed order2, proshade_signed band)</div><div class="ttdoc">This function gets the SO(3) coefficients array index for a particular so(3) band,...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03105">ProSHADE_data.cpp:3105</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_fa9be34cc2c3eb9c0decdfb277595ca7.html">proshade</a></li><li class="navelem"><a class="el" href="_pro_s_h_a_d_e__data_8cpp.html">ProSHADE_data.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
