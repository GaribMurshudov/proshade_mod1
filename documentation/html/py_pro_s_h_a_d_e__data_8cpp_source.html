<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ProSHADE: src/python/pyProSHADE_data.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ProSHADE
   &#160;<span id="projectnumber">0.7.5.1 (JAN 2021) - EXPERIMENTAL</span>
   </div>
   <div id="projectbrief">Protein Shape Detection</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('py_pro_s_h_a_d_e__data_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">pyProSHADE_data.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//==================================================== Include PyBind11 header</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;pybind11/pybind11.h&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;pybind11/stl.h&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;pybind11/numpy.h&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//==================================================== Add the ProSHADE_settings and ProSHADE_run classes to the PyBind11 module</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keywordtype">void</span> add_dataClass ( pybind11::module&amp; pyProSHADE )</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">//================================================ Export the ProSHADE_settings class</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    pybind11::class_ &lt; ProSHADE_internal_data::ProSHADE_data &gt; ( pyProSHADE, <span class="stringliteral">&quot;ProSHADE_data&quot;</span> )</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="comment">//============================================ Constructors (destructors do not need wrappers???)</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        .def                                          ( pybind11::init &lt; ProSHADE_settings* &gt; ( ), pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        .def                                          ( pybind11::init ( [] ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::string strName, pybind11::array_t &lt; float, pybind11::array::c_style | pybind11::array::forcecast &gt; mapData, proshade_single xDmSz, proshade_single yDmSz, proshade_single zDmSz, proshade_unsign xDmInd, proshade_unsign yDmInd, proshade_unsign zDmInd, proshade_signed xFr, proshade_signed yFr, proshade_signed zFr, proshade_signed xT, proshade_signed yT, proshade_signed zT,  proshade_unsign inputO )</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                                                      {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                                                        <span class="comment">//== Find the array size</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                                                        pybind11::buffer_info buf = mapData.request();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                                                        proshade_unsign len = buf.size;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                                                        <span class="comment">//== Allocate memory</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                                        <span class="keywordtype">double</span>* npVals = <span class="keyword">new</span> <span class="keywordtype">double</span>[<span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( len )];</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                                        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( npVals, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                                                        <span class="comment">//== Copy from numpy to ProSHADE (I do not want to be directly changing the python memory, that screams trouble)</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                                                        <span class="keywordflow">if</span> ( buf.ndim == 1 )</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                                        {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                                            <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; len; iter++ ) { npVals[iter] = <span class="keyword">static_cast &lt;</span> <span class="keywordtype">double</span> <span class="keyword">&gt;</span> ( mapData.at(iter) ); }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                                        }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( buf.ndim == 3 )</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                                        {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                                            <span class="keywordtype">float</span>* dataPtr = <span class="keyword">reinterpret_cast &lt;</span> <span class="keywordtype">float</span>* <span class="keyword">&gt;</span> ( buf.ptr );</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                                            <span class="keywordflow">for</span> ( proshade_unsign xIt = 0; xIt &lt; static_cast&lt;proshade_unsign&gt; ( buf.shape.at(0) ); xIt++ )</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                                            {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                                                <span class="keywordflow">for</span> ( proshade_unsign yIt = 0; yIt &lt; static_cast&lt;proshade_unsign&gt; ( buf.shape.at(1) ); yIt++ )</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                                                {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                                                                    <span class="keywordflow">for</span> ( proshade_unsign zIt = 0; zIt &lt; static_cast&lt;proshade_unsign&gt; ( buf.shape.at(2) ); zIt++ )</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                                                                    {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                                                                        npVals[zIt + buf.shape.at(2) * ( yIt + buf.shape.at(1) * xIt )] = <span class="keyword">static_cast &lt;</span> <span class="keywordtype">double</span> <span class="keyword">&gt;</span> ( dataPtr[zIt + buf.shape.at(2) * ( yIt + buf.shape.at(1) * xIt )] );</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                                                    }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                                                }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                                            }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                                        }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                                        {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                                            std::cerr &lt;&lt; <span class="stringliteral">&quot;!!! ProSHADE PYTHON MODULE ERROR !!! The ProSHADE_data class constructor ( ProSHADE_settings, str, numpy.ndarray, float, float, float, ... ) only supports the third argument input array in the 1D or 3D numpy.ndarray format. The supplied array has &quot;</span> &lt;&lt; buf.ndim &lt;&lt; <span class="stringliteral">&quot; dims. Terminating...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                                            exit ( EXIT_FAILURE );</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                                        }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                                        <span class="comment">//== Call the ProSHADE_data constructor</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                                                        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> ( settings,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                                                                                           strName,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                                                                                           npVals,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                                                                                           <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( len ),</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                                                                                           xDmSz,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                                                                                           yDmSz,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                                                                                           zDmSz,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                                                                                           xDmInd,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                                                                                           yDmInd,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                                                                                           zDmInd,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                                                                                           xFr,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                                                                                           yFr,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                                                                                           zFr,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                                                                                           xT,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                                                                                           yT,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                                                                                           zT,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                                                                                           inputO );</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                                      } ) )</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="comment">//============================================ Data I/O functions</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        .def                                          ( <span class="stringliteral">&quot;readInStructure&quot;</span>,  &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59f2f2ce1bfdb90432c5a29600fdd9e6">ProSHADE_internal_data::ProSHADE_data::readInStructure</a>,    <span class="stringliteral">&quot;This function initialises the basic ProSHADE_data variables and reads in a single structure.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;fname&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;inputO&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        .def                                          ( <span class="stringliteral">&quot;writeMap&quot;</span>,         &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a81e6aab30488052e6bdd9b339e8124d8">ProSHADE_internal_data::ProSHADE_data::writeMap</a>,           <span class="stringliteral">&quot;Function for writing out the internal structure representation in MRC MAP format.&quot;</span>,            pybind11::arg ( <span class="stringliteral">&quot;fname&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;title&quot;</span> ) = <span class="stringliteral">&quot;Created by ProSHADE and written by GEMMI&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;mode&quot;</span> ) = 2 )</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        .def                                          ( <span class="stringliteral">&quot;writePdb&quot;</span>,         &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1eb216aaab1c44a29f8552ece206130a">ProSHADE_internal_data::ProSHADE_data::writePdb</a>,           <span class="stringliteral">&quot;This function writes out the PDB formatted file coresponding to the structure.&quot;</span>,               pybind11::arg ( <span class="stringliteral">&quot;fname&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;euA&quot;</span> ) = 0.0, pybind11::arg ( <span class="stringliteral">&quot;euB&quot;</span> ) = 0.0, pybind11::arg ( <span class="stringliteral">&quot;euG&quot;</span> ) = 0.0, pybind11::arg ( <span class="stringliteral">&quot;firstModel&quot;</span> ) = true )</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getMap&quot;</span>,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                                        [] ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> &amp;<span class="keyword">self</span> ) -&gt; pybind11::array_t &lt; proshade_double &gt;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                                        {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                                                            <span class="comment">//== Copy the values</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                                            pybind11::array_t &lt; proshade_double &gt; retArr = pybind11::array_t &lt; proshade_double &gt; ( { <span class="keyword">self</span>.xDimIndices, <span class="keyword">self</span>.yDimIndices, <span class="keyword">self</span>.zDimIndices },  <span class="comment">// Shape</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                                                                                                                                   { <span class="keyword">self</span>.yDimIndices * <span class="keyword">self</span>.zDimIndices * <span class="keyword">sizeof</span>(proshade_double),</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                                                                                                                                     <span class="keyword">self</span>.zDimIndices * <span class="keyword">sizeof</span>(proshade_double),</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                                                                                                                                     <span class="keyword">sizeof</span>(proshade_double) },  <span class="comment">// C-stype strides</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                                                                                                                                   <span class="keyword">self</span>.internalMap );           <span class="comment">// Data</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                                            <span class="comment">//== Done</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                                            <span class="keywordflow">return</span> ( retArr );</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                                        } )</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">//============================================ Data processing functions</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        .def                                          ( <span class="stringliteral">&quot;processInternalMap&quot;</span>,    &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afcb4202e9ffea1b99c59f73faf06d899">ProSHADE_internal_data::ProSHADE_data::processInternalMap</a>,    <span class="stringliteral">&quot;This function simply clusters several map manipulating functions which should be called together. These include centering, phase removal, normalisation, adding extra space, etc.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        .def                                          ( <span class="stringliteral">&quot;invertMirrorMap&quot;</span>,       &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa67115a6b234764c958899863fb60b54">ProSHADE_internal_data::ProSHADE_data::invertMirrorMap</a>,       <span class="stringliteral">&quot;Function for inverting the map to its mirror image.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        .def                                          ( <span class="stringliteral">&quot;normaliseMap&quot;</span>,          &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a255bdb77824ce0fddc2454d5823219e1">ProSHADE_internal_data::ProSHADE_data::normaliseMap</a>,          <span class="stringliteral">&quot;Function for normalising the map values to mean 0 and sd 1.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        .def                                          ( <span class="stringliteral">&quot;maskMap&quot;</span>,               &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0122be830893f5d82bab742be54d1ee7">ProSHADE_internal_data::ProSHADE_data::maskMap</a>,               <span class="stringliteral">&quot;Function for computing the map mask using blurring and X IQRs from median.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        .def                                          ( <span class="stringliteral">&quot;reSampleMap&quot;</span>,           &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab573ea90a16991a06a77c5343328b060">ProSHADE_internal_data::ProSHADE_data::reSampleMap</a>,           <span class="stringliteral">&quot;This function changes the internal map sampling to conform to particular resolution value.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        .def                                          ( <span class="stringliteral">&quot;centreMapOnCOM&quot;</span>,        &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a80ff45ef40549fb6a1d80b70865fc807">ProSHADE_internal_data::ProSHADE_data::centreMapOnCOM</a>,        <span class="stringliteral">&quot;This function shits the map so that its COM is in the centre of the map.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        .def                                          ( <span class="stringliteral">&quot;addExtraSpace&quot;</span>,         &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7a402c710af1af5fabf7505848dad047">ProSHADE_internal_data::ProSHADE_data::addExtraSpace</a>,         <span class="stringliteral">&quot;This function increases the size of the map so that it can add empty space around it.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        .def                                          ( <span class="stringliteral">&quot;removePhaseInormation&quot;</span>, &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5919acc2f26efcf373db47ed96eadc38">ProSHADE_internal_data::ProSHADE_data::removePhaseInormation</a>, <span class="stringliteral">&quot;This function removes phase from the map, effectively converting it to Patterson map.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getReBoxBoundaries&quot;</span>,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                                        [] ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> &amp;<span class="keyword">self</span>,<a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings ) -&gt; pybind11::array_t &lt; proshade_signed &gt;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                                        {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                                            <span class="comment">//== Allocate output memory</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                                            proshade_signed* retVals = <span class="keyword">new</span> proshade_signed[6];</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                                            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( retVals, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                                            <span class="comment">//== If same bounds as first one are required, test if possible and return these instead</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                                            <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a1f0d2cb45fee521ddb2d0bc30beff3ec">useSameBounds</a> &amp;&amp; ( <span class="keyword">self</span>.inputOrder != 0 ) )</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                                            {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                                                <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 6; iter++ ) { retVals[iter] = settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa3e24ef5a66fa7204a2ba9c27f2f12b9">forceBounds</a>[iter]; }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                                            }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                                            <span class="comment">//== In this case, bounds need to be found de novo</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                                            {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                                                <span class="comment">//== Find the non-zero bounds</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                                                <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a26c8be8b50be424bb35d3f6f39aa9aff">ProSHADE_internal_mapManip::getNonZeroBounds</a>  ( <span class="keyword">self</span>.internalMap, <span class="keyword">self</span>.xDimIndices, <span class="keyword">self</span>.yDimIndices, <span class="keyword">self</span>.zDimIndices,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                                                                                                <span class="keyword">self</span>.xDimSize, <span class="keyword">self</span>.yDimSize, <span class="keyword">self</span>.zDimSize, retVals );</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                                                                </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                                                <span class="comment">//== Add the extra space</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                                                <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a7c88b1152378beca4ccee251f2fb5e06">ProSHADE_internal_mapManip::addExtraBoundSpace</a> ( <span class="keyword">self</span>.xDimIndices, <span class="keyword">self</span>.yDimIndices, <span class="keyword">self</span>.zDimIndices,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                                                                                                 <span class="keyword">self</span>.xDimSize, <span class="keyword">self</span>.yDimSize, <span class="keyword">self</span>.zDimSize, retVals, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a633435d4c8a7fd6533016c00ad9ba791">boundsExtraSpace</a> );</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                                                                </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                                                <span class="comment">//== Beautify boundaries</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                                                <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ae273430e12dd5bce08cf29c7689800dd">ProSHADE_internal_mapManip::beautifyBoundaries</a> ( retVals, <span class="keyword">self</span>.xDimIndices, <span class="keyword">self</span>.yDimIndices, <span class="keyword">self</span>.zDimIndices, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a827e3241fa6401027e0526fffb8b281d">boundsSimilarityThreshold</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a> );</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                                                                </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                                                <span class="comment">//== If need be, save boundaries to be used for all other structure</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                                                <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a1f0d2cb45fee521ddb2d0bc30beff3ec">useSameBounds</a> &amp;&amp; ( <span class="keyword">self</span>.inputOrder == 0 ) ) { <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 6; iter++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa3e24ef5a66fa7204a2ba9c27f2f12b9">forceBounds</a>[iter] = retVals[iter]; } }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                                            }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                                            <span class="comment">//== Create capsules to make sure memory is released properly from the allocating language (C++ in this case)</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                                            pybind11::capsule pyCapsuleReBox2 ( retVals, []( <span class="keywordtype">void</span> *f ) { proshade_signed* foo = <span class="keyword">reinterpret_cast&lt;</span> proshade_signed* <span class="keyword">&gt;</span> ( f ); <span class="keyword">delete</span> foo; } );</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                                            <span class="comment">//== Copy the value</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                                            pybind11::array_t &lt; proshade_signed &gt; retArr = pybind11::array_t &lt; proshade_signed &gt; ( { 6 },                         <span class="comment">// Shape</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                                                                                                                                   { <span class="keyword">sizeof</span>(proshade_signed) },   <span class="comment">// C-stype strides</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                                                                                                                                   retVals,                       <span class="comment">// Data</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                                                                                                                                   pyCapsuleReBox2 );             <span class="comment">// Capsule</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                                            <span class="comment">//== Done</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                                            <span class="keywordflow">return</span> ( retArr );</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                                        }, <span class="stringliteral">&quot;This function finds the boundaries enclosing positive map values and adds some extra space.&quot;</span> )</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        .def                                          ( <span class="stringliteral">&quot;createNewMapFromBounds&quot;</span>,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                                        [] ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> &amp;<span class="keyword">self</span>, pybind11::array_t &lt; proshade_signed &gt; bounds, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* newStr, <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                                        {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                                            <span class="comment">//== Allocate memory for bounds copy</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                                            proshade_signed* newBounds = <span class="keyword">new</span> proshade_signed[6];</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                                            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( newBounds, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                                            <span class="comment">//== Copy to the pointer</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                                            <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 6; iter++ ) { newBounds[iter] = bounds.at(iter); }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                                            <span class="comment">//== Run C++ function</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                                            <span class="keyword">self</span>.createNewMapFromBounds ( settings, newStr, newBounds );</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                                            <span class="comment">//== Done</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                                            return ;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                                        }, <span class="stringliteral">&quot;This function creates a new structure from the calling structure and new bounds values.&quot;</span> )</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">//============================================ Data sphere mapping functions</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        .def                                          ( <span class="stringliteral">&quot;mapToSpheres&quot;</span>, &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a56bfcfacedabd84ec54aa2843d59e014">ProSHADE_internal_data::ProSHADE_data::mapToSpheres</a>, <span class="stringliteral">&quot;This function converts the internal map onto a set of concentric spheres.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getSpherePositions&quot;</span>, &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a188b648a0ad28b598d682ca14f288dc4">ProSHADE_internal_data::ProSHADE_data::getSpherePositions</a>, <span class="stringliteral">&quot;This function determines the sphere positions (radii) for sphere mapping.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        .def                                          ( <span class="stringliteral">&quot;computeSphericalHarmonics&quot;</span>, &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23f9a5f8f6fb7cf0f0324bc1d83d6090">ProSHADE_internal_data::ProSHADE_data::computeSphericalHarmonics</a>, <span class="stringliteral">&quot;This function computes the spherical harmonics decomposition for the whole structure.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="comment">//============================================ Accessor functions</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getXDimSize&quot;</span>, &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">ProSHADE_internal_data::ProSHADE_data::getXDimSize</a>, <span class="stringliteral">&quot;This function allows access to the map size in angstroms along the X axis.&quot;</span> )</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getYDimSize&quot;</span>, &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">ProSHADE_internal_data::ProSHADE_data::getYDimSize</a>, <span class="stringliteral">&quot;This function allows access to the map size in angstroms along the Y axis.&quot;</span> )</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getZDimSize&quot;</span>, &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">ProSHADE_internal_data::ProSHADE_data::getZDimSize</a>, <span class="stringliteral">&quot;This function allows access to the map size in angstroms along the Z axis.&quot;</span> )</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getXDim&quot;</span>,     &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">ProSHADE_internal_data::ProSHADE_data::getXDim</a>,     <span class="stringliteral">&quot;This function allows access to the map size in indices along the X axis.&quot;</span>   )</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getYDim&quot;</span>,     &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">ProSHADE_internal_data::ProSHADE_data::getYDim</a>,     <span class="stringliteral">&quot;This function allows access to the map size in indices along the Y axis.&quot;</span>   )</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getZDim&quot;</span>,     &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">ProSHADE_internal_data::ProSHADE_data::getZDim</a>,     <span class="stringliteral">&quot;This function allows access to the map size in indices along the Z axis.&quot;</span>   )</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="comment">//============================================ Symmetry related functions</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        .def                                          ( <span class="stringliteral">&quot;computeRotationFunction&quot;</span>, &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac7cb89ed871668c57a3b5dc953c20482">ProSHADE_internal_data::ProSHADE_data::computeRotationFunction</a>, <span class="stringliteral">&quot;This function computes the self-rotation function for this structure and stores it internally in the ProSHADE_data object.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        .def                                          ( <span class="stringliteral">&quot;detectSymmetryInStructure&quot;</span>,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                                        [] ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> &amp;<span class="keyword">self</span>, <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                                        {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                                            <span class="comment">//== Call the appropriate C++ function</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                                            <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab8d152f5e2e5dc0a64048d2e9c0d8d12">usePeakSearchInRotationFunctionSpace</a> )</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                                            {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                                                <span class="comment">//== Detect point groups in the angle-axis space</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                                                                <span class="keyword">self</span>.detectSymmetryFromAngleAxisSpace ( settings, &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>, &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a> );</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                                            }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                                            {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                                                <span class="comment">//== Detect symmetry using the peak detection in rotation function space</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                                                <span class="keyword">self</span>.detectSymmetryInStructure ( settings, &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>, &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a> );</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                                            }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                                        }, <span class="stringliteral">&quot;This function runs the symmetry detection algorithms on this structure and saves the results in the settings object.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getRecommendedSymmetryType&quot;</span>, &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5add825ce8d5e5d9f598f6912f07aff">ProSHADE_internal_data::ProSHADE_data::getRecommendedSymmetryType</a>, <span class="stringliteral">&quot;This function simply returns the detected recommended symmetry type.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getRecommendedSymmetryFold&quot;</span>, &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e1bd5bd5a3fd12691a1d83735c13250">ProSHADE_internal_data::ProSHADE_data::getRecommendedSymmetryFold</a>, <span class="stringliteral">&quot;This function simply returns the detected recommended symmetry fold.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getRecommendedSymmetryAxes&quot;</span>,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                                        [] ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> &amp;<span class="keyword">self</span>, <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings ) -&gt; pybind11::array_t &lt; float &gt;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                                        {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                                            <span class="comment">//== Allocate memory for the numpy values</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                                            <span class="keywordtype">float</span>* npVals = <span class="keyword">new</span> <span class="keywordtype">float</span>[<span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() * 6 )];</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                                            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( npVals, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                                            <span class="comment">//== Copy values</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                                            <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() ); iter++ ) { <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; 6; it++ ) { npVals[(iter*6)+it] = settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(iter)[it]; } }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                                            <span class="comment">//== Create capsules to make sure memory is released properly from the allocating language (C++ in this case)</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                                            pybind11::capsule pyCapsuleStrRecSym ( npVals, []( <span class="keywordtype">void</span> *f ) { <span class="keywordtype">float</span>* foo = <span class="keyword">reinterpret_cast&lt;</span> <span class="keywordtype">float</span>* <span class="keyword">&gt;</span> ( f ); <span class="keyword">delete</span> foo; } );</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                                            <span class="comment">//== Copy the value</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                                            pybind11::array_t &lt; float &gt; retArr = pybind11::array_t&lt;float&gt; ( { <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( 6 ) },  <span class="comment">// Shape</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                                                                                                            { 6 * <span class="keyword">sizeof</span>(float), <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) },                          <span class="comment">// C-stype strides</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                                                                                                            npVals,                                                        <span class="comment">// Data</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                                                                                                            pyCapsuleStrRecSym );                                          <span class="comment">// Capsule</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                                            <span class="comment">//== Done</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                                            <span class="keywordflow">return</span> ( retArr );</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                                        }, <span class="stringliteral">&quot;This function returns the recommended symmetry axes as a 2D numpy array.&quot;</span> )</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getAllCSyms&quot;</span>,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                                        [] ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> &amp;<span class="keyword">self</span>, <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings ) -&gt; pybind11::array_t &lt; float &gt;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                                        {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                                            <span class="comment">//== Allocate memory for the numpy values</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                                            <span class="keywordtype">float</span>* npVals = <span class="keyword">new</span> <span class="keywordtype">float</span>[<span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.size() * 6 )];</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                                            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( npVals, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                                                            <span class="comment">//== Copy values</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                                                            <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.size() ); iter++ ) { <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; 6; it++ ) { npVals[(iter*6)+it] = settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(iter).at(it); } }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                                                            <span class="comment">//== Create capsules to make sure memory is released properly from the allocating language (C++ in this case)</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                                                            pybind11::capsule pyCapsuleStrSymList ( npVals, []( <span class="keywordtype">void</span> *f ) { <span class="keywordtype">float</span>* foo = <span class="keyword">reinterpret_cast&lt;</span> <span class="keywordtype">float</span>* <span class="keyword">&gt;</span> ( f ); <span class="keyword">delete</span> foo; } );</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                                                            <span class="comment">//== Copy the value</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                                                            pybind11::array_t &lt; float &gt; retArr = pybind11::array_t&lt;float&gt; ( { <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.size() ), 6 },  <span class="comment">// Shape</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                                                                                                            { 6 * <span class="keyword">sizeof</span>(float), <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) },                           <span class="comment">// C-stype strides</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                                                                                                            npVals,                                                         <span class="comment">// Data</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                                                                                                            pyCapsuleStrSymList );                                          <span class="comment">// Capsule</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                                            <span class="comment">//== Done</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                                            <span class="keywordflow">return</span> ( retArr );</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                                        }, <span class="stringliteral">&quot;This function returns all symmetry axes as a 2D numpy array.&quot;</span> )</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getNonCSymmetryAxesIndices&quot;</span>,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                                        [] ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> &amp;<span class="keyword">self</span>, <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings ) -&gt; pybind11::dict</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                                        {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                                            <span class="comment">//== Initialise local variables</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                                                            pybind11::dict retDict;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                                            pybind11::list dList, tList, oList, iList;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                                            <span class="comment">//== Fill in the D list</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                                                            <span class="keywordflow">for</span> ( proshade_unsign dIt = 0; dIt &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.size() ); dIt++ )</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                                            {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                                                pybind11::list memList;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                                                <span class="keywordflow">for</span> ( proshade_unsign memIt = 0; memIt &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).size() ); memIt++ )</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                                                {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                                                                    memList.append ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(memIt) );</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                                                }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                                                dList.append ( memList );</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                                            }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                                            <span class="comment">//== Fill in the T list</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                                            <span class="keywordflow">for</span> ( proshade_unsign tIt = 0; tIt &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.size() ); tIt++ )</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                                            {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                                                                tList.append ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at ( tIt ) );</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                                                            }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                                                            <span class="comment">//== Fill in the O list</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                                            <span class="keywordflow">for</span> ( proshade_unsign oIt = 0; oIt &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.size() ); oIt++ )</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                                            {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                                                oList.append ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at ( oIt ) );</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                                                            }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                                            <span class="comment">//== Fill in the T list</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                                            <span class="keywordflow">for</span> ( proshade_unsign iIt = 0; iIt &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.size() ); iIt++ )</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                                            {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                                                iList.append ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.at ( iIt ) );</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                                            }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                                            <span class="comment">//== Save the lists to the dict</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                                                            retDict[ pybind11::handle ( pybind11::str ( <span class="stringliteral">&quot;D&quot;</span> ).ptr ( ) ) ] = dList;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                                            retDict[ pybind11::handle ( pybind11::str ( <span class="stringliteral">&quot;T&quot;</span> ).ptr ( ) ) ] = tList;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                                            retDict[ pybind11::handle ( pybind11::str ( <span class="stringliteral">&quot;O&quot;</span> ).ptr ( ) ) ] = oList;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                                            retDict[ pybind11::handle ( pybind11::str ( <span class="stringliteral">&quot;I&quot;</span> ).ptr ( ) ) ] = iList;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                                            <span class="comment">//== Done</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                                            <span class="keywordflow">return</span> ( retDict );</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                                        }, <span class="stringliteral">&quot;This function returns array of non-C axes indices.&quot;</span> )</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getAllGroupElements&quot;</span>,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                                        [] ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> &amp;<span class="keyword">self</span>, <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, pybind11::array_t &lt; int &gt; axList, std::string groupType, proshade_double matrixTolerance ) -&gt; pybind11::list</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                                        {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                                            <span class="comment">//== Sanity check</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                                            pybind11::buffer_info buf = axList.request();</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                                            <span class="keywordflow">if</span> ( buf.ndim != 1 ) { std::cerr &lt;&lt; <span class="stringliteral">&quot;!!! ProSHADE PYTHON MODULE ERROR !!! The second argument to getAllGroupElements() must be a 1D numpy array stating the indices of the axes forming the group!&quot;</span> &lt;&lt; std::endl; exit ( EXIT_FAILURE ); }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                                            </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                                            <span class="comment">//== Convert to vector of unsigns</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                                            std::vector&lt; proshade_unsign &gt; axesList;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                                            <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( axList.size() ); iter++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;axesList, axList.at(iter) ); }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                                            <span class="comment">//== Get the results</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                                            std::vector &lt; std::vector&lt; proshade_double &gt; &gt; vals = <span class="keyword">self</span>.getAllGroupElements ( settings, axesList, groupType, matrixTolerance );</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                                                            <span class="comment">//== Initialise return variable</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                                            pybind11::list retList;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                                                            <span class="comment">//== Copy values</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                                                            <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( vals.size() ); iter++ )</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                                                            {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                                                                <span class="comment">//== Allocate memory for the numpy values</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                                                                <span class="keywordtype">float</span>* npVals = <span class="keyword">new</span> <span class="keywordtype">float</span>[<span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span> ( 9 )];</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                                                                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( npVals, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                                                                </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                                                                <span class="comment">//== Copy values to memory</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                                                                <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; 9; it++ ) { npVals[it] = vals.at(iter).at(it); }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                                                <span class="comment">//== Create capsules to make sure memory is released properly from the allocating language (C++ in this case)</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                                                pybind11::capsule pyCapsuleGrpEl ( npVals, []( <span class="keywordtype">void</span> *f ) { <span class="keywordtype">float</span>* foo = <span class="keyword">reinterpret_cast&lt;</span> <span class="keywordtype">float</span>* <span class="keyword">&gt;</span> ( f ); <span class="keyword">delete</span> foo; } );</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                                                <span class="comment">//== Copy the value</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                                                                pybind11::array_t &lt; float &gt; retArr = pybind11::array_t&lt;float&gt; ( { 3, 3 },                                      <span class="comment">// Shape</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                                                                                                                { 3 * <span class="keyword">sizeof</span>(float), <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) },          <span class="comment">// C-stype strides</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                                                                                                                npVals,                                        <span class="comment">// Data</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                                                                                                                                pyCapsuleGrpEl );                              <span class="comment">// Capsule</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                                                                </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                                                                <span class="comment">//== Save matrix</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                                                retList.append ( retArr );</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                                                            }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                                            <span class="comment">//== Done</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                                            <span class="keywordflow">return</span> ( retList );</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                                        }, <span class="stringliteral">&quot;This function returns the group elements as rotation matrices of any point group described by the detected axes.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;axList&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;groupType&quot;</span> ) = <span class="stringliteral">&quot;&quot;</span>, pybind11::arg( <span class="stringliteral">&quot;matrixTolerance&quot;</span> ) = 0.05 )</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="comment">//============================================ Overlay related functions</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getOverlayRotationFunction&quot;</span>, &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad409e4556676857224d1f5e00e5b7911">ProSHADE_internal_data::ProSHADE_data::getOverlayRotationFunction</a>, <span class="stringliteral">&quot;This function computes the overlay rotation function (i.e. the correlation function in SO(3) space).&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;obj2&quot;</span> ) )</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getBestRotationMapPeaksEulerAngles&quot;</span>,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                                        [] ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> &amp;<span class="keyword">self</span>, <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings ) -&gt; pybind11::array_t &lt; float &gt;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                                        {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                                            <span class="comment">//== Get values</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                                            std::vector&lt; proshade_double &gt; vals = <span class="keyword">self</span>.getBestRotationMapPeaksEulerAngles ( settings );</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                                            <span class="comment">//== Allocate memory for the numpy values</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                                            <span class="keywordtype">float</span>* npVals = <span class="keyword">new</span> <span class="keywordtype">float</span>[<span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span> (vals.size())];</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                                            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( npVals, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                                            <span class="comment">//== Copy values</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                                            <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( vals.size() ); iter++ ) { npVals[iter] = vals.at(iter); }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                                            <span class="comment">//== Create capsules to make sure memory is released properly from the allocating language (C++ in this case)</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                                                            pybind11::capsule pyCapsuleEuPeak ( npVals, []( <span class="keywordtype">void</span> *f ) { <span class="keywordtype">float</span>* foo = <span class="keyword">reinterpret_cast&lt;</span> <span class="keywordtype">float</span>* <span class="keyword">&gt;</span> ( f ); <span class="keyword">delete</span> foo; } );</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                                            <span class="comment">//== Copy the value</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                                            pybind11::array_t &lt; float &gt; retArr = pybind11::array_t&lt;float&gt; ( { <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span> (vals.size()) },  <span class="comment">// Shape</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                                                                                                            { <span class="keyword">sizeof</span>(float) },                            <span class="comment">// C-stype strides</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                                                                                                            npVals,                                       <span class="comment">// Data</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                                                                                                            pyCapsuleEuPeak );                            <span class="comment">// Capsule (C++ destructor, basically)</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                                            <span class="comment">//== Done</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                                            <span class="keywordflow">return</span> ( retArr );</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                                        }, <span class="stringliteral">&quot;This function returns a vector of three floats, the three Euler angles of the best peak in the rotation map.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getBestRotationMapPeaksRotationMatrix&quot;</span>,</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                                                    [] ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> &amp;<span class="keyword">self</span>, <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings ) -&gt; pybind11::array_t &lt; proshade_double &gt;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                                    {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                                        <span class="comment">//== Get values</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                                        std::vector&lt; proshade_double &gt; vals = <span class="keyword">self</span>.getBestRotationMapPeaksEulerAngles ( settings );</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                                        <span class="comment">//== Convert Euler ZXZ to matrix</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                                        proshade_double* retMat = <span class="keyword">new</span> proshade_double[9];</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                                        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( retMat, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                                        <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a> ( vals.at(0), vals.at(1), vals.at(2), retMat );</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                                        <span class="comment">//== Create capsules to make sure memory is released properly from the allocating language (C++ in this case)</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                                                        pybind11::capsule pyCapsuleRMPeak ( retMat, []( <span class="keywordtype">void</span> *f ) { proshade_double* foo = <span class="keyword">reinterpret_cast&lt;</span> proshade_double* <span class="keyword">&gt;</span> ( f ); <span class="keyword">delete</span> foo; } );</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                                        <span class="comment">//== Copy the value</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                                                        pybind11::array_t &lt; proshade_double &gt; retArr = pybind11::array_t&lt;proshade_double&gt; ( { 3, 3 },                                                 <span class="comment">// Shape</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                                                                                                                            { 3 * <span class="keyword">sizeof</span>(proshade_double), <span class="keyword">sizeof</span>(proshade_double) }, <span class="comment">// C-stype strides</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                                                                                                                                            retMat,                                                   <span class="comment">// Data</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                                                                                                                                            pyCapsuleRMPeak );                                        <span class="comment">// Capsule</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                                                        <span class="comment">//== Done</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                                                        <span class="keywordflow">return</span> ( retArr );</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                                    }, <span class="stringliteral">&quot;This function returns a rotation matrix representing the best peak in the rotation map.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ) )</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        .def                                          ( <span class="stringliteral">&quot;rotateMap&quot;</span>, &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8089b5dceb60b2e4c2e65957e24d1f56">ProSHADE_internal_data::ProSHADE_data::rotateMap</a>, <span class="stringliteral">&quot;This function rotates a map based on the given Euler angles.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;eulerAlpha&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;eulerBeta&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;eulerGamma&quot;</span> ) )</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        .def                                          ( <span class="stringliteral">&quot;zeroPaddToDims&quot;</span>, &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0cdec5190d4b2ae60350f0f6db751d4b">ProSHADE_internal_data::ProSHADE_data::zeroPaddToDims</a>, <span class="stringliteral">&quot;This function changes the size of a structure to fit the supplied new limits.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;xDimMax&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;yDimMax&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;zDimMax&quot;</span> ) )</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        .def                                          ( <span class="stringliteral">&quot;computeTranslationMap&quot;</span>, &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a767640acbf4999201ce9ea86d76ff6a1">ProSHADE_internal_data::ProSHADE_data::computeTranslationMap</a>, <span class="stringliteral">&quot;This function does the computation of the translation map and saves results internally.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;staticStructure&quot;</span> ) )</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getBestTranslationMapPeaksAngstrom&quot;</span>,</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                                                        [] ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> &amp;<span class="keyword">self</span>, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* staticStructure, proshade_double eulA, proshade_double eulB, proshade_double eulG ) -&gt; pybind11::array_t &lt; float &gt;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                                        {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                                            <span class="comment">//== Get values</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                                            std::vector&lt; proshade_double &gt; vals = <span class="keyword">self</span>.getBestTranslationMapPeaksAngstrom ( staticStructure, eulA, eulB, eulG );</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                                            <span class="comment">//== Convert Euler ZXZ to matrix</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                                            <span class="keywordtype">float</span>* npVals = <span class="keyword">new</span> <span class="keywordtype">float</span>[3];</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                                                            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( npVals, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                                            <span class="comment">//== Copy the vals to memory</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                                            <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 3; iter++ ) { npVals[iter] = vals.at(iter); }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                                                            <span class="comment">//== Create capsules to make sure memory is released properly from the allocating language (C++ in this case)</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                                            pybind11::capsule pyCapsuleTRPeak ( npVals, []( <span class="keywordtype">void</span> *f ) { <span class="keywordtype">float</span>* foo = <span class="keyword">reinterpret_cast&lt;</span> <span class="keywordtype">float</span>* <span class="keyword">&gt;</span> ( f ); <span class="keyword">delete</span> foo; } );</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                                            <span class="comment">//== Create numpy array</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                                                            pybind11::array_t &lt; float &gt; retArr = pybind11::array_t &lt; float &gt; ( { 3 },                 <span class="comment">// Shape</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                                                                                                               { <span class="keyword">sizeof</span>(float) },     <span class="comment">// C-stype strides</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                                                                                                               npVals,                <span class="comment">// Data</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                                                                                                                               pyCapsuleTRPeak );     <span class="comment">// Capsule</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                                                            <span class="comment">//== Done</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                                            <span class="keywordflow">return</span> ( retArr );</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                                        }, <span class="stringliteral">&quot;This function gets the optimal translation vector and returns it as a numpy vector.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;staticStructure&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;eulA&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;eulB&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;eulG&quot;</span> ) )</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        .def                                          ( <span class="stringliteral">&quot;getOverlayTranslations&quot;</span>,</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                                        [] ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> &amp;<span class="keyword">self</span>, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* staticStructure , proshade_double eulA, proshade_double eulB, proshade_double eulG) -&gt; pybind11::dict</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                                        {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                                            <span class="comment">//== Get values</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                                            std::vector&lt; proshade_double &gt; vals = <span class="keyword">self</span>.getBestTranslationMapPeaksAngstrom ( staticStructure, eulA, eulB, eulG );</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                                            <span class="comment">//== Initialise variables</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                                            pybind11::dict retDict;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                                            pybind11::list rotCen, toOverlay;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                                            <span class="comment">//== Copy values</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                                                            rotCen.append ( <span class="keyword">self</span>.originalPdbRotCenX );</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                                                            rotCen.append ( <span class="keyword">self</span>.originalPdbRotCenY );</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                                            rotCen.append ( <span class="keyword">self</span>.originalPdbRotCenZ );</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                                            toOverlay.append ( <span class="keyword">self</span>.originalPdbTransX );</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                                            toOverlay.append ( <span class="keyword">self</span>.originalPdbTransX );</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                                            toOverlay.append ( <span class="keyword">self</span>.originalPdbTransX );</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                                            <span class="comment">//== Save results to return dict</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                                            retDict[ pybind11::handle ( pybind11::str ( <span class="stringliteral">&quot;centreOfRotation&quot;</span> ).ptr ( ) ) ] = rotCen;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                                            retDict[ pybind11::handle ( pybind11::str ( <span class="stringliteral">&quot;originToOverlay&quot;</span> ).ptr ( ) ) ] = toOverlay;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                                            <span class="comment">//== Done</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                                            <span class="keywordflow">return</span> ( retDict );</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                                                        }, <span class="stringliteral">&quot;This function returns the vector from optimal rotation centre to origin and the optimal overlay translation vector. These two vectors allow overlaying the inputs (see documentation for details on how the two vectors should be used).&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;staticStructure&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;eulA&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;eulB&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;eulG&quot;</span> ) )</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        .def                                          ( <span class="stringliteral">&quot;translateMap&quot;</span>, &amp;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aee34d26604c8922b427da61781a3eff6">ProSHADE_internal_data::ProSHADE_data::translateMap</a>, <span class="stringliteral">&quot;This function translates the map by a given number of Angstroms along the three axes. Please note the translation happens firstly to the whole map box and only the translation remainder that cannot be achieved by moving the box will be corrected for using reciprocal space translation within the box.&quot;</span>, pybind11::arg ( <span class="stringliteral">&quot;settings&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;trsX&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;trsY&quot;</span> ), pybind11::arg ( <span class="stringliteral">&quot;trsZ&quot;</span> ) )</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">//============================================ Description</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        .def                                          ( <span class="stringliteral">&quot;__repr__&quot;</span>, [] ( <span class="keyword">const</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> &amp;a ) { <span class="keywordflow">return</span> <span class="stringliteral">&quot;&lt;ProSHADE_data class object&gt; (This class contains all information, results and available functionalities for a structure)&quot;</span>; } );</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;}</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">//void                        ( ProSHADE_settings* settings, proshade_signed*&amp; ret );</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">//void createNewMapFromBounds                   ( ProSHADE_settings* settings, ProSHADE_data*&amp; newStr, proshade_signed* newBounds );</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">//void getRealSphericalHarmonicsForShell        ( proshade_unsign shellNo, proshade_signed verbose, double *sphericalHarmsReal, int len );</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">//void getImagSphericalHarmonicsForShell        ( proshade_unsign shellNo, proshade_signed verbose, double *sphericalHarmsImag, int len );</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">//int sphericalHarmonicsIndex                   ( proshade_signed order, proshade_signed band, proshade_signed shell );</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">//int getSphericalHarmonicsLenForShell          ( proshade_unsign shellNo, proshade_signed verbose );</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a7c88b1152378beca4ccee251f2fb5e06"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a7c88b1152378beca4ccee251f2fb5e06">ProSHADE_internal_mapManip::addExtraBoundSpace</a></div><div class="ttdeci">void addExtraBoundSpace(proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed *&amp;bounds, proshade_single extraSpace)</div><div class="ttdoc">This function takes a set of bounds and adds a given number of Angstroms to them.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01122">ProSHADE_mapManip.cpp:1122</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a23f9a5f8f6fb7cf0f0324bc1d83d6090"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23f9a5f8f6fb7cf0f0324bc1d83d6090">ProSHADE_internal_data::ProSHADE_data::computeSphericalHarmonics</a></div><div class="ttdeci">void computeSphericalHarmonics(ProSHADE_settings *settings)</div><div class="ttdoc">This function computes the spherical harmonics decomposition for the whole structure.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01680">ProSHADE_data.cpp:1680</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad409e4556676857224d1f5e00e5b7911"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad409e4556676857224d1f5e00e5b7911">ProSHADE_internal_data::ProSHADE_data::getOverlayRotationFunction</a></div><div class="ttdeci">void getOverlayRotationFunction(ProSHADE_settings *settings, ProSHADE_internal_data::ProSHADE_data *obj2)</div><div class="ttdoc">This function computes the overlay rotation function (i.e. the correlation function in SO(3) space).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00035">ProSHADE_overlay.cpp:35</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_af4d641d62864e4adf67c1365b0960970"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">ProSHADE_internal_data::ProSHADE_data::getZDimSize</a></div><div class="ttdeci">proshade_single getZDimSize(void)</div><div class="ttdoc">This function allows access to the map size in angstroms along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03550">ProSHADE_data.cpp:3550</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac7cb89ed871668c57a3b5dc953c20482"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac7cb89ed871668c57a3b5dc953c20482">ProSHADE_internal_data::ProSHADE_data::computeRotationFunction</a></div><div class="ttdeci">void computeRotationFunction(ProSHADE_settings *settings)</div><div class="ttdoc">This function computes the self-rotation function for this structure.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00034">ProSHADE_symmetry.cpp:34</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8e1bd5bd5a3fd12691a1d83735c13250"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e1bd5bd5a3fd12691a1d83735c13250">ProSHADE_internal_data::ProSHADE_data::getRecommendedSymmetryFold</a></div><div class="ttdeci">proshade_unsign getRecommendedSymmetryFold(ProSHADE_settings *settings)</div><div class="ttdoc">This function simply returns the detected recommended symmetry fold.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04167">ProSHADE_data.cpp:4167</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a633435d4c8a7fd6533016c00ad9ba791"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a633435d4c8a7fd6533016c00ad9ba791">ProSHADE_settings::boundsExtraSpace</a></div><div class="ttdeci">proshade_single boundsExtraSpace</div><div class="ttdoc">The number of extra angstroms to be added to all re-boxing bounds just for safety.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00137">ProSHADE_settings.hpp:137</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a618c04a2c1d7f0a506d0bb3d7a0da444"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">ProSHADE_settings::allDetectedDAxes</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; allDetectedDAxes</div><div class="ttdoc">The vector of all detected dihedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00191">ProSHADE_settings.hpp:191</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a51d7b9d87d536ef0c48d820872bc9185"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">ProSHADE_internal_data::ProSHADE_data::getXDimSize</a></div><div class="ttdeci">proshade_single getXDimSize(void)</div><div class="ttdoc">This function allows access to the map size in angstroms along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03530">ProSHADE_data.cpp:3530</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a></div><div class="ttdoc">This class contains all inputed and derived data for a single structure.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00048">ProSHADE_data.hpp:49</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae477e3c0d7b866e6069d8603950afe51"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">ProSHADE_internal_data::ProSHADE_data::getYDimSize</a></div><div class="ttdeci">proshade_single getYDimSize(void)</div><div class="ttdoc">This function allows access to the map size in angstroms along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03540">ProSHADE_data.cpp:3540</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a188b648a0ad28b598d682ca14f288dc4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a188b648a0ad28b598d682ca14f288dc4">ProSHADE_internal_data::ProSHADE_data::getSpherePositions</a></div><div class="ttdeci">void getSpherePositions(ProSHADE_settings *settings)</div><div class="ttdoc">This function determines the sphere positions (radii) for sphere mapping.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01580">ProSHADE_data.cpp:1580</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa67115a6b234764c958899863fb60b54"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa67115a6b234764c958899863fb60b54">ProSHADE_internal_data::ProSHADE_data::invertMirrorMap</a></div><div class="ttdeci">void invertMirrorMap(ProSHADE_settings *settings)</div><div class="ttdoc">Function for inverting the map to its mirror image.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00890">ProSHADE_data.cpp:890</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_abd9fe573a48f499dd7d1df4f779222f1"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a></div><div class="ttdeci">void getRotationMatrixFromEulerZXZAngles(proshade_double eulerAlpha, proshade_double eulerBeta, proshade_double eulerGamma, proshade_double *matrix)</div><div class="ttdoc">Function to find the rotation matrix from Euler angles (ZXZ convention).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01005">ProSHADE_maths.cpp:1005</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ae42ba1e294d1887c71b763f9bb5519cc"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">ProSHADE_settings::allDetectedTAxes</a></div><div class="ttdeci">std::vector&lt; proshade_unsign &gt; allDetectedTAxes</div><div class="ttdoc">The vector of all detected tetrahedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00192">ProSHADE_settings.hpp:192</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a4d869a528d0af64bc3688a9a48514061"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">ProSHADE_settings::allDetectedOAxes</a></div><div class="ttdeci">std::vector&lt; proshade_unsign &gt; allDetectedOAxes</div><div class="ttdoc">The vector of all detected octahedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00193">ProSHADE_settings.hpp:193</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a80ff45ef40549fb6a1d80b70865fc807"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a80ff45ef40549fb6a1d80b70865fc807">ProSHADE_internal_data::ProSHADE_data::centreMapOnCOM</a></div><div class="ttdeci">void centreMapOnCOM(ProSHADE_settings *settings)</div><div class="ttdoc">This function shits the map so that its COM is in the centre of the map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01366">ProSHADE_data.cpp:1366</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a89094c73ae033812d4df0bd846e03442"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">ProSHADE_settings::verbose</a></div><div class="ttdeci">proshade_signed verbose</div><div class="ttdoc">Should the software report on the progress, or just be quiet? Value between -1 (nothing) and 4 (loud)</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00185">ProSHADE_settings.hpp:185</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_ae273430e12dd5bce08cf29c7689800dd"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ae273430e12dd5bce08cf29c7689800dd">ProSHADE_internal_mapManip::beautifyBoundaries</a></div><div class="ttdeci">void beautifyBoundaries(proshade_signed *&amp;bounds, proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_signed boundsDiffThres, proshade_signed verbose)</div><div class="ttdoc">Function for modifying boundaries to a mathematically more pleasant values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01897">ProSHADE_mapManip.cpp:1897</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3bc44913222e67ab861dd1e5838c1ae1"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">ProSHADE_internal_data::ProSHADE_data::getXDim</a></div><div class="ttdeci">proshade_unsign getXDim(void)</div><div class="ttdoc">This function allows access to the map size in indices along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03560">ProSHADE_data.cpp:3560</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8089b5dceb60b2e4c2e65957e24d1f56"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8089b5dceb60b2e4c2e65957e24d1f56">ProSHADE_internal_data::ProSHADE_data::rotateMap</a></div><div class="ttdeci">void rotateMap(ProSHADE_settings *settings, proshade_double eulerAlpha, proshade_double eulerBeta, proshade_double eulerGamma)</div><div class="ttdoc">This function rotates a map based on the given Euler angles.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00736">ProSHADE_overlay.cpp:736</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a56bfcfacedabd84ec54aa2843d59e014"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a56bfcfacedabd84ec54aa2843d59e014">ProSHADE_internal_data::ProSHADE_data::mapToSpheres</a></div><div class="ttdeci">void mapToSpheres(ProSHADE_settings *settings)</div><div class="ttdoc">This function converts the internal map onto a set of concentric spheres.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01637">ProSHADE_data.cpp:1637</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a767640acbf4999201ce9ea86d76ff6a1"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a767640acbf4999201ce9ea86d76ff6a1">ProSHADE_internal_data::ProSHADE_data::computeTranslationMap</a></div><div class="ttdeci">void computeTranslationMap(ProSHADE_internal_data::ProSHADE_data *obj1)</div><div class="ttdoc">This function does the computation of the translation map and saves results internally.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00389">ProSHADE_overlay.cpp:389</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a81e6aab30488052e6bdd9b339e8124d8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a81e6aab30488052e6bdd9b339e8124d8">ProSHADE_internal_data::ProSHADE_data::writeMap</a></div><div class="ttdeci">void writeMap(std::string fName, std::string title=&quot;Created by ProSHADE and written by GEMMI&quot;, int mode=2)</div><div class="ttdoc">Function for writing out the internal structure representation in MRC MAP format.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00741">ProSHADE_data.cpp:741</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1eb216aaab1c44a29f8552ece206130a"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1eb216aaab1c44a29f8552ece206130a">ProSHADE_internal_data::ProSHADE_data::writePdb</a></div><div class="ttdeci">void writePdb(std::string fName, proshade_double euA=0.0, proshade_double euB=0.0, proshade_double euG=0.0, bool firstModel=true)</div><div class="ttdoc">This function writes out the PDB formatted file coresponding to the structure so that its COM is at s...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00802">ProSHADE_data.cpp:802</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a26c8be8b50be424bb35d3f6f39aa9aff"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a26c8be8b50be424bb35d3f6f39aa9aff">ProSHADE_internal_mapManip::getNonZeroBounds</a></div><div class="ttdeci">void getNonZeroBounds(proshade_double *map, proshade_signed xDim, proshade_signed yDim, proshade_signed zDim, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed *&amp;ret)</div><div class="ttdoc">Function for finding the map boundaries enclosing positive only values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01065">ProSHADE_mapManip.cpp:1065</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a50c884973add562558803a45991bbf19"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">ProSHADE_internal_data::ProSHADE_data::getYDim</a></div><div class="ttdeci">proshade_unsign getYDim(void)</div><div class="ttdoc">This function allows access to the map size in indices along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03570">ProSHADE_data.cpp:3570</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a0122be830893f5d82bab742be54d1ee7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0122be830893f5d82bab742be54d1ee7">ProSHADE_internal_data::ProSHADE_data::maskMap</a></div><div class="ttdeci">void maskMap(ProSHADE_settings *settings)</div><div class="ttdoc">Function for computing the map mask using blurring and X IQRs from median.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00991">ProSHADE_data.cpp:991</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a></div><div class="ttdoc">This class stores all the settings and is passed to the executive classes instead of a multitude of p...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00085">ProSHADE_settings.hpp:86</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afcb4202e9ffea1b99c59f73faf06d899"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afcb4202e9ffea1b99c59f73faf06d899">ProSHADE_internal_data::ProSHADE_data::processInternalMap</a></div><div class="ttdeci">void processInternalMap(ProSHADE_settings *settings)</div><div class="ttdoc">This function simply clusters several other functions which should be called together.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01536">ProSHADE_data.cpp:1536</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a034af93b9152fb2db675d5632a4ebc6d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">ProSHADE_internal_data::ProSHADE_data::getZDim</a></div><div class="ttdeci">proshade_unsign getZDim(void)</div><div class="ttdoc">This function allows access to the map size in indices along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03580">ProSHADE_data.cpp:3580</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a827e3241fa6401027e0526fffb8b281d"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a827e3241fa6401027e0526fffb8b281d">ProSHADE_settings::boundsSimilarityThreshold</a></div><div class="ttdeci">proshade_signed boundsSimilarityThreshold</div><div class="ttdoc">Number of indices which can be added just to make sure same size in indices is achieved.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00138">ProSHADE_settings.hpp:138</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ab573ea90a16991a06a77c5343328b060"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab573ea90a16991a06a77c5343328b060">ProSHADE_internal_data::ProSHADE_data::reSampleMap</a></div><div class="ttdeci">void reSampleMap(ProSHADE_settings *settings)</div><div class="ttdoc">This function changes the internal map sampling to conform to particular resolution value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01294">ProSHADE_data.cpp:1294</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aee34d26604c8922b427da61781a3eff6"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aee34d26604c8922b427da61781a3eff6">ProSHADE_internal_data::ProSHADE_data::translateMap</a></div><div class="ttdeci">void translateMap(ProSHADE_settings *settings, proshade_double trsX, proshade_double trsY, proshade_double trsZ)</div><div class="ttdoc">This function simply translates the map by a given number of Angstroms along the three axes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00795">ProSHADE_overlay.cpp:795</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_af556836aa9286c1571196de442a6b493"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a></div><div class="ttdeci">void checkMemoryAllocation(chVar checkVar, std::string fileP, unsigned int lineP, std::string funcP, std::string infoP=&quot;This error may occurs when ProSHADE requests memory to be\n                    : allocated to it and this operation fails. This could\n                    : happen when not enough memory is available, either due to\n                    : other processes using a lot of memory, or when the machine\n                    : does not have sufficient memory available. Re-run to see\n                    : if this problem persists.&quot;)</div><div class="ttdoc">Checks if memory was allocated properly.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8hpp_source.html#l00065">ProSHADE_misc.hpp:65</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_aa4957b0a47193ef1042028dc22b350f6"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">ProSHADE_settings::allDetectedIAxes</a></div><div class="ttdeci">std::vector&lt; proshade_unsign &gt; allDetectedIAxes</div><div class="ttdoc">The vector of all detected icosahedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00194">ProSHADE_settings.hpp:194</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_aa3e24ef5a66fa7204a2ba9c27f2f12b9"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#aa3e24ef5a66fa7204a2ba9c27f2f12b9">ProSHADE_settings::forceBounds</a></div><div class="ttdeci">proshade_signed * forceBounds</div><div class="ttdoc">These will be the boundaries to be forced upon the map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00140">ProSHADE_settings.hpp:140</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a42b012ec753ebd1d87a0b6f557e97d1a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">ProSHADE_settings::detectedSymmetry</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; detectedSymmetry</div><div class="ttdoc">The vector of detected symmetry axes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00189">ProSHADE_settings.hpp:189</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a16336bdf0b391c953a549d3df115d691"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a></div><div class="ttdeci">void addToUnsignVector(std::vector&lt; proshade_unsign &gt; *vecToAddTo, proshade_unsign elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00099">ProSHADE_misc.cpp:99</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a1f0d2cb45fee521ddb2d0bc30beff3ec"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a1f0d2cb45fee521ddb2d0bc30beff3ec">ProSHADE_settings::useSameBounds</a></div><div class="ttdeci">bool useSameBounds</div><div class="ttdoc">Switch to say that the same boundaries as used for the first should be used for all input maps.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00139">ProSHADE_settings.hpp:139</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad5add825ce8d5e5d9f598f6912f07aff"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5add825ce8d5e5d9f598f6912f07aff">ProSHADE_internal_data::ProSHADE_data::getRecommendedSymmetryType</a></div><div class="ttdeci">std::string getRecommendedSymmetryType(ProSHADE_settings *settings)</div><div class="ttdoc">This function simply returns the detected recommended symmetry type.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04156">ProSHADE_data.cpp:4156</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ab8d152f5e2e5dc0a64048d2e9c0d8d12"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ab8d152f5e2e5dc0a64048d2e9c0d8d12">ProSHADE_settings::usePeakSearchInRotationFunctionSpace</a></div><div class="ttdeci">bool usePeakSearchInRotationFunctionSpace</div><div class="ttdoc">This variable switch decides whether symmetry detection will be done using peak search in rotation fu...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00176">ProSHADE_settings.hpp:176</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a255bdb77824ce0fddc2454d5823219e1"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a255bdb77824ce0fddc2454d5823219e1">ProSHADE_internal_data::ProSHADE_data::normaliseMap</a></div><div class="ttdeci">void normaliseMap(ProSHADE_settings *settings)</div><div class="ttdoc">Function for normalising the map values to mean 0 and sd 1..</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00944">ProSHADE_data.cpp:944</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a2ac59de43dacdd96c7f89811f80d2e7e"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">ProSHADE_settings::allDetectedCAxes</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; allDetectedCAxes</div><div class="ttdoc">The vector of all detected cyclic symmetry axes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00190">ProSHADE_settings.hpp:190</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5919acc2f26efcf373db47ed96eadc38"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5919acc2f26efcf373db47ed96eadc38">ProSHADE_internal_data::ProSHADE_data::removePhaseInormation</a></div><div class="ttdeci">void removePhaseInormation(ProSHADE_settings *settings)</div><div class="ttdoc">This function removes phase from the map, effectively converting it to Patterson map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03297">ProSHADE_data.cpp:3297</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a0cdec5190d4b2ae60350f0f6db751d4b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0cdec5190d4b2ae60350f0f6db751d4b">ProSHADE_internal_data::ProSHADE_data::zeroPaddToDims</a></div><div class="ttdeci">void zeroPaddToDims(proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim)</div><div class="ttdoc">This function changes the size of a structure to fit the supplied new limits.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00598">ProSHADE_overlay.cpp:598</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a59f2f2ce1bfdb90432c5a29600fdd9e6"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59f2f2ce1bfdb90432c5a29600fdd9e6">ProSHADE_internal_data::ProSHADE_data::readInStructure</a></div><div class="ttdeci">void readInStructure(std::string fName, proshade_unsign inputO, ProSHADE_settings *settings)</div><div class="ttdoc">This function initialises the basic ProSHADE_data variables and reads in a single structure.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00447">ProSHADE_data.cpp:447</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a7a402c710af1af5fabf7505848dad047"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7a402c710af1af5fabf7505848dad047">ProSHADE_internal_data::ProSHADE_data::addExtraSpace</a></div><div class="ttdeci">void addExtraSpace(ProSHADE_settings *settings)</div><div class="ttdoc">This function increases the size of the map so that it can add empty space around it.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01427">ProSHADE_data.cpp:1427</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_5c0d64f70903e893b1efe571a4b8de29.html">python</a></li><li class="navelem"><b>pyProSHADE_data.cpp</b></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
