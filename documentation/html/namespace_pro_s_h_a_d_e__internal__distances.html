<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ProSHADE: ProSHADE_internal_distances Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ProSHADE
   &#160;<span id="projectnumber">0.7.3 (JUL 2020) - EXPERIMENTAL</span>
   </div>
   <div id="projectbrief">Protein Shape Detection</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespace_pro_s_h_a_d_e__internal__distances.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ProSHADE_internal_distances Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This namespace contains the functions used for computing distances between two structures as represented by the ProSHADE_data class.  
<a href="namespace_pro_s_h_a_d_e__internal__distances.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1a977a344baa3b1697743060789bceb5"><td class="memItemLeft" align="right" valign="top">proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#a1a977a344baa3b1697743060789bceb5">computeEnergyLevelsDescriptor</a> (<a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj1, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj2, <a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a1a977a344baa3b1697743060789bceb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the energy levels descriptor value between two objects.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#a1a977a344baa3b1697743060789bceb5">More...</a><br /></td></tr>
<tr class="separator:a1a977a344baa3b1697743060789bceb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e15740000a0079151a2d24dbbdebb2e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#a6e15740000a0079151a2d24dbbdebb2e">isBandWithinShell</a> (proshade_unsign bandInQuestion, proshade_unsign shellInQuestion, <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html">ProSHADE_internal_spheres::ProSHADE_sphere</a> **spheres)</td></tr>
<tr class="memdesc:a6e15740000a0079151a2d24dbbdebb2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks if a band is available for a given shell.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#a6e15740000a0079151a2d24dbbdebb2e">More...</a><br /></td></tr>
<tr class="separator:a6e15740000a0079151a2d24dbbdebb2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acde4bb62c09903a347ecde6f0a5302b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#acde4bb62c09903a347ecde6f0a5302b1">computeRRPPearsonCoefficients</a> (<a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj1, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj2, <a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, proshade_unsign minCommonBands, proshade_unsign minCommonShells, std::vector&lt; proshade_double &gt; *bandDists)</td></tr>
<tr class="memdesc:acde4bb62c09903a347ecde6f0a5302b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function gets the Pearson's coefficients or all bands between two objects.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#acde4bb62c09903a347ecde6f0a5302b1">More...</a><br /></td></tr>
<tr class="separator:acde4bb62c09903a347ecde6f0a5302b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a365752e40ab7c1f09fb4b31827a43dba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#a365752e40ab7c1f09fb4b31827a43dba">allocateTrSigmaWorkspace</a> (proshade_unsign minSpheres, proshade_unsign intOrder, proshade_double *&amp;obj1Vals, proshade_double *&amp;obj2Vals, proshade_double *&amp;GLabscissas, proshade_double *&amp;glWeights, proshade_complex *&amp;radiiVals)</td></tr>
<tr class="memdesc:a365752e40ab7c1f09fb4b31827a43dba"><td class="mdescLeft">&#160;</td><td class="mdescRight">This helper function is responsible for allocating the workspace memory required for trace sigma descriptor computation.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#a365752e40ab7c1f09fb4b31827a43dba">More...</a><br /></td></tr>
<tr class="separator:a365752e40ab7c1f09fb4b31827a43dba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22db876a8cca08073f4db031996f537b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#a22db876a8cca08073f4db031996f537b">computeSphericalHarmonicsMagnitude</a> (<a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj, proshade_unsign band, proshade_unsign order, proshade_unsign radius, proshade_double *result)</td></tr>
<tr class="memdesc:a22db876a8cca08073f4db031996f537b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the magnitude of a particular spherical harmonics position for a given object, weighting it by the radius^2 (for integration).  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#a22db876a8cca08073f4db031996f537b">More...</a><br /></td></tr>
<tr class="separator:a22db876a8cca08073f4db031996f537b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ed62a245d4fa9750f98b60d755b61c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#a8ed62a245d4fa9750f98b60d755b61c1">computeEMatricesForLM</a> (<a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj1, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj2, proshade_unsign bandIter, proshade_unsign orderIter, proshade_complex *radiiVals, proshade_unsign integOrder, proshade_double *abscissas, proshade_double *weights, proshade_double integRange, proshade_double sphereDist)</td></tr>
<tr class="memdesc:a8ed62a245d4fa9750f98b60d755b61c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the E matrix un-weighted values for a given band and order and saves these into the obj2 parameter.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#a8ed62a245d4fa9750f98b60d755b61c1">More...</a><br /></td></tr>
<tr class="separator:a8ed62a245d4fa9750f98b60d755b61c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac086a02b5fd1fb0b32c2084a01aa927d"><td class="memItemLeft" align="right" valign="top">proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#ac086a02b5fd1fb0b32c2084a01aa927d">computeWeightsForEMatricesForLM</a> (<a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj1, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj2, proshade_unsign bandIter, proshade_unsign orderIter, proshade_double *obj1Vals, proshade_double *obj2Vals, proshade_unsign integOrder, proshade_double *abscissas, proshade_double *weights, proshade_double sphereDist)</td></tr>
<tr class="memdesc:ac086a02b5fd1fb0b32c2084a01aa927d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the E matrix weight values for a given band and order and saves these into the appropriate objects.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#ac086a02b5fd1fb0b32c2084a01aa927d">More...</a><br /></td></tr>
<tr class="separator:ac086a02b5fd1fb0b32c2084a01aa927d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dd86bf34be4f3398a83a4865738ddf2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#a3dd86bf34be4f3398a83a4865738ddf2">releaseTrSigmaWorkspace</a> (proshade_double *&amp;obj1Vals, proshade_double *&amp;obj2Vals, proshade_double *&amp;GLabscissas, proshade_double *&amp;glWeights, proshade_complex *&amp;radiiVals)</td></tr>
<tr class="memdesc:a3dd86bf34be4f3398a83a4865738ddf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This helper function is responsible for deleting the workspace memory required for trace sigma descriptor computation.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#a3dd86bf34be4f3398a83a4865738ddf2">More...</a><br /></td></tr>
<tr class="separator:a3dd86bf34be4f3398a83a4865738ddf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add48230d67bd69305df058d29a588507"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#add48230d67bd69305df058d29a588507">computeEMatrices</a> (<a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj1, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj2, <a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:add48230d67bd69305df058d29a588507"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the complete E matrices and their weights between any two objects.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#add48230d67bd69305df058d29a588507">More...</a><br /></td></tr>
<tr class="separator:add48230d67bd69305df058d29a588507"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac96ff1a23997199af76e58885a1ee1e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#ac96ff1a23997199af76e58885a1ee1e2">normaliseEMatrices</a> (<a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj1, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj2, <a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:ac96ff1a23997199af76e58885a1ee1e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function normalises the E matrices.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#ac96ff1a23997199af76e58885a1ee1e2">More...</a><br /></td></tr>
<tr class="separator:ac96ff1a23997199af76e58885a1ee1e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34bad8d846082de4dc61870d67e762cf"><td class="memItemLeft" align="right" valign="top">proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#a34bad8d846082de4dc61870d67e762cf">computeTraceSigmaDescriptor</a> (<a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj1, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj2, <a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a34bad8d846082de4dc61870d67e762cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the trace sigma descriptor value between two objects.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#a34bad8d846082de4dc61870d67e762cf">More...</a><br /></td></tr>
<tr class="separator:a34bad8d846082de4dc61870d67e762cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afacb5240b508ea28b64cacf395b47dba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#afacb5240b508ea28b64cacf395b47dba">generateSO3CoeffsFromEMatrices</a> (<a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj1, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj2, <a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:afacb5240b508ea28b64cacf395b47dba"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function converts the E matrices to SO(3) coefficients.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#afacb5240b508ea28b64cacf395b47dba">More...</a><br /></td></tr>
<tr class="separator:afacb5240b508ea28b64cacf395b47dba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf3050bb282928f5c1639dcdf2b3261f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#adf3050bb282928f5c1639dcdf2b3261f">allocateInvSOFTWorkspaces</a> (proshade_complex *&amp;work1, proshade_complex *&amp;work2, proshade_double *&amp;work3, proshade_unsign band)</td></tr>
<tr class="memdesc:adf3050bb282928f5c1639dcdf2b3261f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allocates the workspaces required to compute the inverse SOFT transform.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#adf3050bb282928f5c1639dcdf2b3261f">More...</a><br /></td></tr>
<tr class="separator:adf3050bb282928f5c1639dcdf2b3261f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a46703d08283073826820000007ec05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#a7a46703d08283073826820000007ec05">prepareInvSOFTPlan</a> (fftw_plan *inverseSO3, proshade_unsign band, fftw_complex *work1, proshade_complex *invCoeffs)</td></tr>
<tr class="memdesc:a7a46703d08283073826820000007ec05"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function prepares the FFTW plan for the inverse SO(3) transform.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#a7a46703d08283073826820000007ec05">More...</a><br /></td></tr>
<tr class="separator:a7a46703d08283073826820000007ec05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7d8c822491454700995e0f1bc702e48"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#ad7d8c822491454700995e0f1bc702e48">releaseInvSOFTMemory</a> (proshade_complex *&amp;work1, proshade_complex *&amp;work2, proshade_double *&amp;work3)</td></tr>
<tr class="memdesc:ad7d8c822491454700995e0f1bc702e48"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function releases the memory used for computation of the inverse SOFT transform.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#ad7d8c822491454700995e0f1bc702e48">More...</a><br /></td></tr>
<tr class="separator:ad7d8c822491454700995e0f1bc702e48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cdde76bf20d9cd5d756ffde2d3dc854"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#a3cdde76bf20d9cd5d756ffde2d3dc854">computeInverseSOFTTransform</a> (<a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj1, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj2, <a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a3cdde76bf20d9cd5d756ffde2d3dc854"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the inverse SO(3) transform.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#a3cdde76bf20d9cd5d756ffde2d3dc854">More...</a><br /></td></tr>
<tr class="separator:a3cdde76bf20d9cd5d756ffde2d3dc854"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f062b77c4b5360a17249e74e6a15538"><td class="memItemLeft" align="right" valign="top">proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html#a0f062b77c4b5360a17249e74e6a15538">computeRotationunctionDescriptor</a> (<a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj1, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj2, <a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a0f062b77c4b5360a17249e74e6a15538"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the rotation function descriptor value between two objects.  <a href="namespace_pro_s_h_a_d_e__internal__distances.html#a0f062b77c4b5360a17249e74e6a15538">More...</a><br /></td></tr>
<tr class="separator:a0f062b77c4b5360a17249e74e6a15538"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This namespace contains the functions used for computing distances between two structures as represented by the ProSHADE_data class. </p>
<p>The <a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html" title="This namespace contains the functions used for computing distances between two structures as represen...">ProSHADE_internal_distances</a> namespace contains all the functionality required to compute distances between two or more ProSHADE_data objects and also all of the pre-computation functions. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="adf3050bb282928f5c1639dcdf2b3261f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf3050bb282928f5c1639dcdf2b3261f">&#9670;&nbsp;</a></span>allocateInvSOFTWorkspaces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_distances::allocateInvSOFTWorkspaces </td>
          <td>(</td>
          <td class="paramtype">proshade_complex *&amp;&#160;</td>
          <td class="paramname"><em>work1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_complex *&amp;&#160;</td>
          <td class="paramname"><em>work2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>work3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>band</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allocates the workspaces required to compute the inverse SOFT transform. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">work1</td><td>The first workspace pointer to be allocated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">work2</td><td>The second workspace pointer to be allocated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">work3</td><td>The third workspace pointer to be allocated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The bandwidth of the computations (this determines how much workspace will be required). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00767">767</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;{</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="comment">//================================================ Allocate memory</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    work1                                             = <span class="keyword">new</span> proshade_complex[8  * <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( pow( <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( band ), 3.0 ) )];</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    work2                                             = <span class="keyword">new</span> proshade_complex[14 * <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( pow( <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( band ), 2.0 ) ) + (48 * band)];</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    work3                                             = <span class="keyword">new</span> proshade_double [2  * <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( pow( <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( band ), 2.0 ) ) + (24 * band)];</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="comment">//================================================ Check the memory allocation</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( work1, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( work2, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( work3, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    return ;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a365752e40ab7c1f09fb4b31827a43dba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a365752e40ab7c1f09fb4b31827a43dba">&#9670;&nbsp;</a></span>allocateTrSigmaWorkspace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_distances::allocateTrSigmaWorkspace </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>minSpheres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>intOrder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>obj1Vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>obj2Vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>GLabscissas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>GLweights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_complex *&amp;&#160;</td>
          <td class="paramname"><em>radiiVals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This helper function is responsible for allocating the workspace memory required for trace sigma descriptor computation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">minSpheres</td><td>The minima of the number of spheres available in the compared objects. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">intOrder</td><td>The integration order for the computation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj1Vals</td><td>Array to hold the shell values for the first object integgration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj2Vals</td><td>Array to hold the shell values for the second object integgration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">GLabscissas</td><td>An array to hold the pre-computed anscissas for the Gauss-Legendre integration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">glWeights</td><td>An array to hold the pre-computed weights for the Gauss-Legendre integration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">radiiVals</td><td>A complex array to hold the results of combining spherical harmonics coefficients of the two objects for each shell. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00317">317</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;{</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">//================================================ Allocate the memory</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    obj1Vals                                          = <span class="keyword">new</span> proshade_double [minSpheres];</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    obj2Vals                                          = <span class="keyword">new</span> proshade_double [minSpheres];</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    radiiVals                                         = <span class="keyword">new</span> proshade_complex[minSpheres];</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    GLabscissas                                       = <span class="keyword">new</span> proshade_double [intOrder];</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    GLweights                                         = <span class="keyword">new</span> proshade_double [intOrder];</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">//================================================ Check the memory allocation</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( obj1Vals, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( obj2Vals, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( radiiVals, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( GLabscissas, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( GLweights, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    return ;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="add48230d67bd69305df058d29a588507"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add48230d67bd69305df058d29a588507">&#9670;&nbsp;</a></span>computeEMatrices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_distances::computeEMatrices </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the complete E matrices and their weights between any two objects. </p>
<p>This function allocates the space required for storing the E matrices, allocates all the workspace requierd for the computation and proceeds to compute the values for all band (l), order1(m) and order2(m') E matrix values. It then proceeds to release all non required memory and terminates, leaving all its results in the second ProSHADE data object supplied. This function does NOT apply the weights to the matrices, it needs to be done subsequently!</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">obj1</td><td>The first ProSHADE_data object for which the computation is done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj2</td><td>The second ProSHADE_data object for which the computation is done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for the task. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00515">515</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;{</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Starting computation of E matrices.&quot;</span> );</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">//================================================ Allocatre memory for E matrices in the second object (first may be compared to more structures and therefore its data would be written over)</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af42a5957efa2e6ec057059bd7c080eaf">allocateEMatrices</a>                           ( settings, std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ) );</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    proshade_double *obj1Vals, *obj2Vals, *GLAbscissas, *GLWeights;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    proshade_complex* radiiVals;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    proshade_double integRange;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">//================================================ Allocate workspace memory</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#a365752e40ab7c1f09fb4b31827a43dba">allocateTrSigmaWorkspace</a>                          ( std::min( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">getMaxSpheres</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">getMaxSpheres</a>() ), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#af696bcba16302fe3a42e0341b4c5415a">integOrder</a>, obj1Vals, obj2Vals, GLAbscissas, GLWeights,  radiiVals);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">//================================================ Initialise abscissas and weights for integration</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a6e2f7de1bba288270ce2cc772d28d065">ProSHADE_internal_maths::getLegendreAbscAndWeights</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#af696bcba16302fe3a42e0341b4c5415a">integOrder</a>, GLAbscissas, GLWeights, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#abebc53842ab9dd92685f66c950a2fc44">taylorSeriesCap</a> );</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">//================================================ For each band (l), compute the E matrix integrals</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign bandIter = 0; bandIter &lt; std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ); bandIter++ )</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="comment">//============================================ For each order (m)</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign orderIter = 0; orderIter &lt; ( ( bandIter * 2 ) + 1 ); orderIter++ )</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="comment">//======================================== Get weights for the required band(l) and order (m)</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            integRange                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#ac086a02b5fd1fb0b32c2084a01aa927d">computeWeightsForEMatricesForLM</a> ( obj1, obj2, bandIter, orderIter, obj1Vals, obj2Vals, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#af696bcba16302fe3a42e0341b4c5415a">integOrder</a>, GLAbscissas, GLWeights, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42e4b11981a2d3a518cb3c70e5470fb2">maxSphereDists</a> );</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="comment">//======================================== Compute E matrices value for given band (l) and order(m)</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#a8ed62a245d4fa9750f98b60d755b61c1">computeEMatricesForLM</a>                     ( obj1, obj2, bandIter, orderIter, radiiVals, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#af696bcba16302fe3a42e0341b4c5415a">integOrder</a>, GLAbscissas, GLWeights, integRange, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42e4b11981a2d3a518cb3c70e5470fb2">maxSphereDists</a> );</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a> &gt; 3 )</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            std::stringstream hlpSS;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            hlpSS &lt;&lt; <span class="stringliteral">&quot;E matrices computed for band &quot;</span> &lt;&lt; bandIter;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, hlpSS.str() );</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">//================================================ Release the workspace memory</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#a3dd86bf34be4f3398a83a4865738ddf2">releaseTrSigmaWorkspace</a>                           ( obj1Vals, obj2Vals, GLAbscissas, GLWeights, radiiVals );</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, <span class="stringliteral">&quot;E matrices computed.&quot;</span> );</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    return ;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ed62a245d4fa9750f98b60d755b61c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ed62a245d4fa9750f98b60d755b61c1">&#9670;&nbsp;</a></span>computeEMatricesForLM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_distances::computeEMatricesForLM </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>bandIter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>orderIter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_complex *&#160;</td>
          <td class="paramname"><em>radiiVals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>integOrder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>abscissas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>integRange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>sphereDist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the E matrix un-weighted values for a given band and order and saves these into the obj2 parameter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">obj1</td><td>The ProSHADE_data object for which the comparison is done in regards to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj2</td><td>The ProSHADE_data object for which the comparison is done in regards from - the E matrices will be saved into this object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The bandwidth of the SH value for which this should be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order</td><td>The order of the SH value for which this should be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">radiiVals</td><td>Already allocated array of proshade_complex to which integrated values will be saved. It must have size equal to minimum of spheres in the two compared objects. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">integOrder</td><td>The Gauss-Legendre integration order to be used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">abscissas</td><td>The pre-computed abscissas for the Gauss-Legendre integration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weights</td><td>The pre-computed weights for the Gauss-Legendre integration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">integRange</td><td>The range in angstroms between the smalleds and largest shell which are integrated over (might not be 0 to max for progressive shell sampling). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sphereDist</td><td>The distance between any two spheres. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00375">375</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;{</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    proshade_unsign objCombValsIter                   = 0;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    proshade_double hlpReal, hlpImag;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    proshade_complex arrVal;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">//================================================ For each combination of m and m&#39; for E matrices</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign order2Iter = 0; order2Iter &lt; ( ( bandIter * 2 ) + 1 ); order2Iter++ )</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="comment">//============================================ Reset loop</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        objCombValsIter                               = 0;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="comment">//============================================ Find the c*conj(c) values for different radii</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign radiusIter = 0; radiusIter &lt; std::min( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">getMaxSpheres</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">getMaxSpheres</a>() ); radiusIter++ )</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="comment">//======================================== Get only values where the shell has the band</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            <span class="keywordflow">if</span> ( std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a898b48c1135e7a37f64f55e2367f0391">getShellBandwidth</a> ( radiusIter ), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a898b48c1135e7a37f64f55e2367f0391">getShellBandwidth</a> ( radiusIter ) ) &lt;= bandIter ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="comment">//======================================== Multiply coeffs</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ca5a3aedba75f52aaf707edc4e790f7">ProSHADE_internal_maths::complexMultiplicationConjug</a> ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5c0df68cd21b4f56abd1008065ca3573">getRealSphHarmValue</a> ( bandIter, orderIter,  radiusIter ),</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                                                   obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae8444b6c9ca3207d32bbf2a68c7b610">getImagSphHarmValue</a> ( bandIter, orderIter,  radiusIter ),</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                                                   obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5c0df68cd21b4f56abd1008065ca3573">getRealSphHarmValue</a> ( bandIter, order2Iter, radiusIter ),</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                                                   obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae8444b6c9ca3207d32bbf2a68c7b610">getImagSphHarmValue</a> ( bandIter, order2Iter, radiusIter ),</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                                                  &amp;hlpReal, &amp;hlpImag );</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="comment">//======================================== Apply r^2 integral weight</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            radiiVals[objCombValsIter][0]             = hlpReal *  pow ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23620b34a604aca7db4d8b21f6d2d09a">getAnySphereRadius</a>( radiusIter ) ) ), 2.0 );</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            radiiVals[objCombValsIter][1]             = hlpImag *  pow ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23620b34a604aca7db4d8b21f6d2d09a">getAnySphereRadius</a>( radiusIter ) ) ), 2.0 );</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            objCombValsIter                          += 1;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="comment">//============================================ Integrate over all radii using n-point Gauss-Legendre integration</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a3d4604176a61820f5fcb95e372861c1d">ProSHADE_internal_maths::gaussLegendreIntegration</a> ( radiiVals, objCombValsIter, integOrder, abscissas, weights, integRange, sphereDist, &amp;hlpReal, &amp;hlpImag );</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="comment">//============================================ Save the result into E matrices</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        arrVal[0]                                     = hlpReal;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        arrVal[1]                                     = hlpImag;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5af5c8c3b18275e65ae4ebacd9877c">setEMatrixValue</a>                         ( bandIter, orderIter, order2Iter, arrVal );</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    return ;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a977a344baa3b1697743060789bceb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a977a344baa3b1697743060789bceb5">&#9670;&nbsp;</a></span>computeEnergyLevelsDescriptor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double ProSHADE_internal_distances::computeEnergyLevelsDescriptor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the energy levels descriptor value between two objects. </p>
<p>This function is where the enery levels descriptor computation is controlled and done from. It starts by making sure that both input data objects have the RRP matrices computed and then it proceeds to compute the Pearson's coefficients for each band, finally averaging the band values and returning the descriptos.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">obj1</td><td>The first ProSHADE_data object against which comparison is done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj2</td><td>The second ProSHADE_data object which is compared to the first. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for the task. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00165">165</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;{</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">//================================================ Report starting the task</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting energy levels distance computation.&quot;</span> );</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    proshade_double ret                               = 0.0;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    std::vector&lt;proshade_double&gt; bandDists;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> ( !settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a23a96d41d415195813dd3237ae47b614">computeEnergyLevelsDesc</a> )</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Attempted computing energy levels descriptors when it was not required.&quot;</span>, <span class="stringliteral">&quot;ED00017&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;Attempted to pre-compute the RRP matrices, when the user\n                    : has specifically stated that these should not be computed.\n                    : Unless you manipulated the code, this error should never\n                    : occur; if you see this, I made a large blunder. Please let\n                    : me know!&quot;</span> );</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">//================================================ Get the RRP matrices for both objects</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6db2dcf87a6f763909ab08201e8de550">computeRRPMatrices</a>                          ( settings );</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6db2dcf87a6f763909ab08201e8de550">computeRRPMatrices</a>                          ( settings );</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">//================================================ Find the minimium comparable shells and bands</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    proshade_unsign minCommonShells                   = std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">getMaxSpheres</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">getMaxSpheres</a>() );</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    proshade_unsign minCommonBands                    = std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>(),    obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>()    );</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">//================================================ Get the Pearson&#39;s coefficients for each common band</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#acde4bb62c09903a347ecde6f0a5302b1">computeRRPPearsonCoefficients</a>                     ( obj1, obj2, settings, minCommonBands, minCommonShells, &amp;bandDists );</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">//================================================ Get distance (by averaging Patterson&#39;s coefficients)</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    ret                                               = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( std::accumulate ( bandDists.begin(), bandDists.end(), 0.0 ) ) /</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                                                                       <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( bandDists.size() );</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Energy levels distance computation complete.&quot;</span> );</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3cdde76bf20d9cd5d756ffde2d3dc854"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cdde76bf20d9cd5d756ffde2d3dc854">&#9670;&nbsp;</a></span>computeInverseSOFTTransform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_distances::computeInverseSOFTTransform </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the inverse SO(3) transform. </p>
<p>This function firstly allocates all the required workspaces for the inverse SO(3) Fourier Transform, then it prepares the FFTW plans for performing the FFTW inverse Fourier transform in the SO(3) space using FFTW and finally it subjects the SO(3) coeffficients available at this point to the computation. The results are saved into the second object, memory is released and function terminates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">obj1</td><td>The first ProSHADE_data object against which comparison is done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj2</td><td>The second ProSHADE_data object which is compared to the first. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for the task. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00860">860</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;{</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Computing inverse SO(3) Fourier transform.&quot;</span> );</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    proshade_complex *workspace1, *workspace2;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    proshade_double *workspace3;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    fftw_plan inverseSO3;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">//================================================ Allocate memory for the workspaces</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#adf3050bb282928f5c1639dcdf2b3261f">allocateInvSOFTWorkspaces</a>                         ( workspace1, workspace2, workspace3, std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ) );</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="comment">//================================================ Prepare the FFTW plan</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#a7a46703d08283073826820000007ec05">prepareInvSOFTPlan</a>                                ( &amp;inverseSO3, std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ), workspace1, obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">getInvSO3Coeffs</a> ( ) );</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="comment">//================================================ Compute the transform</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    Inverse_SO3_Naive_fftw                            ( std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ),</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                                                        obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae5c9c45b0db1e6a9eeef2ba292fbbcc3">getSO3Coeffs</a> ( ),</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                                                        obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">getInvSO3Coeffs</a> ( ),</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                                                        workspace1,</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                                                        workspace2,</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                                                        workspace3,</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                                                       &amp;inverseSO3,</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                                                        0 );</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#ad7d8c822491454700995e0f1bc702e48">releaseInvSOFTMemory</a>                              ( workspace1, workspace2, workspace3 );</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    fftw_destroy_plan                                 ( inverseSO3 );</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, <span class="stringliteral">&quot;Inverse SO(3) Fourier transform computed.&quot;</span> );</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    return ;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0f062b77c4b5360a17249e74e6a15538"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f062b77c4b5360a17249e74e6a15538">&#9670;&nbsp;</a></span>computeRotationunctionDescriptor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double ProSHADE_internal_distances::computeRotationunctionDescriptor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the rotation function descriptor value between two objects. </p>
<p>This function starts by sanity checks and computation and normalisation of the E matrices used for the trace sigma descriptor (these only need to be computed if trace sigma descriptor is NOT computed, otherwise the stored values are used to save time). It then converts the E matrix values to SO(3) transform coefficients and invers these using the SOFT library. From the resulting rotation function map, it selects the highest peak and applies its rotation to the E matrix values. The resulting values are simply summed, as this sum can be proven to be the argmin of the distance between the two objects in their spherical harmonics decomposition space.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">obj1</td><td>The first ProSHADE_data object against which comparison is done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj2</td><td>The second ProSHADE_data object which is compared to the first. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for the task. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>The final normalised value of the rotation function descriptor for the two objects. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00912">912</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;{</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="comment">//================================================ Report starting the task</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting rotation function distance computation.&quot;</span> );</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">//================================================ Initialise return variable</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    proshade_double ret                               = 0.0;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    proshade_double eulA, eulB, eulG, EMatR, EMatI, WigDR, WigDI;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">if</span> ( !settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4ee1d1392407d1317274a793186129aa">computeRotationFuncDesc</a> )</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Attempted computing rotation function descriptors when it\n                    : was not required.&quot;</span>, <span class="stringliteral">&quot;ED00023&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;Attempted to compute the SO(3) transform and the rotation \n                    : function descriptor when the user did not request this. \n                    : Unless you manipulated the code, this error should never \n                    : occur; if you see this, I made a large blunder. \n                    : Please let me know!&quot;</span> );</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="comment">//================================================ Compute weighted E matrices if not already present</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordflow">if</span> ( !settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a48bff4bebb6268c286b68bfd6663d954">computeTraceSigmaDesc</a> )</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#add48230d67bd69305df058d29a588507">computeEMatrices</a>                              ( obj1, obj2, settings );</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#ac96ff1a23997199af76e58885a1ee1e2">normaliseEMatrices</a>                            ( obj1, obj2, settings );</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="comment">//================================================ Generate SO(3) coefficients</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#afacb5240b508ea28b64cacf395b47dba">generateSO3CoeffsFromEMatrices</a>                    ( obj1, obj2, settings );</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="comment">//================================================ Compute the inverse SO(3) Fourier Transform (SOFT) on the newly computed coefficients</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#a3cdde76bf20d9cd5d756ffde2d3dc854">computeInverseSOFTTransform</a>                       ( obj1, obj2, settings );</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="comment">//================================================ Get inverse SO(3) map top peak Euler angle values</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__peak_search.html#ae8a54558e9c9c28568c441a601811449">ProSHADE_internal_peakSearch::getBestPeakEulerAngsNaive</a> ( obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">getInvSO3Coeffs</a> (),</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                                                              std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ) * 2,</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                                                             &amp;eulA, &amp;eulB, &amp;eulG, settings );</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="comment">//================================================ Compute the Wigner D matrices for the Euler angles</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__wigner.html#aba7b804497a1f100d527198e88fab2b8">ProSHADE_internal_wigner::computeWignerMatricesForRotation</a> ( settings, obj2, eulA, eulB, eulG );</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="comment">//================================================ Compute the distance</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign bandIter = 0; bandIter &lt; obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6cc2b8e179a137adda234e0ba0f9d27b">getComparisonBand</a>(); bandIter++ )</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="comment">//============================================ For each order1</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign order1 = 0; order1 &lt; ( ( bandIter * 2 ) + 1 ); order1++ )</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            <span class="comment">//======================================== For each order2</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign order2 = 0; order2 &lt; ( ( bandIter * 2 ) + 1 ); order2++ )</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            {</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                <span class="comment">//==================================== Multiply D_{l} * E_{l} and get sum over l of traces (i.e. just sum all together)</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab053362f9dc5422244ccfbafd9f00ff8">getEMatrixValue</a>                 ( bandIter, order1, order2, &amp;EMatR, &amp;EMatI );</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5999f7181bd3509454966f8271ac39d6">getWignerMatrixValue</a>            ( bandIter, order2, order1, &amp;WigDR, &amp;WigDI );</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                ret                                  += <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ac9b05344ffead449c29a333a57b404f6">ProSHADE_internal_maths::complexMultiplicationRealOnly</a> ( &amp;WigDR, &amp;WigDI, &amp;EMatR, &amp;EMatI );</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            }</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Rotation function distance computation complete.&quot;</span> );</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acde4bb62c09903a347ecde6f0a5302b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acde4bb62c09903a347ecde6f0a5302b1">&#9670;&nbsp;</a></span>computeRRPPearsonCoefficients()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_distances::computeRRPPearsonCoefficients </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>minCommonBands</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>minCommonShells</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double &gt; *&#160;</td>
          <td class="paramname"><em>bandDists</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function gets the Pearson's coefficients or all bands between two objects. </p>
<p>This function takes two data objects with their RRP matrices computed and proceeds to compute the Pearson's correlation coefficient for each band, saving it into the supplied vector.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">obj1</td><td>The first ProSHADE_data object against which comparison is done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj2</td><td>The second ProSHADE_data object which is compared to the first. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for the task. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">minCommonBands</td><td>The number of common bands between the two objects. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">minCommonShells</td><td>The index of highest common shell in both objects. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bandDists</td><td>Empty vector of proshade_doubles to which the Pearson's Coefficients will be saved for each band. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00215">215</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;{</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Correlating RRP matrices.&quot;</span> );</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    proshade_double *str1Vals                         = <span class="keyword">new</span> proshade_double[minCommonShells * minCommonShells];</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    proshade_double *str2Vals                         = <span class="keyword">new</span> proshade_double[minCommonShells * minCommonShells];</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( str1Vals, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( str2Vals, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    proshade_unsign arrIter                           = 0;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">//================================================ Start computation: For each band (l)</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign band = 0; band &lt; minCommonBands; band++ )</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="comment">//============================================ Reset local counter</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        arrIter                                       = 0;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="comment">//============================================ For each shell pair</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign shell1 = 0; shell1 &lt; minCommonShells; shell1++ )</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="comment">//======================================== Check if band exists (progressive only)</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2f1e4debc49664de8842d1b42be74d2d">progressiveSphereMapping</a> ) { <span class="keywordflow">if</span> ( !obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ada8e6f27f49afc3a0ee17758ce9e7594">shellBandExists</a>( shell1, band ) || !obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ada8e6f27f49afc3a0ee17758ce9e7594">shellBandExists</a>( shell1, band ) ) { <span class="keywordflow">continue</span>; } }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign shell2 = 0; shell2 &lt; minCommonShells; shell2++ )</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <span class="comment">//============================ Check the other shell as well</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="keywordflow">if</span> ( !obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ada8e6f27f49afc3a0ee17758ce9e7594">shellBandExists</a>( shell2, band ) || !obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ada8e6f27f49afc3a0ee17758ce9e7594">shellBandExists</a>( shell2, band ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                <span class="comment">//==================================== Set values between which the Person&#39;s correlation coefficient should be computed</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                str1Vals[arrIter]                     = obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa35ae5ccd9d4b22bcc028f609cd1c3e">getRRPValue</a> ( band, shell1, shell2 ) *</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                                        pow ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( shell1 ), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a85edabe260e0466726b5875969dd18e3">enLevMatrixPowerWeight</a> ) *</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                                        pow ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( shell2 ), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a85edabe260e0466726b5875969dd18e3">enLevMatrixPowerWeight</a> );</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                str2Vals[arrIter]                     = obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa35ae5ccd9d4b22bcc028f609cd1c3e">getRRPValue</a> ( band, shell1, shell2 ) *</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                                        pow ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( shell1 ), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a85edabe260e0466726b5875969dd18e3">enLevMatrixPowerWeight</a> ) *</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                                        pow ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( shell2 ), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a85edabe260e0466726b5875969dd18e3">enLevMatrixPowerWeight</a> );</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                arrIter                              += 1;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="comment">//============================================ Get Pearson&#39;s Correlation Coefficient</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( bandDists, <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a894d87e94446db04492b663e54a74bff">ProSHADE_internal_maths::pearsonCorrCoeff</a> ( str1Vals, str2Vals, arrIter ) );</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">//================================================ Clean up</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keyword">delete</span>[] str1Vals;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keyword">delete</span>[] str2Vals;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, <span class="stringliteral">&quot;RRP matrices correlation computed.&quot;</span> );</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    return ;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a22db876a8cca08073f4db031996f537b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22db876a8cca08073f4db031996f537b">&#9670;&nbsp;</a></span>computeSphericalHarmonicsMagnitude()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_distances::computeSphericalHarmonicsMagnitude </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the magnitude of a particular spherical harmonics position for a given object, weighting it by the radius^2 (for integration). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">obj</td><td>The ProSHADE_data object for which the computation is to be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The bandwidth of the SH value for which this should be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order</td><td>The order of the SH value for which this should be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">radius</td><td>The shell of the SH value for which this should be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">result</td><td>The location where the result is to be saved. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00346">346</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;{</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">//================================================ Find the magnitude</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   *result                                            = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#abc59a55f5ed21de90e351005c58a871e">ProSHADE_internal_maths::complexMultiplicationConjugRealOnly</a> ( obj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5c0df68cd21b4f56abd1008065ca3573">getRealSphHarmValue</a> ( band, order, radius ),</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                                                                                                       obj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae8444b6c9ca3207d32bbf2a68c7b610">getImagSphHarmValue</a> ( band, order, radius ),</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                                                                                                       obj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5c0df68cd21b4f56abd1008065ca3573">getRealSphHarmValue</a> ( band, order, radius ),</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                                                                                                       obj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae8444b6c9ca3207d32bbf2a68c7b610">getImagSphHarmValue</a> ( band, order, radius ) );</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">//================================================ Weight by radius^2 for the integration that will follow</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   *result                                           *= pow ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( obj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23620b34a604aca7db4d8b21f6d2d09a">getAnySphereRadius</a>( radius ) ), 2.0 );</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    return ;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a34bad8d846082de4dc61870d67e762cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34bad8d846082de4dc61870d67e762cf">&#9670;&nbsp;</a></span>computeTraceSigmaDescriptor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double ProSHADE_internal_distances::computeTraceSigmaDescriptor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the trace sigma descriptor value between two objects. </p>
<p>This function starts by checking if the trace sigma descriptor was requested and if so, proceeds to compute the E matrices. These are 3D matrices with each l,m,m' value being the combination of the c_{l,m} and c*_{l,m'} spherical harmonics coefficients. Once computed, the E matrices are normalised by the magnitudes of the objects spherical harmonics coefficients and the SVD is computed for each l (i.e. on each m x m' matrix). The sum of the trace of the sigmas of the SVD is then the trace sigma descriptor, whose value is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">obj1</td><td>The first ProSHADE_data object against which comparison is done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj2</td><td>The second ProSHADE_data object which is compared to the first. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for the task. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>The final normalised value of the trace sigma descriptor for the two objects. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00622">622</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;{</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">//================================================ Report starting the task</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting trace sigma distance computation.&quot;</span> );</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">//================================================ Initialise return variable</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    proshade_double ret                               = 0.0;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">if</span> ( !settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a48bff4bebb6268c286b68bfd6663d954">computeTraceSigmaDesc</a> )</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Attempted computing trace sigma descriptors when it was\n                    : not required.&quot;</span>, <span class="stringliteral">&quot;ED00018&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;Attempted to pre-compute the E matrices, when the user\n                    : has specifically stated that these should not be computed.\n                    : Unless you manipulated the code, this error should never\n                    : occur; if you see this, I made a large blunder. Please let\n                    : me know!&quot;</span> );</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="comment">//================================================ Empty the cumulative weights back to 0.0 for each structure</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e7b1d5d4164ea7a6fda53c57ac979f4">setIntegrationWeight</a>                        ( 0.0 );</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e7b1d5d4164ea7a6fda53c57ac979f4">setIntegrationWeight</a>                        ( 0.0 );</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">//================================================ Compute un-weighted E matrices and their weights</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#add48230d67bd69305df058d29a588507">computeEMatrices</a>                                  ( obj1, obj2, settings );</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="comment">//================================================ Normalise E matrices by the magnitudes</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#ac96ff1a23997199af76e58885a1ee1e2">normaliseEMatrices</a>                                ( obj1, obj2, settings );</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="comment">//================================================ Allocate the required memory</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordtype">double</span>* singularValues                            = <span class="keyword">new</span> <span class="keywordtype">double</span>[( ( std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ) * 2 ) + 1 )];</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( singularValues, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="comment">//================================================ Compute the distance</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign lIter = 0; lIter &lt; std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ); lIter++ )</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="comment">//============================================ Find the complex matrix SVD singular values</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ab98abe6f7fac976a70b608951dbdf993">ProSHADE_internal_maths::complexMatrixSVDSigmasOnly</a> ( obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94a73f81ba80621f5f52173e91bb47f7">getEMatrixByBand</a> ( lIter ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( ( lIter * 2 ) + 1 ), singularValues );</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="comment">//============================================ Now sum the trace</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( ( lIter * 2 ) + 1 ); iter++  )</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            ret                                      += singularValues[iter];</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, <span class="stringliteral">&quot;E matrices decomposed to singular values.&quot;</span> );</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="comment">//================================================ Release the memory</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keyword">delete</span>[] singularValues;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Trace sigma distance computation complete.&quot;</span> );</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac086a02b5fd1fb0b32c2084a01aa927d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac086a02b5fd1fb0b32c2084a01aa927d">&#9670;&nbsp;</a></span>computeWeightsForEMatricesForLM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double ProSHADE_internal_distances::computeWeightsForEMatricesForLM </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>bandIter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>orderIter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>obj1Vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>obj2Vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>integOrder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>abscissas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>sphereDist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the E matrix weight values for a given band and order and saves these into the appropriate objects. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">obj1</td><td>The ProSHADE_data object for which the comparison is done in regards to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj2</td><td>The ProSHADE_data object for which the comparison is done in regards from - the E matrices will be saved into this object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The bandwidth of the SH value for which this should be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order</td><td>The order of the SH value for which this should be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj1Vals</td><td>Already allocated array of proshade_double to which integrated values will be saved. It must have size equal to minimum of spheres in the two compared objects. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj2Vals</td><td>Already allocated array of proshade_double to which integrated values will be saved. It must have size equal to minimum of spheres in the two compared objects. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">integOrder</td><td>The Gauss-Legendre integration order to be used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">abscissas</td><td>The pre-computed abscissas for the Gauss-Legendre integration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weights</td><td>The pre-computed weights for the Gauss-Legendre integration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">integRange</td><td>The range in angstroms between the smalleds and largest shell which are integrated over (might not be 0 to max for progressive shell sampling). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sphereDist</td><td>The distance between any two spheres. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sphereRange</td><td>The distance between the smallest and largest usable sphere (usable as in having the required band). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00438">438</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;{</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">//================================================ Initialise local values</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    proshade_unsign obj1ValsIter                      = 0;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    proshade_unsign obj2ValsIter                      = 0;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">//================================================ Set sphere counters</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    proshade_unsign minSphere                         = std::min( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">getMaxSpheres</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">getMaxSpheres</a>() );</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    proshade_unsign maxSphere                         = 0;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">//================================================ For each radius, deal with weights</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign radiusIter  = 0; radiusIter &lt; std::min( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">getMaxSpheres</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">getMaxSpheres</a>() ); radiusIter++ )</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="comment">//============================================ Get only values where the shell has the band</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">if</span> ( std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a898b48c1135e7a37f64f55e2367f0391">getShellBandwidth</a> ( radiusIter ), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a898b48c1135e7a37f64f55e2367f0391">getShellBandwidth</a> ( radiusIter ) ) &lt;= bandIter ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        minSphere                                     = std::min ( radiusIter, minSphere );</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        maxSphere                                     = std::max ( radiusIter, maxSphere );</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="comment">//============================================ Get the magnitudes for weighting</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#a22db876a8cca08073f4db031996f537b">computeSphericalHarmonicsMagnitude</a>            ( obj1, bandIter, orderIter, radiusIter, &amp;(obj1Vals[obj1ValsIter]) );</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#a22db876a8cca08073f4db031996f537b">computeSphericalHarmonicsMagnitude</a>            ( obj2, bandIter, orderIter, radiusIter, &amp;(obj2Vals[obj2ValsIter]) );</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        obj1ValsIter                                 += 1;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        obj2ValsIter                                 += 1;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">//================================================ Integrate weights</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    proshade_double minSphereRad                      = obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3be93c3f8e860afc435750fa1c6c01d7">getSpherePosValue</a> ( minSphere ) - ( sphereDist * 0.5 );</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    proshade_double maxSphereRad                      = obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3be93c3f8e860afc435750fa1c6c01d7">getSpherePosValue</a> ( maxSphere ) + ( sphereDist * 0.5 );</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a737ee01d968fef7ae1094847a0271033">setIntegrationWeightCumul</a>                   ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a62133f51851217e3cb28dff2f520d192">ProSHADE_internal_maths::gaussLegendreIntegrationReal</a> ( obj1Vals, obj1ValsIter, integOrder, abscissas, weights, maxSphereRad - minSphereRad, sphereDist ) );</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a737ee01d968fef7ae1094847a0271033">setIntegrationWeightCumul</a>                   ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a62133f51851217e3cb28dff2f520d192">ProSHADE_internal_maths::gaussLegendreIntegrationReal</a> ( obj2Vals, obj2ValsIter, integOrder, abscissas, weights, maxSphereRad - minSphereRad, sphereDist ) );</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">return</span>                                            ( maxSphereRad - minSphereRad );</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afacb5240b508ea28b64cacf395b47dba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afacb5240b508ea28b64cacf395b47dba">&#9670;&nbsp;</a></span>generateSO3CoeffsFromEMatrices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_distances::generateSO3CoeffsFromEMatrices </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function converts the E matrices to SO(3) coefficients. </p>
<p>This function starts by allocating the memory for the SO(3) coefficients and their inverse. It then proceeds to convert the E matrix values into the SO(3) transform coefficients by applying the Wigner normalisation factor and changing the sign as required by SOFT library. Upon termination, the coeffs will be saved in the obj2 class.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">obj1</td><td>The first ProSHADE_data object against which comparison is done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj2</td><td>The second ProSHADE_data object which is compared to the first. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for the task. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00707">707</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;{</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Converting E matrices to SO(3) coefficients.&quot;</span> );</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="comment">//================================================ Allocate memory for the coefficients</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abc4a61da919ae37b0a03d23df2461224">allocateSO3CoeffsSpace</a>                      ( std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ) );</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    proshade_double wigNorm, hlpValReal, hlpValImag;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    proshade_double signValue                         = 1.0;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    proshade_unsign indexO;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    proshade_complex hlpVal;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="comment">//================================================ For each band (l)</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed bandIter = 0; bandIter &lt; static_cast&lt;proshade_signed&gt; ( std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ) ); bandIter++ )</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="comment">//============================================ Get wigner normalisation factor</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        wigNorm                                       = 2.0 * M_PI * sqrt ( 2.0 / (2.0 * bandIter + 1.0 ) ) ;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="comment">//============================================ For each order (m)</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed orderIter = 0; orderIter &lt; ( ( bandIter * 2 ) + 1 ); orderIter++ )</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <span class="comment">//======================================== Set the sign</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            <span class="keywordflow">if</span> ( ( orderIter - bandIter + bandIter ) % 2 ) { signValue = -1.0 ; }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="keywordflow">else</span>                                           { signValue =  1.0 ; }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            <span class="comment">//======================================== For each order2 (m&#39;)</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed order2Iter = 0; order2Iter &lt; ( ( bandIter * 2 ) + 1 ); order2Iter++ )</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <span class="comment">//==================================== Find output index</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                indexO                                = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( so3CoefLoc ( orderIter - bandIter, order2Iter - bandIter, bandIter, std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ) ) );</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="comment">//==================================== Compute and save the SO(3) coefficients</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab053362f9dc5422244ccfbafd9f00ff8">getEMatrixValue</a>                 ( bandIter, orderIter, order2Iter, &amp;hlpValReal, &amp;hlpValImag );</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                hlpVal[0]                             = hlpValReal * wigNorm * signValue;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                hlpVal[1]                             = hlpValImag * wigNorm * signValue;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5e27540622190be41ce78157c0807e">setSO3CoeffValue</a>                ( indexO, hlpVal );</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                <span class="comment">//==================================== Switch the sign value</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                signValue                            *= -1.0;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    }</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, <span class="stringliteral">&quot;SO(3) coefficients obtained.&quot;</span> );</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    return ;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6e15740000a0079151a2d24dbbdebb2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e15740000a0079151a2d24dbbdebb2e">&#9670;&nbsp;</a></span>isBandWithinShell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProSHADE_internal_distances::isBandWithinShell </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>bandInQuestion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>shellInQuestion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html">ProSHADE_internal_spheres::ProSHADE_sphere</a> **&#160;</td>
          <td class="paramname"><em>spheres</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function checks if a band is available for a given shell. </p>
<p>This function simply checks if a particular sphere bandwidth limit is higher than a requested band, returning true if it is and false if not.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bandInQuestion</td><td>The value of the band existence of which is to be checked. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">shellInQuestion</td><td>The index of the shell for which the band existence is checked. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spheres</td><td>The ProSHADE structure holding all the shells and their information. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00143">143</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> ( bandInQuestion &lt; spheres[shellInQuestion]-&gt;getLocalBandwidth() )</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">return</span>                                        ( <span class="keyword">true</span> );</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">return</span>                                        ( <span class="keyword">false</span> );</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac96ff1a23997199af76e58885a1ee1e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac96ff1a23997199af76e58885a1ee1e2">&#9670;&nbsp;</a></span>normaliseEMatrices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_distances::normaliseEMatrices </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function normalises the E matrices. </p>
<p>This function assumes that the E matrices and integration magnitude weights were already computed. It now proceeds to compute the weighting factor (sqrt of the product of the magnitudes of the two objects) and apply it to the E matrices. This normalisation is similar in formula and meaning to the Pearson's correlation coefficient normalisation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">obj1</td><td>The first ProSHADE_data object for which the computation is done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj2</td><td>The second ProSHADE_data object for which the computation is done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for the task. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00578">578</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;{</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, <span class="stringliteral">&quot;Starting E matrices normalisation.&quot;</span> );</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">//================================================ Normalise by the Pearson&#39;s c.c. like formula</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    proshade_double eMatNormFactor                    = std::sqrt ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa150cfc5715420cf3d2e28c8af3631c4">getIntegrationWeight</a>() * obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa150cfc5715420cf3d2e28c8af3631c4">getIntegrationWeight</a>() );</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">//================================================ If this is self-correlation (i.e. obj1 == obj2), then divide normalisation factor by 2 as the weight was applied cumulatively!</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb39c3bb75f1b925175f9f6b09ada148">task</a> == Symmetry ) { eMatNormFactor /= 2.0; }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign bandIter = 0; bandIter &lt; std::min ( obj1-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>(), obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ); bandIter++ )</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="comment">//============================================ For each combination of m and m&#39; for E matrices</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign orderIter = 0; orderIter &lt; ( ( bandIter * 2 ) + 1 ); orderIter++ )</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign order2Iter = 0; order2Iter &lt; ( ( bandIter * 2 ) + 1 ); order2Iter++ )</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                obj2-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb19c915cebcef22c085cc6619cc472">normaliseEMatrixValue</a>           ( bandIter, orderIter, order2Iter, eMatNormFactor );</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, <span class="stringliteral">&quot;E matrices normalised.&quot;</span> );</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    return ;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a46703d08283073826820000007ec05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a46703d08283073826820000007ec05">&#9670;&nbsp;</a></span>prepareInvSOFTPlan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_distances::prepareInvSOFTPlan </td>
          <td>(</td>
          <td class="paramtype">fftw_plan *&#160;</td>
          <td class="paramname"><em>inverseSO3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>work1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_complex *&#160;</td>
          <td class="paramname"><em>invCoeffs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function prepares the FFTW plan for the inverse SO(3) transform. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">inverseSO3</td><td>The FFTW_PLAN pointer where the result will be saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The bandwidth of the computations. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">work1</td><td>The workspace to be used for the computation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">invCoeffs</td><td>The pointer to where the inverse SOFT transform results will be saved. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00791">791</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;{</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="comment">//================================================ Prepare the plan describing variables</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordtype">int</span> howmany                                       = 4 * band * band;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordtype">int</span> idist                                         = 2 * band;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordtype">int</span> odist                                         = 2 * band;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordtype">int</span> rank                                          = 2;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordtype">int</span> inembed[2], onembed[2];</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    inembed[0]                                        = 2 * band;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    inembed[1]                                        = 4 * band * band;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    onembed[0]                                        = 2 * band;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    onembed[1]                                        = 4 * band * band;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordtype">int</span> istride                                       = 1;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordtype">int</span> ostride                                       = 1;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordtype">int</span> na[2];</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    na[0]                                             = 1;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    na[1]                                             = 2 * band;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">//================================================ Create the plan</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;   *inverseSO3                                        = fftw_plan_many_dft ( rank,</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                                                                             na,</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                                                                             howmany,</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                                                                             work1,</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                                                                             inembed,</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                                                                             istride,</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                                                                             idist,</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                                                                             invCoeffs,</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                                                                             onembed,</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                                                                             ostride,</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                                                                             odist,</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                                                                             FFTW_FORWARD,</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                                                                             FFTW_ESTIMATE );</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    return ;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad7d8c822491454700995e0f1bc702e48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7d8c822491454700995e0f1bc702e48">&#9670;&nbsp;</a></span>releaseInvSOFTMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_distances::releaseInvSOFTMemory </td>
          <td>(</td>
          <td class="paramtype">proshade_complex *&amp;&#160;</td>
          <td class="paramname"><em>work1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_complex *&amp;&#160;</td>
          <td class="paramname"><em>work2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>work3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function releases the memory used for computation of the inverse SOFT transform. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">work1</td><td>The first workspace pointer to be released. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">work2</td><td>The second workspace pointer to be released. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">work3</td><td>The third workspace pointer to be released. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00838">838</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;{</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keyword">delete</span>[] work1;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keyword">delete</span>[] work2;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keyword">delete</span>[] work3;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    return ;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3dd86bf34be4f3398a83a4865738ddf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dd86bf34be4f3398a83a4865738ddf2">&#9670;&nbsp;</a></span>releaseTrSigmaWorkspace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_distances::releaseTrSigmaWorkspace </td>
          <td>(</td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>obj1Vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>obj2Vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>GLabscissas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>GLweights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_complex *&amp;&#160;</td>
          <td class="paramname"><em>radiiVals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This helper function is responsible for deleting the workspace memory required for trace sigma descriptor computation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">obj1Vals</td><td>Array to hold the shell values for the first object integgration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj2Vals</td><td>Array to hold the shell values for the second object integgration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">GLabscissas</td><td>An array to hold the pre-computed anscissas for the Gauss-Legendre integration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">glWeights</td><td>An array to hold the pre-computed weights for the Gauss-Legendre integration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">radiiVals</td><td>A complex array to hold the results of combining spherical harmonics coefficients of the two objects for each shell. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00483">483</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;{</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keyword">delete</span>[] obj1Vals;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keyword">delete</span>[] obj2Vals;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keyword">delete</span>[] radiiVals;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keyword">delete</span>[] GLabscissas;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keyword">delete</span>[] GLweights;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">//================================================ Set to NULL</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    obj1Vals                                          = NULL;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    obj2Vals                                          = NULL;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    radiiVals                                         = NULL;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    GLabscissas                                       = NULL;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    GLweights                                         = NULL;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    return ;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_ac96ff1a23997199af76e58885a1ee1e2"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#ac96ff1a23997199af76e58885a1ee1e2">ProSHADE_internal_distances::normaliseEMatrices</a></div><div class="ttdeci">void normaliseEMatrices(ProSHADE_internal_data::ProSHADE_data *obj1, ProSHADE_internal_data::ProSHADE_data *obj2, ProSHADE_settings *settings)</div><div class="ttdoc">This function normalises the E matrices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00578">ProSHADE_distances.cpp:578</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_af696bcba16302fe3a42e0341b4c5415a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#af696bcba16302fe3a42e0341b4c5415a">ProSHADE_settings::integOrder</a></div><div class="ttdeci">proshade_unsign integOrder</div><div class="ttdoc">The order required for full Gauss-Legendre integration between the spheres.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00113">ProSHADE_settings.hpp:113</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a94a73f81ba80621f5f52173e91bb47f7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94a73f81ba80621f5f52173e91bb47f7">ProSHADE_internal_data::ProSHADE_data::getEMatrixByBand</a></div><div class="ttdeci">proshade_complex ** getEMatrixByBand(proshade_unsign band)</div><div class="ttdoc">This function allows access to E matrix for a particular band.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02497">ProSHADE_data.cpp:2497</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a3d4604176a61820f5fcb95e372861c1d"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a3d4604176a61820f5fcb95e372861c1d">ProSHADE_internal_maths::gaussLegendreIntegration</a></div><div class="ttdeci">void gaussLegendreIntegration(proshade_complex *vals, proshade_unsign valsSize, proshade_unsign order, proshade_double *abscissas, proshade_double *weights, proshade_double integralOverRange, proshade_double maxSphereDists, proshade_double *retReal, proshade_double *retImag)</div><div class="ttdoc">Function to compute the complete complex Gauss-Legendre integration over spherical harmonic values in...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00704">ProSHADE_maths.cpp:704</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a48bff4bebb6268c286b68bfd6663d954"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a48bff4bebb6268c286b68bfd6663d954">ProSHADE_settings::computeTraceSigmaDesc</a></div><div class="ttdeci">bool computeTraceSigmaDesc</div><div class="ttdoc">If true, the trace sigma descriptor will be computed, otherwise all its computations will be omitted.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00154">ProSHADE_settings.hpp:154</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a62133f51851217e3cb28dff2f520d192"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a62133f51851217e3cb28dff2f520d192">ProSHADE_internal_maths::gaussLegendreIntegrationReal</a></div><div class="ttdeci">proshade_double gaussLegendreIntegrationReal(proshade_double *vals, proshade_unsign valsSize, proshade_unsign order, proshade_double *abscissas, proshade_double *weights, proshade_double integralOverRange, proshade_double maxSphereDists)</div><div class="ttdoc">Function to compute real part of the Gauss-Legendre integration over spherical harmonic values in dif...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00614">ProSHADE_maths.cpp:614</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a4ee1d1392407d1317274a793186129aa"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a4ee1d1392407d1317274a793186129aa">ProSHADE_settings::computeRotationFuncDesc</a></div><div class="ttdeci">bool computeRotationFuncDesc</div><div class="ttdoc">If true, the rotation function descriptor will be computed, otherwise all its computations will be om...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00155">ProSHADE_settings.hpp:155</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_abebc53842ab9dd92685f66c950a2fc44"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#abebc53842ab9dd92685f66c950a2fc44">ProSHADE_settings::taylorSeriesCap</a></div><div class="ttdeci">proshade_unsign taylorSeriesCap</div><div class="ttdoc">The max limit on the Taylor series expansion done for the abscissas of the Gauss-Legendre integration...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00114">ProSHADE_settings.hpp:114</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a6cc2b8e179a137adda234e0ba0f9d27b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6cc2b8e179a137adda234e0ba0f9d27b">ProSHADE_internal_data::ProSHADE_data::getComparisonBand</a></div><div class="ttdeci">proshade_unsign getComparisonBand(void)</div><div class="ttdoc">This function allows access to the maximum band for the comparison.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02549">ProSHADE_data.cpp:2549</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_a365752e40ab7c1f09fb4b31827a43dba"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#a365752e40ab7c1f09fb4b31827a43dba">ProSHADE_internal_distances::allocateTrSigmaWorkspace</a></div><div class="ttdeci">void allocateTrSigmaWorkspace(proshade_unsign minSpheres, proshade_unsign intOrder, proshade_double *&amp;obj1Vals, proshade_double *&amp;obj2Vals, proshade_double *&amp;GLabscissas, proshade_double *&amp;glWeights, proshade_complex *&amp;radiiVals)</div><div class="ttdoc">This helper function is responsible for allocating the workspace memory required for trace sigma desc...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00317">ProSHADE_distances.cpp:317</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3e7b1d5d4164ea7a6fda53c57ac979f4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e7b1d5d4164ea7a6fda53c57ac979f4">ProSHADE_internal_data::ProSHADE_data::setIntegrationWeight</a></div><div class="ttdeci">void setIntegrationWeight(proshade_double intW)</div><div class="ttdoc">This function allows setting the integration weight for the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02749">ProSHADE_data.cpp:2749</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_ac086a02b5fd1fb0b32c2084a01aa927d"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#ac086a02b5fd1fb0b32c2084a01aa927d">ProSHADE_internal_distances::computeWeightsForEMatricesForLM</a></div><div class="ttdeci">proshade_double computeWeightsForEMatricesForLM(ProSHADE_internal_data::ProSHADE_data *obj1, ProSHADE_internal_data::ProSHADE_data *obj2, proshade_unsign bandIter, proshade_unsign orderIter, proshade_double *obj1Vals, proshade_double *obj2Vals, proshade_unsign integOrder, proshade_double *abscissas, proshade_double *weights, proshade_double sphereDist)</div><div class="ttdoc">This function computes the E matrix weight values for a given band and order and saves these into the...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00438">ProSHADE_distances.cpp:438</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aceb19c915cebcef22c085cc6619cc472"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb19c915cebcef22c085cc6619cc472">ProSHADE_internal_data::ProSHADE_data::normaliseEMatrixValue</a></div><div class="ttdeci">void normaliseEMatrixValue(proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double normF)</div><div class="ttdoc">This function allows normalising the E matrix value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02798">ProSHADE_data.cpp:2798</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__exception_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a></div><div class="ttdoc">This class is the representation of ProSHADE exception.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__exceptions_8hpp_source.html#l00036">ProSHADE_exceptions.hpp:37</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ab053362f9dc5422244ccfbafd9f00ff8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab053362f9dc5422244ccfbafd9f00ff8">ProSHADE_internal_data::ProSHADE_data::getEMatrixValue</a></div><div class="ttdeci">void getEMatrixValue(proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double *valueReal, proshade_double *valueImag)</div><div class="ttdoc">This function allows access to E matrix by knowing the band, order1 and order2 indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02512">ProSHADE_data.cpp:2512</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_ad7d8c822491454700995e0f1bc702e48"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#ad7d8c822491454700995e0f1bc702e48">ProSHADE_internal_distances::releaseInvSOFTMemory</a></div><div class="ttdeci">void releaseInvSOFTMemory(proshade_complex *&amp;work1, proshade_complex *&amp;work2, proshade_double *&amp;work3)</div><div class="ttdoc">This function releases the memory used for computation of the inverse SOFT transform.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00838">ProSHADE_distances.cpp:838</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2245b15f279de574406204156089e5ef"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">ProSHADE_internal_data::ProSHADE_data::getMaxSpheres</a></div><div class="ttdeci">proshade_unsign getMaxSpheres(void)</div><div class="ttdoc">This function returns the number of spheres which contain the whole object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02279">ProSHADE_data.cpp:2279</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aca5e27540622190be41ce78157c0807e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5e27540622190be41ce78157c0807e">ProSHADE_internal_data::ProSHADE_data::setSO3CoeffValue</a></div><div class="ttdeci">void setSO3CoeffValue(proshade_unsign position, proshade_complex val)</div><div class="ttdoc">This function allows setting the SOFT coefficient values using array position and value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02814">ProSHADE_data.cpp:2814</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a6db2dcf87a6f763909ab08201e8de550"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6db2dcf87a6f763909ab08201e8de550">ProSHADE_internal_data::ProSHADE_data::computeRRPMatrices</a></div><div class="ttdeci">void computeRRPMatrices(ProSHADE_settings *settings)</div><div class="ttdoc">This function pre-computes the RRP matrices for a data object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00061">ProSHADE_distances.cpp:61</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a23620b34a604aca7db4d8b21f6d2d09a"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23620b34a604aca7db4d8b21f6d2d09a">ProSHADE_internal_data::ProSHADE_data::getAnySphereRadius</a></div><div class="ttdeci">proshade_double getAnySphereRadius(proshade_unsign shell)</div><div class="ttdoc">This function allows access to the radius of any particular sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02450">ProSHADE_data.cpp:2450</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a2f1e4debc49664de8842d1b42be74d2d"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a2f1e4debc49664de8842d1b42be74d2d">ProSHADE_settings::progressiveSphereMapping</a></div><div class="ttdeci">bool progressiveSphereMapping</div><div class="ttdoc">If true, each shell will have its own angular resolution dependent on the actual number of map points...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00146">ProSHADE_settings.hpp:146</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae5c9c45b0db1e6a9eeef2ba292fbbcc3"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae5c9c45b0db1e6a9eeef2ba292fbbcc3">ProSHADE_internal_data::ProSHADE_data::getSO3Coeffs</a></div><div class="ttdeci">proshade_complex * getSO3Coeffs(void)</div><div class="ttdoc">This function allows access to the SO(3) coefficients array.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02538">ProSHADE_data.cpp:2538</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a42e4b11981a2d3a518cb3c70e5470fb2"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a42e4b11981a2d3a518cb3c70e5470fb2">ProSHADE_settings::maxSphereDists</a></div><div class="ttdeci">proshade_single maxSphereDists</div><div class="ttdoc">The distance between spheres in spherical mapping for the largest sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00110">ProSHADE_settings.hpp:110</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3be93c3f8e860afc435750fa1c6c01d7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3be93c3f8e860afc435750fa1c6c01d7">ProSHADE_internal_data::ProSHADE_data::getSpherePosValue</a></div><div class="ttdeci">proshade_double getSpherePosValue(proshade_unsign shell)</div><div class="ttdoc">This function allows access to sphere positions.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02485">ProSHADE_data.cpp:2485</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa150cfc5715420cf3d2e28c8af3631c4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa150cfc5715420cf3d2e28c8af3631c4">ProSHADE_internal_data::ProSHADE_data::getIntegrationWeight</a></div><div class="ttdeci">proshade_double getIntegrationWeight(void)</div><div class="ttdoc">This function allows access to the integration weight for the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02461">ProSHADE_data.cpp:2461</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a737ee01d968fef7ae1094847a0271033"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a737ee01d968fef7ae1094847a0271033">ProSHADE_internal_data::ProSHADE_data::setIntegrationWeightCumul</a></div><div class="ttdeci">void setIntegrationWeightCumul(proshade_double intW)</div><div class="ttdoc">This function allows setting the cumulative integration weight for the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02763">ProSHADE_data.cpp:2763</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a89094c73ae033812d4df0bd846e03442"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">ProSHADE_settings::verbose</a></div><div class="ttdeci">proshade_signed verbose</div><div class="ttdoc">Should the software report on the progress, or just be quiet? Value between -1 (nothing) and 4 (loud)</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00177">ProSHADE_settings.hpp:177</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_ab98abe6f7fac976a70b608951dbdf993"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#ab98abe6f7fac976a70b608951dbdf993">ProSHADE_internal_maths::complexMatrixSVDSigmasOnly</a></div><div class="ttdeci">void complexMatrixSVDSigmasOnly(proshade_complex **mat, int dim, double *&amp;singularValues)</div><div class="ttdoc">Function to compute the complete complex matrix SVD and return only the sigmas.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00797">ProSHADE_maths.cpp:797</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5999f7181bd3509454966f8271ac39d6"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5999f7181bd3509454966f8271ac39d6">ProSHADE_internal_data::ProSHADE_data::getWignerMatrixValue</a></div><div class="ttdeci">void getWignerMatrixValue(proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double *valueReal, proshade_double *valueImag)</div><div class="ttdoc">This function allows access to the Wigner D matrix by knowing the band, order1 and order2 indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02564">ProSHADE_data.cpp:2564</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a898b48c1135e7a37f64f55e2367f0391"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a898b48c1135e7a37f64f55e2367f0391">ProSHADE_internal_data::ProSHADE_data::getShellBandwidth</a></div><div class="ttdeci">proshade_unsign getShellBandwidth(proshade_unsign shell)</div><div class="ttdoc">This function allows access to the bandwidth of a particular shell.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02473">ProSHADE_data.cpp:2473</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a68c3eafaeea1c1873c33525f337f9d0b"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a></div><div class="ttdeci">void addToDoubleVector(std::vector&lt; proshade_double &gt; *vecToAddTo, proshade_double elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00077">ProSHADE_misc.cpp:77</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_acde4bb62c09903a347ecde6f0a5302b1"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#acde4bb62c09903a347ecde6f0a5302b1">ProSHADE_internal_distances::computeRRPPearsonCoefficients</a></div><div class="ttdeci">void computeRRPPearsonCoefficients(ProSHADE_internal_data::ProSHADE_data *obj1, ProSHADE_internal_data::ProSHADE_data *obj2, ProSHADE_settings *settings, proshade_unsign minCommonBands, proshade_unsign minCommonShells, std::vector&lt; proshade_double &gt; *bandDists)</div><div class="ttdoc">This function gets the Pearson's coefficients or all bands between two objects.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00215">ProSHADE_distances.cpp:215</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_a7a46703d08283073826820000007ec05"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#a7a46703d08283073826820000007ec05">ProSHADE_internal_distances::prepareInvSOFTPlan</a></div><div class="ttdeci">void prepareInvSOFTPlan(fftw_plan *inverseSO3, proshade_unsign band, fftw_complex *work1, proshade_complex *invCoeffs)</div><div class="ttdoc">This function prepares the FFTW plan for the inverse SO(3) transform.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00791">ProSHADE_distances.cpp:791</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a894d87e94446db04492b663e54a74bff"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a894d87e94446db04492b663e54a74bff">ProSHADE_internal_maths::pearsonCorrCoeff</a></div><div class="ttdeci">proshade_double pearsonCorrCoeff(proshade_double *valSet1, proshade_double *valSet2, proshade_unsign length)</div><div class="ttdoc">Function for computing the Pearson's correlation coefficient.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00240">ProSHADE_maths.cpp:240</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__wigner_html_aba7b804497a1f100d527198e88fab2b8"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__wigner.html#aba7b804497a1f100d527198e88fab2b8">ProSHADE_internal_wigner::computeWignerMatricesForRotation</a></div><div class="ttdeci">void computeWignerMatricesForRotation(ProSHADE_settings *settings, ProSHADE_internal_data::ProSHADE_data *obj, proshade_double eulerAlpha, proshade_double eulerBeta, proshade_double eulerGamma)</div><div class="ttdoc">This function computes the Wigner D matrices for a particular set of Euler angles.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__wigner_matrices_8cpp_source.html#l00260">ProSHADE_wignerMatrices.cpp:260</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__peak_search_html_ae8a54558e9c9c28568c441a601811449"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__peak_search.html#ae8a54558e9c9c28568c441a601811449">ProSHADE_internal_peakSearch::getBestPeakEulerAngsNaive</a></div><div class="ttdeci">void getBestPeakEulerAngsNaive(proshade_complex *map, proshade_unsign dim, proshade_double *eulA, proshade_double *eulB, proshade_double *eulG, ProSHADE_settings *settings)</div><div class="ttdoc">This function finds the highest peaks optimised Euler angles using the &quot;naive&quot; approach.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__peak_search_8cpp_source.html#l00351">ProSHADE_peakSearch.cpp:351</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_afb39c3bb75f1b925175f9f6b09ada148"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#afb39c3bb75f1b925175f9f6b09ada148">ProSHADE_settings::task</a></div><div class="ttdeci">ProSHADE_Task task</div><div class="ttdoc">This custom type variable determines which task to perfom (i.e. symmetry detection,...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00089">ProSHADE_settings.hpp:89</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5c0df68cd21b4f56abd1008065ca3573"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5c0df68cd21b4f56abd1008065ca3573">ProSHADE_internal_data::ProSHADE_data::getRealSphHarmValue</a></div><div class="ttdeci">proshade_double * getRealSphHarmValue(proshade_unsign band, proshade_unsign order, proshade_unsign shell)</div><div class="ttdoc">This function allows access to the private internal real spherical harmonics values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02424">ProSHADE_data.cpp:2424</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_abc59a55f5ed21de90e351005c58a871e"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#abc59a55f5ed21de90e351005c58a871e">ProSHADE_internal_maths::complexMultiplicationConjugRealOnly</a></div><div class="ttdeci">proshade_double complexMultiplicationConjugRealOnly(proshade_double *r1, proshade_double *i1, proshade_double *r2, proshade_double *i2)</div><div class="ttdoc">Function to conjuggate multiply two complex numbers and return the real part only.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00103">ProSHADE_maths.cpp:103</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ada8e6f27f49afc3a0ee17758ce9e7594"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ada8e6f27f49afc3a0ee17758ce9e7594">ProSHADE_internal_data::ProSHADE_data::shellBandExists</a></div><div class="ttdeci">bool shellBandExists(proshade_unsign shell, proshade_unsign bandVal)</div><div class="ttdoc">This function checks if particular shell has a particular band.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02326">ProSHADE_data.cpp:2326</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a152b43815a3d3debd4b60751d9c8afdd"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">ProSHADE_internal_data::ProSHADE_data::getMaxBand</a></div><div class="ttdeci">proshade_unsign getMaxBand(void)</div><div class="ttdoc">This function returns the maximum band value for the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02300">ProSHADE_data.cpp:2300</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aae8444b6c9ca3207d32bbf2a68c7b610"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae8444b6c9ca3207d32bbf2a68c7b610">ProSHADE_internal_data::ProSHADE_data::getImagSphHarmValue</a></div><div class="ttdeci">proshade_double * getImagSphHarmValue(proshade_unsign band, proshade_unsign order, proshade_unsign shell)</div><div class="ttdoc">This function allows access to the private internal imaginary spherical harmonics values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02437">ProSHADE_data.cpp:2437</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_add48230d67bd69305df058d29a588507"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#add48230d67bd69305df058d29a588507">ProSHADE_internal_distances::computeEMatrices</a></div><div class="ttdeci">void computeEMatrices(ProSHADE_internal_data::ProSHADE_data *obj1, ProSHADE_internal_data::ProSHADE_data *obj2, ProSHADE_settings *settings)</div><div class="ttdoc">This function computes the complete E matrices and their weights between any two objects.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00515">ProSHADE_distances.cpp:515</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afa35ae5ccd9d4b22bcc028f609cd1c3e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa35ae5ccd9d4b22bcc028f609cd1c3e">ProSHADE_internal_data::ProSHADE_data::getRRPValue</a></div><div class="ttdeci">proshade_double getRRPValue(proshade_unsign band, proshade_unsign sh1, proshade_unsign sh2)</div><div class="ttdoc">This function allows access to the priva internal RRP matrices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02310">ProSHADE_data.cpp:2310</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_a3cdde76bf20d9cd5d756ffde2d3dc854"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#a3cdde76bf20d9cd5d756ffde2d3dc854">ProSHADE_internal_distances::computeInverseSOFTTransform</a></div><div class="ttdeci">void computeInverseSOFTTransform(ProSHADE_internal_data::ProSHADE_data *obj1, ProSHADE_internal_data::ProSHADE_data *obj2, ProSHADE_settings *settings)</div><div class="ttdoc">This function computes the inverse SO(3) transform.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00860">ProSHADE_distances.cpp:860</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_a8ed62a245d4fa9750f98b60d755b61c1"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#a8ed62a245d4fa9750f98b60d755b61c1">ProSHADE_internal_distances::computeEMatricesForLM</a></div><div class="ttdeci">void computeEMatricesForLM(ProSHADE_internal_data::ProSHADE_data *obj1, ProSHADE_internal_data::ProSHADE_data *obj2, proshade_unsign bandIter, proshade_unsign orderIter, proshade_complex *radiiVals, proshade_unsign integOrder, proshade_double *abscissas, proshade_double *weights, proshade_double integRange, proshade_double sphereDist)</div><div class="ttdoc">This function computes the E matrix un-weighted values for a given band and order and saves these int...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00375">ProSHADE_distances.cpp:375</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a6e2f7de1bba288270ce2cc772d28d065"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a6e2f7de1bba288270ce2cc772d28d065">ProSHADE_internal_maths::getLegendreAbscAndWeights</a></div><div class="ttdeci">void getLegendreAbscAndWeights(proshade_unsign order, proshade_double *abscissas, proshade_double *weights, proshade_unsign taylorSeriesCap)</div><div class="ttdoc">Function to prepare abscissas and weights for Gauss-Legendre integration.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00282">ProSHADE_maths.cpp:282</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_a22db876a8cca08073f4db031996f537b"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#a22db876a8cca08073f4db031996f537b">ProSHADE_internal_distances::computeSphericalHarmonicsMagnitude</a></div><div class="ttdeci">void computeSphericalHarmonicsMagnitude(ProSHADE_internal_data::ProSHADE_data *obj, proshade_unsign band, proshade_unsign order, proshade_unsign radius, proshade_double *result)</div><div class="ttdoc">This function computes the magnitude of a particular spherical harmonics position for a given object,...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00346">ProSHADE_distances.cpp:346</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_af42a5957efa2e6ec057059bd7c080eaf"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af42a5957efa2e6ec057059bd7c080eaf">ProSHADE_internal_data::ProSHADE_data::allocateEMatrices</a></div><div class="ttdeci">void allocateEMatrices(ProSHADE_settings *settings, proshade_unsign band)</div><div class="ttdoc">This function allocates the required memory for the E matrices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00280">ProSHADE_distances.cpp:280</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_af556836aa9286c1571196de442a6b493"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a></div><div class="ttdeci">void checkMemoryAllocation(chVar checkVar, std::string fileP, unsigned int lineP, std::string funcP, std::string infoP=&quot;This error may occurs when ProSHADE requests memory to be\n                    : allocated to it and this operation fails. This could\n                    : happen when not enough memory is available, either due to\n                    : other processes using a lot of memory, or when the machine\n                    : does not have sufficient memory available. Re-run to see\n                    : if this problem persists.&quot;)</div><div class="ttdoc">Checks if memory was allocated properly.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8hpp_source.html#l00063">ProSHADE_misc.hpp:63</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_a3dd86bf34be4f3398a83a4865738ddf2"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#a3dd86bf34be4f3398a83a4865738ddf2">ProSHADE_internal_distances::releaseTrSigmaWorkspace</a></div><div class="ttdeci">void releaseTrSigmaWorkspace(proshade_double *&amp;obj1Vals, proshade_double *&amp;obj2Vals, proshade_double *&amp;GLabscissas, proshade_double *&amp;glWeights, proshade_complex *&amp;radiiVals)</div><div class="ttdoc">This helper function is responsible for deleting the workspace memory required for trace sigma descri...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00483">ProSHADE_distances.cpp:483</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_adf3050bb282928f5c1639dcdf2b3261f"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#adf3050bb282928f5c1639dcdf2b3261f">ProSHADE_internal_distances::allocateInvSOFTWorkspaces</a></div><div class="ttdeci">void allocateInvSOFTWorkspaces(proshade_complex *&amp;work1, proshade_complex *&amp;work2, proshade_double *&amp;work3, proshade_unsign band)</div><div class="ttdoc">This function allocates the workspaces required to compute the inverse SOFT transform.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00767">ProSHADE_distances.cpp:767</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2eb10989a2f8d46b849cdaf8410b68be"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">ProSHADE_internal_data::ProSHADE_data::getInvSO3Coeffs</a></div><div class="ttdeci">proshade_complex * getInvSO3Coeffs(void)</div><div class="ttdoc">This function allows access to the inverse SO(3) coefficients array.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02527">ProSHADE_data.cpp:2527</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a2ca5a3aedba75f52aaf707edc4e790f7"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ca5a3aedba75f52aaf707edc4e790f7">ProSHADE_internal_maths::complexMultiplicationConjug</a></div><div class="ttdeci">void complexMultiplicationConjug(proshade_double *r1, proshade_double *i1, proshade_double *r2, proshade_double *i2, proshade_double *retReal, proshade_double *retImag)</div><div class="ttdoc">Function to multiply two complex numbers by using the second number's conjugate.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00062">ProSHADE_maths.cpp:62</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_afacb5240b508ea28b64cacf395b47dba"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#afacb5240b508ea28b64cacf395b47dba">ProSHADE_internal_distances::generateSO3CoeffsFromEMatrices</a></div><div class="ttdeci">void generateSO3CoeffsFromEMatrices(ProSHADE_internal_data::ProSHADE_data *obj1, ProSHADE_internal_data::ProSHADE_data *obj2, ProSHADE_settings *settings)</div><div class="ttdoc">This function converts the E matrices to SO(3) coefficients.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00707">ProSHADE_distances.cpp:707</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aca5af5c8c3b18275e65ae4ebacd9877c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5af5c8c3b18275e65ae4ebacd9877c">ProSHADE_internal_data::ProSHADE_data::setEMatrixValue</a></div><div class="ttdeci">void setEMatrixValue(proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_complex val)</div><div class="ttdoc">This function allows setting the E matrix value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02780">ProSHADE_data.cpp:2780</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_abc4a61da919ae37b0a03d23df2461224"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abc4a61da919ae37b0a03d23df2461224">ProSHADE_internal_data::ProSHADE_data::allocateSO3CoeffsSpace</a></div><div class="ttdeci">void allocateSO3CoeffsSpace(proshade_unsign band)</div><div class="ttdoc">This function allocates the memory for the SO(3) coefficients and the inverse for that calling object...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00681">ProSHADE_distances.cpp:681</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__messages_html_a6aa8cdb600cad623409802cfaed494fa"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a></div><div class="ttdeci">void printProgressMessage(proshade_signed verbose, proshade_signed messageLevel, std::string message)</div><div class="ttdoc">General stdout message printing.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__messages_8cpp_source.html#l00070">ProSHADE_messages.cpp:70</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a85edabe260e0466726b5875969dd18e3"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a85edabe260e0466726b5875969dd18e3">ProSHADE_settings::enLevMatrixPowerWeight</a></div><div class="ttdeci">proshade_double enLevMatrixPowerWeight</div><div class="ttdoc">If RRP matrices shell position is to be weighted by putting the position as an exponent,...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00153">ProSHADE_settings.hpp:153</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_ac9b05344ffead449c29a333a57b404f6"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#ac9b05344ffead449c29a333a57b404f6">ProSHADE_internal_maths::complexMultiplicationRealOnly</a></div><div class="ttdeci">proshade_double complexMultiplicationRealOnly(proshade_double *r1, proshade_double *i1, proshade_double *r2, proshade_double *i2)</div><div class="ttdoc">Function to multiply two complex numbers and return the real part only.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00083">ProSHADE_maths.cpp:83</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a23a96d41d415195813dd3237ae47b614"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a23a96d41d415195813dd3237ae47b614">ProSHADE_settings::computeEnergyLevelsDesc</a></div><div class="ttdeci">bool computeEnergyLevelsDesc</div><div class="ttdoc">If true, the energy levels descriptor will be computed, otherwise all its computations will be omitte...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00152">ProSHADE_settings.hpp:152</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_pro_s_h_a_d_e__internal__distances.html">ProSHADE_internal_distances</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
