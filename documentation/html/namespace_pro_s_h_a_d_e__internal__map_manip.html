<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ProSHADE: ProSHADE_internal_mapManip Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ProSHADE
   &#160;<span id="projectnumber">0.7.3 (MAY 2020)</span>
   </div>
   <div id="projectbrief">Protein Shape Detection</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespace_pro_s_h_a_d_e__internal__map_manip.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ProSHADE_internal_mapManip Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This namespace contains the internal functions for manipulating maps already present in the internal structures.  
<a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a50df80b02427f9f55a2c7af033a9fb93"><td class="memItemLeft" align="right" valign="top">proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">myRound</a> (proshade_double x)</td></tr>
<tr class="memdesc:a50df80b02427f9f55a2c7af033a9fb93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls the appropriate version of round function depending on compiler version.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">More...</a><br /></td></tr>
<tr class="separator:a50df80b02427f9f55a2c7af033a9fb93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab66d0044647012b861bdb4b755fcc8ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ab66d0044647012b861bdb4b755fcc8ae">determinePDBRanges</a> (clipper::mmdb::CMMDBManager *pdbFile, proshade_single *xFrom, proshade_single *xTo, proshade_single *yFrom, proshade_single *yTo, proshade_single *zFrom, proshade_single *zTo, int *noAt)</td></tr>
<tr class="memdesc:ab66d0044647012b861bdb4b755fcc8ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for finding the PDB file ranges.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ab66d0044647012b861bdb4b755fcc8ae">More...</a><br /></td></tr>
<tr class="separator:ab66d0044647012b861bdb4b755fcc8ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77f03de272e701a6cfa084d1130422a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a77f03de272e701a6cfa084d1130422a8">changePDBBFactors</a> (clipper::mmdb::CMMDBManager *pdbFile, proshade_double newBFactorValue)</td></tr>
<tr class="memdesc:a77f03de272e701a6cfa084d1130422a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for changing the PDB B-factor values to a specific single value.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a77f03de272e701a6cfa084d1130422a8">More...</a><br /></td></tr>
<tr class="separator:a77f03de272e701a6cfa084d1130422a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fc8927d3ed6db95849dba71a2c17c60"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a3fc8927d3ed6db95849dba71a2c17c60">movePDBForClipper</a> (clipper::mmdb::CMMDBManager *pdbFile, proshade_single xMov, proshade_single yMov, proshade_single zMov)</td></tr>
<tr class="memdesc:a3fc8927d3ed6db95849dba71a2c17c60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for moving PDB atoms to better suit clipper map computation.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a3fc8927d3ed6db95849dba71a2c17c60">More...</a><br /></td></tr>
<tr class="separator:a3fc8927d3ed6db95849dba71a2c17c60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bf6fedf2c5aff6bcf8ef020406251ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a6bf6fedf2c5aff6bcf8ef020406251ba">generateMapFromPDB</a> (clipper::mmdb::CMMDBManager *pdbFile, proshade_double *&amp;map, proshade_single requestedResolution, proshade_single xCell, proshade_single yCell, proshade_single zCell, int noAtoms, proshade_signed *xTo, proshade_signed *yTo, proshade_signed *zTo)</td></tr>
<tr class="memdesc:a6bf6fedf2c5aff6bcf8ef020406251ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for moving PDB atoms to better suit clipper map computation.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a6bf6fedf2c5aff6bcf8ef020406251ba">More...</a><br /></td></tr>
<tr class="separator:a6bf6fedf2c5aff6bcf8ef020406251ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a037825616c60bef58075284449872642"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">moveMapByIndices</a> (proshade_single *xMov, proshade_single *yMov, proshade_single *zMov, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed *xFrom, proshade_signed *xTo, proshade_signed *yFrom, proshade_signed *yTo, proshade_signed *zFrom, proshade_signed *zTo, proshade_signed *xOrigin, proshade_signed *yOrigin, proshade_signed *zOrigin)</td></tr>
<tr class="memdesc:a037825616c60bef58075284449872642"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for moving map back to original PDB location by changing the indices.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">More...</a><br /></td></tr>
<tr class="separator:a037825616c60bef58075284449872642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94dfbe2867f4e294dbb49284881fcb2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">moveMapByFourier</a> (proshade_double *&amp;map, proshade_single xMov, proshade_single yMov, proshade_single zMov, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed xDim, proshade_signed yDim, proshade_signed zDim)</td></tr>
<tr class="memdesc:a94dfbe2867f4e294dbb49284881fcb2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for moving map back to original PDB location by using Fourier transformation.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">More...</a><br /></td></tr>
<tr class="separator:a94dfbe2867f4e294dbb49284881fcb2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdac8ed8f140bdcd289ee666b61789d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#afdac8ed8f140bdcd289ee666b61789d4">blurSharpenMap</a> (proshade_double *&amp;map, proshade_double *&amp;maskedMap, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_single blurringFactor)</td></tr>
<tr class="memdesc:afdac8ed8f140bdcd289ee666b61789d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for blurring/sharpening maps.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#afdac8ed8f140bdcd289ee666b61789d4">More...</a><br /></td></tr>
<tr class="separator:afdac8ed8f140bdcd289ee666b61789d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42699d52d1be0d24e58deea4e25439bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a42699d52d1be0d24e58deea4e25439bf">getMaskFromBlurr</a> (proshade_double *&amp;blurMap, proshade_double *&amp;outMap, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_single noIQRs)</td></tr>
<tr class="memdesc:a42699d52d1be0d24e58deea4e25439bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for computing mask from blurred map.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a42699d52d1be0d24e58deea4e25439bf">More...</a><br /></td></tr>
<tr class="separator:a42699d52d1be0d24e58deea4e25439bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26c8be8b50be424bb35d3f6f39aa9aff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a26c8be8b50be424bb35d3f6f39aa9aff">getNonZeroBounds</a> (proshade_double *map, proshade_signed xDim, proshade_signed yDim, proshade_signed zDim, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed *&amp;ret)</td></tr>
<tr class="memdesc:a26c8be8b50be424bb35d3f6f39aa9aff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for finding the map boundaries enclosing positive only values.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a26c8be8b50be424bb35d3f6f39aa9aff">More...</a><br /></td></tr>
<tr class="separator:a26c8be8b50be424bb35d3f6f39aa9aff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c88b1152378beca4ccee251f2fb5e06"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a7c88b1152378beca4ccee251f2fb5e06">addExtraBoundSpace</a> (proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed *&amp;bounds, proshade_single extraSpace)</td></tr>
<tr class="memdesc:a7c88b1152378beca4ccee251f2fb5e06"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes a set of bounds and adds a given number of Angstroms to them.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a7c88b1152378beca4ccee251f2fb5e06">More...</a><br /></td></tr>
<tr class="separator:a7c88b1152378beca4ccee251f2fb5e06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5db74cc13dd4b64cf0a8377ed078b47c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a5db74cc13dd4b64cf0a8377ed078b47c">reSampleMapToResolutionTrilinear</a> (proshade_double *&amp;map, proshade_single resolution, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_single *&amp;corrs)</td></tr>
<tr class="memdesc:a5db74cc13dd4b64cf0a8377ed078b47c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function re-samples a map to conform to given resolution using Fourier.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a5db74cc13dd4b64cf0a8377ed078b47c">More...</a><br /></td></tr>
<tr class="separator:a5db74cc13dd4b64cf0a8377ed078b47c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a167f7a9dbd061752d2a099181090a3b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a167f7a9dbd061752d2a099181090a3b8">removeMapPhase</a> (fftw_complex *&amp;mapCoeffs, proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim)</td></tr>
<tr class="memdesc:a167f7a9dbd061752d2a099181090a3b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function removes the phase from reciprocal (frequency) map.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a167f7a9dbd061752d2a099181090a3b8">More...</a><br /></td></tr>
<tr class="separator:a167f7a9dbd061752d2a099181090a3b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa74663cb1126a4a3235f27945e4ac66f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aa74663cb1126a4a3235f27945e4ac66f">getFakeHalfMap</a> (proshade_double *&amp;map, proshade_double *&amp;fakeHalfMap, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_signed fakeMapKernel)</td></tr>
<tr class="memdesc:aa74663cb1126a4a3235f27945e4ac66f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for creating "fake" half-maps.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aa74663cb1126a4a3235f27945e4ac66f">More...</a><br /></td></tr>
<tr class="separator:aa74663cb1126a4a3235f27945e4ac66f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d1e80b32498ac8019bd2701b49cad2d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a5d1e80b32498ac8019bd2701b49cad2d">getCorrelationMapMask</a> (proshade_double *&amp;map, proshade_double *&amp;fakeHalfMap, proshade_double *&amp;correlationMask, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_signed corrMaskKernel)</td></tr>
<tr class="memdesc:a5d1e80b32498ac8019bd2701b49cad2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for creating the correlation mask.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a5d1e80b32498ac8019bd2701b49cad2d">More...</a><br /></td></tr>
<tr class="separator:a5d1e80b32498ac8019bd2701b49cad2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05098c48b9e98a02fc1bda2f4fbc5415"><td class="memItemLeft" align="right" valign="top">proshade_single&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a05098c48b9e98a02fc1bda2f4fbc5415">getIndicesFromAngstroms</a> (proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_single dist)</td></tr>
<tr class="memdesc:a05098c48b9e98a02fc1bda2f4fbc5415"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function converts distance in Angstroms to distance in map indices.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a05098c48b9e98a02fc1bda2f4fbc5415">More...</a><br /></td></tr>
<tr class="separator:a05098c48b9e98a02fc1bda2f4fbc5415"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf1e3e4bba204a62b6c3046e5c4c0e77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#acf1e3e4bba204a62b6c3046e5c4c0e77">connectMaskBlobs</a> (proshade_double *&amp;mask, proshade_signed xDim, proshade_signed yDim, proshade_signed zDim, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_single maskThres)</td></tr>
<tr class="memdesc:acf1e3e4bba204a62b6c3046e5c4c0e77"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function connects blobs in mask.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#acf1e3e4bba204a62b6c3046e5c4c0e77">More...</a><br /></td></tr>
<tr class="separator:acf1e3e4bba204a62b6c3046e5c4c0e77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae273430e12dd5bce08cf29c7689800dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ae273430e12dd5bce08cf29c7689800dd">beautifyBoundaries</a> (proshade_signed *&amp;bounds, proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_signed boundsDiffThres, proshade_signed verbose)</td></tr>
<tr class="memdesc:ae273430e12dd5bce08cf29c7689800dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for modifying boundaries to a mathematically more pleasant values.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ae273430e12dd5bce08cf29c7689800dd">More...</a><br /></td></tr>
<tr class="separator:ae273430e12dd5bce08cf29c7689800dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc6c505ea6b876bfae4d5f45dab63e98"><td class="memItemLeft" align="right" valign="top">proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#abc6c505ea6b876bfae4d5f45dab63e98">betterClosePrimeFactors</a> (proshade_signed fromRange, proshade_signed toRange)</td></tr>
<tr class="memdesc:abc6c505ea6b876bfae4d5f45dab63e98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for finding close numbers with better prime factors.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#abc6c505ea6b876bfae4d5f45dab63e98">More...</a><br /></td></tr>
<tr class="separator:abc6c505ea6b876bfae4d5f45dab63e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a272ed511f8e39433857ba6c733fa009a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a272ed511f8e39433857ba6c733fa009a">distributeSpaceToBoundaries</a> (proshade_signed &amp;minBound, proshade_signed &amp;maxBound, proshade_signed oldBoundRange, proshade_signed newBoundRange)</td></tr>
<tr class="memdesc:a272ed511f8e39433857ba6c733fa009a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for adding space to boundaries within the map confines.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a272ed511f8e39433857ba6c733fa009a">More...</a><br /></td></tr>
<tr class="separator:a272ed511f8e39433857ba6c733fa009a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c857c8f26f99695e7de52025f590205"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a2c857c8f26f99695e7de52025f590205">copyMapByBounds</a> (proshade_signed xFrom, proshade_signed xTo, proshade_signed yFrom, proshade_signed yTo, proshade_signed zFrom, proshade_signed zTo, proshade_signed origXFrom, proshade_signed origYFrom, proshade_signed origZFrom, proshade_signed yDimIndices, proshade_signed zDimIndices, proshade_signed origXDimIndices, proshade_signed origYDimIndices, proshade_signed origZDimIndices, proshade_double *&amp;newMap, proshade_double *origMap)</td></tr>
<tr class="memdesc:a2c857c8f26f99695e7de52025f590205"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function copies an old map to a new map with different boundaries.  <a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a2c857c8f26f99695e7de52025f590205">More...</a><br /></td></tr>
<tr class="separator:a2c857c8f26f99695e7de52025f590205"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This namespace contains the internal functions for manipulating maps already present in the internal structures. </p>
<p>The <a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html" title="This namespace contains the internal functions for manipulating maps already present in the internal ...">ProSHADE_internal_mapManip</a> namespace contains helper functions for map manipulation and processing. However, these functions do make minimum assumptions about the map internal organisation and variables and simply perform tasks on generic variables. None of these functions should be used directly be the user. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a7c88b1152378beca4ccee251f2fb5e06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c88b1152378beca4ccee251f2fb5e06">&#9670;&nbsp;</a></span>addExtraBoundSpace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::addExtraBoundSpace </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>xAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>yAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>zAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&amp;&#160;</td>
          <td class="paramname"><em>bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>extraSpace</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes a set of bounds and adds a given number of Angstroms to them. </p>
<p>This function adds an extra distance to a set of bounds as given by the number of angstroms to be added. If the resulting bounds are larger than the maximum map bounds, the maxima and minima are returned instead, thus partially ignoring the requested extra space. !!! If the resulting index ranges would be odd, extra one idice is added to make them even. !!!</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xDim</td><td>The number of indices along the x axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDim</td><td>The number of indices along the y axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDim</td><td>The number of indices along the z axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xAngs</td><td>The size of the x dimension of the map in angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yAngs</td><td>The size of the y dimension of the map in angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zAngs</td><td>The size of the z dimension of the map in angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bounds</td><td>A proshade_unsign pointer reference to array of 6 which has the current bounds (0 = minX; 1 = maxX; 2 = minY; 3 = maxY; 4 - minZ; 5 = maxZ). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">extraSpace</td><td>The number of angstroms to be added to each dimension (both to start and to end). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00713">713</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;{</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">//======================================== Convert angstrom distance to indices</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    proshade_signed xExtraInds                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a> ( extraSpace / (  xAngs / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( xDim ) ) );</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    proshade_signed yExtraInds                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a> ( extraSpace / (  yAngs / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( yDim ) ) );</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    proshade_signed zExtraInds                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a> ( extraSpace / (  zAngs / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( zDim ) ) );</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">//======================================== Changed bounds even if exceeding physical map - this will be deal with in the map creation part</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    bounds[0]                                 = bounds[0] - xExtraInds;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    bounds[1]                                 = bounds[1] + xExtraInds;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    bounds[2]                                 = bounds[2] - yExtraInds;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    bounds[3]                                 = bounds[3] + yExtraInds;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    bounds[4]                                 = bounds[4] - zExtraInds;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    bounds[5]                                 = bounds[5] + zExtraInds;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    return ;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae273430e12dd5bce08cf29c7689800dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae273430e12dd5bce08cf29c7689800dd">&#9670;&nbsp;</a></span>beautifyBoundaries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::beautifyBoundaries </td>
          <td>(</td>
          <td class="paramtype">proshade_signed *&amp;&#160;</td>
          <td class="paramname"><em>bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>boundsDiffThres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for modifying boundaries to a mathematically more pleasant values. </p>
<p>This function does two things. Firstly, it attempts to find even boundaries which have a small sum of the prime factors - i.e. this is good for further processing. Secondly, it attempts to make boundaries with sizes within some threshold the same. This is purely human thing :-).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bounds</td><td>A proshade_signed pointer to array of 6 in which the current bounds are (0 = minX; 1 = maxX; 2 = minY; 3 = maxY; 4 - minZ; 5 = maxZ). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDim</td><td>The number of indices along the x axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDim</td><td>The number of indices along the y axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDim</td><td>The number of indices along the z axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">boundsDiffThres</td><td>Number of indices by which boudaries in different dimensions can differ and still be made the same. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbose</td><td>The verbosity of this run - this is needed for the warnings only. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01234">1234</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;{</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="comment">//======================================== If extra bounds space pushed the bounds over the physical map, freely add up to 10 indices over the current value</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">while</span> ( bounds[1] &gt;= <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( xDim ) ) { xDim += 10; }</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordflow">while</span> ( bounds[3] &gt;= <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( yDim ) ) { yDim += 10; }</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordflow">while</span> ( bounds[5] &gt;= <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( zDim ) ) { zDim += 10; }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="comment">//======================================== Find if better bouds exist in terms of prime numbers</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    proshade_signed addToX                    = <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#abc6c505ea6b876bfae4d5f45dab63e98">betterClosePrimeFactors</a> ( bounds[1] - bounds[0] + 1, xDim );</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    proshade_signed addToY                    = <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#abc6c505ea6b876bfae4d5f45dab63e98">betterClosePrimeFactors</a> ( bounds[3] - bounds[2] + 1, yDim );</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    proshade_signed addToZ                    = <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#abc6c505ea6b876bfae4d5f45dab63e98">betterClosePrimeFactors</a> ( bounds[5] - bounds[4] + 1, zDim );</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="comment">//======================================== Figure if similar sizes should not be forced to be the same</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    proshade_signed XtoY                      = std::abs ( addToX - addToY );</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    proshade_signed XtoZ                      = std::abs ( addToX - addToZ );</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    proshade_signed YtoZ                      = std::abs ( addToY - addToZ );</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    </div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordflow">if</span> ( ( ( XtoY &lt; boundsDiffThres ) &amp;&amp; ( XtoZ &lt; boundsDiffThres ) ) ||</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;         ( ( XtoY &lt; boundsDiffThres ) &amp;&amp; ( YtoZ &lt; boundsDiffThres ) ) ||</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;         ( ( XtoZ &lt; boundsDiffThres ) &amp;&amp; ( YtoZ &lt; boundsDiffThres ) ) )</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    {</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="comment">//==================================== Dealing with chain ( a &lt;= b &lt;= c type ) where at least two dista are smaller than threshold</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        proshade_signed maxSize               = std::max ( addToX, std::max ( addToY, addToZ ) );</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        addToX                                = maxSize;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        addToY                                = maxSize;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        addToZ                                = maxSize;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    {</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="comment">//==================================== Only two may be similar enough</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        <span class="keywordflow">if</span> ( XtoY &lt;= boundsDiffThres )</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            proshade_signed maxSize           = std::max ( addToX, addToY );</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            addToX                            = maxSize;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            addToY                            = maxSize;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        }</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        <span class="keywordflow">if</span> ( XtoZ &lt;= boundsDiffThres )</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            proshade_signed maxSize           = std::max ( addToX, addToZ );</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            addToX                            = maxSize;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            addToZ                            = maxSize;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="keywordflow">if</span> ( YtoZ &lt;= boundsDiffThres )</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            proshade_signed maxSize           = std::max ( addToY, addToZ );</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            addToY                            = maxSize;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            addToZ                            = maxSize;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        }</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    }</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    </div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="comment">//======================================== Add the extra space appropriately</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a272ed511f8e39433857ba6c733fa009a">distributeSpaceToBoundaries</a>               ( bounds[0], bounds[1], ( bounds[1] - bounds[0] + 1 ), addToX );</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a272ed511f8e39433857ba6c733fa009a">distributeSpaceToBoundaries</a>               ( bounds[2], bounds[3], ( bounds[3] - bounds[2] + 1 ), addToY );</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a272ed511f8e39433857ba6c733fa009a">distributeSpaceToBoundaries</a>               ( bounds[4], bounds[5], ( bounds[5] - bounds[4] + 1 ), addToZ );</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    return ;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abc6c505ea6b876bfae4d5f45dab63e98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc6c505ea6b876bfae4d5f45dab63e98">&#9670;&nbsp;</a></span>betterClosePrimeFactors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_signed ProSHADE_internal_mapManip::betterClosePrimeFactors </td>
          <td>(</td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>fromRange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>toRange</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for finding close numbers with better prime factors. </p>
<p>This function takes a range of integer numbers and proceeds to find if a close number in the range to the range start does not have better (smaller sum of) prime factors, taking into account the distance of this better number to the starting position. This is useful for finding boundaries with nice prime number sizes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromRange</td><td>Which number the search will be from and possibilities compared to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">toRange</td><td>The maximum number to which the posibilities should be searched. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>The value in the range which has better prime factors, or the first value if none other has. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01304">1304</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;{</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="comment">//======================================== Initialise variables</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    proshade_signed ret                       = fromRange;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    std::vector &lt; proshade_signed &gt; posibles, hlp;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    proshade_signed sum;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    </div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="comment">//======================================== Find the sums of prime factors for each number in the whole range</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed iter = fromRange; iter &lt; toRange; iter++ )</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        sum                                   = 0;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        hlp                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a6359dd366cdd986f5ad155bff8235a8e">ProSHADE_internal_maths::primeFactorsDecomp</a> ( iter+1 );</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign i = 0; i &lt; static_cast&lt;proshade_unsign&gt; ( hlp.size() ); i++ ) { sum += hlp.at(i); }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        hlp.clear                             ( );</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a8a52d854a63ecad80c1805d601ffcf96">ProSHADE_internal_misc::addToSignedVector</a> ( &amp;posibles, sum );</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    </div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="comment">//======================================== Find a better number</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed iter = fromRange; iter &lt; toRange; iter++ )</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    {</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <span class="comment">//==================================== Ignore odd numbers</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        <span class="keywordflow">if</span> ( iter %2 != 0 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        <span class="comment">//==================================== Better number needs to have lower prime factor sum, but also needs not to be too far</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        <span class="keywordflow">if</span> ( posibles.at(iter-fromRange) &lt; ( posibles.at(ret-fromRange) - ( iter - ret ) ) ) { ret = iter; }</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    }</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    </div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="comment">//======================================== In the case of large prime number, just add one for even number</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="keywordflow">if</span> ( ( ret % 2 != 0 ) &amp;&amp; ( ret &lt; ( toRange - 1 ) ) ) { ret += 1; }</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    </div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="keywordflow">return</span>                                    ( ret );</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afdac8ed8f140bdcd289ee666b61789d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdac8ed8f140bdcd289ee666b61789d4">&#9670;&nbsp;</a></span>blurSharpenMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::blurSharpenMap </td>
          <td>(</td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>blurredMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xDimS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yDimS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zDimS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>xAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>yAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>zAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>blurringFactor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for blurring/sharpening maps. </p>
<p>This function takes the internal map representation information from the parameters as well as the internal map itself and proceeds to compute blue/sharpen the map by changing its overall B-factors by adding a specific value. If this value is negative, then the map is sharpened, while if the value is positive, the map is blurred.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">map</td><td>A Reference Pointer to the map which should be blurred/sharpened. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blurredMap</td><td>A Reference Pointer to the variable which will store the modified map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDimS</td><td>The number of indices along the x axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDimS</td><td>The number of indices along the y axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDimS</td><td>The number of indices along the z axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xAngs</td><td>The size of the x dimension of the map in angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yAngs</td><td>The size of the y dimension of the map in angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zAngs</td><td>The size of the z dimension of the map in angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blurringFactor</td><td>The amount of B-factor change that should be applied to the map. (I.e. increasing the map overall B-factors by 20 will be done by supplying 20 as a value for this parameter). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00503">503</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;{</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">//======================================== Set local variables</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    proshade_signed xDim                      = xDimS;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    proshade_signed yDim                      = yDimS;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    proshade_signed zDim                      = zDimS;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    proshade_double real, imag, S, mag, phase;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    proshade_signed h, k, l;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    proshade_unsign arrayPos                  = 0;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    proshade_double normFactor                = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( xDim * yDim * zDim );</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">//======================================== Copy map for processing</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    fftw_complex* mapCoeffs                   = <span class="keyword">new</span> fftw_complex[xDim * yDim * zDim];</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    fftw_complex* mapMask                     = <span class="keyword">new</span> fftw_complex[xDim * yDim * zDim];</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">//======================================== Check memory allocation</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( mapCoeffs, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( mapMask,   __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">//======================================== Copy data to mask</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; (xDim * yDim * zDim); iter++ )</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        mapMask[iter][0]                      = map[iter];</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        mapMask[iter][1]                      = 0.0;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">//======================================== Prepare FFTW plans</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    fftw_plan forward                         = fftw_plan_dft_3d ( xDim, yDim, zDim, mapMask, mapCoeffs, FFTW_FORWARD,  FFTW_ESTIMATE );</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    fftw_plan inverse                         = fftw_plan_dft_3d ( xDim, yDim, zDim, mapCoeffs, mapMask, FFTW_BACKWARD, FFTW_ESTIMATE );</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">//======================================== Run forward Fourier</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    fftw_execute                              ( forward );</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">//======================================== Blur the coeffs</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign uIt = 0; uIt &lt; static_cast&lt;proshade_unsign&gt; ( xDim ); uIt++ )</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign vIt = 0; vIt &lt; static_cast&lt;proshade_unsign&gt; ( yDim ); vIt++ )</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign wIt = 0; wIt &lt; static_cast&lt;proshade_unsign&gt; ( zDim ); wIt++ )</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                <span class="comment">//============================ Var init</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                arrayPos                      = wIt + zDim * ( vIt + yDim * uIt );</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                real                          = mapCoeffs[arrayPos][0];</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                imag                          = mapCoeffs[arrayPos][1];</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                <span class="comment">//============================ Change the B-factors, if required</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                <span class="keywordflow">if</span> ( uIt &gt; <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( (xDim+1) / 2) ) { h = uIt - <span class="keyword">static_cast &lt;</span>proshade_signed<span class="keyword">&gt;</span> ( xDim ); } <span class="keywordflow">else</span> { h = uIt; }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                <span class="keywordflow">if</span> ( vIt &gt; <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( (yDim+1) / 2) ) { k = vIt - <span class="keyword">static_cast &lt;</span>proshade_signed<span class="keyword">&gt;</span> ( yDim ); } <span class="keywordflow">else</span> { k = vIt; }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                <span class="keywordflow">if</span> ( wIt &gt; <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( (zDim+1) / 2) ) { l = wIt - <span class="keyword">static_cast &lt;</span>proshade_signed<span class="keyword">&gt;</span> ( zDim ); } <span class="keywordflow">else</span> { l = wIt; }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <span class="comment">//============================ Get magnitude and phase with mask parameters</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                S                             = ( pow( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( h ) / xAngs, 2.0 ) +</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                                  pow( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( k ) / yAngs, 2.0 ) +</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                                  pow( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( l ) / zAngs, 2.0 ) );</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                mag                           = std::sqrt ( (real*real) + (imag*imag) ) * std::exp ( - ( ( blurringFactor * S ) / 4.0 ) );</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                phase                         = std::atan2 ( imag, real );</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                <span class="comment">//============================ Save the mask data</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                mapCoeffs[arrayPos][0]        = ( mag * cos(phase) ) / normFactor;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                mapCoeffs[arrayPos][1]        = ( mag * sin(phase) ) / normFactor;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="comment">//======================================== Run inverse Fourier</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    fftw_execute                              ( inverse );</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">//======================================== Save the results</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; (xDim * yDim * zDim); iter++ )</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        blurredMap[iter]                      = mapMask[iter][0];</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="comment">//======================================== Release memory</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keyword">delete</span>[] mapMask;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keyword">delete</span>[] mapCoeffs;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">//======================================== Delete FFTW plans</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    fftw_destroy_plan                         ( forward );</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    fftw_destroy_plan                         ( inverse );</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    return ;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a77f03de272e701a6cfa084d1130422a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77f03de272e701a6cfa084d1130422a8">&#9670;&nbsp;</a></span>changePDBBFactors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::changePDBBFactors </td>
          <td>(</td>
          <td class="paramtype">clipper::mmdb::CMMDBManager *&#160;</td>
          <td class="paramname"><em>pdbFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>newBFactorValue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for changing the PDB B-factor values to a specific single value. </p>
<p>This function does a quick read-through the PDB file and changes all the atom B-factor values to a single, pre-set value. This is important for PDB files which have all atoms with B-factor value 0, as these then produce bad maps, which fail further processing by ProSHADE.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdbFile</td><td>Pointer to an open clipper::mmdb::CMMDBManager object to read from. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">newBFactorValue</td><td>The value with which all atom B-factor values should be replaced. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00133">133</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;{</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">//======================================== Initialise MMDB crawl</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">int</span> noChains                              = 0;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">int</span> noResidues                            = 0;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">int</span> noAtoms                               = 0;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    clipper::mmdb::PPCChain chain;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    clipper::mmdb::PPCResidue residue;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    clipper::mmdb::PPCAtom atom;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">//======================================== Get all chains</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    pdbFile-&gt;GetChainTable                      ( 1, chain, noChains );</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> nCh = 0; nCh &lt; noChains; nCh++ )</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span> ( chain[nCh] )</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="comment">//================================ Get all residues</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            chain[nCh]-&gt;GetResidueTable       ( residue, noResidues );</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> nRes = 0; nRes &lt; noResidues; nRes++ )</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="keywordflow">if</span> ( residue[nRes] )</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    <span class="comment">//======================== Get all atoms</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                    residue[nRes]-&gt;GetAtomTable ( atom, noAtoms );</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> aNo = 0; aNo &lt; noAtoms; aNo++ )</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                    {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                        <span class="keywordflow">if</span> ( atom[aNo] )</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                        {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                            <span class="comment">//================ Check for termination &#39;residue&#39;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                            <span class="keywordflow">if</span> ( atom[aNo]-&gt;Ter ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                            </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                            <span class="comment">//================ Change the value</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                            atom[aNo]-&gt;tempFactor = newBFactorValue;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                        }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                    }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    return ;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acf1e3e4bba204a62b6c3046e5c4c0e77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf1e3e4bba204a62b6c3046e5c4c0e77">&#9670;&nbsp;</a></span>connectMaskBlobs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::connectMaskBlobs </td>
          <td>(</td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>xDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>yDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>zDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>xAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>yAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>zAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>maskThres</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function connects blobs in mask. </p>
<p>...</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mask</td><td>A pointer reference to mask map in which blobs should be connected. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDim</td><td>The number of map indices along the x-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDim</td><td>The number of map indices along the y-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDim</td><td>The number of map indices along the z-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xAngs</td><td>The map size in Angstroms along the x-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yAngs</td><td>The map size in Angstroms along the y-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zAngs</td><td>The map size in Angstroms along the z-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maskThres</td><td>The threshold which will be used for applying mask. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01156">1156</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;{</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="comment">//======================================== Initialise variables</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    proshade_double* hlpMap                   = <span class="keyword">new</span> proshade_double[xDim * yDim * zDim];</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    proshade_signed addSurroundingPoints      = std::max ( 3L, <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( std::ceil ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a05098c48b9e98a02fc1bda2f4fbc5415">getIndicesFromAngstroms</a>( xDim, yDim, zDim, xAngs, yAngs, zAngs, std::max( xAngs, std::max( yAngs, zAngs ) ) * 0.1 ) ) ) );</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    proshade_signed currPos, neighXPos, neighYPos, neighZPos, neighArrPos;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="comment">//======================================== Check memory allocation</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( hlpMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    </div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="comment">//======================================== Copy the mask map</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( xDim * yDim * zDim ); iter++ ) { hlpMap[iter] = mask[iter]; }</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="comment">//======================================== Repeat as many times as needed</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed it = 0; it &lt; addSurroundingPoints; it++ )</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    {</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        <span class="comment">//==================================== For each x, y and z</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed xIt = 0; xIt &lt; xDim; xIt++ )</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        {</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed yIt = 0; yIt &lt; yDim; yIt++ )</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                <span class="keywordflow">for</span> ( proshade_signed zIt = 0; zIt &lt; zDim; zIt++ )</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                {</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                    <span class="comment">//======================== Current position</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                    currPos                   = zIt + zDim * ( yIt + yDim * xIt );</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                    </div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                    <span class="comment">//======================== If zero, ignore</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                    <span class="keywordflow">if</span> ( hlpMap[currPos] &lt; maskThres ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                    </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                    <span class="comment">//======================== Check neighbours</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                    <span class="keywordflow">for</span> ( proshade_signed xCh = -1; xCh &lt;= +1; xCh++ )</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                    {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                        <span class="keywordflow">for</span> ( proshade_signed yCh = -1; yCh &lt;= +1; yCh++ )</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                        {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                            <span class="keywordflow">for</span> ( proshade_signed zCh = -1; zCh &lt;= +1; zCh++ )</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                            {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                                <span class="keywordflow">if</span> ( ( xCh == 0 ) &amp;&amp; ( yCh == 0 ) &amp;&amp; ( zCh == 0 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                                </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                                <span class="comment">//============ Find the nieghbour indices (without periodicity)</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                                neighXPos     = xIt + xCh; <span class="keywordflow">if</span> ( neighXPos &lt; 0 ) { <span class="keywordflow">continue</span>; } <span class="keywordflow">if</span> ( neighXPos &gt;= xDim ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                                neighYPos     = yIt + yCh; <span class="keywordflow">if</span> ( neighYPos &lt; 0 ) { <span class="keywordflow">continue</span>; } <span class="keywordflow">if</span> ( neighYPos &gt;= yDim ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                neighZPos     = zIt + zCh; <span class="keywordflow">if</span> ( neighZPos &lt; 0 ) { <span class="keywordflow">continue</span>; } <span class="keywordflow">if</span> ( neighZPos &gt;= zDim ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                                neighArrPos   = neighZPos + zDim * ( neighYPos + yDim * neighXPos );</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                                </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                                <span class="comment">//============ Add to mask if this point is below it (as it is a neighbour to a point which is part of the mask)</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                                <span class="keywordflow">if</span> ( hlpMap[neighArrPos] &lt; maskThres ) { mask[neighArrPos] = maskThres; }</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                            }</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                        }</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                    }</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                }</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            }</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="comment">//======================== Now copy the updated mask to the temporary helper, unless last iteration</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( xDim * yDim * zDim ); iter++ ) { hlpMap[iter] = mask[iter]; }</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    }</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="comment">//======================================== Release memory</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keyword">delete</span>[] hlpMap;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    return ;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c857c8f26f99695e7de52025f590205"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c857c8f26f99695e7de52025f590205">&#9670;&nbsp;</a></span>copyMapByBounds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::copyMapByBounds </td>
          <td>(</td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>xFrom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>xTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>yFrom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>yTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>zFrom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>zTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>origXFrom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>origYFrom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>origZFrom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>yDimIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>zDimIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>origXDimIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>origYDimIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>origZDimIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>newMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>origMap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function copies an old map to a new map with different boundaries. </p>
<p>This function takes old and new structure details and the original structure map. It then proceed to iterate through the new structure map, checking if this particular point is inside the original structure's map and if it is, it will copy the value of this point from the original to the new map. Otherwise, it will set the new map's point value to 0.0. This is used when creating a new structure from an old structure given new bounds, which can be larger or smaller than the originals.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xFrom</td><td>The starting x-axis index of the new map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xTo</td><td>The last x-axis index of the new map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yFrom</td><td>The starting y-axis index of the new map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yTo</td><td>The last y-axis index of the new map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zFrom</td><td>The starting z-axis index of the new map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zTo</td><td>The last z-axis index of the new map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">origXFrom</td><td>The starting x-axis index of the original (copied) map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">origYFrom</td><td>The starting y-axis index of the original (copied) map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">origZFrom</td><td>The starting z-axis index of the original (copied) map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDimIndices</td><td>The size of the y-axis dimension in the new map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDimIndices</td><td>The size of the z-axis dimension in the new map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">origXDimIndices</td><td>The size of the x-axis dimension in the old map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">origYDimIndices</td><td>The size of the y-axis dimension in the old map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">origZDimIndices</td><td>The size of the z-axis dimension in the old map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">newMap</td><td>Pointer reference to the array where new map will be saved to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">origMap</td><td>Pointer to the array where the original map can be accessed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01400">1400</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;{</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="comment">//======================================== Initialise variables</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    proshade_signed newMapIndex, oldMapIndex, oldX, oldY, oldZ, newX, newY, newZ;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    </div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="comment">//======================================== For all values in the new map</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed xIt = xFrom; xIt &lt;= xTo; xIt++ )</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <span class="comment">//==================================== Index position init</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        newX                                  = ( xIt - xFrom );</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        oldX                                  = ( newX + ( xFrom - origXFrom ) );</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed yIt = yFrom; yIt &lt;= yTo; yIt++ )</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;            <span class="comment">//================================ Index position init</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            newY                              = ( yIt - yFrom );</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;            oldY                              = ( newY + ( yFrom - origYFrom ) );</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed zIt = zFrom; zIt &lt;= zTo; zIt++ )</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                <span class="comment">//============================ Index position init</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                newZ                          = ( zIt - zFrom );</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                oldZ                          = ( newZ + ( zFrom - origZFrom ) );</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                <span class="comment">//============================ Index arrays</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                newMapIndex                   = newZ + zDimIndices * ( newY + yDimIndices * newX );</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                oldMapIndex                   = oldZ + origZDimIndices * ( oldY + origYDimIndices * oldX );</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                <span class="comment">//============================ Check if we are adding new point</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                <span class="keywordflow">if</span> ( ( ( oldX &lt; 0 ) || ( oldX &gt;= origXDimIndices ) ) ||</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                    ( ( oldY &lt; 0 ) || ( oldY &gt;= origYDimIndices ) ) ||</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                    ( ( oldZ &lt; 0 ) || ( oldZ &gt;= origZDimIndices ) ) )</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                {</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                    <span class="comment">//======================== Yes, this is a new point, no known value for it</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                    newMap[newMapIndex]       = 0.0;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                }</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                </div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                <span class="comment">//============================ If we got here, this should be within the old map, so just copy  value</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                newMap[newMapIndex]           = origMap[oldMapIndex];</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            }</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        }</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    }</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    return ;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    </div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab66d0044647012b861bdb4b755fcc8ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab66d0044647012b861bdb4b755fcc8ae">&#9670;&nbsp;</a></span>determinePDBRanges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::determinePDBRanges </td>
          <td>(</td>
          <td class="paramtype">clipper::mmdb::CMMDBManager *&#160;</td>
          <td class="paramname"><em>pdbFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single *&#160;</td>
          <td class="paramname"><em>xFrom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single *&#160;</td>
          <td class="paramname"><em>xTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single *&#160;</td>
          <td class="paramname"><em>yFrom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single *&#160;</td>
          <td class="paramname"><em>yTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single *&#160;</td>
          <td class="paramname"><em>zFrom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single *&#160;</td>
          <td class="paramname"><em>zTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>noAt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for finding the PDB file ranges. </p>
<p>This function does a quick read-through the PDB file and reports the x, y and z to and from values. This is used to determine if these need to be changed for proper clipper operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdbFile</td><td>Pointer to an open clipper::mmdb::CMMDBManager object to read from. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xFrom</td><td>Address to a variable to save the x axis minimal atom position. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xTo</td><td>Address to a variable to save the x axis maximum atom position. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yFrom</td><td>Address to a variable to save the y axis minimal atom position. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yTo</td><td>Address to a variable to save the y axis maximum atom position. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zFrom</td><td>Address to a variable to save the z axis minimal atom position. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zTo</td><td>Address to a variable to save the z axis maximum atom position. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noAt</td><td>The number of atoms as determined by the MMDB Crawl. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00050">50</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">//======================================== Initialise MMDB crawl</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">int</span> noChains                              = 0;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordtype">int</span> noResidues                            = 0;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">int</span> noAtoms                               = 0;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   *noAt                                      = 0;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    clipper::mmdb::PPCChain chain;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    clipper::mmdb::PPCResidue residue;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    clipper::mmdb::PPCAtom atom;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">bool</span> firstAtom                            = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">//======================================== Get all chains</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    pdbFile-&gt;GetChainTable                      ( 1, chain, noChains );</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> nCh = 0; nCh &lt; noChains; nCh++ )</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">if</span> ( chain[nCh] )</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="comment">//================================ Get all residues</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            chain[nCh]-&gt;GetResidueTable       ( residue, noResidues );</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> nRes = 0; nRes &lt; noResidues; nRes++ )</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                <span class="keywordflow">if</span> ( residue[nRes] )</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                    <span class="comment">//======================== Get all atoms</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                    residue[nRes]-&gt;GetAtomTable ( atom, noAtoms );</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                    </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> aNo = 0; aNo &lt; noAtoms; aNo++ )</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                    {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                        <span class="keywordflow">if</span> ( atom[aNo] )</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                        {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                            <span class="comment">//================ Check for termination &#39;residue&#39;</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                            <span class="keywordflow">if</span> ( atom[aNo]-&gt;Ter ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                            </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                            <span class="comment">//================ Find axis maxs and mins</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                            <span class="keywordflow">if</span> ( firstAtom )</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                            {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                *xTo           = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;x );</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                *xFrom         = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;x );</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                                *yTo           = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;y );</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                                *yFrom         = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;y );</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                *zTo           = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;z );</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                *zFrom         = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;z );</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                                </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                firstAtom     = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                *noAt         += 1;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                            }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                            {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;x ) &gt; *xTo   ) { *xTo   = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;x ); }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;x ) &lt; *xFrom ) { *xFrom = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;x ); }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;y ) &gt; *yTo   ) { *yTo   = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;y ); }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;y ) &lt; *yFrom ) { *yFrom = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;y ); }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;z ) &gt; *zTo   ) { *zTo   = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;z ); }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;z ) &lt; *zFrom ) { *zFrom = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( atom[aNo]-&gt;z ); }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                *noAt         += 1;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                            }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                        }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    return ;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a272ed511f8e39433857ba6c733fa009a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a272ed511f8e39433857ba6c733fa009a">&#9670;&nbsp;</a></span>distributeSpaceToBoundaries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::distributeSpaceToBoundaries </td>
          <td>(</td>
          <td class="paramtype">proshade_signed &amp;&#160;</td>
          <td class="paramname"><em>minBound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed &amp;&#160;</td>
          <td class="paramname"><em>maxBound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>oldBoundRange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>newBoundRange</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for adding space to boundaries within the map confines. </p>
<p>This function takes the current boudaries and attempts to add the extra space specified by the parameters 3 and 4 equally to both the top and bottom boundaries, making sure the bottom boundary does not go belowe 0 and the top boundary does not exceed the final parameter.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">minBound</td><td>Reference to where the lower boundary value is held. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxBound</td><td>Reference to where the upper boundary value is held. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oldBoundRange</td><td>The range between the original boundaries. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">newBoundRange</td><td>The range which should be between the new boundaries. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01350">1350</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;{</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="comment">//======================================== Only bother when sometings is to be added</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="keywordflow">if</span> ( newBoundRange &gt; oldBoundRange )</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    {</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        <span class="comment">//==================================== How much are we adding?</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        proshade_signed distributeThis        = newBoundRange - oldBoundRange;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        </div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        <span class="keywordflow">while</span> ( distributeThis != 0 )</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        {</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            minBound                     -= 1;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            distributeThis               -= 1;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;            </div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;            <span class="keywordflow">if</span> ( distributeThis != 0 )</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;            {</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                maxBound                     += 1;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                distributeThis               -= 1;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;            }</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    }</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    </div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    return ;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    </div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6bf6fedf2c5aff6bcf8ef020406251ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bf6fedf2c5aff6bcf8ef020406251ba">&#9670;&nbsp;</a></span>generateMapFromPDB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::generateMapFromPDB </td>
          <td>(</td>
          <td class="paramtype">clipper::mmdb::CMMDBManager *&#160;</td>
          <td class="paramname"><em>pdbFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>requestedResolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>xCell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>yCell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>zCell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>noAtoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>xTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>yTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>zTo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for moving PDB atoms to better suit clipper map computation. </p>
<p>This function translates all atoms by a given x, y and z distances. This is required as clipper can only output map cells starting from 0, 0, 0 and therefore to avoid density being in corners for PDB atoms not located in posivite axes, the atoms need to be moved. This effect is reversed later.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdbFile</td><td>Pointer to an open clipper::mmdb::CMMDBManager object to read from. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">map</td><td>Pointer reference to a variable to save the map data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">requestedResolution</td><td>Map resolution to which the map should be computed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xCell</td><td>The size of the map cell to be created. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yCell</td><td>The size of the map cell to be created. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zCell</td><td>The size of the map cell to be created. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noAtoms</td><td>The number of atoms as determined by the MMDB Crawl. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00257">257</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;{</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">//======================================== Initialise clipper variables</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    clipper::Spacegroup spgr                  ( clipper::Spacegroup::P1 );</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    clipper::Cell cell                        ( clipper::Cell_descr ( <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span> ( xCell ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span> ( yCell ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span> ( zCell ) ) );</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    clipper::Resolution reso                  = clipper::Resolution ( requestedResolution );</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keyword">const</span> clipper::Grid_sampling grid         ( spgr, cell, reso );</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    clipper::Xmap&lt;float&gt; *densityMap          = <span class="keyword">new</span> clipper::Xmap&lt;float&gt; ( spgr, cell, grid );</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    clipper::mmdb::PPCAtom atom;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">//======================================== Get Clipper XMap</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordtype">int</span> hndl                                  = pdbFile-&gt;NewSelection ( );</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    pdbFile-&gt;SelectAtoms                      ( hndl, 0, 0, ::mmdb::SKEY_NEW );</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    pdbFile-&gt;GetSelIndex                      ( hndl, atom, noAtoms );</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    clipper::MMDBAtom_list *aList             = <span class="keyword">new</span> clipper::MMDBAtom_list ( atom, noAtoms );</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    clipper::EDcalc_aniso&lt;clipper::ftype32&gt; edCalc;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    edCalc                                    ( *densityMap, *aList );</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">//======================================== Find max U, V and W</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    clipper::Xmap_base::Map_reference_index LastPos = (*densityMap).first();</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    clipper::Xmap_base::Map_reference_index PrevPos = (*densityMap).first();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">for</span> ( LastPos = (*densityMap).first(); !LastPos.last(); LastPos.next() ) { PrevPos = LastPos; }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    *xTo                                       = PrevPos.coord().u();</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    *yTo                                       = PrevPos.coord().v();</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    *zTo                                       = PrevPos.coord().w();</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">//======================================== Convert clipper Xmap to my map format</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    map                                       = <span class="keyword">new</span> proshade_double [(*xTo + 1) * (*yTo + 1) * (*zTo + 1)];</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( map, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    proshade_signed arrPos                    = 0;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed uIt = 0; uIt &lt; (*xTo + 1); uIt++ )</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed vIt = 0; vIt &lt; (*yTo + 1); vIt++ )</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed wIt = 0; wIt &lt; (*zTo + 1); wIt++ )</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                arrPos                        = wIt  + (*zTo + 1) * ( vIt  + (*yTo + 1) * uIt );</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                clipper::Vec3&lt;int&gt; pos        ( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( uIt ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( vIt ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( wIt ) );</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                clipper::Coord_grid cg        ( pos );</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                map[arrPos]                   = densityMap-&gt;get_data ( cg );</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">//======================================== Free memory</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keyword">delete</span> densityMap;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    return ;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d1e80b32498ac8019bd2701b49cad2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d1e80b32498ac8019bd2701b49cad2d">&#9670;&nbsp;</a></span>getCorrelationMapMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::getCorrelationMapMask </td>
          <td>(</td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>fakeHalfMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>correlationMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xDimS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yDimS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zDimS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>corrMaskKernel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for creating the correlation mask. </p>
<p>...</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">map</td><td>A Reference Pointer to the map which should be blurred/sharpened. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blurredMap</td><td>A Reference Pointer to the variable which stores the fake half-map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">correlationMask</td><td>A Reference Pointer to empty map where the mask will be saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDimS</td><td>The number of indices along the x axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDimS</td><td>The number of indices along the y axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDimS</td><td>The number of indices along the z axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">corrMaskKernel</td><td>The amount of neighbours in any direction whose correlation is to be used to get the current points correlation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01060">1060</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;{</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="comment">//======================================== Set local variables</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    proshade_signed xDim = xDimS, yDim = yDimS, zDim = zDimS, currentPos, neighArrPos, neighXPos, neighYPos, neighZPos, corrIter;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    proshade_unsign noCorrVals                = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( pow ( ( ( corrMaskKernel * 2 ) + 1 ), 3 ) );</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">//======================================== Alocate memory</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    proshade_double *origMap                  = <span class="keyword">new</span> proshade_double [noCorrVals];</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    proshade_double *fakeHM                   = <span class="keyword">new</span> proshade_double [noCorrVals];</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="comment">//======================================== Check memory allocation</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( origMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( fakeHM,  __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="comment">//======================================== Blur the coeffs</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed uIt = 0; uIt &lt; xDim; uIt++ )</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    {</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed vIt = 0; vIt &lt; yDim; vIt++ )</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed wIt = 0; wIt &lt; zDim; wIt++ )</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                <span class="comment">//============================ Var init</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                currentPos                    = wIt + zDim * ( vIt + yDim * uIt );</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                corrIter                      = 0;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                <span class="comment">//============================ Average neighbours</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                <span class="keywordflow">for</span> ( proshade_signed xCh = -corrMaskKernel; xCh &lt;= +corrMaskKernel; xCh++ )</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                {</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                    <span class="keywordflow">for</span> ( proshade_signed yCh = -corrMaskKernel; yCh &lt;= +corrMaskKernel; yCh++ )</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                    {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                        <span class="keywordflow">for</span> ( proshade_signed zCh = -corrMaskKernel; zCh &lt;= +corrMaskKernel; zCh++ )</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                        {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                            <span class="comment">//================ Find the nieghbour peak indices (with periodicity)</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                            neighXPos         = uIt + xCh; <span class="keywordflow">if</span> ( neighXPos &gt;= xDim ) { neighXPos -= xDim; }; <span class="keywordflow">if</span> ( neighXPos &lt; 0 ) { neighXPos += xDim; }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                            neighYPos         = vIt + yCh; <span class="keywordflow">if</span> ( neighYPos &gt;= yDim ) { neighYPos -= yDim; }; <span class="keywordflow">if</span> ( neighYPos &lt; 0 ) { neighYPos += yDim; }</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                            neighZPos         = wIt + zCh; <span class="keywordflow">if</span> ( neighZPos &gt;= zDim ) { neighZPos -= zDim; }; <span class="keywordflow">if</span> ( neighZPos &lt; 0 ) { neighZPos += zDim; }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                            neighArrPos       = neighZPos + zDim * ( neighYPos + yDim * neighXPos );</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                            </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                            <span class="comment">//================ Add to correct arrays</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                            origMap[corrIter] = map[neighArrPos];</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                            fakeHM[corrIter]  = fakeHalfMap[neighArrPos];</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                            corrIter         += 1;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                        }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                    }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                }</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                <span class="comment">//============================ Save the correlation comparison result</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                correlationMask[currentPos]   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a894d87e94446db04492b663e54a74bff">ProSHADE_internal_maths::pearsonCorrCoeff</a> ( origMap, fakeHM, noCorrVals );</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        }</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    }</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    return ;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa74663cb1126a4a3235f27945e4ac66f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa74663cb1126a4a3235f27945e4ac66f">&#9670;&nbsp;</a></span>getFakeHalfMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::getFakeHalfMap </td>
          <td>(</td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>fakeHalfMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xDimS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yDimS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zDimS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>fakeMapKernel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for creating "fake" half-maps. </p>
<p>This function takes the internal map and an empty map array and proceeds to find all neighbours within the kernel distance to each map points. It then computes the average of these neighbours and saves this average as the value of the "fake" half-map. These are then useul for map masking, as the correlation between the "fake" half-maps and the original maps give nice masks according to Rangana</p><ul>
<li>see him about how well these work.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">map</td><td>A Reference Pointer to the map which should be blurred/sharpened. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blurredMap</td><td>A Reference Pointer to the variable which will store the modified map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDimS</td><td>The number of indices along the x axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDimS</td><td>The number of indices along the y axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDimS</td><td>The number of indices along the z axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fakeMapKernel</td><td>The amount of neighbours in any direction whose average is to be used to get the current point. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00995">995</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;{</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="comment">//======================================== Set local variables</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    proshade_signed xDim                      = xDimS;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    proshade_signed yDim                      = yDimS;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    proshade_signed zDim                      = zDimS;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    proshade_signed currentPos, neighArrPos, neighXPos, neighYPos, neighZPos;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    proshade_double neighSum;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    proshade_double neighCount                = pow ( ( ( fakeMapKernel * 2 ) + 1 ), 3.0 ) - 1.0;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="comment">//======================================== Blur the coeffs</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed uIt = 0; uIt &lt; xDim; uIt++ )</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed vIt = 0; vIt &lt; yDim; vIt++ )</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed wIt = 0; wIt &lt; zDim; wIt++ )</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                <span class="comment">//============================ Var init</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                currentPos                    = wIt + zDim * ( vIt + yDim * uIt );</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                neighSum                      = 0.0;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                <span class="comment">//============================ Average neighbours</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                <span class="keywordflow">for</span> ( proshade_signed xCh = -fakeMapKernel; xCh &lt;= +fakeMapKernel; xCh++ )</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                {</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                    <span class="keywordflow">for</span> ( proshade_signed yCh = -fakeMapKernel; yCh &lt;= +fakeMapKernel; yCh++ )</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                    {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                        <span class="keywordflow">for</span> ( proshade_signed zCh = -fakeMapKernel; zCh &lt;= +fakeMapKernel; zCh++ )</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                        {</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                            <span class="keywordflow">if</span> ( ( xCh == 0 ) &amp;&amp; ( yCh == 0 ) &amp;&amp; ( zCh == 0 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                            </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                            <span class="comment">//================ Find the nieghbour peak indices (with periodicity)</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                            neighXPos         = uIt + xCh; <span class="keywordflow">if</span> ( neighXPos &gt;= xDim ) { neighXPos -= xDim; }; <span class="keywordflow">if</span> ( neighXPos &lt; 0 ) { neighXPos += xDim; }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                            neighYPos         = vIt + yCh; <span class="keywordflow">if</span> ( neighYPos &gt;= yDim ) { neighYPos -= yDim; }; <span class="keywordflow">if</span> ( neighYPos &lt; 0 ) { neighYPos += yDim; }</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                            neighZPos         = wIt + zCh; <span class="keywordflow">if</span> ( neighZPos &gt;= zDim ) { neighZPos -= zDim; }; <span class="keywordflow">if</span> ( neighZPos &lt; 0 ) { neighZPos += zDim; }</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                            neighArrPos       = neighZPos + zDim * ( neighYPos + yDim * neighXPos );</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                            </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                            <span class="comment">//================ Add to average</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                            neighSum         += map[neighArrPos];</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                        }</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                    }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                }</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                <span class="comment">//============================ Save the average to &quot;fake&quot; half-map</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                fakeHalfMap[currentPos]       = neighSum / neighCount;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            }</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    return ;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a05098c48b9e98a02fc1bda2f4fbc5415"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05098c48b9e98a02fc1bda2f4fbc5415">&#9670;&nbsp;</a></span>getIndicesFromAngstroms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_single ProSHADE_internal_mapManip::getIndicesFromAngstroms </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>xAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>yAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>zAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>dist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function converts distance in Angstroms to distance in map indices. </p>
<p>This function finds out how many indices are required to cover a space of size "dist" in Angstroms. If you need this rounded in any way (ceil, floor, ...), just apply appropriate function to the output of this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xDim</td><td>The number of map indices along the x-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDim</td><td>The number of map indices along the y-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDim</td><td>The number of map indices along the z-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xAngs</td><td>The map size in Angstroms along the x-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yAngs</td><td>The map size in Angstroms along the y-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zAngs</td><td>The map size in Angstroms along the z-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dist</td><td>The distance in Angstroms to be converted </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01131">1131</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;{</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="comment">//======================================== Compute</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    proshade_unsign ret                       = <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a> ( std::max ( dist / ( xAngs / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( xDim ) ),</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                                                                                      std::max ( dist / ( yAngs / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( yDim ) ),</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                                                                                                 dist / ( zAngs / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( zDim ) ) ) ) );</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordflow">return</span>                                    ( ret );</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a42699d52d1be0d24e58deea4e25439bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42699d52d1be0d24e58deea4e25439bf">&#9670;&nbsp;</a></span>getMaskFromBlurr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::getMaskFromBlurr </td>
          <td>(</td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>blurMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>outMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>noIQRs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for computing mask from blurred map. </p>
<p>This function takes a blurred map and proceeds to compute the cut-off threshold for masking. It then applies this mask to the blurred map and applies the masking to the second input map. The assumption is that this second map is the map before blurring, as non-zero mask points will not be changed. Careful about this!!! It, however, does not output the mask.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">blurMap</td><td>A Reference Pointer to the map which has been blurred for mask computation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">outMap</td><td>A Reference Pointer to the map which will be masked - this map should be the map before blurring. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDim</td><td>The number of indices along the x axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDim</td><td>The number of indices along the y axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDim</td><td>The number of indices along the z axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noIQRs</td><td>The number of inter-quartile ranges from the median which should be used to compute the threshold for masking. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00603">603</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;{</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">//======================================== Initialise vector for map data</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    std::vector&lt;proshade_double&gt; mapVals ( xDim * yDim * zDim, 0.0 );</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">//======================================== Save map values in vector</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( xDim * yDim * zDim ); iter++ )</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        mapVals.at(iter)                      = blurMap[iter];</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="comment">//======================================== Find median and IQRs</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    proshade_double* medAndIQR                = <span class="keyword">new</span> proshade_double[2];</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#af185ca14eb5d82fb126092767746e00a">ProSHADE_internal_maths::vectorMedianAndIQR</a> ( &amp;mapVals, medAndIQR );</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">//======================================== Find the threshold</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    proshade_double maskThreshold             = medAndIQR[0] + ( medAndIQR[1] * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( noIQRs ) );</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">//======================================== Apply threshold</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( xDim * yDim * zDim ); iter++ )</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">if</span> ( blurMap[iter] &lt; maskThreshold )</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            outMap[iter]                      = 0.0;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            blurMap[iter]                     = 0.0;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">//======================================== Release vector values</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    mapVals.clear                             ( );</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">//======================================== Release memory</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keyword">delete</span>[] medAndIQR;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    return ;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a26c8be8b50be424bb35d3f6f39aa9aff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26c8be8b50be424bb35d3f6f39aa9aff">&#9670;&nbsp;</a></span>getNonZeroBounds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::getNonZeroBounds </td>
          <td>(</td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>xDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>yDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>zDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>xAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>yAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>zAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&amp;&#160;</td>
          <td class="paramname"><em>ret</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for finding the map boundaries enclosing positive only values. </p>
<p>This function takes a map and searches for minimum and maximum map indices in all three dimensions, which enclose all the non-zero map values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">map</td><td>A pointer to the map for which the bounds are to be found. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDim</td><td>The number of indices along the x axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDim</td><td>The number of indices along the y axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDim</td><td>The number of indices along the z axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xAngs</td><td>The size of the x dimension of the map in angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yAngs</td><td>The size of the y dimension of the map in angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zAngs</td><td>The size of the z dimension of the map in angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ret</td><td>A proshade_unsign pointer to array of 6 to which the results will be saved (0 = minX; 1 = maxX; 2 = minY; 3 = maxY; 4 - minZ; 5 = maxZ). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00656">656</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;{</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="comment">//======================================== Initialise local variables</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    proshade_unsign arrayPos                  = 0;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="comment">//======================================== Initialise result variable</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    ret[0]                                    = xDim;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    ret[1]                                    = 0;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    ret[2]                                    = yDim;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    ret[3]                                    = 0;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    ret[4]                                    = zDim;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    ret[5]                                    = 0;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">//======================================== Iterate through map and check bounds</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed xIt = 0; xIt &lt; xDim; xIt++ )</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed yIt = 0; yIt &lt; yDim; yIt++ )</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed zIt = 0; zIt &lt; zDim; zIt++ )</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                <span class="comment">//============================ Var init</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                arrayPos                      = zIt + zDim * ( yIt + yDim * xIt );</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                <span class="comment">//============================ Check bounds</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                <span class="keywordflow">if</span> ( map[arrayPos] &gt; 0.001 )</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                    <span class="keywordflow">if</span> ( xIt &lt; ret[0] )       { ret[0] = xIt; }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    <span class="keywordflow">if</span> ( xIt &gt; ret[1] )       { ret[1] = xIt; }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                    <span class="keywordflow">if</span> ( yIt &lt; ret[2] )       { ret[2] = yIt; }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                    <span class="keywordflow">if</span> ( yIt &gt; ret[3] )       { ret[3] = yIt; }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                    <span class="keywordflow">if</span> ( zIt &lt; ret[4] )       { ret[4] = zIt; }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                    <span class="keywordflow">if</span> ( zIt &gt; ret[5] )       { ret[5] = zIt; }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    return ;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a94dfbe2867f4e294dbb49284881fcb2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94dfbe2867f4e294dbb49284881fcb2a">&#9670;&nbsp;</a></span>moveMapByFourier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::moveMapByFourier </td>
          <td>(</td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>xMov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>yMov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>zMov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>xAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>yAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>zAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>xDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>yDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>zDim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for moving map back to original PDB location by using Fourier transformation. </p>
<p>This function translates the map by changing the phase information of the map Fourier transform and then doing the inverse Fourier. This allows for movement smaller than one index distance, but should not be used over long distances (could move out of boundaries and meet pariodicity problem such as map from different cell now being moved into this cell).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">map</td><td>A Reference Pointer to the map which should be shifted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xMov</td><td>The NEGATIVE value by how many angstroms should the x axis be moved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yMov</td><td>The NEGATIVE value by how many angstroms should the y axis be moved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zMov</td><td>The NEGATIVE value by how many angstroms should the z axis be moved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xAngs</td><td>How many angstroms are there along the x dimension. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yAngs</td><td>How many angstroms are there along the y dimensionzAngs </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zAngs</td><td>How many angstroms are there along the z dimension. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDim</td><td>How many indices are there along the x dimension. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDim</td><td>How many indices are there along the y dimension. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDim</td><td>How many indices are there along the z dimension. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00382">382</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;{</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">//======================================== Local variables initialisation</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    proshade_signed arrayPos                  = 0;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    proshade_signed h, k, l;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    proshade_double real                      = 0.0;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    proshade_double imag                      = 0.0;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    proshade_double trCoeffReal, trCoeffImag;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    proshade_double normFactor                = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( xDim * yDim * zDim );</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    proshade_double exponent                  = 0.0;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    proshade_double hlpArrReal;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    proshade_double hlpArrImag;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">//======================================== Create Fourier map variable</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    fftw_complex *fCoeffs                     = <span class="keyword">new</span> fftw_complex [xDim * yDim * zDim];</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    fftw_complex *translatedMap               = <span class="keyword">new</span> fftw_complex [xDim * yDim * zDim];</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">//======================================== Check memory allocation</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( fCoeffs,       __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( translatedMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">//======================================== Create plans</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    fftw_plan planForwardFourier              = fftw_plan_dft_3d ( xDim, yDim, zDim, translatedMap, fCoeffs, FFTW_FORWARD,  FFTW_ESTIMATE );</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    fftw_plan planBackwardFourier             = fftw_plan_dft_3d ( xDim, yDim, zDim, fCoeffs, translatedMap, FFTW_BACKWARD, FFTW_ESTIMATE );</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">//======================================== Copy map to complex format</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign uIt = 0; uIt &lt; static_cast&lt;proshade_unsign&gt; ( xDim ); uIt++ )</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign vIt = 0; vIt &lt; static_cast&lt;proshade_unsign&gt; ( yDim ); vIt++ )</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign wIt = 0; wIt &lt; static_cast&lt;proshade_unsign&gt; ( zDim ); wIt++ )</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                arrayPos                      = wIt + zDim * ( vIt + yDim * uIt );</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                <span class="keywordflow">if</span> ( map[arrayPos] == map[arrayPos] ) { translatedMap[arrayPos][0] = map[arrayPos]; }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                <span class="keywordflow">else</span>                                  { translatedMap[arrayPos][0] = 0.0; }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                translatedMap[arrayPos][1]    = 0.0;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">//======================================== Compute Forward Fourier</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    fftw_execute                              ( planForwardFourier );</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">//======================================== Add the required shift</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign uIt = 0; uIt &lt; static_cast&lt;proshade_unsign&gt; ( xDim ); uIt++ )</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign vIt = 0; vIt &lt; static_cast&lt;proshade_unsign&gt; ( yDim ); vIt++ )</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign wIt = 0; wIt &lt; static_cast&lt;proshade_unsign&gt; ( zDim ); wIt++ )</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                <span class="comment">//============================ Var init</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                arrayPos                      = wIt + zDim * ( vIt + yDim * uIt );</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                real                          = fCoeffs[arrayPos][0];</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                imag                          = fCoeffs[arrayPos][1];</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                <span class="comment">//======================== Change the B-factors, if required</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                <span class="keywordflow">if</span> ( uIt &gt; <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( (xDim+1) / 2) ) { h = uIt - <span class="keyword">static_cast &lt;</span>proshade_signed<span class="keyword">&gt;</span> ( xDim ); } <span class="keywordflow">else</span> { h = uIt; }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <span class="keywordflow">if</span> ( vIt &gt; <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( (yDim+1) / 2) ) { k = vIt - <span class="keyword">static_cast &lt;</span>proshade_signed<span class="keyword">&gt;</span> ( yDim ); } <span class="keywordflow">else</span> { k = vIt; }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <span class="keywordflow">if</span> ( wIt &gt; <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( (zDim+1) / 2) ) { l = wIt - <span class="keyword">static_cast &lt;</span>proshade_signed<span class="keyword">&gt;</span> ( zDim ); } <span class="keywordflow">else</span> { l = wIt; }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                <span class="comment">//============================ Get translation coefficient change</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                exponent                      = ( ( ( <span class="keyword">static_cast &lt;</span>proshade_double<span class="keyword">&gt;</span> ( h ) / <span class="keyword">static_cast &lt;</span>proshade_double<span class="keyword">&gt;</span> ( xAngs ) ) * (-xMov) ) +</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                                  ( ( <span class="keyword">static_cast &lt;</span>proshade_double<span class="keyword">&gt;</span> ( k ) / <span class="keyword">static_cast &lt;</span>proshade_double<span class="keyword">&gt;</span> ( yAngs ) ) * (-yMov) ) +</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                                                  ( ( <span class="keyword">static_cast &lt;</span>proshade_double<span class="keyword">&gt;</span> ( l ) / <span class="keyword">static_cast &lt;</span>proshade_double<span class="keyword">&gt;</span> ( zAngs ) ) * (-zMov) ) ) * 2.0 * M_PI;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                trCoeffReal                   = cos ( exponent );</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                trCoeffImag                   = sin ( exponent );</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a254fece06e1cfce122a11ddea4f71970">ProSHADE_internal_maths::complexMultiplication</a> ( &amp;real, &amp;imag, &amp;trCoeffReal, &amp;trCoeffImag, &amp;hlpArrReal, &amp;hlpArrImag );</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                <span class="comment">//============================ Save the mask data</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                fCoeffs[arrayPos][0]          = hlpArrReal / normFactor;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                fCoeffs[arrayPos][1]          = hlpArrImag / normFactor;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">//======================================== Compute inverse Fourier</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    fftw_execute                              ( planBackwardFourier );</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">//======================================== Copy back to map</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign uIt = 0; uIt &lt; static_cast&lt;proshade_unsign&gt; ( xDim ); uIt++ )</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign vIt = 0; vIt &lt; static_cast&lt;proshade_unsign&gt; ( yDim ); vIt++ )</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign wIt = 0; wIt &lt; static_cast&lt;proshade_unsign&gt; ( zDim ); wIt++ )</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                arrayPos                      = wIt + zDim * ( vIt + yDim * uIt );</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                map[arrayPos]                 = translatedMap[arrayPos][0];</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">//======================================== Release memory</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    fftw_destroy_plan                         ( planForwardFourier );</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    fftw_destroy_plan                         ( planBackwardFourier );</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keyword">delete</span>[] fCoeffs;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keyword">delete</span>[] translatedMap;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    return ;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a037825616c60bef58075284449872642"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a037825616c60bef58075284449872642">&#9670;&nbsp;</a></span>moveMapByIndices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::moveMapByIndices </td>
          <td>(</td>
          <td class="paramtype">proshade_single *&#160;</td>
          <td class="paramname"><em>xMov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single *&#160;</td>
          <td class="paramname"><em>yMov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single *&#160;</td>
          <td class="paramname"><em>zMov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>xAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>yAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>zAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>xFrom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>xTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>yFrom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>yTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>zFrom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>zTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>xOrigin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>yOrigin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>zOrigin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for moving map back to original PDB location by changing the indices. </p>
<p>This function translates the map by changing the to and from index values so that the location of the map will be the same as the location of the original PDB file. This most likely cannot be done exactly as it allows only movement by increments of the sampling rate, but it is a decent start.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xMov</td><td>Pointer to the NEGATIVE value by how many angstroms should the x axis be moved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yMov</td><td>Pointer to the NEGATIVE value by how many angstroms should the y axis be moved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zMov</td><td>Pointer to the NEGATIVE value by how many angstroms should the z axis be moved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xAngs</td><td>How many angstroms are there along the x dimension. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yAngs</td><td>How many angstroms are there along the y dimension. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zAngs</td><td>How many angstroms are there along the z dimension. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xFrom</td><td>The initial index of the x dimension of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xTo</td><td>The terminal index of the x dimension of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yFrom</td><td>The initial index of the y dimension of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yTo</td><td>The terminal index of the y dimension of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zFrom</td><td>The initial index of the z dimension of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zTo</td><td>The terminal index of the z dimension of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xOrigin</td><td>The first value of the x axis index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yOrigin</td><td>The first value of the y axis index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zOrigin</td><td>The first value of the z axis index. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00334">334</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;{</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">//======================================== Compute movement in indices</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    proshade_signed xIndMove                  = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> (  std::floor ( -(*xMov) / ( xAngs / (*xTo - *xFrom + 1) ) ) );</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    proshade_signed yIndMove                  = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> (  std::floor ( -(*yMov) / ( yAngs / (*yTo - *yFrom + 1) ) ) );</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    proshade_signed zIndMove                  = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> (  std::floor ( -(*zMov) / ( zAngs / (*zTo - *zFrom + 1) ) ) );</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">//======================================== Set the movs to the remainder</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    *xMov                                     =  -( *xMov ) - ( xIndMove * ( xAngs / (*xTo - *xFrom + 1) ) );</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    *yMov                                     =  -( *yMov ) - ( yIndMove * ( yAngs / (*yTo - *yFrom + 1) ) );</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    *zMov                                     =  -( *zMov ) - ( zIndMove * ( zAngs / (*zTo - *zFrom + 1) ) );</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">//======================================== Move indices by as much</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    *xFrom                                    += xIndMove;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    *xTo                                      += xIndMove;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    *yFrom                                    += yIndMove;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    *yTo                                      += yIndMove;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    *zFrom                                    += zIndMove;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    *zTo                                      += zIndMove;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">//======================================== And set origin to reflect the changes</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    *xOrigin                                  = *xFrom;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    *yOrigin                                  = *yFrom;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    *zOrigin                                  = *zFrom;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    return ;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3fc8927d3ed6db95849dba71a2c17c60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fc8927d3ed6db95849dba71a2c17c60">&#9670;&nbsp;</a></span>movePDBForClipper()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::movePDBForClipper </td>
          <td>(</td>
          <td class="paramtype">clipper::mmdb::CMMDBManager *&#160;</td>
          <td class="paramname"><em>pdbFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>xMov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>yMov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>zMov</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for moving PDB atoms to better suit clipper map computation. </p>
<p>This function translates all atoms by a given x, y and z distances. This is required as clipper can only output map cells starting from 0, 0, 0 and therefore to avoid density being in corners for PDB atoms not located in posivite axes, the atoms need to be moved. This effect is reversed later.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdbFile</td><td>Pointer to an open clipper::mmdb::CMMDBManager object to read from. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xMov</td><td>How many angstroms should the atoms be moved along the x axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yMov</td><td>How many angstroms should the atoms be moved along the y axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zMov</td><td>How many angstroms should the atoms be moved along the z axis. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00192">192</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;{</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">//======================================== Initialise MMDB crawl</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">int</span> noChains                              = 0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordtype">int</span> noResidues                            = 0;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordtype">int</span> noAtoms                               = 0;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    clipper::mmdb::PPCChain chain;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    clipper::mmdb::PPCResidue residue;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    clipper::mmdb::PPCAtom atom;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">//======================================== Get all chains</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    pdbFile-&gt;GetChainTable                      ( 1, chain, noChains );</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> nCh = 0; nCh &lt; noChains; nCh++ )</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span> ( chain[nCh] )</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="comment">//================================ Get all residues</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            chain[nCh]-&gt;GetResidueTable       ( residue, noResidues );</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> nRes = 0; nRes &lt; noResidues; nRes++ )</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <span class="keywordflow">if</span> ( residue[nRes] )</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                    <span class="comment">//======================== Get all atoms</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                    residue[nRes]-&gt;GetAtomTable ( atom, noAtoms );</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                    </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> aNo = 0; aNo &lt; noAtoms; aNo++ )</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                        <span class="keywordflow">if</span> ( atom[aNo] )</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                        {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                            <span class="comment">//================ Check for termination &#39;residue&#39;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                            <span class="keywordflow">if</span> ( atom[aNo]-&gt;Ter ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                            </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                            <span class="comment">//================ Change atom positions as required</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                            atom[aNo]-&gt;SetCoordinates ( atom[aNo]-&gt;x + <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span> ( xMov ),</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                                       atom[aNo]-&gt;y + <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span> ( yMov ),</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                                       atom[aNo]-&gt;z + <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span> ( zMov ),</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                                       atom[aNo]-&gt;occupancy,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                                       atom[aNo]-&gt;tempFactor );</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                        }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    return ;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a50df80b02427f9f55a2c7af033a9fb93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50df80b02427f9f55a2c7af033a9fb93">&#9670;&nbsp;</a></span>myRound()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_signed ProSHADE_internal_mapManip::myRound </td>
          <td>(</td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls the appropriate version of round function depending on compiler version. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>A decimal point number to be rounded. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>The rounded number. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00027">27</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#if __cplusplus &gt;= 201103L</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">return</span>                                    ( std::round ( x ) );</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">return</span>                                    ( round ( x ) );</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a167f7a9dbd061752d2a099181090a3b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a167f7a9dbd061752d2a099181090a3b8">&#9670;&nbsp;</a></span>removeMapPhase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::removeMapPhase </td>
          <td>(</td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>mapCoeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zDim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function removes the phase from reciprocal (frequency) map. </p>
<p>This function takes an already FFTW-ed map and its dimensions as the input and proceeds to remove the phase from the map. It writes over the map and does not release any memory - it is the role of the calling function to deal with both these features.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mapCoeffs</td><td>A Reference Pointer to the frequency map, from which phase is to be removed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDim</td><td>The number of indices along the x-axis of the input map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDim</td><td>The number of indices along the y-axis of the input map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDim</td><td>The number of indices along the z-axis of the input map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00946">946</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;{</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="comment">//======================================== Set local variables</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    proshade_double real, imag, mag, phase;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    proshade_unsign arrayPos                  = 0;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    proshade_double normFactor                = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( xDim * yDim * zDim );</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">//======================================== Blur the coeffs</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign uIt = 0; uIt &lt; xDim; uIt++ )</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    {</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign vIt = 0; vIt &lt; yDim; vIt++ )</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign wIt = 0; wIt &lt; zDim; wIt++ )</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            {</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                <span class="comment">//============================ Var init</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                arrayPos                      = wIt + zDim * ( vIt + yDim * uIt );</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                real                          = mapCoeffs[arrayPos][0];</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                imag                          = mapCoeffs[arrayPos][1];</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                <span class="comment">//============================ Get magnitude and phase with mask parameters</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                mag                           = std::sqrt ( (real*real) + (imag*imag) );;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                phase                         = 0.0; <span class="comment">// This would be std::atan2 ( imag, real ); - but here we remove the phase.</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                <span class="comment">//============================ Save the mask data</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                mapCoeffs[arrayPos][0]        = ( mag * cos(phase) ) / normFactor;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                mapCoeffs[arrayPos][1]        = ( mag * sin(phase) ) / normFactor;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            }</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        }</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    }</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    return ;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5db74cc13dd4b64cf0a8377ed078b47c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5db74cc13dd4b64cf0a8377ed078b47c">&#9670;&nbsp;</a></span>reSampleMapToResolutionTrilinear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_mapManip::reSampleMapToResolutionTrilinear </td>
          <td>(</td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xDimS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yDimS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zDimS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>xAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>yAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>zAngs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single *&amp;&#160;</td>
          <td class="paramname"><em>corrs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function re-samples a map to conform to given resolution using Fourier. </p>
<p>This function takes a map and resolution value and it proceeds to create a new map, which has sampling resolution/2 and is large enough to contain the original map. It then proceeds to interpolate the new map values from the old map values, re-writing the old map once interpolation is done.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">map</td><td>A Reference Pointer to the map for which the bounds are to be found. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">resolution</td><td>The required resolution value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDimS</td><td>The number of indices along the x axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDimS</td><td>The number of indices along the y axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDimS</td><td>The number of indices along the z axis of the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xAngs</td><td>The size of the x dimension of the map in angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yAngs</td><td>The size of the y dimension of the map in angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zAngs</td><td>The size of the z dimension of the map in angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">corrs</td><td>Pointer reference to proshade_single array of 6 values with the following meaning: 0 = xAdd; 1 = yAdd; 2 = zAdd; 3 = newXAng; 4 = newYAng; 5 = newZAng </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00749">749</a> of file <a class="el" href="_pro_s_h_a_d_e__map_manip_8cpp_source.html">ProSHADE_mapManip.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;{</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="comment">//======================================== Sanity check - the resolution needs to be set</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">if</span> ( resolution &lt;= 0.0 )</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Requested resolution not set for map re-sampling.&quot;</span>, <span class="stringliteral">&quot;EM00015&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;There is no resolution value set, but map re-sampling to\n                    : this unset resolution value is required. This error\n                    : occurs when a task with no resolution requirement is\n                    : requested on a map data and the map resolution change is\n                    : set to \&#39;on\&#39;. Either supply a resolution value, or do not\n                    : re-sample the map.&quot;</span> );</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">//======================================== Initialise local variables</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    proshade_signed xDim                      = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( xDimS );</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    proshade_signed yDim                      = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( yDimS );</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    proshade_signed zDim                      = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( zDimS );</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    proshade_single oldXSample                = ( xAngs / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( xDim ) );</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    proshade_single oldYSample                = ( yAngs / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( yDim ) );</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    proshade_single oldZSample                = ( zAngs / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( zDim ) );</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    proshade_single newXSample                = resolution / 2.0;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    proshade_single newYSample                = resolution / 2.0;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    proshade_single newZSample                = resolution / 2.0;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">//======================================== Compute required grid size</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    proshade_signed newXDim                   = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( std::ceil ( xAngs / newXSample ) );</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    proshade_signed newYDim                   = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( std::ceil ( yAngs / newYSample ) );</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    proshade_signed newZDim                   = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( std::ceil ( zAngs / newZSample ) );</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">//======================================== Create a new map variable</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    proshade_double* newMap                   = <span class="keyword">new</span> proshade_double [newXDim * newYDim * newZDim];</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="comment">//======================================== For each new map point</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    proshade_signed xBottom = 0, xTop, yBottom = 0, yTop, zBottom = 0, zTop, oldMapIndex, newMapIndex;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    std::vector&lt;proshade_double&gt; c000         = std::vector&lt;proshade_double&gt; ( 4 );</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    std::vector&lt;proshade_double&gt; c001         = std::vector&lt;proshade_double&gt; ( 4 );</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    std::vector&lt;proshade_double&gt; c010         = std::vector&lt;proshade_double&gt; ( 4 );</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    std::vector&lt;proshade_double&gt; c011         = std::vector&lt;proshade_double&gt; ( 4 );</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    std::vector&lt;proshade_double&gt; c100         = std::vector&lt;proshade_double&gt; ( 4 );</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    std::vector&lt;proshade_double&gt; c101         = std::vector&lt;proshade_double&gt; ( 4 );</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    std::vector&lt;proshade_double&gt; c110         = std::vector&lt;proshade_double&gt; ( 4 );</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    std::vector&lt;proshade_double&gt; c111         = std::vector&lt;proshade_double&gt; ( 4 );</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    std::vector&lt;proshade_double&gt; c00          = std::vector&lt;proshade_double&gt; ( 4 );</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    std::vector&lt;proshade_double&gt; c01          = std::vector&lt;proshade_double&gt; ( 4 );</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    std::vector&lt;proshade_double&gt; c10          = std::vector&lt;proshade_double&gt; ( 4 );</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    std::vector&lt;proshade_double&gt; c11          = std::vector&lt;proshade_double&gt; ( 4 );</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    std::vector&lt;proshade_double&gt; c0           = std::vector&lt;proshade_double&gt; ( 4 );</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    std::vector&lt;proshade_double&gt; c1           = std::vector&lt;proshade_double&gt; ( 4 );</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    proshade_double xRelative, yRelative, zRelative;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed xIt = 0; xIt &lt; newXDim; xIt++ )</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed yIt = 0; yIt &lt; newYDim; yIt++ )</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed zIt = 0; zIt &lt; newZDim; zIt++ )</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                <span class="comment">//============================ Get this point&#39;s index</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                newMapIndex                   = zIt + newZDim * ( yIt + newYDim * xIt );</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                <span class="comment">//============================ Find this points bottom and top positions in the old map (including periodicity)</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign ox = 0; ox &lt; (xDimS-1); ox++ ) { <span class="keywordflow">if</span> ( ( ( xIt * newXSample ) &gt;= ( ox * oldXSample ) ) &amp;&amp; ( ( xIt * newXSample ) &lt;= ( (ox+1) * oldXSample ) ) ) { xBottom = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( ox ); <span class="keywordflow">break</span>; } }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign oy = 0; oy &lt; (yDimS-1); oy++ ) { <span class="keywordflow">if</span> ( ( ( yIt * newYSample ) &gt;= ( oy * oldYSample ) ) &amp;&amp; ( ( yIt * newYSample ) &lt;= ( (oy+1) * oldYSample ) ) ) { yBottom = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( oy ); <span class="keywordflow">break</span>; } }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign oz = 0; oz &lt; (zDimS-1); oz++ ) { <span class="keywordflow">if</span> ( ( ( zIt * newZSample ) &gt;= ( oz * oldZSample ) ) &amp;&amp; ( ( zIt * newZSample ) &lt;= ( (oz+1) * oldZSample ) ) ) { zBottom = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( oz ); <span class="keywordflow">break</span>; } }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                xTop = xBottom + 1;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                yTop = yBottom + 1;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                zTop = zBottom + 1;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                <span class="comment">//============================ Find the surrounding point&#39;s values from the original map</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                oldMapIndex                   = zBottom + zDimS * ( yBottom + yDimS * xBottom );</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                c000.at(0) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( xBottom * oldXSample );</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                c000.at(1) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( yBottom * oldYSample );</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                c000.at(2) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( zBottom * oldZSample );</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                c000.at(3) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( map[oldMapIndex] );</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                oldMapIndex                   = zTop    + zDimS * ( yBottom + yDimS * xBottom );</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                c001.at(0) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( xBottom * oldXSample );</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                c001.at(1) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( yBottom * oldYSample );</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                c001.at(2) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( zTop    * oldZSample );</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                c001.at(3) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( map[oldMapIndex] );</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                oldMapIndex                   = zBottom + zDimS * ( yTop    + yDimS * xBottom );</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                c010.at(0) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( xBottom * oldXSample );</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                c010.at(1) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( yTop    * oldYSample );</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                c010.at(2) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( zBottom * oldZSample );</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                c010.at(3) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( map[oldMapIndex] );</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                oldMapIndex                   = zTop    + zDimS * ( yTop    + yDimS * xBottom );</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                c011.at(0) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( xBottom * oldXSample );</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                c011.at(1) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( yTop    * oldYSample );</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                c011.at(2) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( zTop    * oldZSample );</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                c011.at(3) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( map[oldMapIndex] );</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                oldMapIndex                   = zBottom + zDimS * ( yBottom + yDimS * xTop    );</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                c100.at(0) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( xTop    * oldXSample );</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                c100.at(1) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( yBottom * oldYSample );</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                c100.at(2) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( zBottom * oldZSample );</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                c100.at(3) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( map[oldMapIndex] );</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                oldMapIndex                   = zTop    + zDimS * ( yBottom + yDimS * xTop    );</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                c101.at(0) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( xTop    * oldXSample );</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                c101.at(1) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( yBottom * oldYSample );</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                c101.at(2) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( zTop    * oldZSample );</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                c101.at(3) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( map[oldMapIndex] );</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                oldMapIndex                   = zBottom + zDimS * ( yTop    + yDimS * xTop    );</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                c110.at(0) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( xTop    * oldXSample );</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                c110.at(1) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( yTop    * oldYSample );</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                c110.at(2) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( zBottom * oldZSample );</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                c110.at(3) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( map[oldMapIndex] );</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                oldMapIndex                   = zTop    + zDimS * ( yTop    + yDimS * xTop    );</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                c111.at(0) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( xTop    * oldXSample );</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                c111.at(1) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( yTop    * oldYSample );</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                c111.at(2) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( zTop    * oldZSample );</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                c111.at(3) = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( map[oldMapIndex] );</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                <span class="comment">//============================ Interpolate to the new grid along X</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                xRelative                     = ( ( xIt * newXSample ) - ( xBottom * oldXSample ) ) / ( ( xTop * oldXSample ) - ( xBottom * oldXSample ) );</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                <span class="comment">//============================ Interpolate for the less less point</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                c00.at(0)                     = ( newXSample * xRelative ) + c000.at(0);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                c00.at(1)                     = c000.at(1);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                c00.at(2)                     = c000.at(2);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                c00.at(3)                     = ( c000.at(3) * ( 1.0 - xRelative ) ) + ( c100.at(3) * xRelative );</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                <span class="comment">//============================ Interpolate for the less more point</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                c01.at(0)                     = ( newXSample * xRelative ) + c001.at(0);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                c01.at(1)                     = c001.at(1);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                c01.at(2)                     = c001.at(2);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                c01.at(3)                     = ( c001.at(3) * ( 1.0 - xRelative ) ) + ( c101.at(3) * xRelative );</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                <span class="comment">//============================ Interpolate for the more less point</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                c10.at(0)                     = ( newXSample * xRelative ) + c010.at(0);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                c10.at(1)                     = c010.at(1);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                c10.at(2)                     = c010.at(2);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                c10.at(3)                     = ( c010.at(3) * ( 1.0 - xRelative ) ) + ( c110.at(3) * xRelative );</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                <span class="comment">//============================ Interpolate for the more more point</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                c11.at(0)                     = ( newXSample * xRelative ) + c011.at(0);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                c11.at(1)                     = c011.at(1);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                c11.at(2)                     = c011.at(2);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                c11.at(3)                     = ( c011.at(3) * ( 1.0 - xRelative ) ) + ( c111.at(3) * xRelative );</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                <span class="comment">//============================ Interpolate to the new grid along Y</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                yRelative                     = ( ( yIt * newYSample ) - ( yBottom * oldYSample ) ) / ( ( yTop * oldYSample ) - ( yBottom * oldYSample ) );</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                <span class="comment">//============================ Interpolate for the less point</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                c0.at(0)                      = c00.at(0);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                c0.at(1)                      = ( newYSample * yRelative ) + c00.at(1);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                c0.at(2)                      = c00.at(2);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                c0.at(3)                      = ( c00.at(3) * ( 1.0 - yRelative ) ) + ( c10.at(3) * yRelative );</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                <span class="comment">//============================ Interpolate for the more point</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                c1.at(0)                      = c01.at(0);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                c1.at(1)                      = ( newYSample * yRelative ) + c01.at(1);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                c1.at(2)                      = c01.at(2);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                c1.at(3)                      = ( c01.at(3) * ( 1.0 - yRelative ) ) + ( c11.at(3) * yRelative );</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                <span class="comment">//============================ Interpolate to the new grid along Z</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                zRelative                     = ( ( zIt * newZSample ) - ( zBottom * oldZSample ) ) / ( ( zTop * oldZSample ) - ( zBottom * oldZSample ) );</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                newMap[newMapIndex]           = ( c0.at(3) * ( 1.0 - zRelative ) ) + ( c1.at(3) * zRelative );</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            }</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        }</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    }</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="comment">//======================================== Delete old map and allocate new memory</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keyword">delete</span>[] map;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    map                                       = <span class="keyword">new</span> proshade_double [newXDim * newYDim * newZDim];</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="comment">//======================================== Copy map</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( newXDim * newYDim * newZDim ); iter++ )</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        map[iter]                             = newMap[iter];</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="comment">//======================================== Release memory</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keyword">delete</span>[] newMap;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="comment">//======================================== Define change in indices and return it</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    corrs[0]                                  = newXDim - xDim;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    corrs[1]                                  = newYDim - yDim;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    corrs[2]                                  = newZDim - zDim;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    corrs[3]                                  = newXDim * newXSample;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    corrs[4]                                  = newYDim * newYSample;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    corrs[5]                                  = newZDim * newZSample;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    </div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    return ;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclass_pro_s_h_a_d_e__exception_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a></div><div class="ttdoc">This class is the representation of ProSHADE exception.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__exceptions_8hpp_source.html#l00034">ProSHADE_exceptions.hpp:35</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a272ed511f8e39433857ba6c733fa009a"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a272ed511f8e39433857ba6c733fa009a">ProSHADE_internal_mapManip::distributeSpaceToBoundaries</a></div><div class="ttdeci">void distributeSpaceToBoundaries(proshade_signed &amp;minBound, proshade_signed &amp;maxBound, proshade_signed oldBoundRange, proshade_signed newBoundRange)</div><div class="ttdoc">Function for adding space to boundaries within the map confines.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01350">ProSHADE_mapManip.cpp:1350</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a254fece06e1cfce122a11ddea4f71970"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a254fece06e1cfce122a11ddea4f71970">ProSHADE_internal_maths::complexMultiplication</a></div><div class="ttdeci">void complexMultiplication(proshade_double *r1, proshade_double *i1, proshade_double *r2, proshade_double *i2, proshade_double *retReal, proshade_double *retImag)</div><div class="ttdoc">Function to multiply two complex numbers.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00033">ProSHADE_maths.cpp:33</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a894d87e94446db04492b663e54a74bff"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a894d87e94446db04492b663e54a74bff">ProSHADE_internal_maths::pearsonCorrCoeff</a></div><div class="ttdeci">proshade_double pearsonCorrCoeff(proshade_double *valSet1, proshade_double *valSet2, proshade_unsign length)</div><div class="ttdoc">Function for computing the Pearson's correlation coefficient.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00235">ProSHADE_maths.cpp:235</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a8a52d854a63ecad80c1805d601ffcf96"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a8a52d854a63ecad80c1805d601ffcf96">ProSHADE_internal_misc::addToSignedVector</a></div><div class="ttdeci">void addToSignedVector(std::vector&lt; proshade_signed &gt; *vecToAddTo, proshade_signed elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00118">ProSHADE_misc.cpp:118</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a05098c48b9e98a02fc1bda2f4fbc5415"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a05098c48b9e98a02fc1bda2f4fbc5415">ProSHADE_internal_mapManip::getIndicesFromAngstroms</a></div><div class="ttdeci">proshade_single getIndicesFromAngstroms(proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_single dist)</div><div class="ttdoc">This function converts distance in Angstroms to distance in map indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01131">ProSHADE_mapManip.cpp:1131</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a6359dd366cdd986f5ad155bff8235a8e"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a6359dd366cdd986f5ad155bff8235a8e">ProSHADE_internal_maths::primeFactorsDecomp</a></div><div class="ttdeci">std::vector&lt; proshade_signed &gt; primeFactorsDecomp(proshade_signed number)</div><div class="ttdoc">Function to find prime factors of an integer.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01231">ProSHADE_maths.cpp:1231</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_abc6c505ea6b876bfae4d5f45dab63e98"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#abc6c505ea6b876bfae4d5f45dab63e98">ProSHADE_internal_mapManip::betterClosePrimeFactors</a></div><div class="ttdeci">proshade_signed betterClosePrimeFactors(proshade_signed fromRange, proshade_signed toRange)</div><div class="ttdoc">Function for finding close numbers with better prime factors.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01304">ProSHADE_mapManip.cpp:1304</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a50df80b02427f9f55a2c7af033a9fb93"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a></div><div class="ttdeci">proshade_signed myRound(proshade_double x)</div><div class="ttdoc">Calls the appropriate version of round function depending on compiler version.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00027">ProSHADE_mapManip.cpp:27</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_af556836aa9286c1571196de442a6b493"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a></div><div class="ttdeci">void checkMemoryAllocation(chVar checkVar, std::string fileP, unsigned int lineP, std::string funcP, std::string infoP=&quot;This error may occurs when ProSHADE requests memory to be\n                    : allocated to it and this operation fails. This could\n                    : happen when not enough memory is available, either due to\n                    : other processes using a lot of memory, or when the machine\n                    : does not have sufficient memory available. Re-run to see\n                    : if this problem persists.&quot;)</div><div class="ttdoc">Checks if memory was allocated properly.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8hpp_source.html#l00059">ProSHADE_misc.hpp:59</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_af185ca14eb5d82fb126092767746e00a"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#af185ca14eb5d82fb126092767746e00a">ProSHADE_internal_maths::vectorMedianAndIQR</a></div><div class="ttdeci">void vectorMedianAndIQR(std::vector&lt; proshade_double &gt; *vec, proshade_double *&amp;ret)</div><div class="ttdoc">Function to get vector median and inter-quartile range.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00138">ProSHADE_maths.cpp:138</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_pro_s_h_a_d_e__internal__map_manip.html">ProSHADE_internal_mapManip</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
