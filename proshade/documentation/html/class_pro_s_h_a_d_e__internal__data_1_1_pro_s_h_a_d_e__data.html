<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ProSHADE: ProSHADE_internal_data::ProSHADE_data Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ProSHADE
   &#160;<span id="projectnumber">0.7.6.2 (DEC 2021)</span>
   </div>
   <div id="projectbrief">Protein Shape Detection</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ProSHADE_internal_data::ProSHADE_data Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class contains all inputed and derived data for a single structure.  
 <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_pro_s_h_a_d_e__data_8hpp_source.html">ProSHADE_data.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a549bd90e8cdb71762a48aec59a313dd3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a549bd90e8cdb71762a48aec59a313dd3">ProSHADE_data</a> ()</td></tr>
<tr class="memdesc:a549bd90e8cdb71762a48aec59a313dd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for getting empty <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> class.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a549bd90e8cdb71762a48aec59a313dd3">More...</a><br /></td></tr>
<tr class="separator:a549bd90e8cdb71762a48aec59a313dd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7afb32f0574cb707876c4502680dfd80"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7afb32f0574cb707876c4502680dfd80">ProSHADE_data</a> (std::string strName, double *mapVals, int len, proshade_single xDmSz, proshade_single yDmSz, proshade_single zDmSz, proshade_unsign xDmInd, proshade_unsign yDmInd, proshade_unsign zDmInd, proshade_signed xFr, proshade_signed yFr, proshade_signed zFr, proshade_signed xT, proshade_signed yT, proshade_signed zT, proshade_unsign inputO)</td></tr>
<tr class="memdesc:a7afb32f0574cb707876c4502680dfd80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for creating <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> structure with data.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7afb32f0574cb707876c4502680dfd80">More...</a><br /></td></tr>
<tr class="separator:a7afb32f0574cb707876c4502680dfd80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a485495727d37abd66295bab95d368438"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a485495727d37abd66295bab95d368438">~ProSHADE_data</a> (void)</td></tr>
<tr class="memdesc:a485495727d37abd66295bab95d368438"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for the <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> class.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a485495727d37abd66295bab95d368438">More...</a><br /></td></tr>
<tr class="separator:a485495727d37abd66295bab95d368438"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab12fb2b416250b81dd69d2e86313b59"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aab12fb2b416250b81dd69d2e86313b59">readInStructure</a> (std::string fName, proshade_unsign inputO, <a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, proshade_double *maskArr=nullptr, proshade_unsign maskXDim=0, proshade_unsign maskYDim=0, proshade_unsign maskZDim=0, proshade_double *weightsArr=nullptr, proshade_unsign weigXDim=0, proshade_unsign weigYDim=0, proshade_unsign weigZDim=0)</td></tr>
<tr class="memdesc:aab12fb2b416250b81dd69d2e86313b59"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initialises the basic <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> variables and reads in a single structure.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aab12fb2b416250b81dd69d2e86313b59">More...</a><br /></td></tr>
<tr class="separator:aab12fb2b416250b81dd69d2e86313b59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a341ab1de3f949e1e4688110ed641ae13"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a341ab1de3f949e1e4688110ed641ae13">readInStructure</a> (gemmi::Structure gemmiStruct, proshade_unsign inputO, <a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a341ab1de3f949e1e4688110ed641ae13"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initialises the basic <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> variables and reads in a single structure from Gemmi co-ordinate object.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a341ab1de3f949e1e4688110ed641ae13">More...</a><br /></td></tr>
<tr class="separator:a341ab1de3f949e1e4688110ed641ae13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81e6aab30488052e6bdd9b339e8124d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a81e6aab30488052e6bdd9b339e8124d8">writeMap</a> (std::string fName, std::string title=&quot;Created by ProSHADE and written by GEMMI&quot;, int mode=2)</td></tr>
<tr class="memdesc:a81e6aab30488052e6bdd9b339e8124d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for writing out the internal structure representation in MRC MAP format.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a81e6aab30488052e6bdd9b339e8124d8">More...</a><br /></td></tr>
<tr class="separator:a81e6aab30488052e6bdd9b339e8124d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36f99ea1e23f754d65f3612052ce5c42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a36f99ea1e23f754d65f3612052ce5c42">writePdb</a> (std::string fName, proshade_double euA=0.0, proshade_double euB=0.0, proshade_double euG=0.0, proshade_double trsX=0.0, proshade_double trsY=0.0, proshade_double trsZ=0.0, proshade_double rotX=0.0, proshade_double rotY=0.0, proshade_double rotZ=0.0, bool firstModel=true)</td></tr>
<tr class="memdesc:a36f99ea1e23f754d65f3612052ce5c42"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function writes out the co-ordinates file with ProSHADE type rotation and translation applied.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a36f99ea1e23f754d65f3612052ce5c42">More...</a><br /></td></tr>
<tr class="separator:a36f99ea1e23f754d65f3612052ce5c42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a291d70d6d298ce4094b625f588c83b1c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a291d70d6d298ce4094b625f588c83b1c">writeGemmi</a> (std::string fName, gemmi::Structure gemmiStruct, proshade_double euA=0.0, proshade_double euB=0.0, proshade_double euG=0.0, proshade_double trsX=0.0, proshade_double trsY=0.0, proshade_double trsZ=0.0, proshade_double rotX=0.0, proshade_double rotY=0.0, proshade_double rotZ=0.0, bool firstModel=true)</td></tr>
<tr class="memdesc:a291d70d6d298ce4094b625f588c83b1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function writes out the gemmi::Structure object with ProSHADE type rotation and translation applied.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a291d70d6d298ce4094b625f588c83b1c">More...</a><br /></td></tr>
<tr class="separator:a291d70d6d298ce4094b625f588c83b1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac87b1a87f32a742ea2b41014dac5f7b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aac87b1a87f32a742ea2b41014dac5f7b">writeMask</a> (std::string fName, proshade_double *mask)</td></tr>
<tr class="memdesc:aac87b1a87f32a742ea2b41014dac5f7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for writing out a mask in MRC MAP format.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aac87b1a87f32a742ea2b41014dac5f7b">More...</a><br /></td></tr>
<tr class="separator:aac87b1a87f32a742ea2b41014dac5f7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa67115a6b234764c958899863fb60b54"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa67115a6b234764c958899863fb60b54">invertMirrorMap</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:aa67115a6b234764c958899863fb60b54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for inverting the map to its mirror image.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa67115a6b234764c958899863fb60b54">More...</a><br /></td></tr>
<tr class="separator:aa67115a6b234764c958899863fb60b54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a255bdb77824ce0fddc2454d5823219e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a255bdb77824ce0fddc2454d5823219e1">normaliseMap</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a255bdb77824ce0fddc2454d5823219e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for normalising the map values to mean 0 and sd 1..  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a255bdb77824ce0fddc2454d5823219e1">More...</a><br /></td></tr>
<tr class="separator:a255bdb77824ce0fddc2454d5823219e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0122be830893f5d82bab742be54d1ee7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0122be830893f5d82bab742be54d1ee7">maskMap</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a0122be830893f5d82bab742be54d1ee7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for computing the map mask using blurring and X IQRs from median.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0122be830893f5d82bab742be54d1ee7">More...</a><br /></td></tr>
<tr class="separator:a0122be830893f5d82bab742be54d1ee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0dc9f3ed79cc98719e6b727bb8bb982"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac0dc9f3ed79cc98719e6b727bb8bb982">getReBoxBoundaries</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, proshade_signed *&amp;ret)</td></tr>
<tr class="memdesc:ac0dc9f3ed79cc98719e6b727bb8bb982"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finds the boundaries enclosing positive map values and adds some extra space.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac0dc9f3ed79cc98719e6b727bb8bb982">More...</a><br /></td></tr>
<tr class="separator:ac0dc9f3ed79cc98719e6b727bb8bb982"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3349a7f6ffecc3ffd4e09192eb919248"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3349a7f6ffecc3ffd4e09192eb919248">createNewMapFromBounds</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_data</a> *&amp;newStr, proshade_signed *newBounds)</td></tr>
<tr class="memdesc:a3349a7f6ffecc3ffd4e09192eb919248"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function creates a new structure from the calling structure and new bounds values.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3349a7f6ffecc3ffd4e09192eb919248">More...</a><br /></td></tr>
<tr class="separator:a3349a7f6ffecc3ffd4e09192eb919248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab573ea90a16991a06a77c5343328b060"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab573ea90a16991a06a77c5343328b060">reSampleMap</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:ab573ea90a16991a06a77c5343328b060"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function changes the internal map sampling to conform to particular resolution value.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab573ea90a16991a06a77c5343328b060">More...</a><br /></td></tr>
<tr class="separator:ab573ea90a16991a06a77c5343328b060"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80ff45ef40549fb6a1d80b70865fc807"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a80ff45ef40549fb6a1d80b70865fc807">centreMapOnCOM</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a80ff45ef40549fb6a1d80b70865fc807"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function shits the map so that its COM is in the centre of the map.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a80ff45ef40549fb6a1d80b70865fc807">More...</a><br /></td></tr>
<tr class="separator:a80ff45ef40549fb6a1d80b70865fc807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a402c710af1af5fabf7505848dad047"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7a402c710af1af5fabf7505848dad047">addExtraSpace</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a7a402c710af1af5fabf7505848dad047"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function increases the size of the map so that it can add empty space around it.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7a402c710af1af5fabf7505848dad047">More...</a><br /></td></tr>
<tr class="separator:a7a402c710af1af5fabf7505848dad047"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5919acc2f26efcf373db47ed96eadc38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5919acc2f26efcf373db47ed96eadc38">removePhaseInormation</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a5919acc2f26efcf373db47ed96eadc38"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function removes phase from the map, effectively converting it to Patterson map.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5919acc2f26efcf373db47ed96eadc38">More...</a><br /></td></tr>
<tr class="separator:a5919acc2f26efcf373db47ed96eadc38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e36b0876ff78682480a8ec22f3f5264"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7e36b0876ff78682480a8ec22f3f5264">shiftToBoxCentre</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a7e36b0876ff78682480a8ec22f3f5264"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for shifting map so that its centre of box is at required position.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7e36b0876ff78682480a8ec22f3f5264">More...</a><br /></td></tr>
<tr class="separator:a7e36b0876ff78682480a8ec22f3f5264"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8694002911669527ca6266c66285d57"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad8694002911669527ca6266c66285d57">shiftToRotationCentre</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:ad8694002911669527ca6266c66285d57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for shifting map so that its rotation centre is at the centre of the box.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad8694002911669527ca6266c66285d57">More...</a><br /></td></tr>
<tr class="separator:ad8694002911669527ca6266c66285d57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcb4202e9ffea1b99c59f73faf06d899"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afcb4202e9ffea1b99c59f73faf06d899">processInternalMap</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:afcb4202e9ffea1b99c59f73faf06d899"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function simply clusters several other functions which should be called together.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afcb4202e9ffea1b99c59f73faf06d899">More...</a><br /></td></tr>
<tr class="separator:afcb4202e9ffea1b99c59f73faf06d899"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a188b648a0ad28b598d682ca14f288dc4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a188b648a0ad28b598d682ca14f288dc4">getSpherePositions</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a188b648a0ad28b598d682ca14f288dc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function determines the sphere positions (radii) for sphere mapping.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a188b648a0ad28b598d682ca14f288dc4">More...</a><br /></td></tr>
<tr class="separator:a188b648a0ad28b598d682ca14f288dc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56bfcfacedabd84ec54aa2843d59e014"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a56bfcfacedabd84ec54aa2843d59e014">mapToSpheres</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a56bfcfacedabd84ec54aa2843d59e014"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function converts the internal map onto a set of concentric spheres.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a56bfcfacedabd84ec54aa2843d59e014">More...</a><br /></td></tr>
<tr class="separator:a56bfcfacedabd84ec54aa2843d59e014"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23f9a5f8f6fb7cf0f0324bc1d83d6090"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23f9a5f8f6fb7cf0f0324bc1d83d6090">computeSphericalHarmonics</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a23f9a5f8f6fb7cf0f0324bc1d83d6090"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the spherical harmonics decomposition for the whole structure.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23f9a5f8f6fb7cf0f0324bc1d83d6090">More...</a><br /></td></tr>
<tr class="separator:a23f9a5f8f6fb7cf0f0324bc1d83d6090"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada8e6f27f49afc3a0ee17758ce9e7594"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ada8e6f27f49afc3a0ee17758ce9e7594">shellBandExists</a> (proshade_unsign shell, proshade_unsign bandVal)</td></tr>
<tr class="memdesc:ada8e6f27f49afc3a0ee17758ce9e7594"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks if particular shell has a particular band.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ada8e6f27f49afc3a0ee17758ce9e7594">More...</a><br /></td></tr>
<tr class="separator:ada8e6f27f49afc3a0ee17758ce9e7594"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6db2dcf87a6f763909ab08201e8de550"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6db2dcf87a6f763909ab08201e8de550">computeRRPMatrices</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a6db2dcf87a6f763909ab08201e8de550"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function pre-computes the RRP matrices for a data object.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6db2dcf87a6f763909ab08201e8de550">More...</a><br /></td></tr>
<tr class="separator:a6db2dcf87a6f763909ab08201e8de550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e78c033b2c8c038038887105d67b115"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4e78c033b2c8c038038887105d67b115">allocateEMatrices</a> (proshade_unsign band)</td></tr>
<tr class="memdesc:a4e78c033b2c8c038038887105d67b115"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allocates the required memory for the E matrices.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4e78c033b2c8c038038887105d67b115">More...</a><br /></td></tr>
<tr class="separator:a4e78c033b2c8c038038887105d67b115"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc4a61da919ae37b0a03d23df2461224"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abc4a61da919ae37b0a03d23df2461224">allocateSO3CoeffsSpace</a> (proshade_unsign band)</td></tr>
<tr class="memdesc:abc4a61da919ae37b0a03d23df2461224"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allocates the memory for the SO(3) coefficients and the inverse for that calling object.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abc4a61da919ae37b0a03d23df2461224">More...</a><br /></td></tr>
<tr class="separator:abc4a61da919ae37b0a03d23df2461224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea644c87703e005507e187aa0ffa64b7"><td class="memItemLeft" align="right" valign="top"><a id="aea644c87703e005507e187aa0ffa64b7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aea644c87703e005507e187aa0ffa64b7">allocateWignerMatricesSpace</a> ()</td></tr>
<tr class="memdesc:aea644c87703e005507e187aa0ffa64b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allocates the memory for the Wigner matrices for the calling object. <br /></td></tr>
<tr class="separator:aea644c87703e005507e187aa0ffa64b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7cb89ed871668c57a3b5dc953c20482"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac7cb89ed871668c57a3b5dc953c20482">computeRotationFunction</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:ac7cb89ed871668c57a3b5dc953c20482"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the self-rotation function for this structure.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac7cb89ed871668c57a3b5dc953c20482">More...</a><br /></td></tr>
<tr class="separator:ac7cb89ed871668c57a3b5dc953c20482"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad96cd7a72fc56e7d97cfeff1086faad9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad96cd7a72fc56e7d97cfeff1086faad9">convertRotationFunction</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:ad96cd7a72fc56e7d97cfeff1086faad9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function converts the self-rotation function of this structure to angle-axis representation.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad96cd7a72fc56e7d97cfeff1086faad9">More...</a><br /></td></tr>
<tr class="separator:ad96cd7a72fc56e7d97cfeff1086faad9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa757f9d32ebe20435661599652fd30fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa757f9d32ebe20435661599652fd30fa">getRealEMatrixValuesForLM</a> (proshade_signed band, proshade_signed order1, double *eMatsLMReal, int len)</td></tr>
<tr class="memdesc:aa757f9d32ebe20435661599652fd30fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function fills the input array with the real E matrix values for particular band and order1 (l as opposed to l').  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa757f9d32ebe20435661599652fd30fa">More...</a><br /></td></tr>
<tr class="separator:aa757f9d32ebe20435661599652fd30fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b08a8b6f9569c06cd183c924e6e80de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b08a8b6f9569c06cd183c924e6e80de">getImagEMatrixValuesForLM</a> (proshade_signed band, proshade_signed order1, double *eMatsLMImag, int len)</td></tr>
<tr class="memdesc:a9b08a8b6f9569c06cd183c924e6e80de"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function fills the input array with the imaginary E matrix values for particular band and order1 (l as opposed to l').  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b08a8b6f9569c06cd183c924e6e80de">More...</a><br /></td></tr>
<tr class="separator:a9b08a8b6f9569c06cd183c924e6e80de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30eac0ab5b69c1b7190d6e56571ba8b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30eac0ab5b69c1b7190d6e56571ba8b8">getRealSO3Coeffs</a> (double *so3CoefsReal, int len)</td></tr>
<tr class="memdesc:a30eac0ab5b69c1b7190d6e56571ba8b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function fills the input array with the real SO(3) coefficient values.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30eac0ab5b69c1b7190d6e56571ba8b8">More...</a><br /></td></tr>
<tr class="separator:a30eac0ab5b69c1b7190d6e56571ba8b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b76352faa0915b1fef943fe139de5a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4b76352faa0915b1fef943fe139de5a6">getImagSO3Coeffs</a> (double *so3CoefsImag, int len)</td></tr>
<tr class="memdesc:a4b76352faa0915b1fef943fe139de5a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function fills the input array with the imaginary SO(3) coefficient values.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4b76352faa0915b1fef943fe139de5a6">More...</a><br /></td></tr>
<tr class="separator:a4b76352faa0915b1fef943fe139de5a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bc5fbad1079d42bfa73913a9e2df619"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8bc5fbad1079d42bfa73913a9e2df619">getRealRotFunction</a> (double *rotFunReal, int len)</td></tr>
<tr class="memdesc:a8bc5fbad1079d42bfa73913a9e2df619"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function fills the input array with the real rotation function values.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8bc5fbad1079d42bfa73913a9e2df619">More...</a><br /></td></tr>
<tr class="separator:a8bc5fbad1079d42bfa73913a9e2df619"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b063d1ca2ebed239029bad6250cf376"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b063d1ca2ebed239029bad6250cf376">getImagRotFunction</a> (double *rotFunImag, int len)</td></tr>
<tr class="memdesc:a9b063d1ca2ebed239029bad6250cf376"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function fills the input array with the imaginary rotation function values.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b063d1ca2ebed239029bad6250cf376">More...</a><br /></td></tr>
<tr class="separator:a9b063d1ca2ebed239029bad6250cf376"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94cce09895dc9f41d4b9a429ccf638e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94cce09895dc9f41d4b9a429ccf638e8">getRealTranslationFunction</a> (double *trsFunReal, int len)</td></tr>
<tr class="memdesc:a94cce09895dc9f41d4b9a429ccf638e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function fills the input array with the real translation function values.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94cce09895dc9f41d4b9a429ccf638e8">More...</a><br /></td></tr>
<tr class="separator:a94cce09895dc9f41d4b9a429ccf638e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97766b6a74aee4c364c1fd8efd6478ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a97766b6a74aee4c364c1fd8efd6478ff">getImagTranslationFunction</a> (double *trsFunImag, int len)</td></tr>
<tr class="memdesc:a97766b6a74aee4c364c1fd8efd6478ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function fills the input array with the imaginary translation function values.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a97766b6a74aee4c364c1fd8efd6478ff">More...</a><br /></td></tr>
<tr class="separator:a97766b6a74aee4c364c1fd8efd6478ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a688bac56d3c483bd99c0ff7d63cf7602"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a688bac56d3c483bd99c0ff7d63cf7602">getRotMatrixFromRotFunInds</a> (proshade_signed aI, proshade_signed bI, proshade_signed gI, double *rotMat, int len)</td></tr>
<tr class="memdesc:a688bac56d3c483bd99c0ff7d63cf7602"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes rotation function indices, converts them to Euler angles and these to rotation matrix, which it then returns.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a688bac56d3c483bd99c0ff7d63cf7602">More...</a><br /></td></tr>
<tr class="separator:a688bac56d3c483bd99c0ff7d63cf7602"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f6ba75b25e201466929bfd4df75688d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9f6ba75b25e201466929bfd4df75688d">so3CoeffsArrayIndex</a> (proshade_signed order1, proshade_signed order2, proshade_signed band)</td></tr>
<tr class="memdesc:a9f6ba75b25e201466929bfd4df75688d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function gets the SO(3) coefficients array index for a particular so(3) band, order1 and order2 position.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9f6ba75b25e201466929bfd4df75688d">More...</a><br /></td></tr>
<tr class="separator:a9f6ba75b25e201466929bfd4df75688d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fdc5b9df47ff8de3a5f2f6e6ce233a5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; proshade_double * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1fdc5b9df47ff8de3a5f2f6e6ce233a5">getDihedralSymmetriesList</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, std::vector&lt; proshade_double * &gt; *CSymList)</td></tr>
<tr class="memdesc:a1fdc5b9df47ff8de3a5f2f6e6ce233a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function obtains a list of all D symmetries from already computed C symmetries list.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1fdc5b9df47ff8de3a5f2f6e6ce233a5">More...</a><br /></td></tr>
<tr class="separator:a1fdc5b9df47ff8de3a5f2f6e6ce233a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85bfab9b1babe0b35e6d81f525ead29b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; proshade_double * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a85bfab9b1babe0b35e6d81f525ead29b">getTetrahedralSymmetriesList</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, std::vector&lt; proshade_double * &gt; *CSymList)</td></tr>
<tr class="memdesc:a85bfab9b1babe0b35e6d81f525ead29b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function obtains a list of all T symmetry axes from the already computed C symmetries list.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a85bfab9b1babe0b35e6d81f525ead29b">More...</a><br /></td></tr>
<tr class="separator:a85bfab9b1babe0b35e6d81f525ead29b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14c4d6044c5174afa8a0984025c45436"><td class="memItemLeft" align="right" valign="top">std::vector&lt; proshade_double * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14c4d6044c5174afa8a0984025c45436">getOctahedralSymmetriesList</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, std::vector&lt; proshade_double * &gt; *CSymList)</td></tr>
<tr class="memdesc:a14c4d6044c5174afa8a0984025c45436"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function obtains a list of all O symmetry axes from the already computed C symmetries list.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14c4d6044c5174afa8a0984025c45436">More...</a><br /></td></tr>
<tr class="separator:a14c4d6044c5174afa8a0984025c45436"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad46b5c9a39df4faa45cc53d31aab43db"><td class="memItemLeft" align="right" valign="top">std::vector&lt; proshade_double * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad46b5c9a39df4faa45cc53d31aab43db">getIcosahedralSymmetriesList</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, std::vector&lt; proshade_double * &gt; *CSymList)</td></tr>
<tr class="memdesc:ad46b5c9a39df4faa45cc53d31aab43db"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function obtains a list of all I symmetry axes from the already computed C symmetries list.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad46b5c9a39df4faa45cc53d31aab43db">More...</a><br /></td></tr>
<tr class="separator:ad46b5c9a39df4faa45cc53d31aab43db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9a02d8d68aac021572b764651aad0f1"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; proshade_double * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad9a02d8d68aac021572b764651aad0f1">getPredictedIcosahedralSymmetriesList</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, std::vector&lt; proshade_double * &gt; *CSymList)</td></tr>
<tr class="memdesc:ad9a02d8d68aac021572b764651aad0f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function predicts a list of all I symmetry axes from the already computed C symmetries list.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad9a02d8d68aac021572b764651aad0f1">More...</a><br /></td></tr>
<tr class="separator:ad9a02d8d68aac021572b764651aad0f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae97b54a34689c1dceae47a5e8e94bbb0"><td class="memItemLeft" align="right" valign="top">std::vector&lt; proshade_double * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae97b54a34689c1dceae47a5e8e94bbb0">getPredictedOctahedralSymmetriesList</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, std::vector&lt; proshade_double * &gt; *CSymList)</td></tr>
<tr class="memdesc:ae97b54a34689c1dceae47a5e8e94bbb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function predicts a list of all O symmetry axes from the already computed C symmetries list.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae97b54a34689c1dceae47a5e8e94bbb0">More...</a><br /></td></tr>
<tr class="separator:ae97b54a34689c1dceae47a5e8e94bbb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a931aa4c10c426c3b8041bd4e838b0678"><td class="memItemLeft" align="right" valign="top">std::vector&lt; proshade_double * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a931aa4c10c426c3b8041bd4e838b0678">getPredictedTetrahedralSymmetriesList</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, std::vector&lt; proshade_double * &gt; *CSymList)</td></tr>
<tr class="memdesc:a931aa4c10c426c3b8041bd4e838b0678"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function predicts a list of all T symmetry axes from the already computed C symmetries list.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a931aa4c10c426c3b8041bd4e838b0678">More...</a><br /></td></tr>
<tr class="separator:a931aa4c10c426c3b8041bd4e838b0678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcf770f9177a4d2f1a94a3adb20bf790"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abcf770f9177a4d2f1a94a3adb20bf790">detectSymmetryFromAngleAxisSpace</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, std::vector&lt; proshade_double * &gt; *axes, std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *allCs)</td></tr>
<tr class="memdesc:abcf770f9177a4d2f1a94a3adb20bf790"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function runs the symmetry detection algorithms on this structure using the angle-axis space and saving the results in the settings object.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abcf770f9177a4d2f1a94a3adb20bf790">More...</a><br /></td></tr>
<tr class="separator:abcf770f9177a4d2f1a94a3adb20bf790"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa3b1a8ef870a606035102b5dcf1ce44"><td class="memItemLeft" align="right" valign="top">std::vector&lt; proshade_double * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa3b1a8ef870a606035102b5dcf1ce44">getCyclicSymmetriesListFromAngleAxis</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:afa3b1a8ef870a606035102b5dcf1ce44"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function obtains a list of all C symmetries from the angle-axis space mapped rotation function values.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa3b1a8ef870a606035102b5dcf1ce44">More...</a><br /></td></tr>
<tr class="separator:afa3b1a8ef870a606035102b5dcf1ce44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2714fcb2c08b224ccf09d64322bd2ab2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; proshade_double * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2714fcb2c08b224ccf09d64322bd2ab2">findRequestedCSymmetryFromAngleAxis</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, proshade_unsign fold, proshade_double *peakThres)</td></tr>
<tr class="memdesc:a2714fcb2c08b224ccf09d64322bd2ab2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function searches the angle-axis representation of the rotation function for a cyclic point group with given fold.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2714fcb2c08b224ccf09d64322bd2ab2">More...</a><br /></td></tr>
<tr class="separator:a2714fcb2c08b224ccf09d64322bd2ab2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b0608e80f20087b24cc9498767f0894"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0b0608e80f20087b24cc9498767f0894">saveDetectedSymmetries</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, std::vector&lt; proshade_double * &gt; *CSyms, std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *allCs)</td></tr>
<tr class="memdesc:a0b0608e80f20087b24cc9498767f0894"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes the results of point group searches and saves then into the output variables.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0b0608e80f20087b24cc9498767f0894">More...</a><br /></td></tr>
<tr class="separator:a0b0608e80f20087b24cc9498767f0894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5add825ce8d5e5d9f598f6912f07aff"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5add825ce8d5e5d9f598f6912f07aff">getRecommendedSymmetryType</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:ad5add825ce8d5e5d9f598f6912f07aff"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function simply returns the detected recommended symmetry type.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5add825ce8d5e5d9f598f6912f07aff">More...</a><br /></td></tr>
<tr class="separator:ad5add825ce8d5e5d9f598f6912f07aff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e1bd5bd5a3fd12691a1d83735c13250"><td class="memItemLeft" align="right" valign="top">proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e1bd5bd5a3fd12691a1d83735c13250">getRecommendedSymmetryFold</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a8e1bd5bd5a3fd12691a1d83735c13250"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function simply returns the detected recommended symmetry fold.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e1bd5bd5a3fd12691a1d83735c13250">More...</a><br /></td></tr>
<tr class="separator:a8e1bd5bd5a3fd12691a1d83735c13250"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1fdcd9bdebc2900748821c5b3cb53cc"><td class="memItemLeft" align="right" valign="top">proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1fdcd9bdebc2900748821c5b3cb53cc">getNoRecommendedSymmetryAxes</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:ad1fdcd9bdebc2900748821c5b3cb53cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the number of detected recommended symmetry axes.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1fdcd9bdebc2900748821c5b3cb53cc">More...</a><br /></td></tr>
<tr class="separator:ad1fdcd9bdebc2900748821c5b3cb53cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0662f17e733fb6c1a16f04b273f8b7a5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0662f17e733fb6c1a16f04b273f8b7a5">getSymmetryAxis</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, proshade_unsign axisNo)</td></tr>
<tr class="memdesc:a0662f17e733fb6c1a16f04b273f8b7a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns a single symmetry axis as a vector of strings from the recommended symmetry axes list.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0662f17e733fb6c1a16f04b273f8b7a5">More...</a><br /></td></tr>
<tr class="separator:a0662f17e733fb6c1a16f04b273f8b7a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf2c2c9634a9e641270f8889624c3752"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#acf2c2c9634a9e641270f8889624c3752">prepareFSCFourierMemory</a> (fftw_complex *&amp;mapData, fftw_complex *&amp;origCoeffs, fftw_complex *&amp;fCoeffs, proshade_signed *&amp;binIndexing, proshade_signed *noBins, proshade_double **&amp;bindata, proshade_signed *&amp;binCounts, fftw_plan *planForwardFourier, proshade_double *&amp;fscByBin)</td></tr>
<tr class="memdesc:acf2c2c9634a9e641270f8889624c3752"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allocates the memory and makes all preparations required for FSC computation.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#acf2c2c9634a9e641270f8889624c3752">More...</a><br /></td></tr>
<tr class="separator:acf2c2c9634a9e641270f8889624c3752"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42419398083b05da19ebfb3cfa5cdc34"><td class="memItemLeft" align="right" valign="top">proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">computeFSC</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, std::vector&lt; proshade_double * &gt; *CSym, size_t symIndex, fftw_complex *mapData, fftw_complex *fCoeffs, fftw_complex *origCoeffs, fftw_plan *planForwardFourier, proshade_signed noBins, proshade_signed *binIndexing, proshade_double **&amp;bindata, proshade_signed *&amp;binCounts, proshade_double *&amp;fscByBin)</td></tr>
<tr class="memdesc:a42419398083b05da19ebfb3cfa5cdc34"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes FSC for any given axis in the supplied CSym symmetry axes vector.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">More...</a><br /></td></tr>
<tr class="separator:a42419398083b05da19ebfb3cfa5cdc34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c9b62338517f1da1693b1073ebc9389"><td class="memItemLeft" align="right" valign="top">proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7c9b62338517f1da1693b1073ebc9389">computeFSC</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, proshade_double *sym, fftw_complex *mapData, fftw_complex *fCoeffs, fftw_complex *origCoeffs, fftw_plan *planForwardFourier, proshade_signed noBins, proshade_signed *binIndexing, proshade_double **&amp;bindata, proshade_signed *&amp;binCounts, proshade_double *&amp;fscByBin)</td></tr>
<tr class="memdesc:a7c9b62338517f1da1693b1073ebc9389"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes FSC for any given axis in the supplied CSym symmetry axes vector.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7c9b62338517f1da1693b1073ebc9389">More...</a><br /></td></tr>
<tr class="separator:a7c9b62338517f1da1693b1073ebc9389"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9b0fec5092eed1ab485443c15289e14"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad9b0fec5092eed1ab485443c15289e14">saveRecommendedSymmetry</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, std::vector&lt; proshade_double * &gt; *CSym, std::vector&lt; proshade_double * &gt; *DSym, std::vector&lt; proshade_double * &gt; *TSym, std::vector&lt; proshade_double * &gt; *OSym, std::vector&lt; proshade_double * &gt; *ISym, std::vector&lt; proshade_double * &gt; *axes, fftw_complex *mapData, fftw_complex *origCoeffs, fftw_complex *fCoeffs, fftw_plan *planForwardFourier, proshade_signed noBins, proshade_signed *binIndexing, proshade_double **bindata, proshade_signed *binCounts, proshade_double *&amp;fscByBin)</td></tr>
<tr class="memdesc:ad9b0fec5092eed1ab485443c15289e14"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes all the detected symmetry results and decides on which are to be recommended for this structure.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad9b0fec5092eed1ab485443c15289e14">More...</a><br /></td></tr>
<tr class="separator:ad9b0fec5092eed1ab485443c15289e14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a599a8fa1d6d780a45a2d772413bc778e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a599a8fa1d6d780a45a2d772413bc778e">saveRequestedSymmetryC</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, std::vector&lt; proshade_double * &gt; *CSym, std::vector&lt; proshade_double * &gt; *axes)</td></tr>
<tr class="memdesc:a599a8fa1d6d780a45a2d772413bc778e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes the C symmetries and searched for the requested symmetry.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a599a8fa1d6d780a45a2d772413bc778e">More...</a><br /></td></tr>
<tr class="separator:a599a8fa1d6d780a45a2d772413bc778e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa200af7e84ec7a17ecfd54a45a8ffafe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa200af7e84ec7a17ecfd54a45a8ffafe">saveRequestedSymmetryD</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, std::vector&lt; proshade_double * &gt; *DSym, std::vector&lt; proshade_double * &gt; *axes, fftw_complex *mapData, fftw_complex *origCoeffs, fftw_complex *fCoeffs, fftw_plan *planForwardFourier, proshade_signed noBins, proshade_signed *binIndexing, proshade_double **bindata, proshade_signed *binCounts, proshade_double *&amp;fscByBin)</td></tr>
<tr class="memdesc:aa200af7e84ec7a17ecfd54a45a8ffafe"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes the D symmetries and searched for the requested symmetry.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa200af7e84ec7a17ecfd54a45a8ffafe">More...</a><br /></td></tr>
<tr class="separator:aa200af7e84ec7a17ecfd54a45a8ffafe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2f2469c7d252c5e87d7bf9976b9b796"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; proshade_double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae2f2469c7d252c5e87d7bf9976b9b796">getAllGroupElements</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, std::vector&lt; proshade_unsign &gt; axesList, std::string groupType=&quot;&quot;, proshade_double matrixTolerance=0.05)</td></tr>
<tr class="memdesc:ae2f2469c7d252c5e87d7bf9976b9b796"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the group elements as rotation matrices of any defined point group.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae2f2469c7d252c5e87d7bf9976b9b796">More...</a><br /></td></tr>
<tr class="separator:ae2f2469c7d252c5e87d7bf9976b9b796"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc06f274535401086eefad02fcc8ac10"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; proshade_double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afc06f274535401086eefad02fcc8ac10">getAllGroupElements</a> (std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *allCs, std::vector&lt; proshade_unsign &gt; axesList, std::string groupType=&quot;&quot;, proshade_double matrixTolerance=0.05)</td></tr>
<tr class="memdesc:afc06f274535401086eefad02fcc8ac10"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the group elements as rotation matrices of any defined point group.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afc06f274535401086eefad02fcc8ac10">More...</a><br /></td></tr>
<tr class="separator:afc06f274535401086eefad02fcc8ac10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abea2d62360b17cddca155816d3e485e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abea2d62360b17cddca155816d3e485e8">reportSymmetryResults</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:abea2d62360b17cddca155816d3e485e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes prints the report for symmetry detection.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abea2d62360b17cddca155816d3e485e8">More...</a><br /></td></tr>
<tr class="separator:abea2d62360b17cddca155816d3e485e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad409e4556676857224d1f5e00e5b7911"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad409e4556676857224d1f5e00e5b7911">getOverlayRotationFunction</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj2)</td></tr>
<tr class="memdesc:ad409e4556676857224d1f5e00e5b7911"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the overlay rotation function (i.e. the correlation function in SO(3) space).  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad409e4556676857224d1f5e00e5b7911">More...</a><br /></td></tr>
<tr class="separator:ad409e4556676857224d1f5e00e5b7911"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a129f0b665c31fe2d6c7a03f1ba9997de"><td class="memItemLeft" align="right" valign="top">std::vector&lt; proshade_double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a129f0b665c31fe2d6c7a03f1ba9997de">getBestRotationMapPeaksEulerAngles</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a129f0b665c31fe2d6c7a03f1ba9997de"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns a vector of three floats, the three Euler angles of the best peak in the rotation map.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a129f0b665c31fe2d6c7a03f1ba9997de">More...</a><br /></td></tr>
<tr class="separator:a129f0b665c31fe2d6c7a03f1ba9997de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53412a6bef001a7be8fd98ceaa8a8648"><td class="memItemLeft" align="right" valign="top">std::vector&lt; proshade_double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a53412a6bef001a7be8fd98ceaa8a8648">getBestTranslationMapPeaksAngstrom</a> (<a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *staticStructure)</td></tr>
<tr class="memdesc:a53412a6bef001a7be8fd98ceaa8a8648"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function gets the optimal translation vector and returns it as a standard library vector. It also applies the translation to the internal map.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a53412a6bef001a7be8fd98ceaa8a8648">More...</a><br /></td></tr>
<tr class="separator:a53412a6bef001a7be8fd98ceaa8a8648"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cdec5190d4b2ae60350f0f6db751d4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0cdec5190d4b2ae60350f0f6db751d4b">zeroPaddToDims</a> (proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim)</td></tr>
<tr class="memdesc:a0cdec5190d4b2ae60350f0f6db751d4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function changes the size of a structure to fit the supplied new limits.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0cdec5190d4b2ae60350f0f6db751d4b">More...</a><br /></td></tr>
<tr class="separator:a0cdec5190d4b2ae60350f0f6db751d4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa12ba3d9d61e240ec2d91d924e6cb0d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa12ba3d9d61e240ec2d91d924e6cb0d3">rotateMapReciprocalSpace</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, proshade_double eulerAlpha, proshade_double eulerBeta, proshade_double eulerGamma)</td></tr>
<tr class="memdesc:aa12ba3d9d61e240ec2d91d924e6cb0d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function rotates a map based on the given Euler angles.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa12ba3d9d61e240ec2d91d924e6cb0d3">More...</a><br /></td></tr>
<tr class="separator:aa12ba3d9d61e240ec2d91d924e6cb0d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22caf254dfc11e52890f79a161493e6e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; proshade_double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a22caf254dfc11e52890f79a161493e6e">rotateMapRealSpace</a> (proshade_double axX, proshade_double axY, proshade_double axZ, proshade_double axAng, proshade_double *&amp;map)</td></tr>
<tr class="memdesc:a22caf254dfc11e52890f79a161493e6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function rotates a map based on the given angle-axis rotation.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a22caf254dfc11e52890f79a161493e6e">More...</a><br /></td></tr>
<tr class="separator:a22caf254dfc11e52890f79a161493e6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac626ea4513155170cff98fd18e6f3b09"><td class="memItemLeft" align="right" valign="top">std::vector&lt; proshade_double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac626ea4513155170cff98fd18e6f3b09">rotateMapRealSpaceInPlace</a> (proshade_double eulA, proshade_double eulB, proshade_double eulG)</td></tr>
<tr class="memdesc:ac626ea4513155170cff98fd18e6f3b09"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function rotates a map based on the given Euler angles in place.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac626ea4513155170cff98fd18e6f3b09">More...</a><br /></td></tr>
<tr class="separator:ac626ea4513155170cff98fd18e6f3b09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7170576d4823143e7dd270e0f202d0b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7170576d4823143e7dd270e0f202d0b4">translateMap</a> (proshade_double trsX, proshade_double trsY, proshade_double trsZ)</td></tr>
<tr class="memdesc:a7170576d4823143e7dd270e0f202d0b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function simply translates the map by a given number of Angstroms along the three axes.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7170576d4823143e7dd270e0f202d0b4">More...</a><br /></td></tr>
<tr class="separator:a7170576d4823143e7dd270e0f202d0b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa978d98f77a64fb16862b67a0de634be"><td class="memItemLeft" align="right" valign="top"><a id="aa978d98f77a64fb16862b67a0de634be"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa978d98f77a64fb16862b67a0de634be">allocateRotatedSHMemory</a> (void)</td></tr>
<tr class="memdesc:aa978d98f77a64fb16862b67a0de634be"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allocates the memory required for storing the rotated Spherical Harmonics coefficients. <br /></td></tr>
<tr class="separator:aa978d98f77a64fb16862b67a0de634be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad39f33c52f6d4f0db8e0d63ed0c9a2f3"><td class="memItemLeft" align="right" valign="top"><a id="ad39f33c52f6d4f0db8e0d63ed0c9a2f3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad39f33c52f6d4f0db8e0d63ed0c9a2f3">computeRotatedSH</a> (void)</td></tr>
<tr class="memdesc:ad39f33c52f6d4f0db8e0d63ed0c9a2f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function multiplies the objects spherical harmonics with the Wigner D matrices, obtaining rotated spherical harmonics coefficients. <br /></td></tr>
<tr class="separator:ad39f33c52f6d4f0db8e0d63ed0c9a2f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3dbae1c18d0550ee1940cadb5335684"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac3dbae1c18d0550ee1940cadb5335684">invertSHCoefficients</a> (void)</td></tr>
<tr class="memdesc:ac3dbae1c18d0550ee1940cadb5335684"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the shell mapped data from inverting the Spherical Harmonics coefficients.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac3dbae1c18d0550ee1940cadb5335684">More...</a><br /></td></tr>
<tr class="separator:ac3dbae1c18d0550ee1940cadb5335684"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d11953ff54d5774659117be22bdb3b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9d11953ff54d5774659117be22bdb3b3">interpolateMapFromSpheres</a> (proshade_double *&amp;densityMapRotated)</td></tr>
<tr class="memdesc:a9d11953ff54d5774659117be22bdb3b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function interpolates the density map from the sphere mapped data.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9d11953ff54d5774659117be22bdb3b3">More...</a><br /></td></tr>
<tr class="separator:a9d11953ff54d5774659117be22bdb3b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a767640acbf4999201ce9ea86d76ff6a1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a767640acbf4999201ce9ea86d76ff6a1">computeTranslationMap</a> (<a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *obj1)</td></tr>
<tr class="memdesc:a767640acbf4999201ce9ea86d76ff6a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function does the computation of the translation map and saves results internally.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a767640acbf4999201ce9ea86d76ff6a1">More...</a><br /></td></tr>
<tr class="separator:a767640acbf4999201ce9ea86d76ff6a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac07955296611dd411cf5ed87ced90571"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac07955296611dd411cf5ed87ced90571">findMapCOM</a> (void)</td></tr>
<tr class="memdesc:ac07955296611dd411cf5ed87ced90571"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finds the centre of mass of the internal map representation.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac07955296611dd411cf5ed87ced90571">More...</a><br /></td></tr>
<tr class="separator:ac07955296611dd411cf5ed87ced90571"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6160812636f73e33c1c46a754b68a610"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6160812636f73e33c1c46a754b68a610">writeOutOverlayFiles</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, proshade_double eulA, proshade_double eulB, proshade_double eulG, std::vector&lt; proshade_double &gt; *rotCentre, std::vector&lt; proshade_double &gt; *ultimateTranslation)</td></tr>
<tr class="memdesc:a6160812636f73e33c1c46a754b68a610"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function writes out the rotated map, co-ordinates and transformation JSON file.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6160812636f73e33c1c46a754b68a610">More...</a><br /></td></tr>
<tr class="separator:a6160812636f73e33c1c46a754b68a610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43e3cad6f93a32f92194f76f0ec76a32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a43e3cad6f93a32f92194f76f0ec76a32">reportOverlayResults</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, std::vector&lt; proshade_double &gt; *rotationCentre, std::vector&lt; proshade_double &gt; *eulerAngles, std::vector&lt; proshade_double &gt; *finalTranslation)</td></tr>
<tr class="memdesc:a43e3cad6f93a32f92194f76f0ec76a32"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function reports the results of the overlay mode.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a43e3cad6f93a32f92194f76f0ec76a32">More...</a><br /></td></tr>
<tr class="separator:a43e3cad6f93a32f92194f76f0ec76a32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3fbad5b8628112ace798950e6068bd4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac3fbad5b8628112ace798950e6068bd4">deepCopyMap</a> (proshade_double *&amp;saveTo, proshade_signed verbose)</td></tr>
<tr class="memdesc:ac3fbad5b8628112ace798950e6068bd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function copies the internal map into the supplied pointer, which it also allocates.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac3fbad5b8628112ace798950e6068bd4">More...</a><br /></td></tr>
<tr class="separator:ac3fbad5b8628112ace798950e6068bd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe04510c67e9dc9c19efaef8463b6e6e"><td class="memItemLeft" align="right" valign="top">proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afe04510c67e9dc9c19efaef8463b6e6e">getMapValue</a> (proshade_unsign pos)</td></tr>
<tr class="memdesc:afe04510c67e9dc9c19efaef8463b6e6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the internal map representation value of a particular array position.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afe04510c67e9dc9c19efaef8463b6e6e">More...</a><br /></td></tr>
<tr class="separator:afe04510c67e9dc9c19efaef8463b6e6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2245b15f279de574406204156089e5ef"><td class="memItemLeft" align="right" valign="top">proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">getMaxSpheres</a> (void)</td></tr>
<tr class="memdesc:a2245b15f279de574406204156089e5ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the number of spheres which contain the whole object.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">More...</a><br /></td></tr>
<tr class="separator:a2245b15f279de574406204156089e5ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a152b43815a3d3debd4b60751d9c8afdd"><td class="memItemLeft" align="right" valign="top">proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a> (void)</td></tr>
<tr class="memdesc:a152b43815a3d3debd4b60751d9c8afdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the maximum band value for the object.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">More...</a><br /></td></tr>
<tr class="separator:a152b43815a3d3debd4b60751d9c8afdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c0df68cd21b4f56abd1008065ca3573"><td class="memItemLeft" align="right" valign="top">proshade_double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5c0df68cd21b4f56abd1008065ca3573">getRealSphHarmValue</a> (proshade_unsign band, proshade_unsign order, proshade_unsign shell)</td></tr>
<tr class="memdesc:a5c0df68cd21b4f56abd1008065ca3573"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the private internal real spherical harmonics values.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5c0df68cd21b4f56abd1008065ca3573">More...</a><br /></td></tr>
<tr class="separator:a5c0df68cd21b4f56abd1008065ca3573"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae8444b6c9ca3207d32bbf2a68c7b610"><td class="memItemLeft" align="right" valign="top">proshade_double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae8444b6c9ca3207d32bbf2a68c7b610">getImagSphHarmValue</a> (proshade_unsign band, proshade_unsign order, proshade_unsign shell)</td></tr>
<tr class="memdesc:aae8444b6c9ca3207d32bbf2a68c7b610"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the private internal imaginary spherical harmonics values.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae8444b6c9ca3207d32bbf2a68c7b610">More...</a><br /></td></tr>
<tr class="separator:aae8444b6c9ca3207d32bbf2a68c7b610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa35ae5ccd9d4b22bcc028f609cd1c3e"><td class="memItemLeft" align="right" valign="top">proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa35ae5ccd9d4b22bcc028f609cd1c3e">getRRPValue</a> (proshade_unsign band, proshade_unsign sh1, proshade_unsign sh2)</td></tr>
<tr class="memdesc:afa35ae5ccd9d4b22bcc028f609cd1c3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the priva internal RRP matrices.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa35ae5ccd9d4b22bcc028f609cd1c3e">More...</a><br /></td></tr>
<tr class="separator:afa35ae5ccd9d4b22bcc028f609cd1c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23620b34a604aca7db4d8b21f6d2d09a"><td class="memItemLeft" align="right" valign="top">proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23620b34a604aca7db4d8b21f6d2d09a">getAnySphereRadius</a> (proshade_unsign shell)</td></tr>
<tr class="memdesc:a23620b34a604aca7db4d8b21f6d2d09a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the radius of any particular sphere.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23620b34a604aca7db4d8b21f6d2d09a">More...</a><br /></td></tr>
<tr class="separator:a23620b34a604aca7db4d8b21f6d2d09a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa150cfc5715420cf3d2e28c8af3631c4"><td class="memItemLeft" align="right" valign="top">proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa150cfc5715420cf3d2e28c8af3631c4">getIntegrationWeight</a> (void)</td></tr>
<tr class="memdesc:aa150cfc5715420cf3d2e28c8af3631c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the integration weight for the object.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa150cfc5715420cf3d2e28c8af3631c4">More...</a><br /></td></tr>
<tr class="separator:aa150cfc5715420cf3d2e28c8af3631c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a898b48c1135e7a37f64f55e2367f0391"><td class="memItemLeft" align="right" valign="top">proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a898b48c1135e7a37f64f55e2367f0391">getShellBandwidth</a> (proshade_unsign shell)</td></tr>
<tr class="memdesc:a898b48c1135e7a37f64f55e2367f0391"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the bandwidth of a particular shell.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a898b48c1135e7a37f64f55e2367f0391">More...</a><br /></td></tr>
<tr class="separator:a898b48c1135e7a37f64f55e2367f0391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38d47eb11eafa106c65867ceec62a3fc"><td class="memItemLeft" align="right" valign="top">proshade_single&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a38d47eb11eafa106c65867ceec62a3fc">getSpherePosValue</a> (proshade_unsign shell)</td></tr>
<tr class="memdesc:a38d47eb11eafa106c65867ceec62a3fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to sphere positions.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a38d47eb11eafa106c65867ceec62a3fc">More...</a><br /></td></tr>
<tr class="separator:a38d47eb11eafa106c65867ceec62a3fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94a73f81ba80621f5f52173e91bb47f7"><td class="memItemLeft" align="right" valign="top">proshade_complex **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94a73f81ba80621f5f52173e91bb47f7">getEMatrixByBand</a> (proshade_unsign band)</td></tr>
<tr class="memdesc:a94a73f81ba80621f5f52173e91bb47f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to E matrix for a particular band.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94a73f81ba80621f5f52173e91bb47f7">More...</a><br /></td></tr>
<tr class="separator:a94a73f81ba80621f5f52173e91bb47f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab053362f9dc5422244ccfbafd9f00ff8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab053362f9dc5422244ccfbafd9f00ff8">getEMatrixValue</a> (proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double *valueReal, proshade_double *valueImag)</td></tr>
<tr class="memdesc:ab053362f9dc5422244ccfbafd9f00ff8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to E matrix by knowing the band, order1 and order2 indices.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab053362f9dc5422244ccfbafd9f00ff8">More...</a><br /></td></tr>
<tr class="separator:ab053362f9dc5422244ccfbafd9f00ff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eb10989a2f8d46b849cdaf8410b68be"><td class="memItemLeft" align="right" valign="top">proshade_complex *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">getInvSO3Coeffs</a> (void)</td></tr>
<tr class="memdesc:a2eb10989a2f8d46b849cdaf8410b68be"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the inverse SO(3) coefficients array.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">More...</a><br /></td></tr>
<tr class="separator:a2eb10989a2f8d46b849cdaf8410b68be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5c9c45b0db1e6a9eeef2ba292fbbcc3"><td class="memItemLeft" align="right" valign="top">proshade_complex *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae5c9c45b0db1e6a9eeef2ba292fbbcc3">getSO3Coeffs</a> (void)</td></tr>
<tr class="memdesc:ae5c9c45b0db1e6a9eeef2ba292fbbcc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the SO(3) coefficients array.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae5c9c45b0db1e6a9eeef2ba292fbbcc3">More...</a><br /></td></tr>
<tr class="separator:ae5c9c45b0db1e6a9eeef2ba292fbbcc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc2b8e179a137adda234e0ba0f9d27b"><td class="memItemLeft" align="right" valign="top">proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6cc2b8e179a137adda234e0ba0f9d27b">getComparisonBand</a> (void)</td></tr>
<tr class="memdesc:a6cc2b8e179a137adda234e0ba0f9d27b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the maximum band for the comparison.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6cc2b8e179a137adda234e0ba0f9d27b">More...</a><br /></td></tr>
<tr class="separator:a6cc2b8e179a137adda234e0ba0f9d27b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5999f7181bd3509454966f8271ac39d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5999f7181bd3509454966f8271ac39d6">getWignerMatrixValue</a> (proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double *valueReal, proshade_double *valueImag)</td></tr>
<tr class="memdesc:a5999f7181bd3509454966f8271ac39d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the Wigner D matrix by knowing the band, order1 and order2 indices.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5999f7181bd3509454966f8271ac39d6">More...</a><br /></td></tr>
<tr class="separator:a5999f7181bd3509454966f8271ac39d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51d7b9d87d536ef0c48d820872bc9185"><td class="memItemLeft" align="right" valign="top">proshade_single&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">getXDimSize</a> (void)</td></tr>
<tr class="memdesc:a51d7b9d87d536ef0c48d820872bc9185"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the map size in angstroms along the X axis.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">More...</a><br /></td></tr>
<tr class="separator:a51d7b9d87d536ef0c48d820872bc9185"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae477e3c0d7b866e6069d8603950afe51"><td class="memItemLeft" align="right" valign="top">proshade_single&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">getYDimSize</a> (void)</td></tr>
<tr class="memdesc:ae477e3c0d7b866e6069d8603950afe51"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the map size in angstroms along the Y axis.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">More...</a><br /></td></tr>
<tr class="separator:ae477e3c0d7b866e6069d8603950afe51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4d641d62864e4adf67c1365b0960970"><td class="memItemLeft" align="right" valign="top">proshade_single&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">getZDimSize</a> (void)</td></tr>
<tr class="memdesc:af4d641d62864e4adf67c1365b0960970"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the map size in angstroms along the Z axis.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">More...</a><br /></td></tr>
<tr class="separator:af4d641d62864e4adf67c1365b0960970"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bc44913222e67ab861dd1e5838c1ae1"><td class="memItemLeft" align="right" valign="top">proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">getXDim</a> (void)</td></tr>
<tr class="memdesc:a3bc44913222e67ab861dd1e5838c1ae1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the map size in indices along the X axis.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">More...</a><br /></td></tr>
<tr class="separator:a3bc44913222e67ab861dd1e5838c1ae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50c884973add562558803a45991bbf19"><td class="memItemLeft" align="right" valign="top">proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">getYDim</a> (void)</td></tr>
<tr class="memdesc:a50c884973add562558803a45991bbf19"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the map size in indices along the Y axis.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">More...</a><br /></td></tr>
<tr class="separator:a50c884973add562558803a45991bbf19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a034af93b9152fb2db675d5632a4ebc6d"><td class="memItemLeft" align="right" valign="top">proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">getZDim</a> (void)</td></tr>
<tr class="memdesc:a034af93b9152fb2db675d5632a4ebc6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the map size in indices along the Z axis.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">More...</a><br /></td></tr>
<tr class="separator:a034af93b9152fb2db675d5632a4ebc6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c89c860da1836b30a9b2889d3e873ed"><td class="memItemLeft" align="right" valign="top">proshade_signed *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4c89c860da1836b30a9b2889d3e873ed">getXFromPtr</a> (void)</td></tr>
<tr class="memdesc:a4c89c860da1836b30a9b2889d3e873ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the map start along the X axis.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4c89c860da1836b30a9b2889d3e873ed">More...</a><br /></td></tr>
<tr class="separator:a4c89c860da1836b30a9b2889d3e873ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f0d929d1e013cdd23e956d94b7a40da"><td class="memItemLeft" align="right" valign="top">proshade_signed *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f0d929d1e013cdd23e956d94b7a40da">getYFromPtr</a> (void)</td></tr>
<tr class="memdesc:a5f0d929d1e013cdd23e956d94b7a40da"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the map start along the Y axis.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f0d929d1e013cdd23e956d94b7a40da">More...</a><br /></td></tr>
<tr class="separator:a5f0d929d1e013cdd23e956d94b7a40da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbbcec01a6ee7701e3b1d0e61730fadf"><td class="memItemLeft" align="right" valign="top">proshade_signed *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afbbcec01a6ee7701e3b1d0e61730fadf">getZFromPtr</a> (void)</td></tr>
<tr class="memdesc:afbbcec01a6ee7701e3b1d0e61730fadf"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the map start along the Z axis.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afbbcec01a6ee7701e3b1d0e61730fadf">More...</a><br /></td></tr>
<tr class="separator:afbbcec01a6ee7701e3b1d0e61730fadf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf61c328db45fcd7692d13a8cde5e092"><td class="memItemLeft" align="right" valign="top">proshade_signed *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#adf61c328db45fcd7692d13a8cde5e092">getXToPtr</a> (void)</td></tr>
<tr class="memdesc:adf61c328db45fcd7692d13a8cde5e092"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the map last position along the X axis.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#adf61c328db45fcd7692d13a8cde5e092">More...</a><br /></td></tr>
<tr class="separator:adf61c328db45fcd7692d13a8cde5e092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac859cbd21b93b9d2ed5f119f4ee57f3f"><td class="memItemLeft" align="right" valign="top">proshade_signed *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac859cbd21b93b9d2ed5f119f4ee57f3f">getYToPtr</a> (void)</td></tr>
<tr class="memdesc:ac859cbd21b93b9d2ed5f119f4ee57f3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the map last position along the Y axis.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac859cbd21b93b9d2ed5f119f4ee57f3f">More...</a><br /></td></tr>
<tr class="separator:ac859cbd21b93b9d2ed5f119f4ee57f3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68eb739dd4846a1dd48032eb2cc3f49c"><td class="memItemLeft" align="right" valign="top">proshade_signed *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a68eb739dd4846a1dd48032eb2cc3f49c">getZToPtr</a> (void)</td></tr>
<tr class="memdesc:a68eb739dd4846a1dd48032eb2cc3f49c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the map last position along the Z axis.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a68eb739dd4846a1dd48032eb2cc3f49c">More...</a><br /></td></tr>
<tr class="separator:a68eb739dd4846a1dd48032eb2cc3f49c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a1405b3974697f41c4a73da0cb52a32"><td class="memItemLeft" align="right" valign="top">proshade_signed *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a1405b3974697f41c4a73da0cb52a32">getXAxisOrigin</a> (void)</td></tr>
<tr class="memdesc:a8a1405b3974697f41c4a73da0cb52a32"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the map X axis origin value.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a1405b3974697f41c4a73da0cb52a32">More...</a><br /></td></tr>
<tr class="separator:a8a1405b3974697f41c4a73da0cb52a32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a298bc9a6aae624a091cd97b842a6b618"><td class="memItemLeft" align="right" valign="top">proshade_signed *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a298bc9a6aae624a091cd97b842a6b618">getYAxisOrigin</a> (void)</td></tr>
<tr class="memdesc:a298bc9a6aae624a091cd97b842a6b618"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the map Y axis origin value.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a298bc9a6aae624a091cd97b842a6b618">More...</a><br /></td></tr>
<tr class="separator:a298bc9a6aae624a091cd97b842a6b618"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb0242051835b508e9af193dc40a697c"><td class="memItemLeft" align="right" valign="top">proshade_signed *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aeb0242051835b508e9af193dc40a697c">getZAxisOrigin</a> (void)</td></tr>
<tr class="memdesc:aeb0242051835b508e9af193dc40a697c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the map Z axis origin value.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aeb0242051835b508e9af193dc40a697c">More...</a><br /></td></tr>
<tr class="separator:aeb0242051835b508e9af193dc40a697c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bb8bf1e357cc25f68fe93554e44715d"><td class="memItemLeft" align="right" valign="top">proshade_double *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1bb8bf1e357cc25f68fe93554e44715d">getInternalMap</a> (void)</td></tr>
<tr class="memdesc:a1bb8bf1e357cc25f68fe93554e44715d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the first map array value address.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1bb8bf1e357cc25f68fe93554e44715d">More...</a><br /></td></tr>
<tr class="separator:a1bb8bf1e357cc25f68fe93554e44715d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae27a3e92905ca9d5f9a32c4eaacc64ae"><td class="memItemLeft" align="right" valign="top">proshade_complex *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae27a3e92905ca9d5f9a32c4eaacc64ae">getTranslationFnPointer</a> (void)</td></tr>
<tr class="memdesc:ae27a3e92905ca9d5f9a32c4eaacc64ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the translation function through a pointer.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae27a3e92905ca9d5f9a32c4eaacc64ae">More...</a><br /></td></tr>
<tr class="separator:ae27a3e92905ca9d5f9a32c4eaacc64ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bd7a9a5ea6cac4302ec1cd80922c617"><td class="memItemLeft" align="right" valign="top">std::vector&lt; proshade_double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4bd7a9a5ea6cac4302ec1cd80922c617">getMapCOMProcessChange</a> (void)</td></tr>
<tr class="memdesc:a4bd7a9a5ea6cac4302ec1cd80922c617"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows access to the translation caused by structure processing.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4bd7a9a5ea6cac4302ec1cd80922c617">More...</a><br /></td></tr>
<tr class="separator:a4bd7a9a5ea6cac4302ec1cd80922c617"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e7b1d5d4164ea7a6fda53c57ac979f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e7b1d5d4164ea7a6fda53c57ac979f4">setIntegrationWeight</a> (proshade_double intW)</td></tr>
<tr class="memdesc:a3e7b1d5d4164ea7a6fda53c57ac979f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows setting the integration weight for the object.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e7b1d5d4164ea7a6fda53c57ac979f4">More...</a><br /></td></tr>
<tr class="separator:a3e7b1d5d4164ea7a6fda53c57ac979f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a737ee01d968fef7ae1094847a0271033"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a737ee01d968fef7ae1094847a0271033">setIntegrationWeightCumul</a> (proshade_double intW)</td></tr>
<tr class="memdesc:a737ee01d968fef7ae1094847a0271033"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows setting the cumulative integration weight for the object.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a737ee01d968fef7ae1094847a0271033">More...</a><br /></td></tr>
<tr class="separator:a737ee01d968fef7ae1094847a0271033"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca5af5c8c3b18275e65ae4ebacd9877c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5af5c8c3b18275e65ae4ebacd9877c">setEMatrixValue</a> (proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_complex val)</td></tr>
<tr class="memdesc:aca5af5c8c3b18275e65ae4ebacd9877c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows setting the E matrix value.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5af5c8c3b18275e65ae4ebacd9877c">More...</a><br /></td></tr>
<tr class="separator:aca5af5c8c3b18275e65ae4ebacd9877c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceb19c915cebcef22c085cc6619cc472"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb19c915cebcef22c085cc6619cc472">normaliseEMatrixValue</a> (proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double normF)</td></tr>
<tr class="memdesc:aceb19c915cebcef22c085cc6619cc472"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows normalising the E matrix value.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb19c915cebcef22c085cc6619cc472">More...</a><br /></td></tr>
<tr class="separator:aceb19c915cebcef22c085cc6619cc472"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca5e27540622190be41ce78157c0807e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5e27540622190be41ce78157c0807e">setSO3CoeffValue</a> (proshade_unsign position, proshade_complex val)</td></tr>
<tr class="memdesc:aca5e27540622190be41ce78157c0807e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows setting the SOFT coefficient values using array position and value.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5e27540622190be41ce78157c0807e">More...</a><br /></td></tr>
<tr class="separator:aca5e27540622190be41ce78157c0807e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3aa4cdcd7cc9b458d7618077dfaab02"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab3aa4cdcd7cc9b458d7618077dfaab02">setWignerMatrixValue</a> (proshade_complex val, proshade_unsign band, proshade_unsign order1, proshade_unsign order2)</td></tr>
<tr class="memdesc:ab3aa4cdcd7cc9b458d7618077dfaab02"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows setting the Wigner D matrix value by its band, order1 and order2 co-ordinate.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab3aa4cdcd7cc9b458d7618077dfaab02">More...</a><br /></td></tr>
<tr class="separator:ab3aa4cdcd7cc9b458d7618077dfaab02"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ae9b0d5959b0f461b3b89ffeb059400fa"><td class="memItemLeft" align="right" valign="top"><a id="ae9b0d5959b0f461b3b89ffeb059400fa"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a></td></tr>
<tr class="memdesc:ae9b0d5959b0f461b3b89ffeb059400fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the original file from which the data were obtained. <br /></td></tr>
<tr class="separator:ae9b0d5959b0f461b3b89ffeb059400fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4052e498b4650f62bfe5ff37ed959292"><td class="memItemLeft" align="right" valign="top"><a id="a4052e498b4650f62bfe5ff37ed959292"></a>
ProSHADE_internal_io::InputType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4052e498b4650f62bfe5ff37ed959292">fileType</a></td></tr>
<tr class="memdesc:a4052e498b4650f62bfe5ff37ed959292"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the type of the input file. <br /></td></tr>
<tr class="separator:a4052e498b4650f62bfe5ff37ed959292"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aa6fbd67df9911e886f9001a0ef8bc2"><td class="memItemLeft" align="right" valign="top"><a id="a8aa6fbd67df9911e886f9001a0ef8bc2"></a>
proshade_double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a></td></tr>
<tr class="memdesc:a8aa6fbd67df9911e886f9001a0ef8bc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The internal map data representation, which may be amended as the run progresses. <br /></td></tr>
<tr class="separator:a8aa6fbd67df9911e886f9001a0ef8bc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff65990df92e49b7636134feb56be8f9"><td class="memItemLeft" align="right" valign="top"><a id="aff65990df92e49b7636134feb56be8f9"></a>
proshade_single&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a></td></tr>
<tr class="memdesc:aff65990df92e49b7636134feb56be8f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the size of the map cell x dimension in Angstroms. <br /></td></tr>
<tr class="separator:aff65990df92e49b7636134feb56be8f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37b2746ce3f6560446b4eb45ba552084"><td class="memItemLeft" align="right" valign="top"><a id="a37b2746ce3f6560446b4eb45ba552084"></a>
proshade_single&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a></td></tr>
<tr class="memdesc:a37b2746ce3f6560446b4eb45ba552084"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the size of the map cell y dimension in Angstroms. <br /></td></tr>
<tr class="separator:a37b2746ce3f6560446b4eb45ba552084"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20fd31138680dd622058732eba31dca5"><td class="memItemLeft" align="right" valign="top"><a id="a20fd31138680dd622058732eba31dca5"></a>
proshade_single&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a></td></tr>
<tr class="memdesc:a20fd31138680dd622058732eba31dca5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the size of the map cell z dimension in Angstroms. <br /></td></tr>
<tr class="separator:a20fd31138680dd622058732eba31dca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa75beee618649d6fd9dc850a5a66a551"><td class="memItemLeft" align="right" valign="top"><a id="aa75beee618649d6fd9dc850a5a66a551"></a>
proshade_single&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">aAngle</a></td></tr>
<tr class="memdesc:aa75beee618649d6fd9dc850a5a66a551"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the angle a of the map cell in degrees. <br /></td></tr>
<tr class="separator:aa75beee618649d6fd9dc850a5a66a551"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dbcec9f32eb76625d7aa59d8c2701d9"><td class="memItemLeft" align="right" valign="top"><a id="a9dbcec9f32eb76625d7aa59d8c2701d9"></a>
proshade_single&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9dbcec9f32eb76625d7aa59d8c2701d9">bAngle</a></td></tr>
<tr class="memdesc:a9dbcec9f32eb76625d7aa59d8c2701d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the angle b of the map cell in degrees. <br /></td></tr>
<tr class="separator:a9dbcec9f32eb76625d7aa59d8c2701d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e2f99f00dd05198b508633cf7f6f080"><td class="memItemLeft" align="right" valign="top"><a id="a8e2f99f00dd05198b508633cf7f6f080"></a>
proshade_single&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e2f99f00dd05198b508633cf7f6f080">cAngle</a></td></tr>
<tr class="memdesc:a8e2f99f00dd05198b508633cf7f6f080"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the angle c of the map cell in degrees. <br /></td></tr>
<tr class="separator:a8e2f99f00dd05198b508633cf7f6f080"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceb7facd99379a000035ce35263577d5"><td class="memItemLeft" align="right" valign="top"><a id="aceb7facd99379a000035ce35263577d5"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a></td></tr>
<tr class="memdesc:aceb7facd99379a000035ce35263577d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the size of the map cell x dimension in indices. <br /></td></tr>
<tr class="separator:aceb7facd99379a000035ce35263577d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4da4e87f23a07702dcf32470ec740df"><td class="memItemLeft" align="right" valign="top"><a id="ab4da4e87f23a07702dcf32470ec740df"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a></td></tr>
<tr class="memdesc:ab4da4e87f23a07702dcf32470ec740df"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the size of the map cell y dimension in indices. <br /></td></tr>
<tr class="separator:ab4da4e87f23a07702dcf32470ec740df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1f180d58f829e2c0fc50569b2425d56"><td class="memItemLeft" align="right" valign="top"><a id="ad1f180d58f829e2c0fc50569b2425d56"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a></td></tr>
<tr class="memdesc:ad1f180d58f829e2c0fc50569b2425d56"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the size of the map cell z dimension in indices. <br /></td></tr>
<tr class="separator:ad1f180d58f829e2c0fc50569b2425d56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedb2ba02e77d5795077df91b2578ab29"><td class="memItemLeft" align="right" valign="top"><a id="aedb2ba02e77d5795077df91b2578ab29"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">xGridIndices</a></td></tr>
<tr class="memdesc:aedb2ba02e77d5795077df91b2578ab29"><td class="mdescLeft">&#160;</td><td class="mdescRight">As far as I know, this is identical to the xDimIndices. <br /></td></tr>
<tr class="separator:aedb2ba02e77d5795077df91b2578ab29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d56e4edf14f91833ddfe8908887b506"><td class="memItemLeft" align="right" valign="top"><a id="a3d56e4edf14f91833ddfe8908887b506"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">yGridIndices</a></td></tr>
<tr class="memdesc:a3d56e4edf14f91833ddfe8908887b506"><td class="mdescLeft">&#160;</td><td class="mdescRight">As far as I know, this is identical to the yDimIndices. <br /></td></tr>
<tr class="separator:a3d56e4edf14f91833ddfe8908887b506"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67d6eadd10e10c0b46f1f2e43df7db99"><td class="memItemLeft" align="right" valign="top"><a id="a67d6eadd10e10c0b46f1f2e43df7db99"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">zGridIndices</a></td></tr>
<tr class="memdesc:a67d6eadd10e10c0b46f1f2e43df7db99"><td class="mdescLeft">&#160;</td><td class="mdescRight">As far as I know, this is identical to the zDimIndices. <br /></td></tr>
<tr class="separator:a67d6eadd10e10c0b46f1f2e43df7db99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a603841095e16abd0492dfc6db052fda7"><td class="memItemLeft" align="right" valign="top"><a id="a603841095e16abd0492dfc6db052fda7"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">xAxisOrder</a></td></tr>
<tr class="memdesc:a603841095e16abd0492dfc6db052fda7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the order of the x axis. <br /></td></tr>
<tr class="separator:a603841095e16abd0492dfc6db052fda7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9302095b8642b8d5088cf8f1793d1990"><td class="memItemLeft" align="right" valign="top"><a id="a9302095b8642b8d5088cf8f1793d1990"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">yAxisOrder</a></td></tr>
<tr class="memdesc:a9302095b8642b8d5088cf8f1793d1990"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the order of the y axis. <br /></td></tr>
<tr class="separator:a9302095b8642b8d5088cf8f1793d1990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a550c839b5ce7b53ccee5e6da1cf001af"><td class="memItemLeft" align="right" valign="top"><a id="a550c839b5ce7b53ccee5e6da1cf001af"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">zAxisOrder</a></td></tr>
<tr class="memdesc:a550c839b5ce7b53ccee5e6da1cf001af"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the order of the z axis. <br /></td></tr>
<tr class="separator:a550c839b5ce7b53ccee5e6da1cf001af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2860d3acb4d9e5ec6fca0b58ae33845f"><td class="memItemLeft" align="right" valign="top"><a id="a2860d3acb4d9e5ec6fca0b58ae33845f"></a>
proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a></td></tr>
<tr class="memdesc:a2860d3acb4d9e5ec6fca0b58ae33845f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the origin position along the x axis. <br /></td></tr>
<tr class="separator:a2860d3acb4d9e5ec6fca0b58ae33845f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e2a50d383cdba4b6f6f3d1293c4174b"><td class="memItemLeft" align="right" valign="top"><a id="a3e2a50d383cdba4b6f6f3d1293c4174b"></a>
proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a></td></tr>
<tr class="memdesc:a3e2a50d383cdba4b6f6f3d1293c4174b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the origin position along the y axis. <br /></td></tr>
<tr class="separator:a3e2a50d383cdba4b6f6f3d1293c4174b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57a45df67d87117582f0810ca9f48695"><td class="memItemLeft" align="right" valign="top"><a id="a57a45df67d87117582f0810ca9f48695"></a>
proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a></td></tr>
<tr class="memdesc:a57a45df67d87117582f0810ca9f48695"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the origin position along the z axis. <br /></td></tr>
<tr class="separator:a57a45df67d87117582f0810ca9f48695"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59fbe922fd7fd7aa5c72ca459e4242d0"><td class="memItemLeft" align="right" valign="top"><a id="a59fbe922fd7fd7aa5c72ca459e4242d0"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">xCom</a></td></tr>
<tr class="memdesc:a59fbe922fd7fd7aa5c72ca459e4242d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The COM of the map after processing along the X-axis. <br /></td></tr>
<tr class="separator:a59fbe922fd7fd7aa5c72ca459e4242d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a668381d94a927275b3d839549475c7da"><td class="memItemLeft" align="right" valign="top"><a id="a668381d94a927275b3d839549475c7da"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">yCom</a></td></tr>
<tr class="memdesc:a668381d94a927275b3d839549475c7da"><td class="mdescLeft">&#160;</td><td class="mdescRight">The COM of the map after processing along the Y-axis. <br /></td></tr>
<tr class="separator:a668381d94a927275b3d839549475c7da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a668c168ea0037312025b860b9b5be415"><td class="memItemLeft" align="right" valign="top"><a id="a668c168ea0037312025b860b9b5be415"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">zCom</a></td></tr>
<tr class="memdesc:a668c168ea0037312025b860b9b5be415"><td class="mdescLeft">&#160;</td><td class="mdescRight">The COM of the map after processing along the Z-axis. <br /></td></tr>
<tr class="separator:a668c168ea0037312025b860b9b5be415"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ae6821c27e7facf63839c9fc678c9c7"><td class="memItemLeft" align="right" valign="top"><a id="a1ae6821c27e7facf63839c9fc678c9c7"></a>
proshade_single&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ae6821c27e7facf63839c9fc678c9c7">xDimSizeOriginal</a></td></tr>
<tr class="memdesc:a1ae6821c27e7facf63839c9fc678c9c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the size of the map cell x dimension in Angstroms. <br /></td></tr>
<tr class="separator:a1ae6821c27e7facf63839c9fc678c9c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7855424ca5d51853c7fc665ecb9b935b"><td class="memItemLeft" align="right" valign="top"><a id="a7855424ca5d51853c7fc665ecb9b935b"></a>
proshade_single&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7855424ca5d51853c7fc665ecb9b935b">yDimSizeOriginal</a></td></tr>
<tr class="memdesc:a7855424ca5d51853c7fc665ecb9b935b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the size of the map cell y dimension in Angstroms. <br /></td></tr>
<tr class="separator:a7855424ca5d51853c7fc665ecb9b935b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a530ad7e3396cbcbc1814051031070a8b"><td class="memItemLeft" align="right" valign="top"><a id="a530ad7e3396cbcbc1814051031070a8b"></a>
proshade_single&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a530ad7e3396cbcbc1814051031070a8b">zDimSizeOriginal</a></td></tr>
<tr class="memdesc:a530ad7e3396cbcbc1814051031070a8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the size of the map cell z dimension in Angstroms. <br /></td></tr>
<tr class="separator:a530ad7e3396cbcbc1814051031070a8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9598e9a38546e3bf260bc09c0c9366a2"><td class="memItemLeft" align="right" valign="top"><a id="a9598e9a38546e3bf260bc09c0c9366a2"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9598e9a38546e3bf260bc09c0c9366a2">xDimIndicesOriginal</a></td></tr>
<tr class="memdesc:a9598e9a38546e3bf260bc09c0c9366a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the size of the map cell x dimension in indices. <br /></td></tr>
<tr class="separator:a9598e9a38546e3bf260bc09c0c9366a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ef18126c2c24edc9b6be06e0591127f"><td class="memItemLeft" align="right" valign="top"><a id="a1ef18126c2c24edc9b6be06e0591127f"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ef18126c2c24edc9b6be06e0591127f">yDimIndicesOriginal</a></td></tr>
<tr class="memdesc:a1ef18126c2c24edc9b6be06e0591127f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the size of the map cell y dimension in indices. <br /></td></tr>
<tr class="separator:a1ef18126c2c24edc9b6be06e0591127f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ea6522b99cf1ac72199c9eeccd30742"><td class="memItemLeft" align="right" valign="top"><a id="a1ea6522b99cf1ac72199c9eeccd30742"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ea6522b99cf1ac72199c9eeccd30742">zDimIndicesOriginal</a></td></tr>
<tr class="memdesc:a1ea6522b99cf1ac72199c9eeccd30742"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the size of the map cell z dimension in indices. <br /></td></tr>
<tr class="separator:a1ea6522b99cf1ac72199c9eeccd30742"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43f1c4682016759ea2e24c5903dbe444"><td class="memItemLeft" align="right" valign="top"><a id="a43f1c4682016759ea2e24c5903dbe444"></a>
proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a43f1c4682016759ea2e24c5903dbe444">xAxisOriginOriginal</a></td></tr>
<tr class="memdesc:a43f1c4682016759ea2e24c5903dbe444"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the origin position along the x axis. <br /></td></tr>
<tr class="separator:a43f1c4682016759ea2e24c5903dbe444"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53cffdab0d66cb88884ec4f46c19a5ff"><td class="memItemLeft" align="right" valign="top"><a id="a53cffdab0d66cb88884ec4f46c19a5ff"></a>
proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a53cffdab0d66cb88884ec4f46c19a5ff">yAxisOriginOriginal</a></td></tr>
<tr class="memdesc:a53cffdab0d66cb88884ec4f46c19a5ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the origin position along the y axis. <br /></td></tr>
<tr class="separator:a53cffdab0d66cb88884ec4f46c19a5ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed1c8e0ffb847b093a736c5156f86e9b"><td class="memItemLeft" align="right" valign="top"><a id="aed1c8e0ffb847b093a736c5156f86e9b"></a>
proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aed1c8e0ffb847b093a736c5156f86e9b">zAxisOriginOriginal</a></td></tr>
<tr class="memdesc:aed1c8e0ffb847b093a736c5156f86e9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the origin position along the z axis. <br /></td></tr>
<tr class="separator:aed1c8e0ffb847b093a736c5156f86e9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a3fdf194eca61b1ccfa5bdd2f586e0b"><td class="memItemLeft" align="right" valign="top"><a id="a2a3fdf194eca61b1ccfa5bdd2f586e0b"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2a3fdf194eca61b1ccfa5bdd2f586e0b">originalMapXCom</a></td></tr>
<tr class="memdesc:a2a3fdf194eca61b1ccfa5bdd2f586e0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The COM of the first map to be loaded/computed without any furhter changes being reflacted along the X axis. <br /></td></tr>
<tr class="separator:a2a3fdf194eca61b1ccfa5bdd2f586e0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64323b4117a11f0971cb0d24ec95c64c"><td class="memItemLeft" align="right" valign="top"><a id="a64323b4117a11f0971cb0d24ec95c64c"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a64323b4117a11f0971cb0d24ec95c64c">originalMapYCom</a></td></tr>
<tr class="memdesc:a64323b4117a11f0971cb0d24ec95c64c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The COM of the first map to be loaded/computed without any furhter changes being reflacted along the Y axis. <br /></td></tr>
<tr class="separator:a64323b4117a11f0971cb0d24ec95c64c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac00197ab71e3353cb2884be0e51d6cd3"><td class="memItemLeft" align="right" valign="top"><a id="ac00197ab71e3353cb2884be0e51d6cd3"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac00197ab71e3353cb2884be0e51d6cd3">originalMapZCom</a></td></tr>
<tr class="memdesc:ac00197ab71e3353cb2884be0e51d6cd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">The COM of the first map to be loaded/computed without any furhter changes being reflacted along the Z axis. <br /></td></tr>
<tr class="separator:ac00197ab71e3353cb2884be0e51d6cd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7861a96d94b8f7a8eb2946729c330863"><td class="memItemLeft" align="right" valign="top"><a id="a7861a96d94b8f7a8eb2946729c330863"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7861a96d94b8f7a8eb2946729c330863">mapMovFromsChangeX</a></td></tr>
<tr class="memdesc:a7861a96d94b8f7a8eb2946729c330863"><td class="mdescLeft">&#160;</td><td class="mdescRight">When the map is translated, the xFrom and xTo values are changed. This variable holds how much they have changed. <br /></td></tr>
<tr class="separator:a7861a96d94b8f7a8eb2946729c330863"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1658311301e365cf17721e864b829c28"><td class="memItemLeft" align="right" valign="top"><a id="a1658311301e365cf17721e864b829c28"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1658311301e365cf17721e864b829c28">mapMovFromsChangeY</a></td></tr>
<tr class="memdesc:a1658311301e365cf17721e864b829c28"><td class="mdescLeft">&#160;</td><td class="mdescRight">When the map is translated, the yFrom and yTo values are changed. This variable holds how much they have changed. <br /></td></tr>
<tr class="separator:a1658311301e365cf17721e864b829c28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a682749f30d2fd19842d96e9b870d76ab"><td class="memItemLeft" align="right" valign="top"><a id="a682749f30d2fd19842d96e9b870d76ab"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a682749f30d2fd19842d96e9b870d76ab">mapMovFromsChangeZ</a></td></tr>
<tr class="memdesc:a682749f30d2fd19842d96e9b870d76ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">When the map is translated, the zFrom and zTo values are changed. This variable holds how much they have changed. <br /></td></tr>
<tr class="separator:a682749f30d2fd19842d96e9b870d76ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a471ec29b27c3a402d18b20fee8035f1a"><td class="memItemLeft" align="right" valign="top"><a id="a471ec29b27c3a402d18b20fee8035f1a"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a471ec29b27c3a402d18b20fee8035f1a">mapCOMProcessChangeX</a></td></tr>
<tr class="memdesc:a471ec29b27c3a402d18b20fee8035f1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The change in X axis between the creation of the structure (originalMapXCom) and just before rotation. <br /></td></tr>
<tr class="separator:a471ec29b27c3a402d18b20fee8035f1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47bf2343b0b50267e8e3732c964b63ea"><td class="memItemLeft" align="right" valign="top"><a id="a47bf2343b0b50267e8e3732c964b63ea"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47bf2343b0b50267e8e3732c964b63ea">mapCOMProcessChangeY</a></td></tr>
<tr class="memdesc:a47bf2343b0b50267e8e3732c964b63ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">The change in Y axis between the creation of the structure (originalMapYCom) and just before rotation. <br /></td></tr>
<tr class="separator:a47bf2343b0b50267e8e3732c964b63ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a487131ae5dc44f8667908bf64725b4ab"><td class="memItemLeft" align="right" valign="top"><a id="a487131ae5dc44f8667908bf64725b4ab"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a487131ae5dc44f8667908bf64725b4ab">mapCOMProcessChangeZ</a></td></tr>
<tr class="memdesc:a487131ae5dc44f8667908bf64725b4ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">The change in Z axis between the creation of the structure (originalMapZCom) and just before rotation. <br /></td></tr>
<tr class="separator:a487131ae5dc44f8667908bf64725b4ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a923cdc6e27455ba99ce5f536932f3721"><td class="memItemLeft" align="right" valign="top"><a id="a923cdc6e27455ba99ce5f536932f3721"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a923cdc6e27455ba99ce5f536932f3721">originalPdbRotCenX</a></td></tr>
<tr class="memdesc:a923cdc6e27455ba99ce5f536932f3721"><td class="mdescLeft">&#160;</td><td class="mdescRight">The centre of rotation as it relates to the original PDB positions (and not the ProSHADE internal map) along the x-axis. <br /></td></tr>
<tr class="separator:a923cdc6e27455ba99ce5f536932f3721"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77cabdd70039e82f8c0cbb07fefd3960"><td class="memItemLeft" align="right" valign="top"><a id="a77cabdd70039e82f8c0cbb07fefd3960"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a77cabdd70039e82f8c0cbb07fefd3960">originalPdbRotCenY</a></td></tr>
<tr class="memdesc:a77cabdd70039e82f8c0cbb07fefd3960"><td class="mdescLeft">&#160;</td><td class="mdescRight">The centre of rotation as it relates to the original PDB positions (and not the ProSHADE internal map) along the y-axis. <br /></td></tr>
<tr class="separator:a77cabdd70039e82f8c0cbb07fefd3960"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a924d0767561842716b2ac260426cdc19"><td class="memItemLeft" align="right" valign="top"><a id="a924d0767561842716b2ac260426cdc19"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a924d0767561842716b2ac260426cdc19">originalPdbRotCenZ</a></td></tr>
<tr class="memdesc:a924d0767561842716b2ac260426cdc19"><td class="mdescLeft">&#160;</td><td class="mdescRight">The centre of rotation as it relates to the original PDB positions (and not the ProSHADE internal map) along the z-axis. <br /></td></tr>
<tr class="separator:a924d0767561842716b2ac260426cdc19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9548e8ff07c6a74bbe2353f647fb6a79"><td class="memItemLeft" align="right" valign="top"><a id="a9548e8ff07c6a74bbe2353f647fb6a79"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9548e8ff07c6a74bbe2353f647fb6a79">originalPdbTransX</a></td></tr>
<tr class="memdesc:a9548e8ff07c6a74bbe2353f647fb6a79"><td class="mdescLeft">&#160;</td><td class="mdescRight">The optimal translation vector as it relates to the original PDB positions (and not the ProSHADE internal map) along the x-axis. <br /></td></tr>
<tr class="separator:a9548e8ff07c6a74bbe2353f647fb6a79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5241ee8b8b9d9915e1ef92e3edab202d"><td class="memItemLeft" align="right" valign="top"><a id="a5241ee8b8b9d9915e1ef92e3edab202d"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5241ee8b8b9d9915e1ef92e3edab202d">originalPdbTransY</a></td></tr>
<tr class="memdesc:a5241ee8b8b9d9915e1ef92e3edab202d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The optimal translation vector as it relates to the original PDB positions (and not the ProSHADE internal map) along the y-axis. <br /></td></tr>
<tr class="separator:a5241ee8b8b9d9915e1ef92e3edab202d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee571cb10ce61ab11680b1ebd5e23eb7"><td class="memItemLeft" align="right" valign="top"><a id="aee571cb10ce61ab11680b1ebd5e23eb7"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aee571cb10ce61ab11680b1ebd5e23eb7">originalPdbTransZ</a></td></tr>
<tr class="memdesc:aee571cb10ce61ab11680b1ebd5e23eb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">The optimal translation vector as it relates to the original PDB positions (and not the ProSHADE internal map) along the z-axis. <br /></td></tr>
<tr class="separator:aee571cb10ce61ab11680b1ebd5e23eb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afef6a064a54eb016776cb0879efb0b31"><td class="memItemLeft" align="right" valign="top"><a id="afef6a064a54eb016776cb0879efb0b31"></a>
proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a></td></tr>
<tr class="memdesc:afef6a064a54eb016776cb0879efb0b31"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the starting index along the x axis. <br /></td></tr>
<tr class="separator:afef6a064a54eb016776cb0879efb0b31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d47aafdd2ec9912225c3c44e2bbc4d8"><td class="memItemLeft" align="right" valign="top"><a id="a5d47aafdd2ec9912225c3c44e2bbc4d8"></a>
proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a></td></tr>
<tr class="memdesc:a5d47aafdd2ec9912225c3c44e2bbc4d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the starting index along the y axis. <br /></td></tr>
<tr class="separator:a5d47aafdd2ec9912225c3c44e2bbc4d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14980cdf619bcda026b9aad282c2064b"><td class="memItemLeft" align="right" valign="top"><a id="a14980cdf619bcda026b9aad282c2064b"></a>
proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a></td></tr>
<tr class="memdesc:a14980cdf619bcda026b9aad282c2064b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the starting index along the z axis. <br /></td></tr>
<tr class="separator:a14980cdf619bcda026b9aad282c2064b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac40e8210bd69b598a67c6a3e0a9ecf16"><td class="memItemLeft" align="right" valign="top"><a id="ac40e8210bd69b598a67c6a3e0a9ecf16"></a>
proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a></td></tr>
<tr class="memdesc:ac40e8210bd69b598a67c6a3e0a9ecf16"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the final index along the x axis. <br /></td></tr>
<tr class="separator:ac40e8210bd69b598a67c6a3e0a9ecf16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47b4953dae84a5ab54dadd33d7805887"><td class="memItemLeft" align="right" valign="top"><a id="a47b4953dae84a5ab54dadd33d7805887"></a>
proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a></td></tr>
<tr class="memdesc:a47b4953dae84a5ab54dadd33d7805887"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the final index along the y axis. <br /></td></tr>
<tr class="separator:a47b4953dae84a5ab54dadd33d7805887"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a930e25e9377cf418f6eab71fa2837255"><td class="memItemLeft" align="right" valign="top"><a id="a930e25e9377cf418f6eab71fa2837255"></a>
proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a></td></tr>
<tr class="memdesc:a930e25e9377cf418f6eab71fa2837255"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the final index along the z axis. <br /></td></tr>
<tr class="separator:a930e25e9377cf418f6eab71fa2837255"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31b57e51f48e58828883b04b612dcf55"><td class="memItemLeft" align="right" valign="top"><a id="a31b57e51f48e58828883b04b612dcf55"></a>
std::vector&lt; proshade_single &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a></td></tr>
<tr class="memdesc:a31b57e51f48e58828883b04b612dcf55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of sphere radii from the centre of the map. <br /></td></tr>
<tr class="separator:a31b57e51f48e58828883b04b612dcf55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a411b398b06557387320b56c6b8233fc4"><td class="memItemLeft" align="right" valign="top"><a id="a411b398b06557387320b56c6b8233fc4"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a></td></tr>
<tr class="memdesc:a411b398b06557387320b56c6b8233fc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of spheres with map projected onto them. <br /></td></tr>
<tr class="separator:a411b398b06557387320b56c6b8233fc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa414664dde18320cc52075640590d51d"><td class="memItemLeft" align="right" valign="top"><a id="aa414664dde18320cc52075640590d51d"></a>
<a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html">ProSHADE_internal_spheres::ProSHADE_sphere</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a></td></tr>
<tr class="memdesc:aa414664dde18320cc52075640590d51d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The set of concentric spheres to which the intermal density map has been projected. <br /></td></tr>
<tr class="separator:aa414664dde18320cc52075640590d51d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f934f331c4d3bc7c0a6f63486b2f90e"><td class="memItemLeft" align="right" valign="top"><a id="a5f934f331c4d3bc7c0a6f63486b2f90e"></a>
proshade_complex **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a></td></tr>
<tr class="memdesc:a5f934f331c4d3bc7c0a6f63486b2f90e"><td class="mdescLeft">&#160;</td><td class="mdescRight">A set of spherical harmonics values arrays for each sphere. <br /></td></tr>
<tr class="separator:a5f934f331c4d3bc7c0a6f63486b2f90e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94b04108aa1a9406eb3c5eb61749140b"><td class="memItemLeft" align="right" valign="top"><a id="a94b04108aa1a9406eb3c5eb61749140b"></a>
proshade_complex **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94b04108aa1a9406eb3c5eb61749140b">rotSphericalHarmonics</a></td></tr>
<tr class="memdesc:a94b04108aa1a9406eb3c5eb61749140b"><td class="mdescLeft">&#160;</td><td class="mdescRight">A set of rotated spherical harmonics values arrays for each sphere, used only if map rotation is required. <br /></td></tr>
<tr class="separator:a94b04108aa1a9406eb3c5eb61749140b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a367d0cd13e3d7a2648488980220ca69b"><td class="memItemLeft" align="right" valign="top"><a id="a367d0cd13e3d7a2648488980220ca69b"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a></td></tr>
<tr class="memdesc:a367d0cd13e3d7a2648488980220ca69b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The maximum band for any shell of the object. <br /></td></tr>
<tr class="separator:a367d0cd13e3d7a2648488980220ca69b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8b72cbc56a4f72d0557e01a8101d435"><td class="memItemLeft" align="right" valign="top"><a id="af8b72cbc56a4f72d0557e01a8101d435"></a>
proshade_double ***&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a></td></tr>
<tr class="memdesc:af8b72cbc56a4f72d0557e01a8101d435"><td class="mdescLeft">&#160;</td><td class="mdescRight">The energy levels descriptor shell correlation tables. <br /></td></tr>
<tr class="separator:af8b72cbc56a4f72d0557e01a8101d435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82b2d8f8c05da2eccb5561e6455b4d44"><td class="memItemLeft" align="right" valign="top"><a id="a82b2d8f8c05da2eccb5561e6455b4d44"></a>
proshade_complex ***&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a></td></tr>
<tr class="memdesc:a82b2d8f8c05da2eccb5561e6455b4d44"><td class="mdescLeft">&#160;</td><td class="mdescRight">The trace sigma and full rotation function c*conj(c) integral tables. <br /></td></tr>
<tr class="separator:a82b2d8f8c05da2eccb5561e6455b4d44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d266289b137b48132f1456fd8fc43ea"><td class="memItemLeft" align="right" valign="top"><a id="a5d266289b137b48132f1456fd8fc43ea"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d266289b137b48132f1456fd8fc43ea">integrationWeight</a></td></tr>
<tr class="memdesc:a5d266289b137b48132f1456fd8fc43ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Pearson's c.c. type weighting for the integration. <br /></td></tr>
<tr class="separator:a5d266289b137b48132f1456fd8fc43ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5416490eb3eba7539d08a5b324fbadb"><td class="memItemLeft" align="right" valign="top"><a id="ad5416490eb3eba7539d08a5b324fbadb"></a>
proshade_complex *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">so3Coeffs</a></td></tr>
<tr class="memdesc:ad5416490eb3eba7539d08a5b324fbadb"><td class="mdescLeft">&#160;</td><td class="mdescRight">The coefficients obtained by SO(3) Fourier Transform (SOFT), in this case derived from the E matrices. <br /></td></tr>
<tr class="separator:ad5416490eb3eba7539d08a5b324fbadb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33312dd4333617b460628e4db4bf41fc"><td class="memItemLeft" align="right" valign="top"><a id="a33312dd4333617b460628e4db4bf41fc"></a>
proshade_complex *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a33312dd4333617b460628e4db4bf41fc">so3CoeffsInverse</a></td></tr>
<tr class="memdesc:a33312dd4333617b460628e4db4bf41fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">The inverse coefficients obtained by inverse SO(3) Fourier Transform (SOFT) - i.e. rotation function. <br /></td></tr>
<tr class="separator:a33312dd4333617b460628e4db4bf41fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a618fc0fc9ca71ec70500c99c7e6231f4"><td class="memItemLeft" align="right" valign="top"><a id="a618fc0fc9ca71ec70500c99c7e6231f4"></a>
proshade_complex ***&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">wignerMatrices</a></td></tr>
<tr class="memdesc:a618fc0fc9ca71ec70500c99c7e6231f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">These matrices are computed for a particular rotation to be done in spherical harmonics. <br /></td></tr>
<tr class="separator:a618fc0fc9ca71ec70500c99c7e6231f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99ed9b0a765739d89104eca2c1875dd4"><td class="memItemLeft" align="right" valign="top"><a id="a99ed9b0a765739d89104eca2c1875dd4"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ed9b0a765739d89104eca2c1875dd4">maxCompBand</a></td></tr>
<tr class="memdesc:a99ed9b0a765739d89104eca2c1875dd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The largest comparison band - this variable tells how large arrays will be allocated for the comparison. <br /></td></tr>
<tr class="separator:a99ed9b0a765739d89104eca2c1875dd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37f26ac4bc76e4f4c5da77dd0eace56e"><td class="memItemLeft" align="right" valign="top"><a id="a37f26ac4bc76e4f4c5da77dd0eace56e"></a>
proshade_complex *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37f26ac4bc76e4f4c5da77dd0eace56e">translationMap</a></td></tr>
<tr class="memdesc:a37f26ac4bc76e4f4c5da77dd0eace56e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is where the translation map will be held, if at all used. <br /></td></tr>
<tr class="separator:a37f26ac4bc76e4f4c5da77dd0eace56e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50358df39a25e9ba02fe2794d4a2ca28"><td class="memItemLeft" align="right" valign="top"><a id="a50358df39a25e9ba02fe2794d4a2ca28"></a>
std::vector&lt; <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>sphereMappedRotFun</b></td></tr>
<tr class="separator:a50358df39a25e9ba02fe2794d4a2ca28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac57d606fdb59d54bd3f9249941402b12"><td class="memItemLeft" align="right" valign="top"><a id="ac57d606fdb59d54bd3f9249941402b12"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac57d606fdb59d54bd3f9249941402b12">isEmpty</a></td></tr>
<tr class="memdesc:ac57d606fdb59d54bd3f9249941402b12"><td class="mdescLeft">&#160;</td><td class="mdescRight">This variable stated whether the class contains any information. <br /></td></tr>
<tr class="separator:ac57d606fdb59d54bd3f9249941402b12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99ab4a34f3a42c17f923ef131c64b4a7"><td class="memItemLeft" align="right" valign="top"><a id="a99ab4a34f3a42c17f923ef131c64b4a7"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ab4a34f3a42c17f923ef131c64b4a7">inputOrder</a></td></tr>
<tr class="memdesc:a99ab4a34f3a42c17f923ef131c64b4a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This value is the input order - it is useful to know for writing out files, so that they would not overwrite the same name multiple times. <br /></td></tr>
<tr class="separator:a99ab4a34f3a42c17f923ef131c64b4a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a476092aa08dff20d64a895e7b2227b2e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a476092aa08dff20d64a895e7b2227b2e">figureIndexStartStop</a> (void)</td></tr>
<tr class="memdesc:a476092aa08dff20d64a895e7b2227b2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for determining iterator start and stop positions.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a476092aa08dff20d64a895e7b2227b2e">More...</a><br /></td></tr>
<tr class="separator:a476092aa08dff20d64a895e7b2227b2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30edd2928e423198704adb955989960b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30edd2928e423198704adb955989960b">setPDBMapValues</a> (void)</td></tr>
<tr class="memdesc:a30edd2928e423198704adb955989960b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for determining iterator start and stop positions.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30edd2928e423198704adb955989960b">More...</a><br /></td></tr>
<tr class="separator:a30edd2928e423198704adb955989960b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae85fef5742e6c6c9ef7bda2ff0f7d23"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae85fef5742e6c6c9ef7bda2ff0f7d23">readInMAP</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, proshade_double *maskArr=nullptr, proshade_unsign maskXDim=0, proshade_unsign maskYDim=0, proshade_unsign maskZDim=0, proshade_double *weightsArr=nullptr, proshade_unsign weigXDim=0, proshade_unsign weigYDim=0, proshade_unsign weigZDim=0)</td></tr>
<tr class="memdesc:aae85fef5742e6c6c9ef7bda2ff0f7d23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for reading map data using gemmi library.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae85fef5742e6c6c9ef7bda2ff0f7d23">More...</a><br /></td></tr>
<tr class="separator:aae85fef5742e6c6c9ef7bda2ff0f7d23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd1c1b3588308f775da5c8aeba3f3e78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abd1c1b3588308f775da5c8aeba3f3e78">readInPDB</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:abd1c1b3588308f775da5c8aeba3f3e78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for reading pdb data.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abd1c1b3588308f775da5c8aeba3f3e78">More...</a><br /></td></tr>
<tr class="separator:abd1c1b3588308f775da5c8aeba3f3e78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8dcc353f075b824d2f3479f487c8bd0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8dcc353f075b824d2f3479f487c8bd0">readInGemmi</a> (gemmi::Structure gemmiStruct, <a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:af8dcc353f075b824d2f3479f487c8bd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for reading co-ordinate data from Gemmi object.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8dcc353f075b824d2f3479f487c8bd0">More...</a><br /></td></tr>
<tr class="separator:af8dcc353f075b824d2f3479f487c8bd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f8698493efda1aa3e057c266d5c697b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4f8698493efda1aa3e057c266d5c697b">allocateRRPMemory</a> ()</td></tr>
<tr class="memdesc:a4f8698493efda1aa3e057c266d5c697b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allocates the required memory for the RRP matrices.  <a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4f8698493efda1aa3e057c266d5c697b">More...</a><br /></td></tr>
<tr class="separator:a4f8698493efda1aa3e057c266d5c697b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class contains all inputed and derived data for a single structure. </p>
<p>This class codes the object that contains all the information about the input data and the derived information as well. It does not, however, provide the computation code as that lives elsewhere, except for the forward declarations. </p>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8hpp_source.html#l00048">48</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8hpp_source.html">ProSHADE_data.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a549bd90e8cdb71762a48aec59a313dd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a549bd90e8cdb71762a48aec59a313dd3">&#9670;&nbsp;</a></span>ProSHADE_data() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ProSHADE_internal_data::ProSHADE_data::ProSHADE_data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor for getting empty <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> class. </p>
<p>This constructor creates an empty data structure which can later be filled with data and used to process these data further.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td><a class="el" href="class_pro_s_h_a_d_e__settings.html" title="This class stores all the settings and is passed to the executive classes instead of a multitude of p...">ProSHADE_settings</a> object specifying what should be done. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>Empty data object with deault values. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l00093">93</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// ... Variables regarding input file</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a>                                    = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4052e498b4650f62bfe5ff37ed959292">fileType</a>                                    = ProSHADE_internal_io::UNKNOWN;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// ... Variables regarding map</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>                                 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// ... Variables regarding map information</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>                                    = 0.0;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>                                    = 0.0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>                                    = 0.0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">aAngle</a>                                      = 0.0;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9dbcec9f32eb76625d7aa59d8c2701d9">bAngle</a>                                      = 0.0;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e2f99f00dd05198b508633cf7f6f080">cAngle</a>                                      = 0.0;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>                                 = 0;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>                                 = 0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>                                 = 0;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">xGridIndices</a>                                = 0;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">yGridIndices</a>                                = 0;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">zGridIndices</a>                                = 0;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">xAxisOrder</a>                                  = 1;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">yAxisOrder</a>                                  = 2;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">zAxisOrder</a>                                  = 3;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a>                                 = 0;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a>                                 = 0;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a>                                 = 0;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">xCom</a>                                        = 0.0;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">yCom</a>                                        = 0.0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">zCom</a>                                        = 0.0;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// ... Variables regarding original input values (i.e. these do not change with ProSHADE manipulations)</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ae6821c27e7facf63839c9fc678c9c7">xDimSizeOriginal</a>                            = 0.0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7855424ca5d51853c7fc665ecb9b935b">yDimSizeOriginal</a>                            = 0.0;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a530ad7e3396cbcbc1814051031070a8b">zDimSizeOriginal</a>                            = 0.0;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9598e9a38546e3bf260bc09c0c9366a2">xDimIndicesOriginal</a>                         = 0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ef18126c2c24edc9b6be06e0591127f">yDimIndicesOriginal</a>                         = 0;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ea6522b99cf1ac72199c9eeccd30742">zDimIndicesOriginal</a>                         = 0;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a43f1c4682016759ea2e24c5903dbe444">xAxisOriginOriginal</a>                         = 0;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a53cffdab0d66cb88884ec4f46c19a5ff">yAxisOriginOriginal</a>                         = 0;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aed1c8e0ffb847b093a736c5156f86e9b">zAxisOriginOriginal</a>                         = 0;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2a3fdf194eca61b1ccfa5bdd2f586e0b">originalMapXCom</a>                             = 0.0;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a64323b4117a11f0971cb0d24ec95c64c">originalMapYCom</a>                             = 0.0;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac00197ab71e3353cb2884be0e51d6cd3">originalMapZCom</a>                             = 0.0;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7861a96d94b8f7a8eb2946729c330863">mapMovFromsChangeX</a>                          = 0.0;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1658311301e365cf17721e864b829c28">mapMovFromsChangeY</a>                          = 0.0;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a682749f30d2fd19842d96e9b870d76ab">mapMovFromsChangeZ</a>                          = 0.0;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a471ec29b27c3a402d18b20fee8035f1a">mapCOMProcessChangeX</a>                        = 0.0;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47bf2343b0b50267e8e3732c964b63ea">mapCOMProcessChangeY</a>                        = 0.0;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a487131ae5dc44f8667908bf64725b4ab">mapCOMProcessChangeZ</a>                        = 0.0;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// ... Variables regarding rotation and translation of original input files</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a923cdc6e27455ba99ce5f536932f3721">originalPdbRotCenX</a>                          = 0.0;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a77cabdd70039e82f8c0cbb07fefd3960">originalPdbRotCenY</a>                          = 0.0;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a924d0767561842716b2ac260426cdc19">originalPdbRotCenZ</a>                          = 0.0;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9548e8ff07c6a74bbe2353f647fb6a79">originalPdbTransX</a>                           = 0.0;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5241ee8b8b9d9915e1ef92e3edab202d">originalPdbTransY</a>                           = 0.0;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aee571cb10ce61ab11680b1ebd5e23eb7">originalPdbTransZ</a>                           = 0.0;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// ... Variables regarding iterator positions</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>                                       = 0;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>                                       = 0;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>                                       = 0;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>                                         = 0;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>                                         = 0;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>                                         = 0;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// ... Variables regarding SH mapping spheres</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>                                   = std::vector&lt;proshade_single&gt; ( );</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>                                   = 0;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>                                     = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>                          = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94b04108aa1a9406eb3c5eb61749140b">rotSphericalHarmonics</a>                       = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a>                                = 0;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// ... Variables regarding shape distance computations</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>                                 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>                                   = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">so3Coeffs</a>                                   = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a33312dd4333617b460628e4db4bf41fc">so3CoeffsInverse</a>                            = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">wignerMatrices</a>                              = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d266289b137b48132f1456fd8fc43ea">integrationWeight</a>                           = 0.0;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ed9b0a765739d89104eca2c1875dd4">maxCompBand</a>                                 = 0;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37f26ac4bc76e4f4c5da77dd0eace56e">translationMap</a>                              = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// ... Control variables</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac57d606fdb59d54bd3f9249941402b12">isEmpty</a>                                     = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7afb32f0574cb707876c4502680dfd80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7afb32f0574cb707876c4502680dfd80">&#9670;&nbsp;</a></span>ProSHADE_data() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ProSHADE_internal_data::ProSHADE_data::ProSHADE_data </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>strName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mapVals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>xDmSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>yDmSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_single&#160;</td>
          <td class="paramname"><em>zDmSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xDmInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yDmInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zDmInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>xFr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>yFr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>zFr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>xT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>yT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>zT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>inputO</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor for creating <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> structure with data. </p>
<p>This constructor creates a data structure with all the map information, so that maps obtained from other software could be loeaded and used. This function makes a lot of assumptions (all angles are 90 degrees, axis grids are equal to indices, axis order is XYZ and axis origin is the first index in all dimensions). If any of these are not true, the user is required to change the appropriate internal values after this function has returned the object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td><a class="el" href="class_pro_s_h_a_d_e__settings.html" title="This class stores all the settings and is passed to the executive classes instead of a multitude of p...">ProSHADE_settings</a> object specifying what should be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">strName</td><td>The name of the structure for reference. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mapVals</td><td>A pointer to array where all the map data are. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>The length of this map values array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDmSz</td><td>The size of the x-axis dimension in Angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDmSz</td><td>The size of the y-axis dimension in Angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDmSz</td><td>The size of the z-axis dimension in Angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDmInd</td><td>The size of the x-axis dimension in indices. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDmInd</td><td>The size of the y-axis dimension in indices. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDmInd</td><td>The size of the z-axis dimension in indices. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xFr</td><td>The first index statting position along the x-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yFr</td><td>The first index statting position along the y-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zFr</td><td>The first index statting position along the z-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xT</td><td>The last index end position along the x-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yT</td><td>The last index end position along the y-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zT</td><td>The last index end position along the z-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inputO</td><td>The input order for this structure. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>Empty data object with filled in values and map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l00214">214</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// ... Variables regarding input file</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a>                                    = strName;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4052e498b4650f62bfe5ff37ed959292">fileType</a>                                    = ProSHADE_internal_io::MAP;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// ... Variables regarding map</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>                                 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// ... Variables regarding map information</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>                                    = xDmSz;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>                                    = yDmSz;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>                                    = zDmSz;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">aAngle</a>                                      = 90.0;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9dbcec9f32eb76625d7aa59d8c2701d9">bAngle</a>                                      = 90.0;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e2f99f00dd05198b508633cf7f6f080">cAngle</a>                                      = 90.0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>                                 = xDmInd;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>                                 = yDmInd;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>                                 = zDmInd;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">xGridIndices</a>                                = xDmInd;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">yGridIndices</a>                                = yDmInd;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">zGridIndices</a>                                = zDmInd;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">xAxisOrder</a>                                  = 1;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">yAxisOrder</a>                                  = 2;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">zAxisOrder</a>                                  = 3;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a>                                 = xFr;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a>                                 = yFr;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a>                                 = zFr;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">xCom</a>                                        = 0.0;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">yCom</a>                                        = 0.0;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">zCom</a>                                        = 0.0;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">// ... Variables regarding original input values (i.e. these do not change with ProSHADE manipulations)</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ae6821c27e7facf63839c9fc678c9c7">xDimSizeOriginal</a>                            = 0.0;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7855424ca5d51853c7fc665ecb9b935b">yDimSizeOriginal</a>                            = 0.0;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a530ad7e3396cbcbc1814051031070a8b">zDimSizeOriginal</a>                            = 0.0;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9598e9a38546e3bf260bc09c0c9366a2">xDimIndicesOriginal</a>                         = 0;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ef18126c2c24edc9b6be06e0591127f">yDimIndicesOriginal</a>                         = 0;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ea6522b99cf1ac72199c9eeccd30742">zDimIndicesOriginal</a>                         = 0;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a43f1c4682016759ea2e24c5903dbe444">xAxisOriginOriginal</a>                         = 0;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a53cffdab0d66cb88884ec4f46c19a5ff">yAxisOriginOriginal</a>                         = 0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aed1c8e0ffb847b093a736c5156f86e9b">zAxisOriginOriginal</a>                         = 0;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2a3fdf194eca61b1ccfa5bdd2f586e0b">originalMapXCom</a>                             = 0.0;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a64323b4117a11f0971cb0d24ec95c64c">originalMapYCom</a>                             = 0.0;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac00197ab71e3353cb2884be0e51d6cd3">originalMapZCom</a>                             = 0.0;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7861a96d94b8f7a8eb2946729c330863">mapMovFromsChangeX</a>                          = 0.0;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1658311301e365cf17721e864b829c28">mapMovFromsChangeY</a>                          = 0.0;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a682749f30d2fd19842d96e9b870d76ab">mapMovFromsChangeZ</a>                          = 0.0;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a471ec29b27c3a402d18b20fee8035f1a">mapCOMProcessChangeX</a>                        = 0.0;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47bf2343b0b50267e8e3732c964b63ea">mapCOMProcessChangeY</a>                        = 0.0;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a487131ae5dc44f8667908bf64725b4ab">mapCOMProcessChangeZ</a>                        = 0.0;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">// ... Variables regarding rotation and translation of original input files</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a923cdc6e27455ba99ce5f536932f3721">originalPdbRotCenX</a>                          = 0.0;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a77cabdd70039e82f8c0cbb07fefd3960">originalPdbRotCenY</a>                          = 0.0;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a924d0767561842716b2ac260426cdc19">originalPdbRotCenZ</a>                          = 0.0;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9548e8ff07c6a74bbe2353f647fb6a79">originalPdbTransX</a>                           = 0.0;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5241ee8b8b9d9915e1ef92e3edab202d">originalPdbTransY</a>                           = 0.0;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aee571cb10ce61ab11680b1ebd5e23eb7">originalPdbTransZ</a>                           = 0.0;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">// ... Variables regarding iterator positions</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>                                       = xFr;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>                                       = yFr;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>                                       = zFr;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>                                         = xT;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>                                         = yT;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>                                         = zT;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// ... Variables regarding SH mapping spheres</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>                                   = std::vector&lt;proshade_single&gt; ( );</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>                                   = 0;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>                                     = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>                          = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94b04108aa1a9406eb3c5eb61749140b">rotSphericalHarmonics</a>                       = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a>                                = 0;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// ... Variables regarding shape distance computations</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>                                 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>                                   = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">so3Coeffs</a>                                   = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a33312dd4333617b460628e4db4bf41fc">so3CoeffsInverse</a>                            = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">wignerMatrices</a>                              = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d266289b137b48132f1456fd8fc43ea">integrationWeight</a>                           = 0.0;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ed9b0a765739d89104eca2c1875dd4">maxCompBand</a>                                 = 0;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37f26ac4bc76e4f4c5da77dd0eace56e">translationMap</a>                              = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">// ... Control variables</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac57d606fdb59d54bd3f9249941402b12">isEmpty</a>                                     = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ab4a34f3a42c17f923ef131c64b4a7">inputOrder</a>                                  = inputO;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">//================================================ Sanity checks</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( len ) != ( xDmInd * yDmInd * zDmInd ) )</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Structure class input map has wrong dimensions.&quot;</span>, <span class="stringliteral">&quot;EP00044&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied map array size has different dimensions to\n                    : the required map dimensions.&quot;</span> );</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">if</span> ( ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( xT - xFr ) != <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( xDmInd - 1 ) ) ||</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;         ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( yT - yFr ) != <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( yDmInd - 1 ) ) ||</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;         ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( zT - zFr ) != <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( zDmInd - 1 ) ) )</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Structure class input dimensions not in line with map\n                    : to/from indices.&quot;</span>, <span class="stringliteral">&quot;EP00045&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied map information does not add up. The\n                    : dimensions are not in line with the indexing start/stop\n                    : position distances and therefore proper map indexing\n                    : cannot be done. Please check the input values.&quot;</span> );</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">//================================================ Allocate the map memory</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>                                 = <span class="keyword">new</span> proshade_double [this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">//================================================ Copy the values into the map</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    proshade_unsign arrPos                            = 0;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign xIt = 0; xIt &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>; xIt++ )</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign yIt = 0; yIt &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>; yIt++ )</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign zIt = 0; zIt &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>; zIt++ )</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                arrPos                                = zIt + this-&gt;zDimIndices * ( yIt + this-&gt;yDimIndices * xIt );</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[arrPos]             = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( mapVals[arrPos] );</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">//================================================ Release memory (it was allocated by the PyBind11 lambda function and needs to be released)</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keyword">delete</span>[] mapVals;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a485495727d37abd66295bab95d368438"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a485495727d37abd66295bab95d368438">&#9670;&nbsp;</a></span>~ProSHADE_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ProSHADE_internal_data::ProSHADE_data::~ProSHADE_data </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor for the <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> class. </p>
<p>This destructor is responsible for releasing all memory used by the data storing object</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>N/A. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l00349">349</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;{</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">//================================================ Release the internal map</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a> != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">//================================================ Release the sphere mapping</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a> != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>; iter++ )</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[iter] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <span class="keyword">delete</span> this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[iter];</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[iter]                   = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">//================================================ Release the spherical harmonics</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a> != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>; iter++ )</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>[iter] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>[iter];</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>[iter]        = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">//================================================ Release the rotated spherical harmonics</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94b04108aa1a9406eb3c5eb61749140b">rotSphericalHarmonics</a> != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>; iter++ )</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94b04108aa1a9406eb3c5eb61749140b">rotSphericalHarmonics</a>[iter] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94b04108aa1a9406eb3c5eb61749140b">rotSphericalHarmonics</a>[iter];</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94b04108aa1a9406eb3c5eb61749140b">rotSphericalHarmonics</a>[iter]     = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94b04108aa1a9406eb3c5eb61749140b">rotSphericalHarmonics</a>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">//================================================ Release the RRP matrices (pre-computation for the energy levels descriptor)</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a> != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign bwIt = 0; bwIt &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a>; bwIt++ )</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>[bwIt] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign shIt = 0; shIt &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>; shIt++ )</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>[bwIt][shIt] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>[bwIt][shIt];</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>[bwIt];</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">//================================================ Release the E matrices</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a> != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign bandIter = 0; bandIter &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ed9b0a765739d89104eca2c1875dd4">maxCompBand</a>; bandIter++ )</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[bandIter] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign band2Iter = 0; band2Iter &lt; static_cast&lt;proshade_unsign&gt; ( ( bandIter * 2 ) + 1 ); band2Iter++ )</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[bandIter][band2Iter] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                    {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                        <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[bandIter][band2Iter];</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                    }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[bandIter];</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">//================================================ Release SOFT and inverse SOFT coefficients</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">so3Coeffs</a> != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">so3Coeffs</a>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a33312dd4333617b460628e4db4bf41fc">so3CoeffsInverse</a> != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a33312dd4333617b460628e4db4bf41fc">so3CoeffsInverse</a>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">//================================================ Release Wigner matrices</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">wignerMatrices</a> != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign bandIter = 1; bandIter &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ed9b0a765739d89104eca2c1875dd4">maxCompBand</a>; bandIter++ )</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">wignerMatrices</a>[bandIter] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign order1Iter = 0; order1Iter &lt; ( (bandIter * 2) + 1 ); order1Iter++ )</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">wignerMatrices</a>[bandIter][order1Iter] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                        <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">wignerMatrices</a>[bandIter][order1Iter];</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                    }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">wignerMatrices</a>[bandIter];</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keyword">delete</span>[] <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">wignerMatrices</a>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">//================================================ Release translation map</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37f26ac4bc76e4f4c5da77dd0eace56e">translationMap</a> != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37f26ac4bc76e4f4c5da77dd0eace56e">translationMap</a>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">//================================================ Release the angle-axis space rotation function</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;sphereMappedRotFun.size() &gt; 0 )</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign spIt = 0; spIt &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;sphereMappedRotFun.size() ); spIt++ )</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="keyword">delete</span> this-&gt;sphereMappedRotFun.at(spIt);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7a402c710af1af5fabf7505848dad047"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a402c710af1af5fabf7505848dad047">&#9670;&nbsp;</a></span>addExtraSpace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::addExtraSpace </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function increases the size of the map so that it can add empty space around it. </p>
<p>This function adds a given number of angstroms (as given in the settings object) to the internal structure map. This requires all the internal variables to be adjusted for the extra space at the begginning and at the end, while also copying the map into a larger one with appropriate extra space.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map manipulation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01585">1585</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;{</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot;Adding extra &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">addExtraSpace</a> &lt;&lt; <span class="stringliteral">&quot; angstroms.&quot;</span>;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1,  hlpSS.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="comment">//================================================ Figure how much indices need to change</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    proshade_unsign xAddIndices                       = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">addExtraSpace</a> / ( this-&gt;xDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimIndices ) ) ) );</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    proshade_unsign yAddIndices                       = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">addExtraSpace</a> / ( this-&gt;yDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) ) ) );</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    proshade_unsign zAddIndices                       = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">addExtraSpace</a> / ( this-&gt;zDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) ) ) );</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    <span class="comment">//================================================ Update internal data variables</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>                                   += 2 * <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( xAddIndices ) * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a> / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> );</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>                                   += 2 * <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( yAddIndices ) * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a> / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> );</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>                                   += 2 * <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( zAddIndices ) * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> );</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;            </div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>                                += 2 * xAddIndices;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>                                += 2 * yAddIndices;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>                                += 2 * zAddIndices;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            </div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">xGridIndices</a>                                = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">yGridIndices</a>                                = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">zGridIndices</a>                                = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            </div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a>                                -= xAddIndices;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a>                                -= yAddIndices;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a>                                -= zAddIndices;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            </div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>                                      -= xAddIndices;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>                                      -= yAddIndices;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>                                      -= zAddIndices;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            </div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>                                        += xAddIndices;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>                                        += yAddIndices;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>                                        += zAddIndices;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    </div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="comment">//================================================ Allocate new map</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    proshade_double* newMap                           = <span class="keyword">new</span> proshade_double[this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( newMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    </div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="comment">//================================================ Set new map to zeroes</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ )</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    {</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        newMap[iter]                                  = 0.0;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    }</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="comment">//================================================ Update the map</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    proshade_unsign newMapIndex, oldMapIndex;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign xIt = 0; xIt &lt; (this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> - xAddIndices); xIt++ )</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    {</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        <span class="comment">//============================================ Check if point is applicable</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        <span class="keywordflow">if</span> ( xIt &lt; xAddIndices ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        </div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign yIt = 0; yIt &lt; (this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> - yAddIndices); yIt++ )</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        {</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;            <span class="comment">//======================================== Check if point is applicable</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;            <span class="keywordflow">if</span> ( yIt &lt; yAddIndices ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            </div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign zIt = 0; zIt &lt; (this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> - zAddIndices); zIt++ )</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;            {</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                <span class="comment">//==================================== Check if point is applicable</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                <span class="keywordflow">if</span> ( zIt &lt; zAddIndices ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                </div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                <span class="comment">//==================================== Var init</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                newMapIndex                           = zIt + this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> * ( yIt + this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * xIt );</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                oldMapIndex                           = (zIt - zAddIndices) + (this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> - ( 2 * zAddIndices ) ) * ( (yIt - yAddIndices) + (this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> - ( 2 * yAddIndices ) ) * (xIt - xAddIndices) );</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                </div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                newMap[newMapIndex]                   = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[oldMapIndex];</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;            }</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        }</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    }</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    </div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="comment">//================================================ Copy new to old</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    </div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>                                 = <span class="keyword">new</span> proshade_double[this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    </div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ )</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    {</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter]                       = newMap[iter];</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    }</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    </div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="keyword">delete</span>[] newMap;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    </div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Extra space added.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    </div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    return ;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    </div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e78c033b2c8c038038887105d67b115"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e78c033b2c8c038038887105d67b115">&#9670;&nbsp;</a></span>allocateEMatrices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::allocateEMatrices </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>band</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allocates the required memory for the E matrices. </p>
<p>This function belongs to the <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> class and its role is to allocate the require memory for the E matrices required by both, the Trace Sigma and Full Rotational descriptors, as well as symmetry and rotation tasks.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The minimal band of the comparison for which E matrices are computed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00275">275</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;{</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">//================================================ Save the maximum band to the object</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ed9b0a765739d89104eca2c1875dd4">maxCompBand</a>                                 = band;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">//================================================ Allocate the required memory</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>                                   = <span class="keyword">new</span> proshade_complex** [this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ed9b0a765739d89104eca2c1875dd4">maxCompBand</a>];</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign bandIter = 0; bandIter &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ed9b0a765739d89104eca2c1875dd4">maxCompBand</a>; bandIter++ )</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">//============================================ Allocate the data structure</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[bandIter]                     = <span class="keyword">new</span> proshade_complex*  [<span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( ( bandIter * 2 ) + 1 )];</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[bandIter], __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign band2Iter = 0; band2Iter &lt; static_cast&lt;proshade_unsign&gt; ( ( bandIter * 2 ) + 1 ); band2Iter++ )</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[bandIter][band2Iter]      = <span class="keyword">new</span> proshade_complex [<span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( ( bandIter * 2 ) + 1 )];</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[bandIter][band2Iter], __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    return ;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f8698493efda1aa3e057c266d5c697b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f8698493efda1aa3e057c266d5c697b">&#9670;&nbsp;</a></span>allocateRRPMemory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::allocateRRPMemory </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function allocates the required memory for the RRP matrices. </p>
<p>This function belongs to the <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> class and its role is to allocate the require memory for the RRP matrices, given the already determined bandwidths and shell count. </p>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00031">31</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">//================================================ Allocate the required memory</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>                                 = <span class="keyword">new</span> proshade_double** [this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a>];</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign bwIt = 0; bwIt &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a>; bwIt++ )</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="comment">//============================================ For rach sphere</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>[bwIt]                       = <span class="keyword">new</span> proshade_double*  [this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>];</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>[bwIt], __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign shIt = 0; shIt &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>; shIt++ )</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>[bwIt][shIt]             = <span class="keyword">new</span> <span class="keywordtype">double</span> [this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>[bwIt][shIt], __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abc4a61da919ae37b0a03d23df2461224"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc4a61da919ae37b0a03d23df2461224">&#9670;&nbsp;</a></span>allocateSO3CoeffsSpace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::allocateSO3CoeffsSpace </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>band</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allocates the memory for the SO(3) coefficients and the inverse for that calling object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The bandwidth to which the computation will be done. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00675">675</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;{</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">//================================================ Allocate the memory</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">so3Coeffs</a>                                   = <span class="keyword">new</span> fftw_complex [<span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>( ( 4 * pow( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( band ), 3.0 ) - <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( band ) ) / 3.0 )];</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a33312dd4333617b460628e4db4bf41fc">so3CoeffsInverse</a>                            = <span class="keyword">new</span> fftw_complex [<span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>( pow( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( band ) * 2.0, 3.0 ) )];</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">//================================================ Check memory allocation</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">so3Coeffs</a>,        __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;so3CoeffsInverse, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    return ;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a80ff45ef40549fb6a1d80b70865fc807"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80ff45ef40549fb6a1d80b70865fc807">&#9670;&nbsp;</a></span>centreMapOnCOM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::centreMapOnCOM </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function shits the map so that its COM is in the centre of the map. </p>
<p>This function finds the Centre Of Mass (COM) for the internal map and proceeds to use Fourier to shift the COM to the centre of the map. There is an assumption that the COM and centre of map are close, as if they were far apart, the shift could move some part of the map through the boundaries and cause the map to become messy.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map manipulation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01520">1520</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;{</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Centering map onto its COM.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    </div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    proshade_double xCOM                              = 0.0;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    proshade_double yCOM                              = 0.0;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    proshade_double zCOM                              = 0.0;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="comment">//================================================ Find the COM location</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aaad67127777eab70acca5952a7838d26">ProSHADE_internal_mapManip::findMAPCOMValues</a>      ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, &amp;xCOM, &amp;yCOM, &amp;zCOM,</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>,</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a> );</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    </div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="comment">//================================================ Find the sampling rates</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    proshade_single xSampRate                         = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a> ) / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a> - this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> );</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    proshade_single ySampRate                         = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a> ) / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a> - this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> );</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    proshade_single zSampRate                         = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> ) / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a> - this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> );</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="comment">//================================================ Convert to position in indices starting from 0</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    xCOM                                             /= <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( xSampRate );</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    yCOM                                             /= <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( ySampRate );</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    zCOM                                             /= <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( zSampRate );</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;         </div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    xCOM                                             -= <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> );</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    yCOM                                             -= <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> );</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    zCOM                                             -= <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> );</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="comment">//================================================ Find distance from COM to map centre in Angstroms</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    proshade_double xDist                             = ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ) / 2.0 ) - xCOM ) * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a> ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> );</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    proshade_double yDist                             = ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) / 2.0 ) - yCOM ) * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a> ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> );</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    proshade_double zDist                             = ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) / 2.0 ) - zCOM ) * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> );</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    </div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="comment">//================================================ Move the map within the box</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>      ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>,</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( xDist ),</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( yDist ),</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( zDist ),</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>,</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ),</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ),</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) );</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="comment">//================================================ Note the change due to centering</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a471ec29b27c3a402d18b20fee8035f1a">mapCOMProcessChangeX</a>                       -= xDist;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47bf2343b0b50267e8e3732c964b63ea">mapCOMProcessChangeY</a>                       -= yDist;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a487131ae5dc44f8667908bf64725b4ab">mapCOMProcessChangeZ</a>                       -= zDist;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Map centered.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    </div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    return ;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    </div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c9b62338517f1da1693b1073ebc9389"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c9b62338517f1da1693b1073ebc9389">&#9670;&nbsp;</a></span>computeFSC() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double ProSHADE_internal_data::ProSHADE_data::computeFSC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>mapData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>fCoeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>origCoeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan *&#160;</td>
          <td class="paramname"><em>planForwardFourier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>noBins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>binIndexing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double **&amp;&#160;</td>
          <td class="paramname"><em>bindata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&amp;&#160;</td>
          <td class="paramname"><em>binCounts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>fscByBin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes FSC for any given axis in the supplied CSym symmetry axes vector. </p>
<p>This function drives the FSC computation for symmetry detection. It iterates over all rotations specified by the symmetry axis (except for the I rotation) and for each of these, computes the map rotation accordingly. Next, it computes the Fourier transform of such rotated map and procceds to bin the coefficients according to the supplied key. From these bins, the sums required for finding the FSC between the rotated map and the original map can be obtained. Finally, averaging the FSC'c for all rotations the final FSC for the whole symmetry axis is obtained and returned.</p>
<dl class="section warning"><dt>Warning</dt><dd>This function does not really work on its own, it makes plethora of assumptions, the main ones being: Fourier transform of original (non-rotated) map is already computed and supplied, the FFTW plan for the Fourier transform of the rotated map is prepared and supplied, the workspace is allocated and supplied, the binning mask and number of bins is already determined ans supplied and so on. It would not be hard to remove these, but then repeated calls of this function would become much slower as all of these steps would have to be done for each call separately.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sym</td><td>A single double array containing a single Cyclic symmetry entry in the ProSHADE format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mapData</td><td>FFTW complex array which will be the input for the Fourier transform done by the planForwardFourier plan. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fCoeffs</td><td>FFTW complex array where the Fourier transform coefficients will be saved into by the planForwardFourier plan. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">origCoeffs</td><td>FFTW complex array holding already compute Fourier transform of the non-rotated map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">planForwardFourier</td><td>A prepared FFTW3 plan for transforming the mapData onto fCoeffs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noBins</td><td>The number of bins as already pre-computed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">binIndexing</td><td>A map of pre-computed bin assignments for each reflection in the format as outputted by FFTW. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bindata</td><td>Pre-allocated array of dimensions noBins x 12 serving as workspace for the bin summation and FSC computation. This array is modified by the function in case the caller would be interested in these results. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">binCounts</td><td>Pre-allocated array of dimension noBins serving to store the bin sizes for FSC computation. This array is modified by the function in case the caller would be interested in these results. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fscByBin</td><td>This array will hold FSC values for each bin. This is useful in further computations, but could be internal for FSC only computation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fsc</td><td>The FSC value found for the first (smallest) rotated map along the symmetry axis and the original map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l02472">2472</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;{</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="comment">//================================================ Ignore if already computed</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    <span class="keywordflow">if</span> ( sym[6] &gt; -2.0 ) { <span class="keywordflow">return</span> ( sym[6] ); }</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    </div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    std::stringstream ss2;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    ss2 &lt;&lt; <span class="stringliteral">&quot;Computing FSC for symmetry C&quot;</span> &lt;&lt; sym[0] &lt;&lt; <span class="stringliteral">&quot; ( &quot;</span> &lt;&lt; sym[1] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; sym[2] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; sym[3] &lt;&lt; <span class="stringliteral">&quot; ) with peak height &quot;</span> &lt;&lt; sym[5];</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, ss2.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    </div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    proshade_double *rotMap;</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    </div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    <span class="comment">//================================================ For each rotation along the axis</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    proshade_double averageFSC                        = 0.0;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    <span class="keywordflow">for</span> ( proshade_double rotIter = 1.0; rotIter &lt; sym[0]; rotIter += 1.0 )</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    {</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;        <span class="comment">//============================================ Get rotated map by the smallest fold angle along the symmetry axis</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a22caf254dfc11e52890f79a161493e6e">rotateMapRealSpace</a>                      ( sym[1], sym[2], sym[3], ( ( 2.0 * M_PI ) / sym[0] ) * rotIter, rotMap );</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        </div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        <span class="comment">//============================================ Get Fourier for the rotated map</span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; static_cast&lt; size_t &gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ ) { mapData[iter][0] = rotMap[iter]; mapData[iter][1] = 0.0; }</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        fftw_execute                                  ( *planForwardFourier );</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;        </div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;        <span class="comment">//============================================ Clean FSC computation memory</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> binIt = 0; binIt &lt; static_cast&lt; size_t &gt; ( noBins ); binIt++ ) { <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> valIt = 0; valIt &lt; 12; valIt++ ) { bindata[binIt][valIt] = 0.0; } }</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> binIt = 0; binIt &lt; static_cast&lt; size_t &gt; ( noBins ); binIt++ ) { binCounts[binIt] = 0; }</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;        </div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;        <span class="comment">//============================================ Compute FSC</span></div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;        averageFSC                                   += <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ab32d795fc4057093f27e5981551f5d99">ProSHADE_internal_maths::computeFSC</a> ( origCoeffs, fCoeffs, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>, noBins, binIndexing, bindata, binCounts, fscByBin );</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;        </div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;        <span class="comment">//============================================ Release memory</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        <span class="keyword">delete</span>[] rotMap;</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    }</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    </div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    <span class="comment">//================================================ Convert sum to average</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    averageFSC                                       /= ( sym[0] - 1.0 );</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    </div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    <span class="comment">//================================================ Save result to the axis</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    sym[6]                                            = averageFSC;</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    </div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    std::stringstream ss3;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    ss3 &lt;&lt; <span class="stringliteral">&quot;FSC value is &quot;</span> &lt;&lt; averageFSC &lt;&lt; <span class="stringliteral">&quot; .&quot;</span>;</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 5, ss3.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    </div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    <span class="keywordflow">return</span>                                            ( averageFSC );</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    </div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a42419398083b05da19ebfb3cfa5cdc34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42419398083b05da19ebfb3cfa5cdc34">&#9670;&nbsp;</a></span>computeFSC() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double ProSHADE_internal_data::ProSHADE_data::computeFSC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>CSym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>symIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>mapData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>fCoeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>origCoeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan *&#160;</td>
          <td class="paramname"><em>planForwardFourier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>noBins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>binIndexing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double **&amp;&#160;</td>
          <td class="paramname"><em>bindata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&amp;&#160;</td>
          <td class="paramname"><em>binCounts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>fscByBin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes FSC for any given axis in the supplied CSym symmetry axes vector. </p>
<p>This function drives the FSC computation for symmetry detection. It iterates over all rotations specified by the symmetry axis (except for the I rotation) and for each of these, computes the map rotation accordingly. Next, it computes the Fourier transform of such rotated map and procceds to bin the coefficients according to the supplied key. From these bins, the sums required for finding the FSC between the rotated map and the original map can be obtained. Finally, averaging the FSC'c for all rotations the final FSC for the whole symmetry axis is obtained and returned.</p>
<dl class="section warning"><dt>Warning</dt><dd>This function does not really work on its own, it makes plethora of assumptions, the main ones being: Fourier transform of original (non-rotated) map is already computed and supplied, the FFTW plan for the Fourier transform of the rotated map is prepared and supplied, the workspace is allocated and supplied, the binning mask and number of bins is already determined ans supplied and so on. It would not be hard to remove these, but then repeated calls of this function would become much slower as all of these steps would have to be done for each call separately.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CSym</td><td>A vector of pointers to double arrays, each array being a single Cyclic symmetry entry. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symIndex</td><td>The index of the symmetry axis in the CSym vector for which FSC should be computed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mapData</td><td>FFTW complex array which will be the input for the Fourier transform done by the planForwardFourier plan. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fCoeffs</td><td>FFTW complex array where the Fourier transform coefficients will be saved into by the planForwardFourier plan. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">origCoeffs</td><td>FFTW complex array holding already compute Fourier transform of the non-rotated map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">planForwardFourier</td><td>A prepared FFTW3 plan for transforming the mapData onto fCoeffs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noBins</td><td>The number of bins as already pre-computed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">binIndexing</td><td>A map of pre-computed bin assignments for each reflection in the format as outputted by FFTW. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bindata</td><td>Pre-allocated array of dimensions noBins x 12 serving as workspace for the bin summation and FSC computation. This array is modified by the function in case the caller would be interested in these results. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">binCounts</td><td>Pre-allocated array of dimension noBins serving to store the bin sizes for FSC computation. This array is modified by the function in case the caller would be interested in these results. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fscByBin</td><td>This array will hold FSC values for each bin. This is useful in further computations, but could be internal for FSC only computation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fsc</td><td>The FSC value found for the first (smallest) rotated map along the symmetry axis and the original map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l02391">2391</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;{</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <span class="keywordflow">if</span> ( symIndex &gt;= CSym-&gt;size() )</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    {</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;The supplied symmetry axes vector does not contain element number &quot;</span> &lt;&lt; symIndex &lt;&lt; <span class="stringliteral">&quot;. Returning FSC 0.0.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        <span class="keywordflow">return</span>                                        ( -2.0 );</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    }</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    </div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <span class="comment">//================================================ Ignore if already computed</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <span class="keywordflow">if</span> ( CSym-&gt;at(symIndex)[6] &gt; -2.0 ) { <span class="keywordflow">return</span> ( CSym-&gt;at(symIndex)[6] ); }</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    </div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    std::stringstream ss2;</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    ss2 &lt;&lt; <span class="stringliteral">&quot;Computing FSC for symmetry C&quot;</span> &lt;&lt; CSym-&gt;at(symIndex)[0] &lt;&lt; <span class="stringliteral">&quot; ( &quot;</span> &lt;&lt; CSym-&gt;at(symIndex)[1] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; CSym-&gt;at(symIndex)[2] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; CSym-&gt;at(symIndex)[3] &lt;&lt; <span class="stringliteral">&quot; ) with peak height &quot;</span> &lt;&lt; CSym-&gt;at(symIndex)[5];</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, ss2.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    </div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    proshade_double *rotMap;</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    </div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;    <span class="comment">//================================================ For each rotation along the axis</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    proshade_double averageFSC                        = 0.0;</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    <span class="keywordflow">for</span> ( proshade_double rotIter = 1.0; rotIter &lt; CSym-&gt;at(symIndex)[0]; rotIter += 1.0 )</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    {</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        <span class="comment">//============================================ Get rotated map by the smallest fold angle along the symmetry axis</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a22caf254dfc11e52890f79a161493e6e">rotateMapRealSpace</a>                      ( CSym-&gt;at(symIndex)[1], CSym-&gt;at(symIndex)[2], CSym-&gt;at(symIndex)[3], ( ( 2.0 * M_PI ) / CSym-&gt;at(symIndex)[0] ) * rotIter, rotMap );</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        </div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;        <span class="comment">//============================================ Get Fourier for the rotated map</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; static_cast&lt; size_t &gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ ) { mapData[iter][0] = rotMap[iter]; mapData[iter][1] = 0.0; }</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        fftw_execute                                  ( *planForwardFourier );</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        </div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        <span class="comment">//============================================ Compute FSC</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;        averageFSC                                   += <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ab32d795fc4057093f27e5981551f5d99">ProSHADE_internal_maths::computeFSC</a> ( origCoeffs, fCoeffs, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>, noBins, binIndexing, bindata, binCounts, fscByBin );</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        </div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;        <span class="comment">//============================================ Release memory</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;        <span class="keyword">delete</span>[] rotMap;</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    }</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    </div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    <span class="comment">//================================================ Convert sum to average</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    averageFSC                                       /= ( CSym-&gt;at(symIndex)[0] - 1.0 );</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    </div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    <span class="comment">//================================================ Save result to the axis</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    CSym-&gt;at(symIndex)[6]                             = averageFSC;</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    </div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    std::stringstream ss3;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    ss3 &lt;&lt; <span class="stringliteral">&quot;FSC value is &quot;</span> &lt;&lt; averageFSC &lt;&lt; <span class="stringliteral">&quot; .&quot;</span>;</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 5, ss3.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    </div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    <span class="keywordflow">return</span>                                            ( averageFSC );</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    </div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac7cb89ed871668c57a3b5dc953c20482"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7cb89ed871668c57a3b5dc953c20482">&#9670;&nbsp;</a></span>computeRotationFunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::computeRotationFunction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the self-rotation function for this structure. </p>
<p>This function assumes that the spherical harmonics have been computed for a data object. It can be then called on this object and it will proceed to compute the E matrices for this object against itself. From these "self E matrices", the function will generate the SO(3) transform coefficients and finally it will invert transform these coefficients back, thus getting the self-rotation function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map self-rotation function computation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00041">41</a> of file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting self-rotation function computation.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">//================================================ Compute un-weighted E matrices and their weights</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#add48230d67bd69305df058d29a588507">ProSHADE_internal_distances::computeEMatrices</a>     ( <span class="keyword">this</span>, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">//================================================ Normalise E matrices by the magnitudes</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#ac96ff1a23997199af76e58885a1ee1e2">ProSHADE_internal_distances::normaliseEMatrices</a>   ( <span class="keyword">this</span>, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">//================================================ Generate SO(3) coefficients</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#afacb5240b508ea28b64cacf395b47dba">ProSHADE_internal_distances::generateSO3CoeffsFromEMatrices</a> ( <span class="keyword">this</span>, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">//================================================ Compute the inverse SO(3) Fourier Transform (SOFT) on the newly computed coefficients</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#a3cdde76bf20d9cd5d756ffde2d3dc854">ProSHADE_internal_distances::computeInverseSOFTTransform</a> ( <span class="keyword">this</span>, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Self-rotation function obtained.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    return ;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6db2dcf87a6f763909ab08201e8de550"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6db2dcf87a6f763909ab08201e8de550">&#9670;&nbsp;</a></span>computeRRPMatrices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::computeRRPMatrices </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function pre-computes the RRP matrices for a data object. </p>
<p>This function belongs to the <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> class and its role is to set the objects internal variables properly and provide all the required calculations, so that the object will in the end have all the RRP matrices computed and be ready for the energy levels calculation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for the task. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00059">59</a> of file <a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;{</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Computing RRP matrices for structure &quot;</span> + this-&gt;fileName, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">//================================================ Allocate the memory</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4f8698493efda1aa3e057c266d5c697b">allocateRRPMemory</a>                           ( );</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">//================================================ Start computation: For each band (l)</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    proshade_double descValR                          = 0.0;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    proshade_unsign arrPos1, arrPos2;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign band = 0; band &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a>; band++ )</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="comment">//============================================ For each unique shell couple</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign shell1 = 0; shell1 &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>; shell1++ )</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="comment">//======================================== Does the band exist for this shell1?</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="keywordflow">if</span> ( !<a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#a6e15740000a0079151a2d24dbbdebb2e">ProSHADE_internal_distances::isBandWithinShell</a> ( band, shell1, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a> ) )</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign shell2 = 0; shell2 &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>; shell2++ )</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>[band][shell1][shell2] = 0.0;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>[band][shell2][shell1] = 0.0;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign shell2 = 0; shell2 &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>; shell2++ )</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                <span class="comment">//==================================== Compute each values only once</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                <span class="keywordflow">if</span> ( shell1 &gt; shell2 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                <span class="comment">//==================================== Check if band exists for this shell2?</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <span class="keywordflow">if</span> ( !<a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#a6e15740000a0079151a2d24dbbdebb2e">ProSHADE_internal_distances::isBandWithinShell</a> ( band, shell2, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a> ) )</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>[band][shell1][shell2] = 0.0;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>[band][shell2][shell1] = 0.0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <span class="comment">//==================================== Initialise</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                descValR                              = 0.0;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                <span class="comment">//==================================== Sum over order (m)</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign order = 0; order &lt; static_cast&lt; proshade_unsign &gt;  ( ( 2 * band ) + 1 ); order++ )</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                    arrPos1                           = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( seanindex ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( order ) - <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( band ),</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                                                                                   <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( band ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[shell1]-&gt;getLocalBandwidth() ) ) );</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                    arrPos2                           = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( seanindex ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( order ) - <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( band ),</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                                                                                   <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( band ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[shell2]-&gt;getLocalBandwidth() ) ) );</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                    descValR                         += <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#abc59a55f5ed21de90e351005c58a871e">ProSHADE_internal_maths::complexMultiplicationConjugRealOnly</a> ( &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>[shell1][arrPos1][0],</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                                                                                                       &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>[shell1][arrPos1][1],</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                                                                                                       &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>[shell2][arrPos2][0],</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                                                                                                       &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>[shell2][arrPos2][1]  );</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <span class="comment">//==================================== Save the matrices</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>[band][shell1][shell2] = descValR;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>[band][shell2][shell1] = descValR;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, <span class="stringliteral">&quot;RRP matrices successfully computed.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    return ;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a23f9a5f8f6fb7cf0f0324bc1d83d6090"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23f9a5f8f6fb7cf0f0324bc1d83d6090">&#9670;&nbsp;</a></span>computeSphericalHarmonics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::computeSphericalHarmonics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the spherical harmonics decomposition for the whole structure. </p>
<p>This function is called to compute the spherical harmonics decomposition of the mapped data on every available sphere. This is done sphere-wise and there is some sub-optimal memory management stemming from different shells having different resolutions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map manipulation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01847">1847</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;{</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting spherical harmonics decomposition.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    </div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="comment">//================================================ Initialise memory</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>                          = <span class="keyword">new</span> proshade_complex* [this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>];</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>; iter++ )</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    {</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>[iter]                = <span class="keyword">new</span> proshade_complex [(this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[iter]-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#a331955e5674dd112f83402375dce7bc5">getLocalBandwidth</a>() * 2) * (this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[iter]-&gt;getLocalBandwidth() * 2)];</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>[iter], __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    }</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    </div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="comment">//================================================ Compute the spherical harmonics</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>; iter++ )</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    {</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        ss &lt;&lt; <span class="stringliteral">&quot;Now decomposing sphere &quot;</span> &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot;. &quot;</span> &lt;&lt; <span class="stringliteral">&quot;( Band is: &quot;</span> &lt;&lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[iter]-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#a331955e5674dd112f83402375dce7bc5">getLocalBandwidth</a>() &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>;</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, ss.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        </div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        <span class="comment">//============================================ Compute</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__spherical_harmonics.html#a3fa7caeb0d21183a39d7cca2d889c437">ProSHADE_internal_sphericalHarmonics::computeSphericalHarmonics</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[iter]-&gt;getLocalBandwidth(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[iter]-&gt;getMappedData(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>[iter] );</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    }</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    </div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Spherical harmonics decomposition complete.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    </div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    return ;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a767640acbf4999201ce9ea86d76ff6a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a767640acbf4999201ce9ea86d76ff6a1">&#9670;&nbsp;</a></span>computeTranslationMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::computeTranslationMap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>staticStructure</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function does the computation of the translation map and saves results internally. </p>
<p>This function takes the static structure, the optimal translation to which should be found and then it proceeds to compute the Fourier transform of both this and the static structures. It then combines the coefficients for translation function and computes the inverse Fourier transform, thus obtaining the translation function. This function is then saved, while all other internal data are deleted.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">staticStructure</td><td>A pointer to the data class object of the other ( static ) structure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00324">324</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;{</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">//================================================ Do this using Fourier!</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    fftw_complex *tmpIn1 = <span class="keyword">nullptr</span>, *tmpOut1 = <span class="keyword">nullptr</span>, *tmpIn2 = <span class="keyword">nullptr</span>, *tmpOut2 = <span class="keyword">nullptr</span>, *resOut = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    fftw_plan forwardFourierObj1, forwardFourierObj2, inverseFourierCombo;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    proshade_unsign dimMult                           = staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">getXDim</a>() * staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">getYDim</a>() * staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">getZDim</a>();</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a5f5eacf55d707e1d80d3df360fc0fe91">ProSHADE_internal_overlay::allocateTranslationFunctionMemory</a> ( tmpIn1, tmpOut1, tmpIn2, tmpOut2, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37f26ac4bc76e4f4c5da77dd0eace56e">translationMap</a>, resOut, forwardFourierObj1, forwardFourierObj2, inverseFourierCombo, staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">getXDim</a>(), staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">getYDim</a>(), staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">getZDim</a>() );</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">//================================================ Fill in input data</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; dimMult; iter++ ) { tmpIn1[iter][0] = staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afe04510c67e9dc9c19efaef8463b6e6e">getMapValue</a> ( iter ); tmpIn1[iter][1] = 0.0; }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; dimMult; iter++ ) { tmpIn2[iter][0] = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afe04510c67e9dc9c19efaef8463b6e6e">getMapValue</a>            ( iter ); tmpIn2[iter][1] = 0.0; }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">//================================================ Calculate Fourier</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    fftw_execute                                      ( forwardFourierObj1 );</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    fftw_execute                                      ( forwardFourierObj2 );</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">//================================================ Combine Fourier coeffs and invert</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a64ba4ba55d58078eeea8b70311e4ab49">ProSHADE_internal_maths::combineFourierForTranslation</a> ( tmpOut1, tmpOut2, resOut, staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">getXDim</a>(), staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">getYDim</a>(), staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">getZDim</a>() );</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    fftw_execute                                      ( inverseFourierCombo );</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">//================================================ Free memory</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a448b6438ea9979e18af75f419f175603">ProSHADE_internal_overlay::freeTranslationFunctionMemory</a> ( tmpIn1, tmpOut1, tmpIn2, tmpOut2, resOut, forwardFourierObj1, forwardFourierObj2, inverseFourierCombo );</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    return ;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad96cd7a72fc56e7d97cfeff1086faad9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad96cd7a72fc56e7d97cfeff1086faad9">&#9670;&nbsp;</a></span>convertRotationFunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::convertRotationFunction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function converts the self-rotation function of this structure to angle-axis representation. </p>
<p>This function creates a set of concentric spheres in a spherical co-ordinates space, where the radius is the angle-axis representation angle and the lattitude and longitude angles are the angle-axis representation axis vector. I.e. each of the spheres contains all angle-axis representation axes for a single given angle.</p>
<p>Then, it proceeds to interpolate the rotation function for each point in this space, thus effectivelly re-sampling the rotation function onto the required space.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map self-rotation function computation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00121">121</a> of file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;{</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting self-rotation function conversion to angle-axis representation.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    proshade_double shellSpacing                      = ( 2.0 * M_PI ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> ) * 2.0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    std::vector&lt; proshade_double &gt; allPeakHeights;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">//================================================ Initialise the spheres</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign spIt = 1; spIt &lt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> * 2 ); spIt++ )</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        this-&gt;sphereMappedRotFun.emplace_back         ( <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a>( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( spIt ) * shellSpacing,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                                                                                                               shellSpacing,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                                                                                               this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> * 2,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                                                                                               <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( spIt ) * shellSpacing,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                                                                                               spIt - 1 ) );</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">//================================================ Interpolate the rotation function onto the spheres</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign shIt = 0; shIt &lt; static_cast&lt;proshade_unsign&gt; ( sphereMappedRotFun.size() ); shIt++ )</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        std::stringstream hlpSS;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;Interpolating sphere &quot;</span> &lt;&lt; shIt &lt;&lt; <span class="stringliteral">&quot; ( radius: &quot;</span> &lt;&lt; this-&gt;sphereMappedRotFun.at(shIt)-&gt;getRadius() &lt;&lt; <span class="stringliteral">&quot; ).&quot;</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, hlpSS.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">//============================================ Interpolate onto spheres</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        this-&gt;sphereMappedRotFun.at(shIt)-&gt;interpolateSphereValues ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">getInvSO3Coeffs</a> ( ) );</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Self-rotation function converted to spherical angle-axis space.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Started peak detection on the angle-axis spheres.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">//================================================ Find all peaks in the sphere grids</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign shIt = 0; shIt &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;sphereMappedRotFun.size() ); shIt++ )</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        this-&gt;sphereMappedRotFun.at(shIt)-&gt;findAllPeaks  ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a26b57d39529ca69a117aceead6b12680">peakNeighbours</a> ), &amp;allPeakHeights );</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot;Detected &quot;</span> &lt;&lt; allPeakHeights.size() &lt;&lt; <span class="stringliteral">&quot; peaks with any height.&quot;</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, hlpSS.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">//================================================ Compute threshold for small peaks</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    proshade_double peakThres                         = std::max ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a>, <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#af62700fc94d2901ec61928d01773ea57">determinePeakThreshold</a> ( allPeakHeights, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3e7948fd9177bd39ed3dd2320ea2b0bc">noIQRsFromMedianNaivePeak</a> ) );</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    std::stringstream hlpSS2;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    hlpSS2 &lt;&lt; <span class="stringliteral">&quot;From these peaks, decided the threshold will be &quot;</span> &lt;&lt; peakThres &lt;&lt; <span class="stringliteral">&quot; peak height.&quot;</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, hlpSS2.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">//================================================ Remove too small peaks</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign shIt = 0; shIt &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;sphereMappedRotFun.size() ); shIt++ )</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        this-&gt;sphereMappedRotFun.at(shIt)-&gt;removeSmallPeaks  ( peakThres );</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, <span class="stringliteral">&quot;Peaks detected for all spheres.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    return ;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3349a7f6ffecc3ffd4e09192eb919248"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3349a7f6ffecc3ffd4e09192eb919248">&#9670;&nbsp;</a></span>createNewMapFromBounds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::createNewMapFromBounds </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_data</a> *&amp;&#160;</td>
          <td class="paramname"><em>newStr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>newBounds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function creates a new structure from the calling structure and new bounds values. </p>
<p>This function takes a pointer to uninitialised structure and fills it with the calling structure values adjusted for the new bounds. If the bounds are the same, the two structures should be identical except the file (the new structure does not have an input file associated) and the type (no type for the new structure). It can deal with both larger and smaller bounds than the original values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for reading in the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">newStr</td><td>A pointer reference to a new structure class which has all the same values except for the new bounds and adequately changed map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">newBounds</td><td>A pointer to proshade_signed array of 6 storing the results - (0 = minX; 1 = maxX; 2 = minY; 3 = maxY; 4 - minZ; 5 = maxZ). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01374">1374</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;{</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Creating new structure according to the new  bounds.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="comment">//================================================ Fill in basic info</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    newStr-&gt;fileName                                  = <span class="stringliteral">&quot;N/A&quot;</span>;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    newStr-&gt;fileType                                  = ProSHADE_internal_io::MAP;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="comment">//================================================ Fill in new structure values</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    newStr-&gt;xDimIndices                               = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( newBounds[1] ) - <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( newBounds[0] ) + 1;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    newStr-&gt;yDimIndices                               = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( newBounds[3] ) - <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( newBounds[2] ) + 1;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    newStr-&gt;zDimIndices                               = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( newBounds[5] ) - <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( newBounds[4] ) + 1;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    newStr-&gt;aAngle                                    = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">aAngle</a>;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    newStr-&gt;bAngle                                    = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">aAngle</a>;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    newStr-&gt;cAngle                                    = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">aAngle</a>;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;            </div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    newStr-&gt;xDimSize                                  = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( newStr-&gt;xDimIndices ) * ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a> / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ) );</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    newStr-&gt;yDimSize                                  = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( newStr-&gt;yDimIndices ) * ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a> / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) );</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    newStr-&gt;zDimSize                                  = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( newStr-&gt;zDimIndices ) * ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) );</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            </div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    newStr-&gt;xGridIndices                              = newStr-&gt;xDimIndices;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    newStr-&gt;yGridIndices                              = newStr-&gt;yDimIndices;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    newStr-&gt;zGridIndices                              = newStr-&gt;zDimIndices;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            </div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    newStr-&gt;xAxisOrder                                = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">xAxisOrder</a>;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    newStr-&gt;yAxisOrder                                = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">yAxisOrder</a>;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    newStr-&gt;zAxisOrder                                = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">zAxisOrder</a>;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;            </div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    newStr-&gt;xAxisOrigin                               = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a> + newBounds[0];</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    newStr-&gt;yAxisOrigin                               = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a> + newBounds[2];</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    newStr-&gt;zAxisOrigin                               = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a> + newBounds[4];</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;            </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    newStr-&gt;xFrom                                     = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> + newBounds[0];</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    newStr-&gt;yFrom                                     = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> + newBounds[2];</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    newStr-&gt;zFrom                                     = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> + newBounds[4];</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    newStr-&gt;xTo                                       = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a> - ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> - 1 ) - newBounds[1] );</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    newStr-&gt;yTo                                       = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a> - ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> - 1 ) - newBounds[3] );</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    newStr-&gt;zTo                                       = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a> - ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> - 1 ) - newBounds[5] );</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    </div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="comment">//================================================ Allocate new structure map</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    newStr-&gt;internalMap                               = <span class="keyword">new</span> proshade_double[newStr-&gt;xDimIndices * newStr-&gt;yDimIndices * newStr-&gt;zDimIndices];</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( newStr-&gt;internalMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <span class="comment">//================================================ Copy the map</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aa373379d6fa4ebebb0f62e66384186e1">ProSHADE_internal_mapManip::copyMapByBounds</a>       ( newStr-&gt;xFrom, newStr-&gt;xTo, newStr-&gt;yFrom, newStr-&gt;yTo, newStr-&gt;zFrom, newStr-&gt;zTo,</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                                                        this-&gt;xFrom, this-&gt;yFrom, this-&gt;zFrom, newStr-&gt;yDimIndices, newStr-&gt;zDimIndices,</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                                                        this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, newStr-&gt;internalMap, this-&gt;internalMap );</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;New structure created.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    return ;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3fbad5b8628112ace798950e6068bd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3fbad5b8628112ace798950e6068bd4">&#9670;&nbsp;</a></span>deepCopyMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::deepCopyMap </td>
          <td>(</td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>saveTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function copies the internal map into the supplied pointer, which it also allocates. </p>
<p>This function is provided so that the user can provide a pointer and have it allocated and filled with the map values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">saveTo</td><td>A pointer where the internal map should be deep copied into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbose</td><td>How loud the run should be? </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03447">3447</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;{</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;    <span class="keywordflow">if</span> ( saveTo != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;    {</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( verbose, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! The deep copy pointer is not set to NULL. Cannot proceed and returning unmodified pointer.&quot;</span>, <span class="stringliteral">&quot;WB00040&quot;</span> );</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;        return ;</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;    }</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;    </div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;    <span class="comment">//================================================ Allocate the memory</span></div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;    saveTo                                            = <span class="keyword">new</span> proshade_double[this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;    </div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;    <span class="comment">//================================================ Check memory allocation</span></div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( saveTo, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;    </div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;    <span class="comment">//================================================ Copy internal map to the new pointer</span></div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ )</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;    {</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;        saveTo[iter]                                  = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter];</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;    }</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;    </div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;    return ;</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;    </div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abcf770f9177a4d2f1a94a3adb20bf790"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcf770f9177a4d2f1a94a3adb20bf790">&#9670;&nbsp;</a></span>detectSymmetryFromAngleAxisSpace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::detectSymmetryFromAngleAxisSpace </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>axes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *&#160;</td>
          <td class="paramname"><em>allCs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function runs the symmetry detection algorithms on this structure using the angle-axis space and saving the results in the settings object. </p>
<p>This function firstly decides whether specific C symmetry was requested or not. This decision is important as knowing the required fold allows for a rather simplified algorithm to be applied. Thus, if specific fold is known, simplified algorithm will be used. Otherwise, this function will do a general search by firstly finding all cyclic point groups and then applying the dihedral, tetrahedral, octahedral and icosahedral searches.</p>
<p>Once complete, the function will save both, the vector of ProSHADE formatted array pointers as well as vector of vectors of doubles with the same information containing all detected cyclic point groups into the supplied vector pointers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axes</td><td>A vector to which all the axes of the recommended symmetry (if any) will be saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allCs</td><td>A vector to which all the detected cyclic symmetries will be saved into. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01907">1907</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;{</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="comment">//================================================ Modify axis tolerance and matrix tolerance by sampling, if required by user</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;axisErrToleranceDefault )</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    {</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>                    = std::min ( std::max ( 0.01, ( ( 2.0 * M_PI ) / <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> ) ) / 2.0 ), 0.05 );</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    }</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    </div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="comment">//================================================ Prepare FSC computation memory and variables</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    fftw_complex *mapData, *origCoeffs, *fCoeffs;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    fftw_plan planForwardFourier;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    proshade_double **bindata, *fscByBin;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    proshade_signed *binIndexing, *binCounts, noBins;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#acf2c2c9634a9e641270f8889624c3752">prepareFSCFourierMemory</a>                     ( mapData, origCoeffs, fCoeffs, binIndexing, &amp;noBins, bindata, binCounts, &amp;planForwardFourier, fscByBin );</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    </div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    <span class="comment">//================================================  If C was requested, we will do it immediately - this allows for a significant speed-up.</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;C&quot;</span> )</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    {</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        std::stringstream hlpSS;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;Starting detection of cyclic point group C&quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6dc170d9826bad9ce4a2c31a033f7f6a">requestedSymmetryFold</a>;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, hlpSS.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        </div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        <span class="comment">//============================================ Do simplified search only in the applicable data</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        proshade_double symThres                      = 0.0;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        std::vector&lt; proshade_double* &gt; CSyms         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2714fcb2c08b224ccf09d64322bd2ab2">findRequestedCSymmetryFromAngleAxis</a> ( settings, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6dc170d9826bad9ce4a2c31a033f7f6a">requestedSymmetryFold</a>, &amp;symThres );</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        </div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        <span class="comment">//============================================ Deal with the rotation function 0 1 0 PI issue</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        <span class="keywordtype">bool</span> possible010PIIssue                       = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; CSyms.size(); iter++ ) { <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2380a3710f7dbe672519c3adda30f7cd">ProSHADE_internal_maths::isAxisUnique</a> ( &amp;CSyms, 0.0, 1.0, 0.0, 2.0, 0.1 ) ) { possible010PIIssue = <span class="keyword">true</span>; } }</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="keywordflow">if</span> ( possible010PIIssue )</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        {</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;            proshade_double* addAxis                  = <span class="keyword">new</span> proshade_double[7];</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;            addAxis[0] = 2.0; addAxis[1] = 0.0; addAxis[2] = 1.0; addAxis[3] = 0.0; addAxis[4] = M_PI; addAxis[5] = -999.9; addAxis[6] = -std::numeric_limits &lt; proshade_double &gt;::infinity();</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( &amp;CSyms, addAxis );</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;            <span class="keyword">delete</span>[] addAxis;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        }</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        </div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        <span class="comment">//============================================ Compute FSC for all possible axes</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> cIt = 0; cIt &lt; CSyms.size(); cIt++ ) { <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs ( CSyms.at(cIt)[5] ), rhs ( -999.9 ); <span class="keywordflow">if</span> ( ( CSyms.at(cIt)[5] &gt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a> ) || ( lhs.AlmostEquals ( rhs ) ) ) { this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">computeFSC</a> ( settings, &amp;CSyms, cIt, mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin ); } }</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        </div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        <span class="comment">//============================================ Sort by FSC</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        std::sort                                     ( CSyms.begin(), CSyms.end(), <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#ae2a2bd26e2e081130593c7783c54f293">sortProSHADESymmetryByFSC</a> );</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        </div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <span class="comment">//============================================ Save the best axis as the recommended one</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { <span class="keywordflow">if</span> ( CSyms.size() &gt; 0 ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSyms.at(0) ); } }</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        <span class="keywordflow">if</span> ( CSyms.size() &gt; 0 )</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        {</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;            <span class="keywordtype">bool</span> passedTests                          = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> cIt = 0; cIt &lt; CSyms.size(); cIt++ )</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;            {</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                <span class="keywordflow">if</span> ( CSyms.at(0)[6] &gt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> )</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                {</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                    settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>  ( <span class="stringliteral">&quot;C&quot;</span> );</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;                    settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>      ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6dc170d9826bad9ce4a2c31a033f7f6a">requestedSymmetryFold</a> );</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                    </div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSyms.at(0) );</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0b0608e80f20087b24cc9498767f0894">saveDetectedSymmetries</a>      ( settings, &amp;CSyms, allCs );</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                    </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;                    passedTests                       = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                }</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;            }</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;            </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;            <span class="keywordflow">if</span> ( !passedTests )</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;            {</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>      ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>          ( 0 );</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;            }</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        }</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        {</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>          ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>              ( 0 );</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        }</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <span class="comment">//============================================ Release memory after FSC computation</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        <span class="keyword">delete</span>[] mapData;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        <span class="keyword">delete</span>[] origCoeffs;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        <span class="keyword">delete</span>[] fCoeffs;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        fftw_destroy_plan                             ( planForwardFourier );</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        <span class="keyword">delete</span>[] binIndexing;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> binIt = 0; binIt &lt; static_cast&lt; size_t &gt; ( noBins ); binIt++ ) { <span class="keyword">delete</span>[] bindata[binIt]; }</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        <span class="keyword">delete</span>[] bindata;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        <span class="keyword">delete</span>[] binCounts;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        <span class="keyword">delete</span>[] fscByBin;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        </div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        <span class="comment">//============================================ Done</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        return ;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    }</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting C symmetry detection.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160; </div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <span class="comment">//================================================ Detect cyclic symmetries</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    std::vector&lt; proshade_double* &gt; CSyms             = <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa3b1a8ef870a606035102b5dcf1ce44">getCyclicSymmetriesListFromAngleAxis</a> ( settings );</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    </div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;Detected &quot;</span> &lt;&lt; CSyms.size() &lt;&lt; <span class="stringliteral">&quot; C symmetries.&quot;</span>;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, ss.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    </div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    <span class="comment">//================================================ Sanity check - was the rotation function mapped properly?</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;sphereMappedRotFun.size() &lt; 1 )</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    {</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Rotation function was not converted into angle-axis space.&quot;</span>, <span class="stringliteral">&quot;ES00062&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;It seems that the convertRotationFunction() function was\n                    : not yet called. Therefore, there are no data to detect the\n                    : symmetry from; please call the convertRotationFunction()\n                    : function before the detectSymmetryFromAngleAxisSpace()\n                    : function.&quot;</span> );</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    }</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    </div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="comment">//================================================ If only C syms were requested (e.g. rotation centre detection), terminate here!</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;onlyC&quot;</span> )</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    {</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        <span class="comment">//============================================ Prepare threshold</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        proshade_double bestHistPeakStart             = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a26fa82e82a6a4af696cfae0581785446">ProSHADE_internal_maths::findTopGroupSmooth</a> ( &amp;CSyms, 5, 0.01, 0.03, 9 );</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        <span class="keywordflow">if</span> ( bestHistPeakStart &gt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a> ) { bestHistPeakStart = settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a>; }</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;        </div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;        <span class="comment">//============================================ Find FSCs for C syms</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> cIt = 0; cIt &lt; CSyms.size(); cIt++ )</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        {</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;            <span class="comment">//======================================== Check the peak height</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;            <span class="keywordflow">if</span> ( CSyms.at(cIt)[5]  &lt; bestHistPeakStart ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;            </div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;            <span class="comment">//======================================== Stop at some point - it is unlikely the true axis would be this far.</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;            <span class="keywordflow">if</span> ( cIt &gt; 15 ) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;            </div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;            <span class="comment">//======================================== Compute FSC</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;            this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">computeFSC</a>                          ( settings, &amp;CSyms, cIt, mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin );</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        }</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160; </div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        <span class="comment">//============================================ Save the detected Cs</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0b0608e80f20087b24cc9498767f0894">saveDetectedSymmetries</a>                  ( settings, &amp;CSyms, allCs );</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;        <span class="comment">//============================================ Done</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    }</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    </div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="comment">//================================================ Sanity check - was any symmetry requested?</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="keywordflow">if</span> ( ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;C&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;D&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;T&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;O&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;I&quot;</span> ) )</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    {</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Requested symmetry supplied, but not recognised.&quot;</span>, <span class="stringliteral">&quot;ES00032&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;There are only the following value allowed for the\n                    : symmetry type request: \&quot;C\&quot;, \&quot;D\&quot;, \&quot;T\&quot;, \&quot;O\&quot; and \&quot;I\&quot;. Any\n                    : other value will result in this error.&quot;</span> );</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    }</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    </div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="comment">//================================================ Are we doing general search?</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;&quot;</span> )</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    {</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        <span class="comment">//============================================ Run the symmetry detection functions for C, D, T, O and I symmetries</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        std::vector&lt; proshade_double* &gt; DSyms         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1fdc5b9df47ff8de3a5f2f6e6ce233a5">getDihedralSymmetriesList</a> ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;        std::vector&lt; proshade_double* &gt; ISyms;</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        std::vector &lt; std::vector&lt; proshade_double* &gt; &gt; ISymsHlp = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad9a02d8d68aac021572b764651aad0f1">getPredictedIcosahedralSymmetriesList</a> ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;        std::vector&lt; proshade_double* &gt; OSyms         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae97b54a34689c1dceae47a5e8e94bbb0">getPredictedOctahedralSymmetriesList</a> ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;        std::vector&lt; proshade_double* &gt; TSyms         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a931aa4c10c426c3b8041bd4e838b0678">getPredictedTetrahedralSymmetriesList</a> ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;        </div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        <span class="comment">//============================================ Find which of the I groups is the correct one</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;        proshade_double fscMax                        = 0.0;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        <span class="keywordtype">size_t</span> fscMaxInd                              = 0;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        </div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> icoIt = 0; icoIt &lt; ISymsHlp.size(); icoIt++ )</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        {</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;            <span class="comment">//======================================== Is this a complete icosahedron?</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;            <span class="keywordflow">if</span> ( ISymsHlp.at(icoIt).size() != 31 )    { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;            </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;            <span class="comment">//======================================== Initialise decision vars</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;            proshade_double fscVal                    = 0.0;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;            proshade_double fscValAvg                 = 0.0;</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;            </div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;            <span class="comment">//======================================== For each axis</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> aIt = 0; aIt &lt; ISymsHlp.at(icoIt).size(); aIt++ )</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;            {</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                <span class="comment">//==================================== Match to CSyms</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                proshade_signed matchedPos            = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( ISymsHlp.at(icoIt).at(aIt)[0] ), ISymsHlp.at(icoIt).at(aIt)[1], ISymsHlp.at(icoIt).at(aIt)[2], ISymsHlp.at(icoIt).at(aIt)[3], ISymsHlp.at(icoIt).at(aIt)[5], ISymsHlp.at(icoIt).at(aIt)[6], &amp;CSyms, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a> );</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                </div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                <span class="comment">//==================================== Compute FSC</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                fscVal                                = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">computeFSC</a> ( settings, &amp;CSyms, <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( matchedPos ), mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin );</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                ISymsHlp.at(fscMaxInd).at(aIt)[6]     = fscVal;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                fscValAvg                            += fscVal;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;            }</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;            </div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;            <span class="comment">//======================================== Get FSC average over all axes</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;            fscValAvg                                /= 31.0;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;            </div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;            <span class="comment">//======================================== Is this the best</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            <span class="keywordflow">if</span> ( fscValAvg &gt; fscMax )</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;            {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                fscMax                                = fscValAvg;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                fscMaxInd                             = icoIt;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;            }</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;            </div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;            <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3d484590819881311b611ab08c2ce9b0">fastISearch</a> ) { fscMaxInd = 0; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        }</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        </div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        <span class="comment">//============================================ If C3 and C5 are found and have correct angle (must have if they are both in ISym)</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        <span class="keywordflow">if</span> ( fscMax &gt;= settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> )</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;        {</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;            <span class="comment">//======================================== Add predicted axes to detected C axes list and also to the settings Icosahedral symmetry list</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign retIt = 0; retIt &lt; static_cast &lt; proshade_unsign &gt; ( ISymsHlp.at(fscMaxInd).size() ); retIt++ )</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;            {</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;                <span class="comment">//==================================== Add the correct index to the settings object</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                proshade_signed matchedPos            = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( ISymsHlp.at(fscMaxInd).at(retIt)[0] ), ISymsHlp.at(fscMaxInd).at(retIt)[1], ISymsHlp.at(fscMaxInd).at(retIt)[2], ISymsHlp.at(fscMaxInd).at(retIt)[3], ISymsHlp.at(fscMaxInd).at(retIt)[5], ISymsHlp.at(fscMaxInd).at(retIt)[6], &amp;CSyms, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a> );</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>, <span class="keyword">static_cast &lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( matchedPos ) );</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                </div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                <span class="comment">//==================================== Set ISyms for saving</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( &amp;ISyms, ISymsHlp.at(fscMaxInd).at(retIt) );</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;            }</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;        }</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        </div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        <span class="comment">//============================================ Decide on recommended symmetry</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad9b0fec5092eed1ab485443c15289e14">saveRecommendedSymmetry</a>                 ( settings, &amp;CSyms, &amp;DSyms, &amp;TSyms, &amp;OSyms, &amp;ISyms, axes, mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin );</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    }</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    </div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;D&quot;</span> )</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    {</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;        <span class="comment">//============================================ Run only the D symmetry detection and search for requested fold</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        std::vector&lt; proshade_double* &gt; DSyms         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1fdc5b9df47ff8de3a5f2f6e6ce233a5">getDihedralSymmetriesList</a> ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa200af7e84ec7a17ecfd54a45a8ffafe">saveRequestedSymmetryD</a>                  ( settings, &amp;DSyms, axes, mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin );</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    }</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    </div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;T&quot;</span> )</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    {</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;        <span class="comment">//============================================ Run only the T symmetry detection</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;        std::vector&lt; proshade_double* &gt; TSyms         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a931aa4c10c426c3b8041bd4e838b0678">getPredictedTetrahedralSymmetriesList</a> ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        <span class="keywordflow">if</span> ( TSyms.size() == 7 )</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;        {</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;            <span class="comment">//======================================== Initialise decision vars</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;            proshade_double fscVal                    = 0.0;</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;            proshade_double fscValAvg                 = 0.0;</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;            </div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            <span class="comment">//======================================== Check if axes have high enough FSC and peak height</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> tIt = 0; tIt &lt; 7; tIt++ ) { <span class="keywordflow">if</span> ( CSyms.at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at(tIt))[5] &gt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a> ) { fscVal = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">computeFSC</a> ( settings, &amp;CSyms, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at(tIt), mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin ); fscValAvg += fscVal; } }</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;            fscValAvg                                /= 7.0;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;            </div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;            <span class="comment">//======================================== If C3 and C5 are found and have correct angle (must have if they are both in ISym)</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;            <span class="keywordflow">if</span> ( fscValAvg &gt;= ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> ) )</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;            {</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                <span class="comment">//==================================== The decision is T</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>      ( <span class="stringliteral">&quot;T&quot;</span> );</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>          ( 0 );</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.size() ); it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSyms.at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at(it)) ); }</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSyms.at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at(it)) ); } }</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;            }</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;        }</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    }</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    </div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;O&quot;</span> )</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    {</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;        <span class="comment">//============================================ Run only the O symmetry detection</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        std::vector&lt; proshade_double* &gt; OSyms         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae97b54a34689c1dceae47a5e8e94bbb0">getPredictedOctahedralSymmetriesList</a> ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;        </div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;        <span class="keywordflow">if</span> ( OSyms.size() == 13 )</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;        {</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;            <span class="comment">//======================================== Initialise decision vars</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;            proshade_double fscVal                    = 0.0;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;            proshade_double fscValAvg                 = 0.0;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;            </div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;            <span class="comment">//======================================== Check if at least one C5 and one C3 with the correct angle have high FSC and peak height</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> oIt = 0; oIt &lt; 13; oIt++ ) { <span class="keywordflow">if</span> ( CSyms.at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at(oIt))[5] &gt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a> ) { fscVal = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">computeFSC</a> ( settings, &amp;CSyms, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at(oIt), mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin ); fscValAvg += fscVal; } }</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;            fscValAvg                                /= 13.0;</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;            </div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;            <span class="comment">//======================================== If C3 and C5 are found and have correct angle (must have if they are both in ISym)</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;            <span class="keywordflow">if</span> ( fscValAvg &gt;= ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> ) )</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;            {</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                <span class="comment">//==================================== The decision is O</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>      ( <span class="stringliteral">&quot;O&quot;</span> );</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>          ( 0 );</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.size() ); it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSyms.at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at(it)) ); }</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSyms.at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at(it)) ); } }</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;            }</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;        }</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    }</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    </div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;I&quot;</span> )</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    {</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;        <span class="comment">//============================================ Find which of the I groups is the correct one</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;        proshade_double fscMax                        = 0.0;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;        <span class="keywordtype">size_t</span> fscMaxInd                              = 0;</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        std::vector &lt; std::vector&lt; proshade_double* &gt; &gt; ISymsHlp = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad9a02d8d68aac021572b764651aad0f1">getPredictedIcosahedralSymmetriesList</a> ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;        std::vector&lt; proshade_double* &gt; ISyms;</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        </div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> icoIt = 0; icoIt &lt; ISymsHlp.size(); icoIt++ )</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;        {</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;            <span class="comment">//======================================== Is this a complete icosahedron?</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;            <span class="keywordflow">if</span> ( ISymsHlp.at(icoIt).size() != 31 )    { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;            </div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;            <span class="comment">//======================================== Initialise decision vars</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;            proshade_double fscVal                    = 0.0;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;            proshade_double fscValAvg                 = 0.0;</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            </div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;            <span class="comment">//======================================== For each axis</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> aIt = 0; aIt &lt; ISymsHlp.at(icoIt).size(); aIt++ )</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;            {</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                <span class="comment">//==================================== Match to CSyms</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                proshade_signed matchedPos            = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( ISymsHlp.at(icoIt).at(aIt)[0] ), ISymsHlp.at(icoIt).at(aIt)[1], ISymsHlp.at(icoIt).at(aIt)[2], ISymsHlp.at(icoIt).at(aIt)[3], ISymsHlp.at(icoIt).at(aIt)[5], ISymsHlp.at(icoIt).at(aIt)[6], &amp;CSyms, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a> );</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                </div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                <span class="comment">//==================================== Compute FSC</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                fscVal                                = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">computeFSC</a> ( settings, &amp;CSyms, <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( matchedPos ), mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin );</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                ISymsHlp.at(fscMaxInd).at(aIt)[6]     = fscVal;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                fscValAvg                            += fscVal;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;            }</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;            </div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;            <span class="comment">//======================================== Get FSC average over all axes</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;            fscValAvg                                /= 31.0;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;            </div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;            <span class="comment">//======================================== Is this the best</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;            <span class="keywordflow">if</span> ( fscValAvg &gt; fscMax )</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;            {</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                fscMax                                = fscValAvg;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                fscMaxInd                             = icoIt;</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            }</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        }</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        </div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;        <span class="comment">//============================================ If C3 and C5 are found and have correct angle (must have if they are both in ISym)</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        <span class="keywordflow">if</span> ( fscMax &gt;= ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> ) )</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        {</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;            <span class="comment">//======================================== Add predicted axes to detected C axes list and also to the settings Icosahedral symmetry list</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign retIt = 0; retIt &lt; static_cast &lt; proshade_unsign &gt; ( ISymsHlp.at(fscMaxInd).size() ); retIt++ )</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;            {</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                <span class="comment">//==================================== Add the correct index to the settings object</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                proshade_signed matchedPos            = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( ISymsHlp.at(fscMaxInd).at(retIt)[0] ), ISymsHlp.at(fscMaxInd).at(retIt)[1], ISymsHlp.at(fscMaxInd).at(retIt)[2], ISymsHlp.at(fscMaxInd).at(retIt)[3], ISymsHlp.at(fscMaxInd).at(retIt)[5], ISymsHlp.at(fscMaxInd).at(retIt)[6], &amp;CSyms, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a> );</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>, <span class="keyword">static_cast &lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( matchedPos ) );</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                </div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                <span class="comment">//==================================== Set ISyms for saving</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( &amp;ISyms, ISymsHlp.at(fscMaxInd).at(retIt) );</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;            }</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        }</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;        </div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;        <span class="comment">//============================================ Delete all memory from ISymsHlp</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> gIt = 0; gIt &lt; ISymsHlp.size(); gIt++ ) { <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> aIt = 0; aIt &lt; ISymsHlp.at(gIt).size(); aIt++ ) { <span class="keyword">delete</span>[] ISymsHlp.at(gIt).at(aIt); } }</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        </div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;        <span class="comment">//============================================ If C3 and C5 are found and have correct angle (must have if they are both in ISym)</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        <span class="keywordflow">if</span> ( fscMax &gt;= ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> * 0.7 ) )</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;        {</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;            <span class="comment">//======================================== The decision is I</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>          ( <span class="stringliteral">&quot;I&quot;</span> );</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>              ( 0 );</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> it = 0; it &lt; ISyms.size(); it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, ISyms.at(it) ); }</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSyms.at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.at(it)) ); } }</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        }</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    }</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    </div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    <span class="comment">//================================================ Save C symmetries to argument and if different from settings, to the settings as well</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0b0608e80f20087b24cc9498767f0894">saveDetectedSymmetries</a>                      ( settings, &amp;CSyms, allCs );</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    </div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    <span class="comment">//================================================ Release memory after FSC computation</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <span class="keyword">delete</span>[] mapData;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="keyword">delete</span>[] origCoeffs;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <span class="keyword">delete</span>[] fCoeffs;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    fftw_destroy_plan                                 ( planForwardFourier );</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="keyword">delete</span>[] binIndexing;</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> binIt = 0; binIt &lt; static_cast&lt; size_t &gt; ( noBins ); binIt++ ) { <span class="keyword">delete</span>[] bindata[binIt]; }</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="keyword">delete</span>[] bindata;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    <span class="keyword">delete</span>[] binCounts;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    </div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    return ;</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    </div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a476092aa08dff20d64a895e7b2227b2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a476092aa08dff20d64a895e7b2227b2e">&#9670;&nbsp;</a></span>figureIndexStartStop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::figureIndexStartStop </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function for determining iterator start and stop positions. </p>
<p>This function is called to set the xFrom, yFrom, ..., yTo and zTo iterator values for easier further calculations. It assumes that gemmi has read in the xFrom, yFrom and zFrom values already. </p>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l00870">870</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;{</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="comment">//================================================ Set ends to origin + size - 1</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>                                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ) - 1;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>                                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) - 1;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>                                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) - 1;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    return ;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac07955296611dd411cf5ed87ced90571"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac07955296611dd411cf5ed87ced90571">&#9670;&nbsp;</a></span>findMapCOM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::findMapCOM </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function finds the centre of mass of the internal map representation. </p>
<p>This function simply computes the centre of mass for the given <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> object map in the "real space" (i.e. the space that counts Angstroms from the bottom left further corner). These are then saved into the <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> object. </p>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03535">3535</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;{</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">xCom</a>                                        = 0.0;</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">yCom</a>                                        = 0.0;</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">zCom</a>                                        = 0.0;</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;    proshade_double totNonZeroPoints                  = 0.0;</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;    proshade_signed mapIt                             = 0;</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    </div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;    <span class="comment">//================================================ Compute COM from 0 ; 0 ; 0</span></div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed xIt = 0; xIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ); xIt++ )</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;    {</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed yIt = 0; yIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ); yIt++ )</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;        {</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed zIt = 0; zIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); zIt++ )</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;            {</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;                <span class="comment">//==================================== Find map index</span></div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;                mapIt                                 = zIt  + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( yIt  + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * xIt  );</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;                </div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;                <span class="comment">//==================================== Use only positive density</span></div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;                <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[mapIt] &lt;= 0.0 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;                </div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;                <span class="comment">//==================================== Compute Index COM</span></div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;                this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">xCom</a>                           += this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[mapIt] * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( xIt + this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> );</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;                this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">yCom</a>                           += this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[mapIt] * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( yIt + this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> );</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;                this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">zCom</a>                           += this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[mapIt] * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( zIt + this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> );</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;                totNonZeroPoints                     += this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[mapIt];</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;            }</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;        }</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;    }</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;    </div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">xCom</a>                                       /= totNonZeroPoints;</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">yCom</a>                                       /= totNonZeroPoints;</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">zCom</a>                                       /= totNonZeroPoints;</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;    </div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;    <span class="comment">//================================================ Convert to real world</span></div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">xCom</a>         = <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> ) * ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ae6821c27e7facf63839c9fc678c9c7">xDimSizeOriginal</a> / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9598e9a38546e3bf260bc09c0c9366a2">xDimIndicesOriginal</a> ) ) ) +</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;                                                        ( ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">xCom</a> ) - <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> ) ) *</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;                                                        ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ae6821c27e7facf63839c9fc678c9c7">xDimSizeOriginal</a> ) / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9598e9a38546e3bf260bc09c0c9366a2">xDimIndicesOriginal</a> ) ) ) );</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">yCom</a>         = <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> ) * ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7855424ca5d51853c7fc665ecb9b935b">yDimSizeOriginal</a> / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ef18126c2c24edc9b6be06e0591127f">yDimIndicesOriginal</a> ) ) ) +</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;                                                        ( ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">yCom</a> ) - <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> ) ) *</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;                                                        ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7855424ca5d51853c7fc665ecb9b935b">yDimSizeOriginal</a> ) / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ef18126c2c24edc9b6be06e0591127f">yDimIndicesOriginal</a> ) ) ) );</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">zCom</a>         = <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> ) * ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a530ad7e3396cbcbc1814051031070a8b">zDimSizeOriginal</a> / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ea6522b99cf1ac72199c9eeccd30742">zDimIndicesOriginal</a> ) ) ) +</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;                                                        ( ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">zCom</a> ) - <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> ) ) *</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;                                                        ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a530ad7e3396cbcbc1814051031070a8b">zDimSizeOriginal</a> ) / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ea6522b99cf1ac72199c9eeccd30742">zDimIndicesOriginal</a> ) ) ) );</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;    </div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    return ;</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;    </div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2714fcb2c08b224ccf09d64322bd2ab2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2714fcb2c08b224ccf09d64322bd2ab2">&#9670;&nbsp;</a></span>findRequestedCSymmetryFromAngleAxis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; proshade_double * &gt; ProSHADE_internal_data::ProSHADE_data::findRequestedCSymmetryFromAngleAxis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>fold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>peakThres</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function searches the angle-axis representation of the rotation function for a cyclic point group with given fold. </p>
<p>This function is a simplification of the <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa3b1a8ef870a606035102b5dcf1ce44" title="This function obtains a list of all C symmetries from the angle-axis space mapped rotation function v...">getCyclicSymmetriesListFromAngleAxis()</a> function, where this function does not map the whole rotation function, but rothar only to the spheres it knows it will required. Moreover, it does not search for all cyclic point groups, but only those which span all the spheres (angles) and therefore have the required fold.</p>
<p>In terms of operations, this function interpolates the rotation function values onto the spheres it requires, then it finds peaks and removes the small peaks, so that these can then be grouped. For each group which spans all the angles it then finds the index with highest sum of peak height over all spheres. It can then do the bi-cubic interpolation if requested. Finally, all the detected peaks are sorted by the peak height and returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td><a class="el" href="class_pro_s_h_a_d_e__settings.html" title="This class stores all the settings and is passed to the executive classes instead of a multitude of p...">ProSHADE_settings</a> object containing all the settings for this run. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fold</td><td>The fold which should be sought for by the function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">peakThres</td><td>The threshold used to cut peaks. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>Vector of double pointers to arrays having the standard ProSHADE symmetry group structure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02909">2909</a> of file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;{    </div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    proshade_double soughtAngle;</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    std::vector&lt; proshade_double  &gt; allPeakHeights;</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;    std::vector&lt; ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup* &gt; peakGroups;</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    <span class="keywordtype">bool</span> newPeak;</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;    </div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    <span class="comment">//================================================ Make sure we have a clean start</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    this-&gt;sphereMappedRotFun.clear();</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    </div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    <span class="comment">//================================================ Convert rotation function to only the required angle-axis space spheres and find all peaks</span></div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    <span class="keywordflow">for</span> ( proshade_double angIt = 1.0; angIt &lt; static_cast &lt; proshade_double &gt; ( fold ); angIt += 1.0 )</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    {</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;        <span class="comment">//============================================ Figure the angles to form the symmetry</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;        soughtAngle                                   = angIt * ( 2.0 * M_PI / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( fold ) );</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        </div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;        <span class="comment">//============================================ Create the angle-axis sphere with correct radius (angle)</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;        this-&gt;sphereMappedRotFun.emplace_back         ( <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a> ( soughtAngle,</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;                                                                                                                M_PI / <span class="keyword">static_cast &lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> ),</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;                                                                                                                this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> * 2,</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;                                                                                                                soughtAngle,</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;                                                                                                                <span class="keyword">static_cast &lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( angIt - 1.0 ) ) );</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;        </div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;        <span class="comment">//=========================================== Interpolate rotation function onto the sphere</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;        this-&gt;sphereMappedRotFun.at(<span class="keyword">static_cast &lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( angIt - 1.0 ))-&gt;interpolateSphereValues ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">getInvSO3Coeffs</a> ( ) );</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;        </div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;        <span class="comment">//============================================ Find all peaks for this sphere</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;        this-&gt;sphereMappedRotFun.at(<span class="keyword">static_cast &lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( angIt - 1.0 ))-&gt;findAllPeaks ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a26b57d39529ca69a117aceead6b12680">peakNeighbours</a> ), &amp;allPeakHeights );</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;    }</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;    </div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;    <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot;Found a total of &quot;</span> &lt;&lt; std::pow ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> ) * 2.0 * ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( fold ) - 1.0 ), 2.0 ) - <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( allPeakHeights.size() ) &lt;&lt; <span class="stringliteral">&quot; non-peaks for thresholding.&quot;</span>;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, hlpSS.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    </div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    <span class="comment">//================================================ Determine the threshold for significant peaks</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;   *peakThres                                         = std::min ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a>, <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#af62700fc94d2901ec61928d01773ea57">determinePeakThreshold</a> ( allPeakHeights, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3e7948fd9177bd39ed3dd2320ea2b0bc">noIQRsFromMedianNaivePeak</a> ) );</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;    </div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;    <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;    std::stringstream hlpSS2;</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;    hlpSS2 &lt;&lt; <span class="stringliteral">&quot;Determined peak threshold &quot;</span> &lt;&lt; *peakThres &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, hlpSS2.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    </div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;    <span class="comment">//================================================ Remove small peaks</span></div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign shIt = 0; shIt &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;sphereMappedRotFun.size() ); shIt++ )</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;    {</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;        this-&gt;sphereMappedRotFun.at(shIt)-&gt;removeSmallPeaks ( *peakThres );</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    }</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;    </div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;    <span class="comment">//================================================ Group peaks</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign sphIt = 0; sphIt &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;sphereMappedRotFun.size() ); sphIt++ )</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    {</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;        <span class="comment">//============================================ For each peak</span></div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign pkIt = 0; pkIt &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;sphereMappedRotFun.at(sphIt)-&gt;getPeaks().size() ); pkIt++ )</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;        {</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;            <span class="comment">//======================================== Check if peak belongs to an already detected peak group</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;            newPeak                                   = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign pkGrpIt = 0; pkGrpIt &lt; static_cast&lt;proshade_unsign&gt; ( peakGroups.size() ); pkGrpIt++ )</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;            {</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;                <span class="keywordflow">if</span> ( peakGroups.at(pkGrpIt)-&gt;checkIfPeakBelongs ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;sphereMappedRotFun.at(sphIt)-&gt;getPeaks().at(pkIt).first  ),</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;                                                                  <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;sphereMappedRotFun.at(sphIt)-&gt;getPeaks().at(pkIt).second ),</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;                                                                  sphIt, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> ) ) { newPeak = <span class="keyword">false</span>; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;            }</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;            </div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;            <span class="comment">//======================================== If already added, go to next one</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;            <span class="keywordflow">if</span> ( !newPeak ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;            </div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;            <span class="comment">//======================================== If not, create a new group with this peak</span></div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;            peakGroups.emplace_back                   ( <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup</a> ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;sphereMappedRotFun.at(sphIt)-&gt;getPeaks().at(pkIt).first ),</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;                                                                                                                         <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;sphereMappedRotFun.at(sphIt)-&gt;getPeaks().at(pkIt).second ),</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;                                                                                                                         sphIt,</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;                                                                                                                         this-&gt;sphereMappedRotFun.at(sphIt)-&gt;getAngularDim() ) );</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;        }</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;    }</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;    </div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;    <span class="comment">//================================================ For each peak group, look for the requested fold</span></div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( peakGroups.size() ); grIt++ )</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;    {</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;        std::stringstream hlpSS3;</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;        hlpSS3 &lt;&lt; <span class="stringliteral">&quot;Now considering group with LAT &quot;</span> &lt;&lt; peakGroups.at(grIt)-&gt;getLatFromIndices() &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; peakGroups.at(grIt)-&gt;getLatToIndices() &lt;&lt; <span class="stringliteral">&quot; and LON &quot;</span> &lt;&lt; peakGroups.at(grIt)-&gt;getLonFromIndices() &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; peakGroups.at(grIt)-&gt;getLonToIndices() &lt;&lt; <span class="stringliteral">&quot; spanning spheres &quot;</span>;</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign sphIt = 0; sphIt &lt; static_cast&lt;proshade_unsign&gt; ( peakGroups.at(grIt)-&gt;getSpherePositions().size() ); sphIt++ ) { hlpSS3 &lt;&lt; peakGroups.at(grIt)-&gt;getSpherePositions().at(sphIt) &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span>; }</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 5, hlpSS3.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;        </div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;        <span class="comment">//============================================ Find point groups in the peak group</span></div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;        peakGroups.at(grIt)-&gt;findCyclicPointGroupsGivenFold ( this-&gt;sphereMappedRotFun, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb183823a47a73d459a5bae16042bf4e">useBiCubicInterpolationOnPeaks</a>, fold, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160; </div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;        <span class="comment">//============================================ Release the memory</span></div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;        <span class="keyword">delete</span> peakGroups.at(grIt);</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    }</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    </div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;    <span class="comment">//================================================ Sort ret by peak height</span></div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    std::sort                                         ( ret.begin(), ret.end(), <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#afe2404666a504704a67e634c2abe186c">sortProSHADESymmetryByPeak</a> );</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    </div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    </div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2f2469c7d252c5e87d7bf9976b9b796"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2f2469c7d252c5e87d7bf9976b9b796">&#9670;&nbsp;</a></span>getAllGroupElements() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; ProSHADE_internal_data::ProSHADE_data::getAllGroupElements </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_unsign &gt;&#160;</td>
          <td class="paramname"><em>axesList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>groupType</em> = <code>&quot;&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>matrixTolerance</em> = <code>0.05</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the group elements as rotation matrices of any defined point group. </p>
<p>This function is essentially a wrapper for the overloaded version of this function. The purpose of this function is allow getting point group elements for axes detected in a particular structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axesList</td><td>A vector of ints specifying which C axes from the full list are members of the group. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">groupType</td><td>An optional string specifying for which symmetry type the group elements are to be computed. Leave empty if you want to use the supplied axes without any questions being asked. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">matrixTolerance</td><td>The maximum allowed trace difference for two matrices to still be considered the same. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">val</td><td>A vector containing a vector of 9 doubles (rotation matrix) for each group element for the requested group. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03151">3151</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;{</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;    std::vector&lt;std::vector&lt; proshade_double &gt; &gt; ret  = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae2f2469c7d252c5e87d7bf9976b9b796">getAllGroupElements</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>, axesList, groupType, matrixTolerance );</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;    </div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;    </div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afc06f274535401086eefad02fcc8ac10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc06f274535401086eefad02fcc8ac10">&#9670;&nbsp;</a></span>getAllGroupElements() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; ProSHADE_internal_data::ProSHADE_data::getAllGroupElements </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *&#160;</td>
          <td class="paramname"><em>allCs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_unsign &gt;&#160;</td>
          <td class="paramname"><em>axesList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>groupType</em> = <code>&quot;&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>matrixTolerance</em> = <code>0.05</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the group elements as rotation matrices of any defined point group. </p>
<p>This function generates a list of all point group elements for any group defined by a set of cyclic point groups. The set is supplied using the first parameter for a larger set and the second parameter for specifying a subset of the first parameter set.</p>
<p>This function can generate appropriate elementes for all ProSHADE supported point group types (i.e. C, D, T, O and I) as well as for any supplied set of cyclic point groups (use the groupType value of "X").</p>
<p>Please note that the final set of point group elements will be checked for being a point group, i.e. for the fact that a product of any two members will be another already present member. If this condition is not met, error will be thrown. This poses some issues when the point group axes are slightly off, as this can lead to the point group check failing...</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axesList</td><td>A vector of ints specifying which C axes from the full list are members of the group. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">groupType</td><td>An optional string specifying for which symmetry type the group elements are to be computed. Leave empty if you want to use the supplied axes without any questions being asked. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">matrixTolerance</td><td>The maximum allowed trace difference for two matrices to still be considered the same. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">val</td><td>A vector containing a vector of 9 doubles (rotation matrix) for each group element for the requested group. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03179">3179</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;{</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;    std::vector&lt;std::vector&lt; proshade_double &gt; &gt; ret;</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;    </div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    <span class="comment">//================================================ Select which symmetry type are we computing for</span></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;    <span class="keywordflow">if</span> ( groupType == <span class="stringliteral">&quot;C&quot;</span> )</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;    {</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;        <span class="comment">//============================================ Sanity check</span></div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;        <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">axesToGroupTypeSanityCheck</a>                    ( 1, <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( axesList.size() ), groupType );</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;        </div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;        <span class="comment">//============================================ Generate elements</span></div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;        ret                                           = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( allCs-&gt;at(axesList.at(0)).at(1),</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;                                                                                       allCs-&gt;at(axesList.at(0)).at(2),</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;                                                                                       allCs-&gt;at(axesList.at(0)).at(3),</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;                                                                                       <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( allCs-&gt;at(axesList.at(0)).at(0) ) );</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160; </div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;        <span class="comment">//============================================ Check the element to form a group</span></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a> ( &amp;ret, matrixTolerance ) ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;        {</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Computed point group elements do not form a group.&quot;</span>, <span class="stringliteral">&quot;ES00060&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied cyclic groups list does not form a group and\n                    : therefore such group&#39;s elements cannot be obtained. Please\n                    : check the cyclic groups list supplied to the\n                    : getAllGroupElements() function.&quot;</span> );</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;        }</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    }</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( groupType == <span class="stringliteral">&quot;D&quot;</span> )</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;    {</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;        <span class="comment">//============================================ Sanity check</span></div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;        <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">axesToGroupTypeSanityCheck</a>                    ( 2, <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( axesList.size() ), groupType );</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;        </div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;        <span class="comment">//============================================ Generate elements for both axes</span></div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;        std::vector&lt;std::vector&lt; proshade_double &gt; &gt; first  = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( allCs-&gt;at(axesList.at(0)).at(1),</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;                                                                                             allCs-&gt;at(axesList.at(0)).at(2),</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;                                                                                             allCs-&gt;at(axesList.at(0)).at(3),</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;                                                                                             <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( allCs-&gt;at(axesList.at(0)).at(0) ) );</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;        </div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;        std::vector&lt;std::vector&lt; proshade_double &gt; &gt; second = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( allCs-&gt;at(axesList.at(1)).at(1),</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;                                                                                             allCs-&gt;at(axesList.at(1)).at(2),</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;                                                                                             allCs-&gt;at(axesList.at(1)).at(3),</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;                                                                                             <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( allCs-&gt;at(axesList.at(1)).at(0) ) );</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;        </div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;        <span class="comment">//============================================ Join the element lists</span></div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;        ret                                           = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;first, &amp;second, matrixTolerance, <span class="keyword">true</span> );</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;        </div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;        <span class="comment">//============================================ Check the element to form a group</span></div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a> ( &amp;ret, matrixTolerance ) ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;        {</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Computed point group elements do not form a group.&quot;</span>, <span class="stringliteral">&quot;ES00060&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied cyclic groups list does not form a group and\n                    : therefore such group&#39;s elements cannot be obtained. Please\n                    : check the cyclic groups list supplied to the\n                    : getAllGroupElements() function.&quot;</span> );</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;        }</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;    }</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( groupType == <span class="stringliteral">&quot;T&quot;</span> )</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;    {</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;        <span class="comment">//============================================ Sanity check</span></div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;        <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">axesToGroupTypeSanityCheck</a>                    ( 7, <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( axesList.size() ), groupType );</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;        </div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;        <span class="comment">//============================================ Generate elements for all four C3 axes first</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;        {</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;            <span class="comment">//======================================== If this is a C3 axis</span></div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( allCs-&gt;at(axesList.at(grIt)).at(0) ), rhs1 ( 3.0 );</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;            {</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( allCs-&gt;at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( allCs-&gt;at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;                </div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;            }</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;        }</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;        </div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;        <span class="comment">//============================================ Generate elements for all three C2 axes second</span></div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;        {</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;            <span class="comment">//======================================== If this is a C3 axis</span></div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( allCs-&gt;at(axesList.at(grIt)).at(0) ), rhs1 ( 2.0 );</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;            {</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( allCs-&gt;at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( allCs-&gt;at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;                </div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;            }</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;        }</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;        </div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;        <span class="comment">//============================================ Check the element to form a group</span></div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a> ( &amp;ret, matrixTolerance ) ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;        {</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Computed point group elements do not form a group.&quot;</span>, <span class="stringliteral">&quot;ES00060&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied cyclic groups list does not form a group and\n                    : therefore such group&#39;s elements cannot be obtained. Please\n                    : check the cyclic groups list supplied to the\n                    : getAllGroupElements() function.&quot;</span> );</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;        }</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    }</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( groupType == <span class="stringliteral">&quot;O&quot;</span> )</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;    {</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;        <span class="comment">//============================================ Sanity check</span></div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;        <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">axesToGroupTypeSanityCheck</a>                    ( 13, <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( axesList.size() ), groupType );</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;        </div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;        <span class="comment">//============================================ Generate elements for all three C4 axes first</span></div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;        {</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;            <span class="comment">//======================================== If this is a C3 axis</span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( allCs-&gt;at(axesList.at(grIt)).at(0) ), rhs1 ( 4.0 );</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;            {</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( allCs-&gt;at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( allCs-&gt;at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160; </div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;            }</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;        }</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160; </div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;        <span class="comment">//============================================ Generate elements for all four C3 axes first</span></div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;        {</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;            <span class="comment">//======================================== If this is a C3 axis</span></div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( allCs-&gt;at(axesList.at(grIt)).at(0) ), rhs1 ( 3.0 );</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;            {</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( allCs-&gt;at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( allCs-&gt;at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160; </div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;            }</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;        }</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;        </div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;        <span class="comment">//============================================ Generate elements for all six C2 axes next</span></div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;        {</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;            <span class="comment">//======================================== If this is a C3 axis</span></div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( allCs-&gt;at(axesList.at(grIt)).at(0) ), rhs1 ( 2.0 );</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;            {</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( allCs-&gt;at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( allCs-&gt;at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160; </div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;            }</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;        }</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160; </div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;        <span class="comment">//============================================ Check the element to form a group</span></div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a> ( &amp;ret, matrixTolerance ) ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;        {</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Computed point group elements do not form a group.&quot;</span>, <span class="stringliteral">&quot;ES00060&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied cyclic groups list does not form a group and\n                    : therefore such group&#39;s elements cannot be obtained. Please\n                    : check the cyclic groups list supplied to the\n                    : getAllGroupElements() function.&quot;</span> );</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;        }</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;    }</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( groupType == <span class="stringliteral">&quot;I&quot;</span> )</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;    {</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;        <span class="comment">//============================================ Sanity check</span></div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;        <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">axesToGroupTypeSanityCheck</a>                    ( 31, <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( axesList.size() ), groupType );</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;        </div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;        <span class="comment">//============================================ Generate elements for all six C5 axes first</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;        {</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;            <span class="comment">//======================================== If this is a C5 axis</span></div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( allCs-&gt;at(axesList.at(grIt)).at(0) ), rhs1 ( 5.0 );</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;            {</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( allCs-&gt;at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( allCs-&gt;at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160; </div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;            }</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;        }</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;        </div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;        <span class="comment">//============================================ Generate elements for all ten C3 axes next</span></div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;        {</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;            <span class="comment">//======================================== If this is a C3 axis</span></div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( allCs-&gt;at(axesList.at(grIt)).at(0) ), rhs1 ( 3.0 );</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;            {</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( allCs-&gt;at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( allCs-&gt;at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160; </div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;            }</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;        }</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;        </div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;        <span class="comment">//============================================ Generate elements for all fifteen C2 axes lastly</span></div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;        {</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;            <span class="comment">//======================================== If this is a C3 axis</span></div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( allCs-&gt;at(axesList.at(grIt)).at(0) ), rhs1 ( 2.0 );</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;            {</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( allCs-&gt;at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;                                                                                                  allCs-&gt;at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( allCs-&gt;at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160; </div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;            }</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;        }</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160; </div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;        <span class="comment">//============================================ Check the element to form a group</span></div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a> ( &amp;ret, matrixTolerance ) ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;        {</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Computed point group elements do not form a group.&quot;</span>, <span class="stringliteral">&quot;ES00060&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied cyclic groups list does not form a group and\n                    : therefore such group&#39;s elements cannot be obtained. Please\n                    : check the cyclic groups list supplied to the\n                    : getAllGroupElements() function.&quot;</span> );</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;        }</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;    }</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( groupType == <span class="stringliteral">&quot;X&quot;</span> )</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;    {</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;        <span class="comment">//============================================ User forced no checking for unspecified symmetry</span></div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;        {</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;            <span class="comment">//======================================== Compute group elements</span></div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;            std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( allCs-&gt;at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;                                                                                              allCs-&gt;at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;                                                                                              allCs-&gt;at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;                                                                                              <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( allCs-&gt;at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;            </div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;            <span class="comment">//======================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;            ret                                       = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">true</span> );</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;        }</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;        </div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;        <span class="comment">//============================================ Check the element to form a group</span></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a> ( &amp;ret, matrixTolerance ) ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;        {</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Computed point group elements do not form a group.&quot;</span>, <span class="stringliteral">&quot;ES00060&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied cyclic groups list does not form a group and\n                    : therefore such group&#39;s elements cannot be obtained. Please\n                    : check the cyclic groups list supplied to the\n                    : getAllGroupElements() function.&quot;</span> );</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;        }</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;    }</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;    {</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;        std::stringstream hlpSS;</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;Unknown symmetry type: &gt;&quot;</span> &lt;&lt; groupType &lt;&lt; <span class="stringliteral">&quot;&lt;&quot;</span>;</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( hlpSS.str().c_str(), <span class="stringliteral">&quot;ES00058&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;Function getAllGroupElements was called with symmetry type\n                    : value outside of the allowed values C, D, T, O, I\n                    : or empty for using all supplied axes.&quot;</span> );</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;    }</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160; </div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a23620b34a604aca7db4d8b21f6d2d09a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23620b34a604aca7db4d8b21f6d2d09a">&#9670;&nbsp;</a></span>getAnySphereRadius()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double ProSHADE_internal_data::ProSHADE_data::getAnySphereRadius </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>shell</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the radius of any particular sphere. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>The distance of the requested sphere to the centre of the coordinates. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03770">3770</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;{</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[shell]-&gt;getShellRadius() );</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;    </div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a129f0b665c31fe2d6c7a03f1ba9997de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a129f0b665c31fe2d6c7a03f1ba9997de">&#9670;&nbsp;</a></span>getBestRotationMapPeaksEulerAngles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; proshade_double &gt; ProSHADE_internal_data::ProSHADE_data::getBestRotationMapPeaksEulerAngles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns a vector of three floats, the three Euler angles of the best peak in the rotation map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map overlay. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">val</td><td>A vector of the Euler angles of the best peak in the rotation function map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l01300">1300</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;{</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    std::vector &lt; proshade_double &gt; ret;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    proshade_double eulA, eulB, eulG;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    </div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="comment">//================================================ Get inverse SO(3) map top peak Euler angle values</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__peak_search.html#ae8a54558e9c9c28568c441a601811449">ProSHADE_internal_peakSearch::getBestPeakEulerAngsNaive</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">getInvSO3Coeffs</a> (),</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                                                              this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() * 2,</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                                                             &amp;eulA, &amp;eulB, &amp;eulG, settings );</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    </div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="comment">//================================================ Re-format to vector</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;ret, eulA );</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;ret, eulB );</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;ret, eulG );</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;     </div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    </div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a53412a6bef001a7be8fd98ceaa8a8648"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53412a6bef001a7be8fd98ceaa8a8648">&#9670;&nbsp;</a></span>getBestTranslationMapPeaksAngstrom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; proshade_double &gt; ProSHADE_internal_data::ProSHADE_data::getBestTranslationMapPeaksAngstrom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>staticStructure</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function gets the optimal translation vector and returns it as a standard library vector. It also applies the translation to the internal map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">staticStructure</td><td>A pointer to the data class object of the other ( static ) structure. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>A vector of doubles with the optimal translation vector in Angstroms. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00250">250</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;{</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    std::vector&lt; proshade_double &gt; ret;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    proshade_double mapPeak                           = 0.0;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    proshade_unsign xDimS                             = staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">getXDim</a>();</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    proshade_unsign yDimS                             = staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">getYDim</a>();</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    proshade_unsign zDimS                             = staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">getZDim</a>();</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    proshade_double trsX = 0.0, trsY = 0.0, trsZ = 0.0;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a7caf87603d759cb0de1b0bd834ae8f6d">ProSHADE_internal_maths::findHighestValueInMap</a>    ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae27a3e92905ca9d5f9a32c4eaacc64ae">getTranslationFnPointer</a>(),</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                                        xDimS,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                                        yDimS,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                                        zDimS,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                                       &amp;trsX,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                                                       &amp;trsY,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                                       &amp;trsZ,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                                       &amp;mapPeak );</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">//================================================ Dont translate over half</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> ( trsX &gt; ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( xDimS ) / 2.0 ) ) { trsX = trsX - <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( xDimS ); }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">if</span> ( trsY &gt; ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( yDimS ) / 2.0 ) ) { trsY = trsY - <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( yDimS ); }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> ( trsZ &gt; ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( zDimS ) / 2.0 ) ) { trsZ = trsZ - <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( zDimS ); }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">//================================================ Convert the map positions onto translation in Angstroms and save the results</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__overlay.html#aed7eab7c65fccfa0690ef475ae4e2e9e">ProSHADE_internal_overlay::computeTranslationsFromPeak</a> ( staticStructure, <span class="keyword">this</span>, &amp;trsX, &amp;trsY, &amp;trsZ );</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9548e8ff07c6a74bbe2353f647fb6a79">originalPdbTransX</a>                           = trsX;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5241ee8b8b9d9915e1ef92e3edab202d">originalPdbTransY</a>                           = trsY;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aee571cb10ce61ab11680b1ebd5e23eb7">originalPdbTransZ</a>                           = trsZ;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    proshade_single xMov                              = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( -trsX );</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    proshade_single yMov                              = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( -trsY );</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    proshade_single zMov                              = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( -trsZ );</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">//================================================ Save results as vector</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;ret, <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( -xMov ) );</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;ret, <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( -yMov ) );</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;ret, <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( -zMov ) );</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">//================================================ Save original from variables for PDB output</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7861a96d94b8f7a8eb2946729c330863">mapMovFromsChangeX</a>                          = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> );</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1658311301e365cf17721e864b829c28">mapMovFromsChangeY</a>                          = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> );</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a682749f30d2fd19842d96e9b870d76ab">mapMovFromsChangeZ</a>                          = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> );</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">//================================================ Move the map</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">ProSHADE_internal_mapManip::moveMapByIndices</a>      ( &amp;xMov, &amp;yMov, &amp;zMov, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">getXDimSize</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">getYDimSize</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">getZDimSize</a>(),</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                                         this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4c89c860da1836b30a9b2889d3e873ed">getXFromPtr</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#adf61c328db45fcd7692d13a8cde5e092">getXToPtr</a>(),</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                                         this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f0d929d1e013cdd23e956d94b7a40da">getYFromPtr</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac859cbd21b93b9d2ed5f119f4ee57f3f">getYToPtr</a>(),</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                                         this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afbbcec01a6ee7701e3b1d0e61730fadf">getZFromPtr</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a68eb739dd4846a1dd48032eb2cc3f49c">getZToPtr</a>(),</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                                         this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a1405b3974697f41c4a73da0cb52a32">getXAxisOrigin</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a298bc9a6aae624a091cd97b842a6b618">getYAxisOrigin</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aeb0242051835b508e9af193dc40a697c">getZAxisOrigin</a>() );</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>      ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1bb8bf1e357cc25f68fe93554e44715d">getInternalMap</a>(), xMov, yMov, zMov,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">getXDimSize</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">getYDimSize</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">getZDimSize</a>(),</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">getXDim</a>() ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">getYDim</a>() ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">getZDim</a>() ) );</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">//================================================ Keep only the change in from and to variables</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7861a96d94b8f7a8eb2946729c330863">mapMovFromsChangeX</a>                          = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> ) - this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7861a96d94b8f7a8eb2946729c330863">mapMovFromsChangeX</a>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1658311301e365cf17721e864b829c28">mapMovFromsChangeY</a>                          = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> ) - this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1658311301e365cf17721e864b829c28">mapMovFromsChangeY</a>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a682749f30d2fd19842d96e9b870d76ab">mapMovFromsChangeZ</a>                          = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> ) - this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a682749f30d2fd19842d96e9b870d76ab">mapMovFromsChangeZ</a>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cc2b8e179a137adda234e0ba0f9d27b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cc2b8e179a137adda234e0ba0f9d27b">&#9670;&nbsp;</a></span>getComparisonBand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_unsign ProSHADE_internal_data::ProSHADE_data::getComparisonBand </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the maximum band for the comparison. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>The bandwidth used for this comparison. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03869">3869</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;{</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ed9b0a765739d89104eca2c1875dd4">maxCompBand</a> );</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;    </div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afa3b1a8ef870a606035102b5dcf1ce44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa3b1a8ef870a606035102b5dcf1ce44">&#9670;&nbsp;</a></span>getCyclicSymmetriesListFromAngleAxis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; proshade_double * &gt; ProSHADE_internal_data::ProSHADE_data::getCyclicSymmetriesListFromAngleAxis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function obtains a list of all C symmetries from the angle-axis space mapped rotation function values. </p>
<p>This function oversees the full search for cyclic point groups in the self-rotation function. It starts with finding all prime numbers up to the user specified limit. It then checks for each of the prime numbers whether there is a cyclic point group with fold equal to the prime number.</p>
<p>If any such point groups are found, the function searches for nultiples of these folds, making use of the fact that any structure with cyclic point group of fold n must also contain a point group of fold n/2 if n/2 is an integer. In this manner, cyclic point group with any fold can be found using a small number of specific fold searches, thus eliminating the need to determine which folds should be considered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for symmetry detection. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>A vector of arrays containing all detected cyclic point groups in the standard ProSHADE format, i.e. [0] = fold, [1] = x-axis, [2] = y-axis, [3] = z-axis, [4] = angle, [5] = average peak height. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02770">2770</a> of file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;{</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;    std::vector&lt; proshade_unsign  &gt; primes            = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2454c19169bb38d616e52b99f1dc4495">ProSHADE_internal_maths::findAllPrimes</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afcece610f52c27cadefb217f1d0c278c">maxSymmetryFold</a> );</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    std::vector&lt; proshade_double* &gt; ret, tmpHolder;</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;    std::vector&lt; proshade_unsign  &gt; testedFolds;</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;    proshade_double symThres;</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    proshade_unsign foldToTest;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    <span class="keywordtype">bool</span> foldDone, anyNewSyms = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;    </div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    <span class="comment">//================================================ For each found prime number in the limit</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign prIt = 0; prIt &lt; static_cast&lt; proshade_unsign &gt; ( primes.size() ); prIt++ )</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    {</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;        std::stringstream hlpSS;</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;Searching for prime fold symmetry C&quot;</span> &lt;&lt; primes.at(prIt) &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, hlpSS.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        </div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;        <span class="comment">//============================================ Get all symmetries for this prime fold</span></div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        std::vector&lt; proshade_double* &gt; prSyms        = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2714fcb2c08b224ccf09d64322bd2ab2">findRequestedCSymmetryFromAngleAxis</a> ( settings, primes.at(prIt), &amp;symThres );</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;        </div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;        <span class="comment">//============================================ Save the detected C symmetries</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> axIt = 0; axIt &lt; prSyms.size(); axIt++ )</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;        {</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;            <span class="comment">//======================================== Is this symmetry passing the threshold?</span></div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;            <span class="keywordflow">if</span> ( prSyms.at(axIt)[5] &gt;= symThres )</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;            {</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;                <span class="comment">//==================================== Add this symmetry to final list</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;                <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2380a3710f7dbe672519c3adda30f7cd">ProSHADE_internal_maths::isAxisUnique</a> ( &amp;ret, prSyms.at(axIt), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">true</span> ) )</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;                {</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( &amp;ret, prSyms.at(axIt) );</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;                }</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;            }</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;        </div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;            <span class="comment">//======================================== Release memory</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;            <span class="keyword">delete</span>[] prSyms.at(axIt);</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;        }</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    }</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    </div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    <span class="comment">//================================================ Was anything found?</span></div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    <span class="keywordflow">if</span> ( ret.size() &lt; 1 ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;    </div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    <span class="comment">//================================================ Check for prime symmetry fold multiples</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;    <span class="keywordflow">while</span> ( anyNewSyms )</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;    {</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;        <span class="comment">//============================================ Initialise new iteration</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;        anyNewSyms                                    = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;        </div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        <span class="comment">//============================================ For each passing symmetry, look if there are any combinations of symmetries that would contain it</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign axIt1 = 0; axIt1 &lt; static_cast&lt; proshade_unsign &gt; ( ret.size() ); axIt1++ )</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        {</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign axIt2 = 0; axIt2 &lt; static_cast&lt; proshade_unsign &gt; ( ret.size() ); axIt2++ )</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;            {</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;                <span class="comment">//==================================== Initialise iteration</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;                foldToTest                            = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( ret.at(axIt1)[0] * ret.at(axIt2)[0] );</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;                <span class="keywordflow">if</span> ( foldToTest &gt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afcece610f52c27cadefb217f1d0c278c">maxSymmetryFold</a> ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;                </div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;                <span class="comment">//==================================== Was this fold tested already?</span></div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;                foldDone                              = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign fIt = 0; fIt &lt; static_cast&lt; proshade_unsign &gt; ( testedFolds.size() ); fIt++ ) { <span class="keywordflow">if</span> ( testedFolds.at(fIt) == foldToTest ) { foldDone = <span class="keyword">true</span>; <span class="keywordflow">break</span>; } }</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;                <span class="keywordflow">if</span> ( foldDone ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;                <span class="keywordflow">else</span>            { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;testedFolds, foldToTest ); }</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;                </div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;                <span class="comment">//==================================== Report progress</span></div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;                std::stringstream hlpSS2;</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;                hlpSS2 &lt;&lt; <span class="stringliteral">&quot;Searching for fold combination of detected folds &quot;</span> &lt;&lt; ret.at(axIt1)[0] &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; ret.at(axIt2)[0] &lt;&lt; <span class="stringliteral">&quot;, i.e. C&quot;</span> &lt;&lt; foldToTest &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, hlpSS2.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;                </div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;                <span class="comment">//==================================== Get all symmetries for this fold</span></div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;                std::vector&lt; proshade_double* &gt; prSyms = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2714fcb2c08b224ccf09d64322bd2ab2">findRequestedCSymmetryFromAngleAxis</a> ( settings, foldToTest, &amp;symThres );</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;                </div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;                <span class="comment">//==================================== For each detected group with the required fold</span></div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;                <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> newAxIt = 0; newAxIt &lt; prSyms.size(); newAxIt++ )</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;                {</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;                    <span class="keywordflow">if</span> ( prSyms.at(newAxIt)[5] &gt;= symThres )</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;                    {</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;                        <span class="comment">//================================ Add to detected axes</span></div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;                        <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2380a3710f7dbe672519c3adda30f7cd">ProSHADE_internal_maths::isAxisUnique</a> ( &amp;ret, prSyms.at(newAxIt), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">true</span> ) )</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;                        {</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;                            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( &amp;tmpHolder, prSyms.at(newAxIt) );</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;                        }</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;                    }</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160; </div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;                    <span class="comment">//==================================== Release memory</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;                    <span class="keyword">delete</span>[] prSyms.at(newAxIt);</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;                }</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;            }</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;        }</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;        </div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;        <span class="comment">//============================================ Add newly found groups and repeat if need be</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;        <span class="keywordflow">if</span> ( tmpHolder.size() &gt; 0 )</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;        {</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign tmpIt = 0; tmpIt &lt; static_cast&lt; proshade_unsign &gt; ( tmpHolder.size() ); tmpIt++ )</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;            {</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( &amp;ret, tmpHolder.at(tmpIt) );</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;                <span class="keyword">delete</span>[] tmpHolder.at(tmpIt);</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;            }</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;            </div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;            anyNewSyms                                = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;            tmpHolder.clear                           ( );</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;        }</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    }</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    </div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    <span class="comment">//================================================ Sort the vector</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    std::sort                                         ( ret.begin(), ret.end(), <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a2e915d310892aea124046acd14db4a84">ProSHADE_internal_misc::sortSymHlpInv</a> );</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    </div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1fdc5b9df47ff8de3a5f2f6e6ce233a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fdc5b9df47ff8de3a5f2f6e6ce233a5">&#9670;&nbsp;</a></span>getDihedralSymmetriesList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; proshade_double * &gt; ProSHADE_internal_data::ProSHADE_data::getDihedralSymmetriesList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>CSymList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function obtains a list of all D symmetries from already computed C symmetries list. </p>
<p>This function simply returns a vector of C symmetry pairs which are perpendicular to each other (and therefore form dihedral symmetry). The vector contains arrays of 12 double numbers with the following format: [0] = Fold of axis 1; [1] = X-axis of axis 1; [2] Y-axis of axis 1; [3] = Z-axis of axis 1; [4] = angle of axis 1; [5] = average peak height of axis 1; [6] = Fold of axis 2; [7] = X-axis of axis 2; [8] Y-axis of axis 2; [9] = Z-axis of axis 2; [10] = angle of axis 2; [11] = average peak height of axis 2. Note that the larger fold axis is listed first in this format.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CSymList</td><td>A vector containing the already detected Cyclic symmetries. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00302">302</a> of file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;{</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    proshade_double dotProduct;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting D symmetry detection.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">//================================================If not enough axes, just end here</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">if</span> ( CSymList-&gt;size() &lt; 2 ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">//================================================ For each unique pair of axes</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign ax1 = 0; ax1 &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); ax1++ )</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="comment">//============================================ Ignore small axes</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(ax1)[5] ), rhs1 ( -999.9 );</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">if</span> ( ( CSymList-&gt;at(ax1)[5] &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) &amp;&amp; !( lhs1.AlmostEquals ( rhs1 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign ax2 = 1; ax2 &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); ax2++ )</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="comment">//======================================= Use unique pairs only</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <span class="keywordflow">if</span> ( ax1 &gt;= ax2 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="comment">//======================================== Ignore small axes</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs2 ( CSymList-&gt;at(ax2)[5] ), rhs2 ( -999.9 );</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordflow">if</span> ( ( CSymList-&gt;at(ax2)[5] &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) &amp;&amp; !( lhs2.AlmostEquals ( rhs2 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="comment">//======================================= Compute the dot product</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            dotProduct                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;CSymList-&gt;at(ax1)[1], &amp;CSymList-&gt;at(ax1)[2],</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                                                                                                     &amp;CSymList-&gt;at(ax1)[3], &amp;CSymList-&gt;at(ax2)[1],</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                                                                                     &amp;CSymList-&gt;at(ax2)[2], &amp;CSymList-&gt;at(ax2)[3] );</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="comment">//======================================== If close to zero, these two axes are perpendicular</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="keywordflow">if</span> ( std::abs( dotProduct ) &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a> )</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                <span class="comment">//==================================== Save</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                <span class="keywordflow">if</span> ( CSymList-&gt;at(ax1)[0] &gt;= CSymList-&gt;at(ax2)[0] )</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ab0ac919dd609bc6bded806c0f78201fd">ProSHADE_internal_symmetry::saveDSymmetry</a> ( &amp;ret, CSymList, ax1, ax2 );</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                    </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                    std::vector&lt; proshade_unsign &gt; DSymInd;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;DSymInd, ax1 );</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;DSymInd, ax2 );</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a86e2bb172f766ab4a620df482d2fe481">ProSHADE_internal_misc::addToUnsignVectorVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>, DSymInd );</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ab0ac919dd609bc6bded806c0f78201fd">ProSHADE_internal_symmetry::saveDSymmetry</a> ( &amp;ret, CSymList, ax2, ax1 );</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    std::vector&lt; proshade_unsign &gt; DSymInd;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;DSymInd, ax2 );</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;DSymInd, ax1 );</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a86e2bb172f766ab4a620df482d2fe481">ProSHADE_internal_misc::addToUnsignVectorVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>, DSymInd );</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot;Detected &quot;</span> &lt;&lt; ret.size() &lt;&lt; <span class="stringliteral">&quot; D symmetries.&quot;</span>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, hlpSS.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a94a73f81ba80621f5f52173e91bb47f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94a73f81ba80621f5f52173e91bb47f7">&#9670;&nbsp;</a></span>getEMatrixByBand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_complex ** ProSHADE_internal_data::ProSHADE_data::getEMatrixByBand </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>band</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to E matrix for a particular band. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The band for which the E matrix subset order * order should be returned. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>Pointer to pointer of complex matrix with dimensions order * order of the E matrices. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03817">3817</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;{</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[band] );</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;    </div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab053362f9dc5422244ccfbafd9f00ff8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab053362f9dc5422244ccfbafd9f00ff8">&#9670;&nbsp;</a></span>getEMatrixValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::getEMatrixValue </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>order1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>order2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>valueReal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>valueImag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to E matrix by knowing the band, order1 and order2 indices. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The band for which the E matrix value should be returned. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order1</td><td>The first order for which the E matrix value should be returned. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order2</td><td>The second order for which the E matrix value should be returned. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">valueReal</td><td>The proshade_double number pointer to where the real part of the value will be saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">valueImag</td><td>The proshade_double number pointer to where the imaginary part of the value will be saved. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03832">3832</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;{</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;    <span class="comment">//================================================ Set pointer</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;   *valueReal                                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[band][order1][order2][0];</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;   *valueImag                                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[band][order1][order2][1];</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;    </div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;    return ;</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;    </div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad46b5c9a39df4faa45cc53d31aab43db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad46b5c9a39df4faa45cc53d31aab43db">&#9670;&nbsp;</a></span>getIcosahedralSymmetriesList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; proshade_double * &gt; ProSHADE_internal_data::ProSHADE_data::getIcosahedralSymmetriesList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>CSymList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function obtains a list of all I symmetry axes from the already computed C symmetries list. </p>
<p>This function starts by checking if there is a pair of C3 and C4 symmetries with the octahedron dihedral angle ( acos ( 1/sqrt(3) ) ). If so, it will then assume existence of octahedral symmetry and it will search for three C4 axes, four C3 axes and six C2 axes with the correct angle to each other and within the group. If all required axes are detected, it will return a list of 13 axes, otherwise it will return empty or shorter list. Automated missing symmetry axis detection is also included.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CSymList</td><td>A vector containing the already detected Cyclic symmetries. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01808">1808</a> of file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;{</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting I symmetry detection.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    </div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="comment">//================================================ Are the basic requirements for icosahedral symmetry met?</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a4f09b90de1f15b345ee7998ff31327f3">ProSHADE_internal_symmetry::detectIcosahedralSymmetry</a> ( CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) )</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    {</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        <span class="comment">//============================================ Search for all the symmetry axes</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af4dec365c5650c93198d73b6d259e4e7">ProSHADE_internal_symmetry::findIcos6C5s</a>      ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 6 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160; </div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ab53cd7561731d9426989f5ace523826a">ProSHADE_internal_symmetry::findIcos10C3s</a>     ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 16 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160; </div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a422414bb07db89a5c797f371a5448c0e">ProSHADE_internal_symmetry::findIcos15C2s</a>     ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 31 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;        {</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            <span class="comment">//======================================== Sort ret by fold</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            std::sort                                 ( ret.begin(), ret.end(), <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad14d6427df4269728627fcd880abaf31">ProSHADE_internal_misc::sortSymInvFoldHlp</a> );</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            </div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;            <span class="comment">//======================================== Save indices</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign csIt = 0; csIt &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); csIt++ )</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;            {</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign retIt = 0; retIt &lt; static_cast&lt;proshade_unsign&gt; ( ret.size() ); retIt++ )</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                {</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(csIt)[0] ), rhs1 ( ret.at(retIt)[0] );</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs2 ( CSymList-&gt;at(csIt)[1] ), rhs2 ( ret.at(retIt)[1] );</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs3 ( CSymList-&gt;at(csIt)[2] ), rhs3 ( ret.at(retIt)[2] );</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs4 ( CSymList-&gt;at(csIt)[3] ), rhs4 ( ret.at(retIt)[3] );</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs5 ( CSymList-&gt;at(csIt)[4] ), rhs5 ( ret.at(retIt)[4] );</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs6 ( CSymList-&gt;at(csIt)[5] ), rhs6 ( ret.at(retIt)[5] );</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                    <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) &amp;&amp;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                         lhs2.AlmostEquals ( rhs2 ) &amp;&amp;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                         lhs3.AlmostEquals ( rhs3 ) &amp;&amp;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                         lhs4.AlmostEquals ( rhs4 ) &amp;&amp;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                         lhs5.AlmostEquals ( rhs5 ) &amp;&amp;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                         lhs6.AlmostEquals ( rhs6 ) )</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                    {</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>, csIt );</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                    }</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                }</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;            }</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        }</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160; </div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;I symmetry detection complete.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160; </div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    </div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b08a8b6f9569c06cd183c924e6e80de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b08a8b6f9569c06cd183c924e6e80de">&#9670;&nbsp;</a></span>getImagEMatrixValuesForLM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::getImagEMatrixValuesForLM </td>
          <td>(</td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>order1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>eMatsLMImag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function fills the input array with the imaginary E matrix values for particular band and order1 (l as opposed to l'). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The band for which the imaginary E matrix values are requested. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order</td><td>The order for which the imaginary E matrix values are requested. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eMatsLMImag</td><td>The array to which the values will be written into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>The lenght of the array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04208">4208</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;{</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;    {</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;        eMatsLMImag[iter]                             = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[band][order1][iter][1] );</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;    }</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;    </div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;    return ;</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;    </div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b063d1ca2ebed239029bad6250cf376"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b063d1ca2ebed239029bad6250cf376">&#9670;&nbsp;</a></span>getImagRotFunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::getImagRotFunction </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rotFunImag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function fills the input array with the imaginary rotation function values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rotFunImag</td><td>The array to which the values will be written into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>The lenght of the array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04295">4295</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;{</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;    {</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;        rotFunImag[iter]                              = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a33312dd4333617b460628e4db4bf41fc">so3CoeffsInverse</a>[iter][1] );</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;    }</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;    </div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;    return ;</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;    </div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4b76352faa0915b1fef943fe139de5a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b76352faa0915b1fef943fe139de5a6">&#9670;&nbsp;</a></span>getImagSO3Coeffs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::getImagSO3Coeffs </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>so3CoefsImag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function fills the input array with the imaginary SO(3) coefficient values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">so3CoefsImag</td><td>The array to which the values will be written into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>The lenght of the array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04244">4244</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;{</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;    {</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;        so3CoefsImag[iter]                            = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">so3Coeffs</a>[iter][1] );</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;    }</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;    </div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;    return ;</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;    </div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aae8444b6c9ca3207d32bbf2a68c7b610"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae8444b6c9ca3207d32bbf2a68c7b610">&#9670;&nbsp;</a></span>getImagSphHarmValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double * ProSHADE_internal_data::ProSHADE_data::getImagSphHarmValue </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>shell</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the private internal imaginary spherical harmonics values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>Pointer to the value of the internal private spherical harmonics imaginary value of the given index. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03757">3757</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;{</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>[shell][seanindex ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( order ) - <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( band ),</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;                                                                                                     <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( band ),</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;                                                                                                     <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[shell]-&gt;getLocalBandwidth() ) )][1] );</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;    </div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a97766b6a74aee4c364c1fd8efd6478ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97766b6a74aee4c364c1fd8efd6478ff">&#9670;&nbsp;</a></span>getImagTranslationFunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::getImagTranslationFunction </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>trsFunImag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function fills the input array with the imaginary translation function values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">trsFunImag</td><td>The array to which the values will be written into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>The lenght of the array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04331">4331</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;{</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;    {</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;        trsFunImag[iter]                              = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37f26ac4bc76e4f4c5da77dd0eace56e">translationMap</a>[iter][1] );</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;    }</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;    </div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;    return ;</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;    </div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa150cfc5715420cf3d2e28c8af3631c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa150cfc5715420cf3d2e28c8af3631c4">&#9670;&nbsp;</a></span>getIntegrationWeight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double ProSHADE_internal_data::ProSHADE_data::getIntegrationWeight </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the integration weight for the object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>The integration weight for the object or 0.0 if not yet computed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03781">3781</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;{</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d266289b137b48132f1456fd8fc43ea">integrationWeight</a> );</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;    </div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1bb8bf1e357cc25f68fe93554e44715d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bb8bf1e357cc25f68fe93554e44715d">&#9670;&nbsp;</a></span>getInternalMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double *&amp; ProSHADE_internal_data::ProSHADE_data::getInternalMap </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the first map array value address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">internalMap</td><td>Pointer to the first position in the internal map array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04049">4049</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;{</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a> );</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2eb10989a2f8d46b849cdaf8410b68be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eb10989a2f8d46b849cdaf8410b68be">&#9670;&nbsp;</a></span>getInvSO3Coeffs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_complex * ProSHADE_internal_data::ProSHADE_data::getInvSO3Coeffs </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the inverse SO(3) coefficients array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>The internal inverse SO(3) coefficients array variable. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03847">3847</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;{</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a33312dd4333617b460628e4db4bf41fc">so3CoeffsInverse</a> );</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;    </div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4bd7a9a5ea6cac4302ec1cd80922c617"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bd7a9a5ea6cac4302ec1cd80922c617">&#9670;&nbsp;</a></span>getMapCOMProcessChange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; proshade_double &gt; ProSHADE_internal_data::ProSHADE_data::getMapCOMProcessChange </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the translation caused by structure processing. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">mapCOMProcessChange</td><td>Vector of the distances in Angstroms that the structure has been moved internally. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04069">4069</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;{</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;    std::vector&lt; proshade_double &gt; ret;</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;    </div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;    <span class="comment">//================================================ Save the values</span></div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;ret, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a471ec29b27c3a402d18b20fee8035f1a">mapCOMProcessChangeX</a> );</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;ret, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47bf2343b0b50267e8e3732c964b63ea">mapCOMProcessChangeY</a> );</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;ret, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a487131ae5dc44f8667908bf64725b4ab">mapCOMProcessChangeZ</a> );</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;    </div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afe04510c67e9dc9c19efaef8463b6e6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe04510c67e9dc9c19efaef8463b6e6e">&#9670;&nbsp;</a></span>getMapValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double ProSHADE_internal_data::ProSHADE_data::getMapValue </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>pos</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the internal map representation value of a particular array position. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pos</td><td>The position in the map array, of which the value should be returned. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>The internal map representation value at position pos. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03601">3601</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;{</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[pos] );</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a152b43815a3d3debd4b60751d9c8afdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a152b43815a3d3debd4b60751d9c8afdd">&#9670;&nbsp;</a></span>getMaxBand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_unsign ProSHADE_internal_data::ProSHADE_data::getMaxBand </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the maximum band value for the object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>The largest number of bands used in any shell of the object. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03611">3611</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;{</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> );</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2245b15f279de574406204156089e5ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2245b15f279de574406204156089e5ef">&#9670;&nbsp;</a></span>getMaxSpheres()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_unsign ProSHADE_internal_data::ProSHADE_data::getMaxSpheres </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the number of spheres which contain the whole object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>The total number of spheres to which the structure is mapped. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03590">3590</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;{</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a> );</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad1fdcd9bdebc2900748821c5b3cb53cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1fdcd9bdebc2900748821c5b3cb53cc">&#9670;&nbsp;</a></span>getNoRecommendedSymmetryAxes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_unsign ProSHADE_internal_data::ProSHADE_data::getNoRecommendedSymmetryAxes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the number of detected recommended symmetry axes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map manipulation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">val</td><td>The length of the recommended symmetry axes vector. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04407">4407</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;{</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() ) );</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a14c4d6044c5174afa8a0984025c45436"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14c4d6044c5174afa8a0984025c45436">&#9670;&nbsp;</a></span>getOctahedralSymmetriesList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; proshade_double * &gt; ProSHADE_internal_data::ProSHADE_data::getOctahedralSymmetriesList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>CSymList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function obtains a list of all O symmetry axes from the already computed C symmetries list. </p>
<p>This function starts by checking if there is a pair of C3 and C4 symmetries with the octahedron dihedral angle ( acos ( 1/sqrt(3) ) ). If so, it will then assume existence of octahedral symmetry and it will search for three C4 axes, four C3 axes and six C2 axes with the correct angle to each other and within the group. If all required axes are detected, it will return a list of 13 axes, otherwise it will return empty or shorter list. Automated missing symmetry axis detection is also included.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CSymList</td><td>A vector containing the already detected Cyclic symmetries. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01204">1204</a> of file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;{</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting O symmetry detection.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="comment">//================================================ Are the basic requirements for tetrahedral symmetry met?</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a18d456057604616a7cf6b68f59b4f2d0">ProSHADE_internal_symmetry::detectOctahedralSymmetry</a> ( CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) )</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <span class="comment">//============================================ Search for all the symmetry axes</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a31e25079d4a20a0d6442c7fb36fdeaea">ProSHADE_internal_symmetry::findOcta3C4s</a> ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 3 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a1db775b80f6ce426bb98d87f8ba99d72">ProSHADE_internal_symmetry::findOcta4C3s</a> ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 7 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a7f24f5b37a7810ce379fce1b71877a0e">ProSHADE_internal_symmetry::findOcta6C2s</a> ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 13 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign csIt = 0; csIt &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); csIt++ )</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;            {</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign retIt = 0; retIt &lt; static_cast&lt;proshade_unsign&gt; ( ret.size() ); retIt++ )</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                {</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                    <span class="comment">//======================================== Sort ret by fold</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                    std::sort                                 ( ret.begin(), ret.end(), <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad14d6427df4269728627fcd880abaf31">ProSHADE_internal_misc::sortSymInvFoldHlp</a> );</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                    </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                    <span class="comment">//======================================== Save indices</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(csIt)[0] ), rhs1 ( ret.at(retIt)[0] );</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs2 ( CSymList-&gt;at(csIt)[1] ), rhs2 ( ret.at(retIt)[1] );</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs3 ( CSymList-&gt;at(csIt)[2] ), rhs3 ( ret.at(retIt)[2] );</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs4 ( CSymList-&gt;at(csIt)[3] ), rhs4 ( ret.at(retIt)[3] );</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs5 ( CSymList-&gt;at(csIt)[4] ), rhs5 ( ret.at(retIt)[4] );</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs6 ( CSymList-&gt;at(csIt)[5] ), rhs6 ( ret.at(retIt)[5] );</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                    <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) &amp;&amp;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                         lhs2.AlmostEquals ( rhs2 ) &amp;&amp;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                         lhs3.AlmostEquals ( rhs3 ) &amp;&amp;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                         lhs4.AlmostEquals ( rhs4 ) &amp;&amp;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                         lhs5.AlmostEquals ( rhs5 ) &amp;&amp;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                         lhs6.AlmostEquals ( rhs6 ) )</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                    {</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>, csIt );</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                    }</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;            }</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    }</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;O symmetry detection complete.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    </div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad409e4556676857224d1f5e00e5b7911"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad409e4556676857224d1f5e00e5b7911">&#9670;&nbsp;</a></span>getOverlayRotationFunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::getOverlayRotationFunction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>obj2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the overlay rotation function (i.e. the correlation function in SO(3) space). </p>
<p>This function assumes it is called from the object to which the rotation function is to be assigned to (presumably the moving rather than static structure). It starts by computing the E matrices, normalising these using the Patterson-like normalisation, generating SO(3) coefficients from the E matrices and finally computing their inverse SOFT transform to get the rotation function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj2</td><td>A pointer to the data class object of the other ( static ) structure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00035">35</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting rotation function computation.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">//================================================ Compute un-weighted E matrices and their weights</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#add48230d67bd69305df058d29a588507">ProSHADE_internal_distances::computeEMatrices</a>     ( obj2, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//================================================ Normalise E matrices by the magnitudes</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#ac96ff1a23997199af76e58885a1ee1e2">ProSHADE_internal_distances::normaliseEMatrices</a>   ( obj2, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">//================================================ Generate SO(3) coefficients</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#afacb5240b508ea28b64cacf395b47dba">ProSHADE_internal_distances::generateSO3CoeffsFromEMatrices</a> ( obj2, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">//================================================ Compute the inverse SO(3) Fourier Transform (SOFT) on the newly computed coefficients</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#a3cdde76bf20d9cd5d756ffde2d3dc854">ProSHADE_internal_distances::computeInverseSOFTTransform</a> ( obj2, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Rotation function obtained.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    return ;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9a02d8d68aac021572b764651aad0f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9a02d8d68aac021572b764651aad0f1">&#9670;&nbsp;</a></span>getPredictedIcosahedralSymmetriesList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; proshade_double * &gt; &gt; ProSHADE_internal_data::ProSHADE_data::getPredictedIcosahedralSymmetriesList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>CSymList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function predicts a list of all I symmetry axes from the already computed C symmetries list. </p>
<p>This function starts by checking if there is a pair of C3 and C5 symmetries with the icosahedron dihedral angle ( acos( std::sqrt ( ( 1.0 + 2.0 / std::sqrt ( 5.0 ) ) / 3.0 ) ) ). If found, it calls the <a class="el" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a16d3cf24f73eafc1d5b8ef9e204aaf8d" title="This function predicts all possible icosahedral point groups symmetry axes from the cyclic point grou...">predictIcosAxes()</a> function, which uses the knowledge of the two axes (C5 and C3) which are closest to the dihedral angle to find the best rotation matrix matching a pre-computed icosahedron model to the detected axes. After rotating the model, the model axes become the predicted axes for the structure and their peak heights are then computed. Once complete, all the predicted axes are in the ret variable.</p>
<dl class="section warning"><dt>Warning</dt><dd>This function does not check if the correct number of C axes was found, it is assumed this will be checked when the determination of which symmetry was found.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CSymList</td><td>A vector containing the already detected Cyclic symmetries. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>A vector of all the detected axes in the standard ProSHADE format with height either the detected value (for the detected ones) or 0 for the predicted ones. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01880">1880</a> of file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;{</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    std::vector&lt; std::vector&lt; proshade_double* &gt; &gt; ret;</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    </div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting I symmetry prediction.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    </div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="comment">//================================================ Are the basic requirements for icosahedral symmetry met?</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a4f09b90de1f15b345ee7998ff31327f3">ProSHADE_internal_symmetry::detectIcosahedralSymmetry</a> ( CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) )</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    {</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        <span class="comment">//============================================ Generate the rest of the axes</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a16d3cf24f73eafc1d5b8ef9e204aaf8d">ProSHADE_internal_symmetry::predictIcosAxes</a>   ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160; </div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;        <span class="comment">//============================================ For each possible axes pair</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> pIt = 0; pIt &lt; ret.size(); pIt++ )</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;        {</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;            <span class="comment">//======================================== Get heights for the predicted axes</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a33c650c19a6954800bba6b3a8f5842e6">ProSHADE_internal_symmetry::findPredictedAxesHeights</a> ( &amp;(ret.at(pIt)), <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        }</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    }</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <span class="comment">//================================================ Sort by best peak height sum</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    std::sort                                         ( ret.begin(), ret.end(), <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#afc48122cd1adf605eb8f7479cd197585">ProSHADE_internal_misc::sortISymByPeak</a> );</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160; </div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;I symmetry prediction complete.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160; </div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    </div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae97b54a34689c1dceae47a5e8e94bbb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae97b54a34689c1dceae47a5e8e94bbb0">&#9670;&nbsp;</a></span>getPredictedOctahedralSymmetriesList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; proshade_double * &gt; ProSHADE_internal_data::ProSHADE_data::getPredictedOctahedralSymmetriesList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>CSymList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function predicts a list of all O symmetry axes from the already computed C symmetries list. </p>
<p>This function starts by checking if there is a pair of C3 and C4 symmetries with the octahedron dihedral angle ( acos( ( 1.0 / sqrt ( 3.0 ) ) ) ). If found, it calls the <a class="el" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a38ce8efbbe05220793b5f01f0fef07a6" title="This function predicts all octahedral point group symmetry axes from the cyclic point groups list.">predictOctaAxes()</a> function, which uses the knowledge of the two axes (C4 and C3) which are closest to the dihedral angle to find the best rotation matrix matching a pre-computed octahedron model to the detected axes. After rotating the model, the model axes become the predicted axes for the structure and their peak heights are then computed. Once complete, all the predicted axes are in the ret variable.</p>
<dl class="section warning"><dt>Warning</dt><dd>This function does not check if the correct number of C axes was found, it is assumed this will be checked when the determination of which symmetry was found.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CSymList</td><td>A vector containing the already detected Cyclic symmetries. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>A vector of all the detected axes in the standard ProSHADE format with height either the detected value (for the detected ones) or 0 for the predicted ones. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01927">1927</a> of file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;{</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting O symmetry prediction.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    </div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="comment">//================================================ Are the basic requirements for icosahedral symmetry met?</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a18d456057604616a7cf6b68f59b4f2d0">ProSHADE_internal_symmetry::detectOctahedralSymmetry</a> ( CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) )</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    {</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        <span class="comment">//============================================ Generate the rest of the axes</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a38ce8efbbe05220793b5f01f0fef07a6">ProSHADE_internal_symmetry::predictOctaAxes</a>   ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        <span class="comment">//============================================ Get heights for the predicted axes</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a33c650c19a6954800bba6b3a8f5842e6">ProSHADE_internal_symmetry::findPredictedAxesHeights</a> ( &amp;ret, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160; </div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        <span class="comment">//============================================ Add predicted axes to detected C axes list and also to the settings Icosahedral symmetry list</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign retIt = 0; retIt &lt; static_cast &lt; proshade_unsign &gt; ( ret.size() ); retIt++ )</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        {</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;            proshade_signed matchedPos                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( ret.at(retIt)[0] ), ret.at(retIt)[1], ret.at(retIt)[2], ret.at(retIt)[3], ret.at(retIt)[5], CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a> );</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>, <span class="keyword">static_cast &lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( matchedPos ) );</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        }</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    }</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    </div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;O symmetry prediction complete.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160; </div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    </div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a931aa4c10c426c3b8041bd4e838b0678"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a931aa4c10c426c3b8041bd4e838b0678">&#9670;&nbsp;</a></span>getPredictedTetrahedralSymmetriesList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; proshade_double * &gt; ProSHADE_internal_data::ProSHADE_data::getPredictedTetrahedralSymmetriesList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>CSymList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function predicts a list of all T symmetry axes from the already computed C symmetries list. </p>
<p>This function starts by checking if there is a pair of C3 and C2 symmetries with the tetrahedron dihedral angle ( acos( ( 1.0 / sqrt ( 3.0 ) ) ). If found, it calls the <a class="el" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aef7a2435e9d3616d860aeee2d94dba55" title="This function predicts all tetrahedral point group symmetry axes from the cyclic point groups list.">predictTetraAxes()</a> function, which uses the knowledge of the two axes (C3 and C2) which are closest to the dihedral angle to find the best rotation matrix matching a pre-computed tetrhedron model to the detected axes. After rotating the model, the model axes become the predicted axes for the structure and their peak heights are then computed. Once complete, all the predicted axes are in the ret variable.</p>
<dl class="section warning"><dt>Warning</dt><dd>This function does not check if the correct number of C axes was found, it is assumed this will be checked when the determination of which symmetry was found.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CSymList</td><td>A vector containing the already detected Cyclic symmetries. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>A vector of all the detected axes in the standard ProSHADE format with height either the detected value (for the detected ones) or 0 for the predicted ones. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03505">3505</a> of file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;{</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;    </div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting T symmetry prediction.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;    </div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;    <span class="comment">//================================================ Are the basic requirements for icosahedral symmetry met?</span></div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a37925ac477480c718451debb01a9c74a">ProSHADE_internal_symmetry::detectTetrahedralSymmetry</a> ( CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) )</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;    {</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;        <span class="comment">//============================================ Generate the rest of the axes</span></div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aef7a2435e9d3616d860aeee2d94dba55">ProSHADE_internal_symmetry::predictTetraAxes</a>  ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160; </div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;        <span class="comment">//============================================ Get heights for the predicted axes</span></div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a33c650c19a6954800bba6b3a8f5842e6">ProSHADE_internal_symmetry::findPredictedAxesHeights</a> ( &amp;ret, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160; </div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;        <span class="comment">//============================================ Add predicted axes to detected C axes list and also to the settings Icosahedral symmetry list</span></div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign retIt = 0; retIt &lt; static_cast &lt; proshade_unsign &gt; ( ret.size() ); retIt++ )</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;        {</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;            proshade_signed matchedPos                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( ret.at(retIt)[0] ), ret.at(retIt)[1], ret.at(retIt)[2], ret.at(retIt)[3], ret.at(retIt)[5], CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a> );</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>, <span class="keyword">static_cast &lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( matchedPos ) );</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;        }</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;    }</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;    </div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;T symmetry prediction complete.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160; </div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;    </div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa757f9d32ebe20435661599652fd30fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa757f9d32ebe20435661599652fd30fa">&#9670;&nbsp;</a></span>getRealEMatrixValuesForLM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::getRealEMatrixValuesForLM </td>
          <td>(</td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>order1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>eMatsLMReal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function fills the input array with the real E matrix values for particular band and order1 (l as opposed to l'). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The band for which the real E matrix values are requested. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order</td><td>The order for which the real E matrix values are requested. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eMatsLMReal</td><td>The array to which the values will be written into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>The lenght of the array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04188">4188</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;{</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;    {</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;        eMatsLMReal[iter]                             = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[band][order1][iter][0] );</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;    }</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;    </div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;    return ;</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;    </div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8bc5fbad1079d42bfa73913a9e2df619"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bc5fbad1079d42bfa73913a9e2df619">&#9670;&nbsp;</a></span>getRealRotFunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::getRealRotFunction </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rotFunReal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function fills the input array with the real rotation function values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rotFunReal</td><td>The array to which the values will be written into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>The lenght of the array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04277">4277</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;{</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;    {</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;        rotFunReal[iter]                              = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a33312dd4333617b460628e4db4bf41fc">so3CoeffsInverse</a>[iter][0] );</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;    }</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;    </div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;    return ;</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;    </div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a30eac0ab5b69c1b7190d6e56571ba8b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30eac0ab5b69c1b7190d6e56571ba8b8">&#9670;&nbsp;</a></span>getRealSO3Coeffs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::getRealSO3Coeffs </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>so3CoefsReal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function fills the input array with the real SO(3) coefficient values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">so3CoefsReal</td><td>The array to which the values will be written into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>The lenght of the array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04226">4226</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;{</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;    {</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;        so3CoefsReal[iter]                            = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">so3Coeffs</a>[iter][0] );</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;    }</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;    </div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;    return ;</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;    </div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5c0df68cd21b4f56abd1008065ca3573"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c0df68cd21b4f56abd1008065ca3573">&#9670;&nbsp;</a></span>getRealSphHarmValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double * ProSHADE_internal_data::ProSHADE_data::getRealSphHarmValue </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>shell</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the private internal real spherical harmonics values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>Pointer to the value of the internal private spherical harmonics real value of the given index. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03744">3744</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;{</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>[shell][seanindex ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( order ) - <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( band ),</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;                                                                                                     <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( band ),</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;                                                                                                     <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[shell]-&gt;getLocalBandwidth() ) )][0] );</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;    </div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a94cce09895dc9f41d4b9a429ccf638e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94cce09895dc9f41d4b9a429ccf638e8">&#9670;&nbsp;</a></span>getRealTranslationFunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::getRealTranslationFunction </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>trsFunReal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function fills the input array with the real translation function values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">trsFunReal</td><td>The array to which the values will be written into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>The lenght of the array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04313">4313</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;{</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;    {</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;        trsFunReal[iter]                              = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37f26ac4bc76e4f4c5da77dd0eace56e">translationMap</a>[iter][0] );</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;    }</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;    </div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;    return ;</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;    </div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0dc9f3ed79cc98719e6b727bb8bb982"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0dc9f3ed79cc98719e6b727bb8bb982">&#9670;&nbsp;</a></span>getReBoxBoundaries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::getReBoxBoundaries </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&amp;&#160;</td>
          <td class="paramname"><em>ret</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function finds the boundaries enclosing positive map values and adds some extra space. </p>
<p>This function firstly finds the boundaries which enclose the positive map values and then it proceeds to add a given amount of space to all dimensions (positive and negative) to make sure the map does not end exactly at the bounds. It returns the new boundaries in the ret variable if they are smaller than the original bounds, or just the original bounds in case decrease was not achieved.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for reading in the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ret</td><td>A pointer to proshade_signed array of 6 storing the results - (0 = minX; 1 = maxX; 2 = minY; 3 = maxY; 4 - minZ; 5 = maxZ). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01316">1316</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;{</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Finding new boundaries.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    </div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="comment">//================================================ If same bounds as first one are required, test if possible and return these instead</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a1f0d2cb45fee521ddb2d0bc30beff3ec">useSameBounds</a> &amp;&amp; ( this-&gt;inputOrder != 0 ) )</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    {</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 6; iter++ ) { ret[iter] = settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa3e24ef5a66fa7204a2ba9c27f2f12b9">forceBounds</a>[iter]; }</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    }</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="comment">//================================================ In this case, bounds need to be found de novo</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    {</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        <span class="comment">//============================================ Find the non-zero bounds</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ac2650a79c20be34894c23d73ffaae750">ProSHADE_internal_mapManip::getNonZeroBounds</a>  ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>,</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ),</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ),</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ),</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                                                        ret );</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        </div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        <span class="comment">//============================================ Add the extra space</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a7c88b1152378beca4ccee251f2fb5e06">ProSHADE_internal_mapManip::addExtraBoundSpace</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>,</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                                                         this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>, ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a633435d4c8a7fd6533016c00ad9ba791">boundsExtraSpace</a> );</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        </div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        <span class="comment">//============================================ Beautify boundaries</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aeb9acf2a6f2f23b72424f01417c9ead3">ProSHADE_internal_mapManip::beautifyBoundaries</a> ( ret, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a827e3241fa6401027e0526fffb8b281d">boundsSimilarityThreshold</a> );</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        <span class="comment">//============================================ Report function results</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        std::stringstream ssHlp;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        ssHlp &lt;&lt; <span class="stringliteral">&quot;New boundaries are: &quot;</span> &lt;&lt; ret[1] - ret[0] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; ret[3] - ret[2] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; ret[5] - ret[4] + 1;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, ssHlp.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <span class="comment">//============================================ If need be, save boundaries to be used for all other structure</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a1f0d2cb45fee521ddb2d0bc30beff3ec">useSameBounds</a> &amp;&amp; ( this-&gt;inputOrder == 0 ) )</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        {</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 6; iter++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa3e24ef5a66fa7204a2ba9c27f2f12b9">forceBounds</a>[iter] = ret[iter]; }</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        }</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    }</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;New boundaries determined.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    </div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    return ;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e1bd5bd5a3fd12691a1d83735c13250"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e1bd5bd5a3fd12691a1d83735c13250">&#9670;&nbsp;</a></span>getRecommendedSymmetryFold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_unsign ProSHADE_internal_data::ProSHADE_data::getRecommendedSymmetryFold </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function simply returns the detected recommended symmetry fold. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map manipulation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04395">4395</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;{</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;    <span class="keywordflow">return</span>                                            ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac8e62cc8dbd40265e51143c8207b6638">recommendedSymmetryFold</a> );</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;    </div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5add825ce8d5e5d9f598f6912f07aff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5add825ce8d5e5d9f598f6912f07aff">&#9670;&nbsp;</a></span>getRecommendedSymmetryType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string ProSHADE_internal_data::ProSHADE_data::getRecommendedSymmetryType </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function simply returns the detected recommended symmetry type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map manipulation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04384">4384</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;{</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;    <span class="keywordflow">return</span>                                            ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac39560ba9aca9053753c158fb2adb9de">recommendedSymmetryType</a> );</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;    </div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a688bac56d3c483bd99c0ff7d63cf7602"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a688bac56d3c483bd99c0ff7d63cf7602">&#9670;&nbsp;</a></span>getRotMatrixFromRotFunInds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::getRotMatrixFromRotFunInds </td>
          <td>(</td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>aI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>bI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>gI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rotMat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes rotation function indices, converts them to Euler angles and these to rotation matrix, which it then returns. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aI</td><td>The index along the Euler alpha dimension. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bI</td><td>The index along the Euler beta dimension. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gI</td><td>The index along the Euler gamma dimension. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotMat</td><td>The array to which the rotation matrix will be written into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>The lenght of the array (must be 9). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04352">4352</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;{</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;    <span class="comment">//================================================ Get Euler angles</span></div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;    proshade_double eA, eB, eG;</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#acf6c5376edac98e54ef0e418cd05d706">ProSHADE_internal_maths::getEulerZXZFromSOFTPosition</a> ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ), aI, bI, gI, &amp;eA, &amp;eB, &amp;eG );</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;    </div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;    <span class="comment">//================================================ Prepare internal rotation matrix memory</span></div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;    proshade_double* rMat                             = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;    rMat                                              = <span class="keyword">new</span> proshade_double[9];</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rMat, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;    </div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;    <span class="comment">//================================================ Convert to rotation matrix</span></div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a> ( eA, eB, eG, rMat );</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;    </div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;    <span class="comment">//================================================ Copy to output</span></div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;    {</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;        rotMat[iter]                                  = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( rMat[iter] );</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;    }</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;    </div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;    <span class="comment">//================================================ Release internal memory</span></div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;    <span class="keyword">delete</span>[] rMat;</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;    </div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;    return ;</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;    </div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afa35ae5ccd9d4b22bcc028f609cd1c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa35ae5ccd9d4b22bcc028f609cd1c3e">&#9670;&nbsp;</a></span>getRRPValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double ProSHADE_internal_data::ProSHADE_data::getRRPValue </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>sh1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>sh2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the priva internal RRP matrices. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>The value of the internal private RRP matrix for the given indices. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03621">3621</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;{</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>[band][sh1][sh2] );</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a898b48c1135e7a37f64f55e2367f0391"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a898b48c1135e7a37f64f55e2367f0391">&#9670;&nbsp;</a></span>getShellBandwidth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_unsign ProSHADE_internal_data::ProSHADE_data::getShellBandwidth </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>shell</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the bandwidth of a particular shell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">shell</td><td>The index of the shell for which the bandwidth is required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>The bandwidth of the requested shell. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03793">3793</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;{</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[shell]-&gt;getLocalBandwidth ( ) );</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;    </div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5c9c45b0db1e6a9eeef2ba292fbbcc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5c9c45b0db1e6a9eeef2ba292fbbcc3">&#9670;&nbsp;</a></span>getSO3Coeffs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_complex * ProSHADE_internal_data::ProSHADE_data::getSO3Coeffs </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the SO(3) coefficients array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>The internal SO(3) coefficients array variable. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03858">3858</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;{</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">so3Coeffs</a> );</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;    </div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a188b648a0ad28b598d682ca14f288dc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a188b648a0ad28b598d682ca14f288dc4">&#9670;&nbsp;</a></span>getSpherePositions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::getSpherePositions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function determines the sphere positions (radii) for sphere mapping. </p>
<p>This function determines the radii of the concentric spheres (as measured from the centre of the map). This is done by checking if these values have already been as and if not, then the radii are placed between points of the map starting between the centre point and its neighbours and then adding spheres until the most outlying diagonal point is covered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map manipulation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01746">1746</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;{</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <span class="comment">//================================================ Check the current settings value is set to auto</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>.size() != 0 )</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    {</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        std::stringstream hlpSS;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;The sphere distances were determined as &quot;</span> &lt;&lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>.at(0);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 1; iter &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>.size() ); iter++ ) { hlpSS &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>.at(iter); }</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot; Angstroms.&quot;</span>;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, hlpSS.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        return ;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    }</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    </div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="comment">//================================================ Find maximum diagonal</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    proshade_unsign maxDim                            = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( std::max ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, std::max ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> ) ) );</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    proshade_unsign minDim                            = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( std::min ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, std::min ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> ) ) );</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    proshade_unsign midDim                            = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( 0 );</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <span class="keywordflow">if</span>      ( ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a> &lt; <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( maxDim ) ) &amp;&amp; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a> &gt; <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( minDim ) ) ) { midDim = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a> ); }</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a> &lt; <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( maxDim ) ) &amp;&amp; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a> &gt; <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( minDim ) ) ) { midDim = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a> ); }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <span class="keywordflow">else</span>                                                                                                                                         { midDim = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> ); }</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    </div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    proshade_single maxDiag                           = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( std::sqrt ( std::pow ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( maxDim ), 2.0 ) +</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                                                                                                     std::pow ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( midDim ), 2.0 ) ) );</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    </div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">//================================================ Set between the points</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="keywordflow">for</span> ( proshade_single iter = 0.5f; ( iter * settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42e4b11981a2d3a518cb3c70e5470fb2">maxSphereDists</a> ) &lt; ( maxDiag / 2.0f ); iter += 1.0f )</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    {</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a2d19df22d740c51de6edafbf679ae3fd">ProSHADE_internal_misc::addToSingleVector</a>     ( &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>, ( iter * settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42e4b11981a2d3a518cb3c70e5470fb2">maxSphereDists</a> ) );</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    }</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    </div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <span class="comment">//================================================ Save the number of spheres</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>                                   = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>.size() );</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    </div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot;The sphere distances were determined as &quot;</span> &lt;&lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>.at(0);</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 1; iter &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>.size() ); iter++ ) { hlpSS &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>.at(iter); }</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot; Angstroms.&quot;</span>;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, hlpSS.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    </div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    return ;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160; </div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a38d47eb11eafa106c65867ceec62a3fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38d47eb11eafa106c65867ceec62a3fc">&#9670;&nbsp;</a></span>getSpherePosValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_single ProSHADE_internal_data::ProSHADE_data::getSpherePosValue </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>shell</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to sphere positions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">shell</td><td>The index of the sphere for which the position (radius) is to be obtained. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>The radius of the sphere with index shell. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03805">3805</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;{</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>.at(shell) );</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;    </div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0662f17e733fb6c1a16f04b273f8b7a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0662f17e733fb6c1a16f04b273f8b7a5">&#9670;&nbsp;</a></span>getSymmetryAxis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; ProSHADE_internal_data::ProSHADE_data::getSymmetryAxis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>axisNo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns a single symmetry axis as a vector of strings from the recommended symmetry axes list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axisNo</td><td>The index of the axis to be returned. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">val</td><td>A vector of strings containing the symmetry axis fold, x, y, z axis element, angle, peak height and averaged FSC in this order. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04419">4419</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;{</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;    <span class="comment">//================================================ Sanity checks</span></div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;    <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() ) &lt;= axisNo )</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;    {</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Requested symmetry index does not exist. Returning empty vector.&quot;</span>, <span class="stringliteral">&quot;WS00039&quot;</span> );</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;        <span class="keywordflow">return</span>                                        ( std::vector&lt; std::string &gt; ( ) );</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;    }</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;    </div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;    std::vector&lt; std::string &gt; ret;</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;    </div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;    <span class="comment">//================================================ Input the axis data as strings</span></div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;    std::stringstream ssHlp;</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[0];</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;    </div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[1];</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;    </div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[2];</div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;    </div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[3];</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;    </div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[4];</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;    </div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[5];</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;    </div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[6];</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;    </div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;    </div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a85bfab9b1babe0b35e6d81f525ead29b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85bfab9b1babe0b35e6d81f525ead29b">&#9670;&nbsp;</a></span>getTetrahedralSymmetriesList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; proshade_double * &gt; ProSHADE_internal_data::ProSHADE_data::getTetrahedralSymmetriesList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>CSymList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function obtains a list of all T symmetry axes from the already computed C symmetries list. </p>
<p>This function starts by checking if there are two C3 symmetries with the tetrahedral dihedral angle. If so, it proceeds to search for all seven symmetry axes expected to form a full tetrahedral symmetry. It then returns the list of found symmetries; if full tetrahedral symmetry was found, seven axes (four C3s and three C2s) are returned. If less than seven symmetries are returned, the procedure has failed and no tetrahedral symmetry was found.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CSymList</td><td>A vector containing the already detected Cyclic symmetries. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00422">422</a> of file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;{</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting T symmetry detection.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">//================================================ Are the basic requirements for tetrahedral symmetry met?</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a37925ac477480c718451debb01a9c74a">ProSHADE_internal_symmetry::detectTetrahedralSymmetry</a> ( CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) )</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="comment">//============================================ Search for all the symmetry axes</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5d4e5e34da6e4a9ed4a67cca16491c17">ProSHADE_internal_symmetry::findTetra4C3s</a>     ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 4 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5e5d3ccec33e4cf7204124a5647fe5c9">ProSHADE_internal_symmetry::findTetra3C2s</a>     ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 7 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign csIt = 0; csIt &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); csIt++ )</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign retIt = 0; retIt &lt; static_cast&lt;proshade_unsign&gt; ( ret.size() ); retIt++ )</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                    <span class="comment">//======================================== Sort ret by fold</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                    std::sort                                 ( ret.begin(), ret.end(), <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad14d6427df4269728627fcd880abaf31">ProSHADE_internal_misc::sortSymInvFoldHlp</a> );</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                    </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                    <span class="comment">//======================================== Save indices</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(csIt)[0] ), rhs1 ( ret.at(retIt)[0] );</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs2 ( CSymList-&gt;at(csIt)[1] ), rhs2 ( ret.at(retIt)[1] );</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs3 ( CSymList-&gt;at(csIt)[2] ), rhs3 ( ret.at(retIt)[2] );</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs4 ( CSymList-&gt;at(csIt)[3] ), rhs4 ( ret.at(retIt)[3] );</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs5 ( CSymList-&gt;at(csIt)[4] ), rhs5 ( ret.at(retIt)[4] );</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs6 ( CSymList-&gt;at(csIt)[5] ), rhs6 ( ret.at(retIt)[5] );</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    <span class="keywordflow">if</span> ( ( lhs1.AlmostEquals ( rhs1 ) ) &amp;&amp;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                         ( lhs2.AlmostEquals ( rhs2 ) ) &amp;&amp;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                         ( lhs3.AlmostEquals ( rhs3 ) ) &amp;&amp;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                         ( lhs4.AlmostEquals ( rhs4 ) ) &amp;&amp;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                         ( lhs5.AlmostEquals ( rhs5 ) ) &amp;&amp;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                         ( lhs6.AlmostEquals ( rhs6 ) ) )</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                    {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>, csIt );</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;T symmetry detection complete.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae27a3e92905ca9d5f9a32c4eaacc64ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae27a3e92905ca9d5f9a32c4eaacc64ae">&#9670;&nbsp;</a></span>getTranslationFnPointer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_complex * ProSHADE_internal_data::ProSHADE_data::getTranslationFnPointer </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the translation function through a pointer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">translationMap</td><td>Pointer to the first position in the translation function map array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04059">4059</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;{</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37f26ac4bc76e4f4c5da77dd0eace56e">translationMap</a> );</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5999f7181bd3509454966f8271ac39d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5999f7181bd3509454966f8271ac39d6">&#9670;&nbsp;</a></span>getWignerMatrixValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::getWignerMatrixValue </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>order1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>order2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>valueReal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>valueImag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the Wigner D matrix by knowing the band, order1 and order2 indices. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The band for which the Wigner D matrix value should be returned. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order1</td><td>The first order for which the Wigner D matrix value should be returned. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order2</td><td>The second order for which the Wigner D matrix value should be returned. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">valueReal</td><td>The proshade_double number pointer to where the real part of the value will be saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">valueImag</td><td>The proshade_double number pointer to where the imaginary part of the value will be saved. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03884">3884</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;{</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;    <span class="comment">//================================================ Set pointer</span></div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;    *valueReal                                        = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">wignerMatrices</a>[band][order1][order2][0];</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;    *valueImag                                        = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">wignerMatrices</a>[band][order1][order2][1];</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;    </div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;    return ;</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;    </div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a1405b3974697f41c4a73da0cb52a32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a1405b3974697f41c4a73da0cb52a32">&#9670;&nbsp;</a></span>getXAxisOrigin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_signed * ProSHADE_internal_data::ProSHADE_data::getXAxisOrigin </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the map X axis origin value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">xAxisOrigin</td><td>The value of X axis origin for the map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04019">4019</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;{</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a> );</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3bc44913222e67ab861dd1e5838c1ae1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bc44913222e67ab861dd1e5838c1ae1">&#9670;&nbsp;</a></span>getXDim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_unsign ProSHADE_internal_data::ProSHADE_data::getXDim </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the map size in indices along the X axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">xDimSize</td><td>The size of the internal map in indices along the X axis. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03929">3929</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;{</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> );</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a51d7b9d87d536ef0c48d820872bc9185"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51d7b9d87d536ef0c48d820872bc9185">&#9670;&nbsp;</a></span>getXDimSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_single ProSHADE_internal_data::ProSHADE_data::getXDimSize </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the map size in angstroms along the X axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">xDimSize</td><td>The size of the internal map in angstroms along the X axis. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03899">3899</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;{</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a> );</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4c89c860da1836b30a9b2889d3e873ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c89c860da1836b30a9b2889d3e873ed">&#9670;&nbsp;</a></span>getXFromPtr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_signed * ProSHADE_internal_data::ProSHADE_data::getXFromPtr </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the map start along the X axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">xFrom</td><td>Pointer to the starting index along the X axis. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03959">3959</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;{</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> );</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adf61c328db45fcd7692d13a8cde5e092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf61c328db45fcd7692d13a8cde5e092">&#9670;&nbsp;</a></span>getXToPtr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_signed * ProSHADE_internal_data::ProSHADE_data::getXToPtr </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the map last position along the X axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">xFrom</td><td>Pointer to the final index along the X axis. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03989">3989</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;{</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a> );</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a298bc9a6aae624a091cd97b842a6b618"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a298bc9a6aae624a091cd97b842a6b618">&#9670;&nbsp;</a></span>getYAxisOrigin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_signed * ProSHADE_internal_data::ProSHADE_data::getYAxisOrigin </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the map Y axis origin value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">yAxisOrigin</td><td>The value of Y axis origin for the map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04029">4029</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;{</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a> );</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a50c884973add562558803a45991bbf19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50c884973add562558803a45991bbf19">&#9670;&nbsp;</a></span>getYDim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_unsign ProSHADE_internal_data::ProSHADE_data::getYDim </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the map size in indices along the Y axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">xDimSize</td><td>The size of the internal map in indices along the Y axis. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03939">3939</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;{</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> );</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae477e3c0d7b866e6069d8603950afe51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae477e3c0d7b866e6069d8603950afe51">&#9670;&nbsp;</a></span>getYDimSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_single ProSHADE_internal_data::ProSHADE_data::getYDimSize </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the map size in angstroms along the Y axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">xDimSize</td><td>The size of the internal map in angstroms along the Y axis. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03909">3909</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;{</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a> );</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5f0d929d1e013cdd23e956d94b7a40da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f0d929d1e013cdd23e956d94b7a40da">&#9670;&nbsp;</a></span>getYFromPtr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_signed * ProSHADE_internal_data::ProSHADE_data::getYFromPtr </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the map start along the Y axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">yFrom</td><td>Pointer to the starting index along the Y axis. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03969">3969</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;{</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> );</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac859cbd21b93b9d2ed5f119f4ee57f3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac859cbd21b93b9d2ed5f119f4ee57f3f">&#9670;&nbsp;</a></span>getYToPtr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_signed * ProSHADE_internal_data::ProSHADE_data::getYToPtr </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the map last position along the Y axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">yFrom</td><td>Pointer to the final index along the Y axis. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03999">3999</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;{</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a> );</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeb0242051835b508e9af193dc40a697c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb0242051835b508e9af193dc40a697c">&#9670;&nbsp;</a></span>getZAxisOrigin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_signed * ProSHADE_internal_data::ProSHADE_data::getZAxisOrigin </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the map Z axis origin value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">zAxisOrigin</td><td>The value of Z axis origin for the map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04039">4039</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;{</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a> );</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a034af93b9152fb2db675d5632a4ebc6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a034af93b9152fb2db675d5632a4ebc6d">&#9670;&nbsp;</a></span>getZDim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_unsign ProSHADE_internal_data::ProSHADE_data::getZDim </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the map size in indices along the Z axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">xDimSize</td><td>The size of the internal map in indices along the Z axis. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03949">3949</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;{</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> );</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af4d641d62864e4adf67c1365b0960970"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4d641d62864e4adf67c1365b0960970">&#9670;&nbsp;</a></span>getZDimSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_single ProSHADE_internal_data::ProSHADE_data::getZDimSize </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the map size in angstroms along the Z axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">xDimSize</td><td>The size of the internal map in angstroms along the Z axis. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03919">3919</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;{</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> );</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afbbcec01a6ee7701e3b1d0e61730fadf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbbcec01a6ee7701e3b1d0e61730fadf">&#9670;&nbsp;</a></span>getZFromPtr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_signed * ProSHADE_internal_data::ProSHADE_data::getZFromPtr </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the map start along the Z axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">zFrom</td><td>Pointer to the starting index along the Z axis. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03979">3979</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;{</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> );</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a68eb739dd4846a1dd48032eb2cc3f49c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68eb739dd4846a1dd48032eb2cc3f49c">&#9670;&nbsp;</a></span>getZToPtr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_signed * ProSHADE_internal_data::ProSHADE_data::getZToPtr </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows access to the map last position along the Z axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">zFrom</td><td>Pointer to the final index along the Z axis. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04009">4009</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;{</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a> );</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9d11953ff54d5774659117be22bdb3b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d11953ff54d5774659117be22bdb3b3">&#9670;&nbsp;</a></span>interpolateMapFromSpheres()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::interpolateMapFromSpheres </td>
          <td>(</td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>densityMapRotated</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function interpolates the density map from the sphere mapped data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">densityMapRotated</td><td>The pointer to allocated memory where the new map values will be held. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l01114">1114</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;{</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    proshade_double rad = 0.0, lon = 0.0, lat = 0.0, newU = 0.0, newV = 0.0, newW = 0.0;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    proshade_unsign lowerLonL = 0, upperLonL = 0, lowerLonU = 0, upperLonU = 0, lowerLatL = 0, upperLatL = 0, lowerLatU = 0, upperLatU = 0, lowerShell = 0, upperShell = 0;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    proshade_double x00 = 0.0, x01 = 0.0, x10 = 0.0, x11 = 0.0, distLLon = 0.0, distLLat = 0.0, distLRad = 0.0, valLLon = 0.0, valULon = 0.0;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    proshade_double lowerShellValue = 0.0, upperShellValue = 0.0;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    proshade_double xSamplingRate                     = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a> ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> );</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    proshade_double ySamplingRate                     = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a> ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> );</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    proshade_double zSamplingRate                     = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> );</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    proshade_signed arrPos;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    std::vector&lt;proshade_double&gt; lonCOU, latCOU, lonCOL, latCOL;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed uIt = 0; uIt &lt; static_cast&lt;proshade_signed&gt; (this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>); uIt++ )</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed vIt = 0; vIt &lt; static_cast&lt;proshade_signed&gt; (this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>); vIt++ )</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        {</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed wIt = 0; wIt &lt; static_cast&lt;proshade_signed&gt; (this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>); wIt++ )</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                <span class="comment">//==================================== Convert to centered coords</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                newU                                  = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( uIt - ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> (this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>) / 2 ) );</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                newV                                  = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( vIt - ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> (this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>) / 2 ) );</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                newW                                  = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( wIt - ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> (this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>) / 2 ) );</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                <span class="comment">//==================================== Deal with 0 ; 0 ; 0</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                <span class="keywordflow">if</span> ( ( newU == 0.0 ) &amp;&amp; ( newV == 0.0 ) &amp;&amp; ( newW == 0.0 ) )</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                {</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                    arrPos                            = wIt + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( vIt + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * uIt );</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                    densityMapRotated[arrPos]         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[arrPos];</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                <span class="comment">//==================================== Convert to spherical coords</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                rad                                   = sqrt  ( pow( ( newU * xSamplingRate ), 2.0 ) +</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                                                                pow( ( newV * ySamplingRate ), 2.0 ) +</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                                                                pow( ( newW * zSamplingRate ), 2.0 ) );</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                lon                                   = atan2 ( ( newV * ySamplingRate ), ( newU * xSamplingRate ) );</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                lat                                   = asin  ( ( newW * zSamplingRate ) / rad );</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                <span class="comment">//==================================== Deal with nan&#39;s</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                <span class="keywordflow">if</span> ( rad   != rad ) { rad   = 0.0; }</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                <span class="keywordflow">if</span> ( lon   != lon ) { lon   = 0.0; }</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                <span class="keywordflow">if</span> ( lat   != lat ) { lat   = 0.0; }</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                                </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                <span class="comment">//==================================== Find shells above and below</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                lowerShell                            = 0;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                upperShell                            = 0;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; (this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>-1); iter++ )</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                    <span class="keywordflow">if</span> ( ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>.at(iter) ) &lt;= rad ) &amp;&amp; ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>.at(iter+1) ) &gt; rad ) )</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                    {</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                        lowerShell                    = iter;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                        upperShell                    = iter+1;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                    }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                }</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                </div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                <span class="keywordflow">if</span> ( upperShell == 0 )</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                {</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                    arrPos                            = wIt + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( vIt + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * uIt );</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                    densityMapRotated[arrPos]         = 0.0;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                <span class="comment">//==================================== Get the longitude and lattitude cut-offs for this shell resolution</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                lonCOL.clear(); latCOL.clear(); lonCOU.clear(); latCOU.clear();</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a78c51dc39b75ffb4731c7219b25e290b">ProSHADE_internal_overlay::computeAngularThreshold</a> ( &amp;lonCOL, &amp;latCOL, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[lowerShell]-&gt;getLocalAngRes() );</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a78c51dc39b75ffb4731c7219b25e290b">ProSHADE_internal_overlay::computeAngularThreshold</a> ( &amp;lonCOU, &amp;latCOU, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[upperShell]-&gt;getLocalAngRes() );</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                </div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                <span class="comment">//==================================== Find the angle cutoffs around the point</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( lonCOL.size() ); iter++ )</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                {</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                    <span class="keywordflow">if</span> ( iter == ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( lonCOL.size() ) - 1 ) )</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                    {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                        lowerLonL                     = 0;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                        upperLonL                     = 1;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                    }</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                    <span class="keywordflow">if</span> ( ( std::floor(10000. * lonCOL.at(iter)) &lt;= std::floor(10000. * lon) ) &amp;&amp; ( std::floor(10000. * lonCOL.at(iter+1)) &gt; std::floor(10000. * lon) ) )</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                    {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                        lowerLonL                     = iter;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                        upperLonL                     = iter+1;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                    }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                <span class="keywordflow">if</span> ( upperLonL == this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[lowerShell]-&gt;getLocalAngRes() ) { upperLonL = 0; }</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                </div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( lonCOU.size() ); iter++ )</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                {</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                    <span class="keywordflow">if</span> ( iter == ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( lonCOU.size() ) - 1 ) )</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                    {</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                        lowerLonU                     = 0;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                        upperLonU                     = 1;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                    }</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                    <span class="keywordflow">if</span> ( ( std::floor(10000. * lonCOU.at(iter)) &lt;= std::floor(10000. * lon) ) &amp;&amp; ( std::floor(10000. * lonCOU.at(iter+1)) &gt; std::floor(10000. * lon) ) )</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                    {</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                        lowerLonU                     = iter;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                        upperLonU                     = iter+1;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                    }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                }</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                <span class="keywordflow">if</span> ( upperLonU == this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[upperShell]-&gt;getLocalAngRes() ) { upperLonU = 0; }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( latCOL.size() ); iter++ )</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                {</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                    <span class="keywordflow">if</span> ( iter == ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( latCOL.size() ) - 1 ) )</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                    {</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                        lowerLatL                     = 0;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                        upperLatL                     = 1;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                    }</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                    <span class="keywordflow">if</span> ( ( std::floor(10000. * latCOL.at(iter)) &lt;=  std::floor(10000. * lat) ) &amp;&amp; ( std::floor(10000. * latCOL.at(iter+1)) &gt; std::floor(10000. * lat) ) )</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                    {</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                        lowerLatL                     = iter;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                        upperLatL                     = iter+1;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                    }</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                }</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                <span class="keywordflow">if</span> ( upperLatL == this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[lowerShell]-&gt;getLocalAngRes() ) { upperLatL = 0; }</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                </div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( latCOU.size() ); iter++ )</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                {</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                    <span class="keywordflow">if</span> ( iter == ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( latCOU.size() ) - 1 ) )</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                    {</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                        lowerLatU                     = 0;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                        upperLatU                     = 1;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                    }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                    <span class="keywordflow">if</span> ( ( std::floor(10000. * latCOU.at(iter)) &lt;=  std::floor(10000. * lat) ) &amp;&amp; ( std::floor(10000. * latCOU.at(iter+1)) &gt; std::floor(10000. * lat) ) )</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                    {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                        lowerLatU                     = iter;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                        upperLatU                     = iter+1;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                    }</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                <span class="keywordflow">if</span> ( upperLatU == this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[upperShell]-&gt;getLocalAngRes() ) { upperLatU = 0; }</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                </div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                <span class="comment">//==================================== Interpolate lower shell</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                x00                                   = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[lowerShell]-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#aca3c4a9ccce4508de9e292c4628d703e">getRotatedMappedData</a> ( lowerLatL * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[lowerShell]-&gt;getLocalAngRes() + lowerLonL );</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                x01                                   = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[lowerShell]-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#aca3c4a9ccce4508de9e292c4628d703e">getRotatedMappedData</a> ( lowerLatL * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[lowerShell]-&gt;getLocalAngRes() + upperLonL );</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                x10                                   = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[lowerShell]-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#aca3c4a9ccce4508de9e292c4628d703e">getRotatedMappedData</a> ( upperLatL * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[lowerShell]-&gt;getLocalAngRes() + lowerLonL );</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                x11                                   = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[lowerShell]-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#aca3c4a9ccce4508de9e292c4628d703e">getRotatedMappedData</a> ( upperLatL * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[lowerShell]-&gt;getLocalAngRes() + upperLonL );</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                        </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                distLLon                              = std::abs ( lon - lonCOL.at(lowerLonL) ) / ( std::abs( lon - lonCOL.at(lowerLonL) ) + std::abs( lon - lonCOL.at(upperLonL) ) );</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                valLLon                               = ( ( 1.0 - distLLon ) * x00 ) + ( distLLon * x01 );</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                valULon                               = ( ( 1.0 - distLLon ) * x10 ) + ( distLLon * x11 );</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                        </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                distLLat                              = std::abs ( lat - latCOL.at(lowerLatL) ) / ( std::abs( lat - latCOL.at(lowerLatL) ) + std::abs( lat - latCOL.at(upperLatL) ) );</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                lowerShellValue                       = ( ( 1.0 - distLLat ) * valLLon ) + ( distLLat * valULon );</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                <span class="comment">//==================================== Interpolate upper shell</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                x00                                   = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[upperShell]-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#aca3c4a9ccce4508de9e292c4628d703e">getRotatedMappedData</a> ( lowerLatU * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[upperShell]-&gt;getLocalAngRes() + lowerLonU );</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                x01                                   = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[upperShell]-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#aca3c4a9ccce4508de9e292c4628d703e">getRotatedMappedData</a> ( lowerLatU * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[upperShell]-&gt;getLocalAngRes() + upperLonU );</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                x10                                   = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[upperShell]-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#aca3c4a9ccce4508de9e292c4628d703e">getRotatedMappedData</a> ( upperLatU * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[upperShell]-&gt;getLocalAngRes() + lowerLonU );</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                x11                                   = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[upperShell]-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#aca3c4a9ccce4508de9e292c4628d703e">getRotatedMappedData</a> ( upperLatU * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[upperShell]-&gt;getLocalAngRes() + upperLonU );</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                        </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                distLLon                              = std::abs ( lon - lonCOU.at(lowerLonU) ) / ( std::abs( lon - lonCOU.at(lowerLonU) ) + std::abs( lon - lonCOU.at(upperLonU) ) );</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                valLLon                               = ( ( 1.0 - distLLon ) * x00 ) + ( distLLon * x01 );</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                valULon                               = ( ( 1.0 - distLLon ) * x10 ) + ( distLLon * x11 );</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                        </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                distLLat                              = std::abs ( lat - latCOU.at(lowerLatU) ) / ( std::abs( lat - latCOU.at(lowerLatU) ) + std::abs( lat - latCOU.at(upperLatU) ) );</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                upperShellValue                       = ( ( 1.0 - distLLat ) * valLLon ) + ( distLLat * valULon );</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                <span class="comment">//==================================== Interpolate between shells</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                distLRad                              = std::abs ( rad - <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>.at(lowerShell) ) ) / ( std::abs( rad - <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>.at(lowerShell) ) ) +</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                                                                                              std::abs( rad - <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>.at(upperShell) ) ) );</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                </div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                arrPos                                = wIt + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( vIt + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * uIt );</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                densityMapRotated[arrPos]             = ( ( 1.0 - distLRad ) * lowerShellValue ) + ( distLRad * upperShellValue );</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            }</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;     </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        }</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    }</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    </div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    return ;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;     </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa67115a6b234764c958899863fb60b54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa67115a6b234764c958899863fb60b54">&#9670;&nbsp;</a></span>invertMirrorMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::invertMirrorMap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for inverting the map to its mirror image. </p>
<p>This function switches all index values along the three axes from 0 ... max to max ... 0. This should not normally be done, but in the case where the wrong hand has been used in the map re-construction process, this may be helpful.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for reading in the map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01175">1175</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;{</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map inversion.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    proshade_signed arrayPos, invPos;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    </div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="comment">//================================================ Create helper map</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    proshade_double* hlpMap                           = <span class="keyword">new</span> proshade_double [this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( hlpMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    </div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="comment">//================================================ Save map values to the helper map</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ )</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        hlpMap[iter]                                  = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter];</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    }</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="comment">//================================================ Invert the values</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed xIt = 0; xIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ); xIt++ )</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    {</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed yIt = 0; yIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ); yIt++ )</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        {</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed zIt = 0; zIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); zIt++ )</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;            {</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                <span class="comment">//==================================== Var init</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                arrayPos                              = zIt + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( yIt + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * xIt );</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                invPos                                = ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> - 1 ) - zIt ) + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> - 1 ) - yIt ) + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> - 1 ) - xIt ) );</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                </div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                <span class="comment">//==================================== And save</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[invPos]             = hlpMap[arrayPos];</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            }</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    }</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keyword">delete</span>[] hlpMap;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Map inversion completed.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    return ;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3dbae1c18d0550ee1940cadb5335684"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3dbae1c18d0550ee1940cadb5335684">&#9670;&nbsp;</a></span>invertSHCoefficients()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::invertSHCoefficients </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the shell mapped data from inverting the Spherical Harmonics coefficients. </p>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l01021">1021</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;{</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keywordtype">double</span> *sigR =  <span class="keyword">nullptr</span>, *sigI =  <span class="keyword">nullptr</span>, *rcoeffs =  <span class="keyword">nullptr</span>, *icoeffs =  <span class="keyword">nullptr</span>, *weights =  <span class="keyword">nullptr</span>, *workspace =  <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    fftw_plan idctPlan, ifftPlan;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="comment">//================================================ For each shell</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> shell = 0; shell &lt; static_cast&lt;int&gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a> ); shell++ )</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;     {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;         <span class="comment">//=========================================== Initialise internal variables</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;         proshade_unsign oneDim                       = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[shell]-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#a331955e5674dd112f83402375dce7bc5">getLocalBandwidth</a>() * 2;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;         </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;         <span class="comment">//=========================================== Allocate memory</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;         <a class="code" href="namespace_pro_s_h_a_d_e__internal__overlay.html#ac173210899aeeae2e207f9acdd7670a7">ProSHADE_internal_overlay::initialiseInverseSHComputation</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[shell]-&gt;getLocalBandwidth(), sigR, sigI, rcoeffs, icoeffs, weights, workspace, idctPlan, ifftPlan );</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;         </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;         <span class="comment">//=========================================== Compute weights for the transform using the appropriate shell related band</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;         makeweights                                  ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[shell]-&gt;getLocalBandwidth() ), weights );</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;         </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;         <span class="comment">//============================================ Allocate rotated shell mapped data memory</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;         this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[shell]-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#a125477466283ee2e9b30d0299fc8e501">allocateRotatedMap</a>     ( );</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;         </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;         <span class="comment">//============================================ Load SH coeffs to arrays</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iter = 0; iter &lt; static_cast&lt;unsigned int&gt; ( oneDim * oneDim ); iter++ )</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;         {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;             rcoeffs[iter]                            = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94b04108aa1a9406eb3c5eb61749140b">rotSphericalHarmonics</a>[shell][iter][0];</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;             icoeffs[iter]                            = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94b04108aa1a9406eb3c5eb61749140b">rotSphericalHarmonics</a>[shell][iter][1];</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;             sigR[iter]                               = 0.0;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;             sigI[iter]                               = 0.0;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;         }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;         </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;         <span class="comment">//============================================ Get inverse spherical harmonics transform for the shell</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;         InvFST_semi_fly                              ( rcoeffs,</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                                                        icoeffs,</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                                                        sigR,</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                                                        sigI,</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[shell]-&gt;getLocalBandwidth() ),</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                                                        workspace,</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                                                        0,</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[shell]-&gt;getLocalBandwidth() ),</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                                                        &amp;idctPlan,</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                                                        &amp;ifftPlan );</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;         </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;         <span class="comment">//=========================================== Copy the results to the rotated shells array</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iter = 0; iter &lt; static_cast&lt;unsigned int&gt; ( oneDim * oneDim ); iter++ )</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;         {</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;             this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[shell]-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#a050b2c9c5a64d16fb47257f9abb19c8b">setRotatedMappedData</a> ( iter, sigR[iter] );</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;         }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;         </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;         <span class="comment">//=========================================== Release the plans</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;         fftw_destroy_plan ( idctPlan );</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;         fftw_destroy_plan ( ifftPlan );</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;         </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;         <span class="comment">//=========================================== Release the memory</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;         <span class="keyword">delete</span>[] sigR;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;         <span class="keyword">delete</span>[] rcoeffs;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;         <span class="keyword">delete</span>[] weights;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;         <span class="keyword">delete</span>[] workspace;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;     }</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;     <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;     return ;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;     </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a56bfcfacedabd84ec54aa2843d59e014"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56bfcfacedabd84ec54aa2843d59e014">&#9670;&nbsp;</a></span>mapToSpheres()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::mapToSpheres </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function converts the internal map onto a set of concentric spheres. </p>
<p>This function starts by determining the spherical harmonics values which were not supplied by the user, these may be bandwidth, taylor series cap, integration order, etc. It then proceeds to determine the optimal sphere distances, unless these were determined by the user.</p>
<p>Finally, the function creates a new instance of the ProSHADE_sphere class for each of the already determined sphere positions. Note: The constructor of ProSHADE_sphere is where the mapping then happens.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map manipulation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01803">1803</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;{</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting sphere mapping procedure.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    </div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="comment">//================================================ Determine spherical harmonics variables</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a450e03005d24cc3e58d2d05fb3bc5027">determineAllSHValues</a>                    ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>,</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>,    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>,    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> );</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Sphere settings determined.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="comment">//================================================ Find number of spheres supported</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a188b648a0ad28b598d682ca14f288dc4">getSpherePositions</a>                          ( settings );</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Sphere positions obtained.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    </div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="comment">//================================================ Create sphere objects and map the density</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>                                     = <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html">ProSHADE_internal_spheres::ProSHADE_sphere</a>* [ this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a> ];</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>.size() ); iter++ )</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    {</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;        ss &lt;&lt; <span class="stringliteral">&quot;Now mapping sphere &quot;</span> &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot; .&quot;</span>;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, ss.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        </div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[iter]                           = <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html">ProSHADE_internal_spheres::ProSHADE_sphere</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>,</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                                                                                                         this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>, iter,</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                                                                                                        &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2f1e4debc49664de8842d1b42be74d2d">progressiveSphereMapping</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a8324ed7ec9c19df21511f117df80ab11">maxBandwidth</a>,</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                                                                                                         this-&gt;internalMap, &amp;this-&gt;maxShellBand );</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    }</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Sphere mapping procedure completed.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    </div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    return ;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    </div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0122be830893f5d82bab742be54d1ee7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0122be830893f5d82bab742be54d1ee7">&#9670;&nbsp;</a></span>maskMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::maskMap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for computing the map mask using blurring and X IQRs from median. </p>
<p>This function takes all the internal map representation information from the calling object and the internal map itself and proceeds to write all this information in MRC MAP format for visualisation and further processing by other software. It is dependent on the internal information being correct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for reading in the map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01276">1276</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;{</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Computing mask.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="comment">//================================================ Initialise the blurred map</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    proshade_double* blurredMap                       = <span class="keyword">new</span> proshade_double[this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( blurredMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    </div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="comment">//================================================ Compute blurred map</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#afdac8ed8f140bdcd289ee666b61789d4">ProSHADE_internal_mapManip::blurSharpenMap</a>        ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, blurredMap, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>,</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a51c87d0b415c8eaa517dbb9b5496e7e9">blurFactor</a> );</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="comment">//================================================ Compute mask from blurred map and save it into the original map</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a42699d52d1be0d24e58deea4e25439bf">ProSHADE_internal_mapManip::getMaskFromBlurr</a>      ( blurredMap, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7c96697585083a53f83556e70e4faca8">maskingThresholdIQRs</a> );</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="comment">//================================================ Print the mask if need be</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a29445fb6221eed35a32147814a3f58d5">saveMask</a> ) {  <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#affb17d9099f0b85b3af04a78d5c670f4">maskFileName</a> == <span class="stringliteral">&quot;&quot;</span> ) { this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aac87b1a87f32a742ea2b41014dac5f7b">writeMask</a> ( <span class="stringliteral">&quot;proshade_mask.map&quot;</span>, blurredMap ); } <span class="keywordflow">else</span> { std::stringstream ss; ss &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#affb17d9099f0b85b3af04a78d5c670f4">maskFileName</a> &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ab4a34f3a42c17f923ef131c64b4a7">inputOrder</a> &lt;&lt; <span class="stringliteral">&quot;.map&quot;</span>; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aac87b1a87f32a742ea2b41014dac5f7b">writeMask</a> ( ss.str(), blurredMap ); } }</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    </div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="keyword">delete</span>[] blurredMap;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Mask computed.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    return ;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aceb19c915cebcef22c085cc6619cc472"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aceb19c915cebcef22c085cc6619cc472">&#9670;&nbsp;</a></span>normaliseEMatrixValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::normaliseEMatrixValue </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>order1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>order2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>normF</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows normalising the E matrix value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The band indice of the E matrix to which the value should be assigned. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order1</td><td>The first order indice of the E matrix to which the value should be assigned. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order2</td><td>The second order indice of the E matrix to which the value should be assigned. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">normF</td><td>The value by which the original E matrix value will be divided to normalise it. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04136">4136</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;{</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[band][order1][order2][0]         /= normF;</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[band][order1][order2][1]         /= normF;</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;    </div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;    return ;</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;    </div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a255bdb77824ce0fddc2454d5823219e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a255bdb77824ce0fddc2454d5823219e1">&#9670;&nbsp;</a></span>normaliseMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::normaliseMap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for normalising the map values to mean 0 and sd 1.. </p>
<p>This function takes the map and changes its value to have mean 0 and standard deviation of 1. This should make wo maps with very different density levels more comparable, but it remains to be seen if this causes any trouble. Can be turned off using the settings options.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for reading in the map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01229">1229</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;{</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map normalisation.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="comment">//================================================ Initialise vector of map values</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    std::vector&lt;proshade_double&gt; mapVals              ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>, 0.0 );</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="comment">//================================================ Get all map values</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ )</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    {</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        mapVals.at(iter)                              = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter];</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    }</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="comment">//================================================ Get mean and sd</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    proshade_double* meanSD                           = <span class="keyword">new</span> proshade_double[2];</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a8a7c6330e101fb6d729aaf6f545db9c8">ProSHADE_internal_maths::vectorMeanAndSD</a>          ( &amp;mapVals, meanSD );</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    </div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="comment">//================================================ Normalise the values</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ )</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    {</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter]                       = ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter] - meanSD[0] ) / meanSD[1];</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    </div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="comment">//================================================ Clear the vector</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    mapVals.clear                                     ( );</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="keyword">delete</span>[] meanSD;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    </div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Map normalisation completed.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    return ;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acf2c2c9634a9e641270f8889624c3752"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf2c2c9634a9e641270f8889624c3752">&#9670;&nbsp;</a></span>prepareFSCFourierMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::prepareFSCFourierMemory </td>
          <td>(</td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>mapData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>origCoeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>fCoeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&amp;&#160;</td>
          <td class="paramname"><em>binIndexing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>noBins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double **&amp;&#160;</td>
          <td class="paramname"><em>bindata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&amp;&#160;</td>
          <td class="paramname"><em>binCounts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan *&#160;</td>
          <td class="paramname"><em>planForwardFourier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>fscByBin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allocates the memory and makes all preparations required for FSC computation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mapData</td><td>The input array for Fourier transform. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">origCoeffs</td><td>The array for holding the Fourier coefficients of the original (non-rotated) density. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fCoeffs</td><td>The array for holding the results of Fourier transform. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">binIndexing</td><td>A map that will be filled with binning indices for fast binning. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noBins</td><td>The number of bins will be stored in this variable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bindata</td><td>An array to store the bin sums and other FSC computation temporary results. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">binCounts</td><td>An array that will be used to store the number of reflactions in each bin. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fscByBin</td><td>This array will hold FSC values for each bin. This is useful in further computations, but could be internal for FSC only computation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l02320">2320</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;{</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    <span class="comment">//================================================ Decide number of bins and allocate which reflection belongs to which bin</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#aa2702798938d50ec2a55e46cbc31333e">ProSHADE_internal_maths::binReciprocalSpaceReflections</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>, noBins, binIndexing );</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    </div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    <span class="comment">//================================================ Allocate memory for FSC sums</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    bindata                                           = <span class="keyword">new</span> proshade_double*[*noBins];</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    binCounts                                         = <span class="keyword">new</span> proshade_signed [*noBins];</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    fscByBin                                          = <span class="keyword">new</span> proshade_double [*noBins];</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    </div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    <span class="comment">//================================================ Allcate memory for bin sumation</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> binIt = 0; binIt &lt; static_cast&lt; size_t &gt; ( *noBins ); binIt++ )</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    {</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        bindata[binIt]                                = <span class="keyword">new</span> proshade_double[12];</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( bindata[binIt], __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    }</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    </div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <span class="comment">//================================================ Allocate memory for Fourier transform imputs and outputs</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    mapData                                           = <span class="keyword">new</span> fftw_complex [this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    origCoeffs                                        = <span class="keyword">new</span> fftw_complex [this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    fCoeffs                                           = <span class="keyword">new</span> fftw_complex [this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    </div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    <span class="comment">//================================================ Check memory allocation</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( mapData,       __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( origCoeffs,    __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( fCoeffs,       __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( bindata,       __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( binCounts,     __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( fscByBin,      __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    </div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;    <span class="comment">//================================================ Prepare memory for Fourier transform</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;   *planForwardFourier                                = fftw_plan_dft_3d ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ), mapData, fCoeffs, FFTW_FORWARD,  FFTW_ESTIMATE );</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    </div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    <span class="comment">//================================================ Compute Fourier transform of the original map</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; static_cast&lt; size_t &gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ ) { mapData[iter][0] = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter]; mapData[iter][1] = 0.0; }</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    fftw_execute                                      ( *planForwardFourier );</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; static_cast&lt; size_t &gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ ) { origCoeffs[iter][0] = fCoeffs[iter][0]; origCoeffs[iter][1] = fCoeffs[iter][1]; }</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    </div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    return ;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    </div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afcb4202e9ffea1b99c59f73faf06d899"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcb4202e9ffea1b99c59f73faf06d899">&#9670;&nbsp;</a></span>processInternalMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::processInternalMap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function simply clusters several other functions which should be called together. </p>
<p>This function serves to cluster the map normalisation, map masking, map centering and map extra space addition into a single function. This allows for simpler code and does not take any control away, as all the decisions are ultimately driven by the settings. This function also shifts the map so that its centre of box is at the desired position.</p>
<p>This function also does some internal value saving and auto-determination of any parameters that the user did not supply. This, however, means, that this function MUST be called for every structure that is to be processed by ProSHADE. This is of importance to people whe want to use only a perticular functions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map manipulation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>This function MUST be called on any structure that is to be processed by ProSHADE. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01695">1695</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;{</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="comment">//================================================ Move given point to box centre</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <span class="keywordflow">if</span> ( !( ( std::isinf ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(0) ) ) || ( std::isinf ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(1) ) ) || ( std::isinf ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(2) ) ) ) ) { this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7e36b0876ff78682480a8ec22f3f5264">shiftToBoxCentre</a> ( settings ); }</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map left at original position.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> ); }</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    </div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="comment">//================================================ Shift map to centre of rotation if so required</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="keywordflow">if</span> ( !( ( std::isinf ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6f93b0061117d6bb3fc8cea3c4314957">centrePosition</a>.at(0) ) ) || ( std::isinf ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6f93b0061117d6bb3fc8cea3c4314957">centrePosition</a>.at(1) ) ) || ( std::isinf ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6f93b0061117d6bb3fc8cea3c4314957">centrePosition</a>.at(2) ) ) ) ) { this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad8694002911669527ca6266c66285d57">shiftToRotationCentre</a> ( settings ); }</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map rotation centre not shifted.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> ); }</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    </div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <span class="comment">//================================================ Invert map</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0d205c102e722997ab1f0953f76a288a">invertMap</a> ) { this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa67115a6b234764c958899863fb60b54">invertMirrorMap</a> ( settings ); }</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map inversion (mirror image) not requested.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> ); }</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160; </div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="comment">//================================================ Normalise map</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0d796061e73e8635f75fc6921b98ad66">normaliseMap</a> ) { this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a255bdb77824ce0fddc2454d5823219e1">normaliseMap</a> ( settings ); }</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map normalisation not requested.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> ); }</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; </div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="comment">//================================================ Compute mask</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7c941c912cd17ad86057b8d7a15b9a21">maskMap</a> ) { this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0122be830893f5d82bab742be54d1ee7">maskMap</a> ( settings ); }</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Masking not requested.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> ); }</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160; </div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="comment">//================================================ Centre map</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a37c9037721c1ad28ad6421a31dbcd8d8">moveToCOM</a> ) { this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a80ff45ef40549fb6a1d80b70865fc807">centreMapOnCOM</a> ( settings ); }</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map centering not requested.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> ); }</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="comment">//================================================ Remove phase, if required</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <span class="keywordflow">if</span> ( !settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2019a6bae1b3e6f7d8805ae2734b769e">usePhase</a> ) { this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5919acc2f26efcf373db47ed96eadc38">removePhaseInormation</a> ( settings ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Phase information removed from the data.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> ); }</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Phase information retained in the data.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> ); }</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    </div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="comment">//================================================ Add extra space</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">addExtraSpace</a> != 0.0f ) { this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7a402c710af1af5fabf7505848dad047">addExtraSpace</a> ( settings ); }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Extra space not requested.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> ); }</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    </div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="comment">//================================================ Set settings values which were left on AUTO by user and will not be set later</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a192954646aa4b895b5fc522e79ea38cf">setVariablesLeftOnAuto</a>                  ( );</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        </div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    return ;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    </div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af8dcc353f075b824d2f3479f487c8bd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8dcc353f075b824d2f3479f487c8bd0">&#9670;&nbsp;</a></span>readInGemmi()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::readInGemmi </td>
          <td>(</td>
          <td class="paramtype">gemmi::Structure&#160;</td>
          <td class="paramname"><em>gemmiStruct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function for reading co-ordinate data from Gemmi object. </p>
<p>This function processes the input Gemmi structure into ProSHADE internal map. It starts with ProSHADE optional modifications of the co-ordinates (i.e. setting all B-factors to given value and removing waters). It then proceeds to move the co-ordinates so that their minimal point is at position [20, 20, 20] (this is to make sure map density will be at the centre of the box) and computes the theoretical density map using Gemmi's Cromer &amp; Libermann method. It then moves the map box to the original co-ordinates position.</p>
<p>If map re-sampling is required, then this is done here as well.</p>
<p>Finally, this function sets all the ProSHADE internal values to what other functions expect and terminates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for reading in the map.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>For multiple models, this function works, but the map is not perfectly fitted to the PDB file. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l00735">735</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;{</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="comment">//================================================ Set resolution if need be</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a> &lt; 0.0f )</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3e7f4174b62aa402a1f6d3becd8e9dd5">setResolution</a>                       ( 8.0 );</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">//================================================ Change B-factors if need be</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3cac1bd635aabf3a3370fc26dfa0f49a">pdbBFactorNewVal</a> &gt;= 0.0 )</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#afe3659ed2939880f96701cb162d8a12d">ProSHADE_internal_mapManip::changePDBBFactors</a> ( &amp;gemmiStruct, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3cac1bd635aabf3a3370fc26dfa0f49a">pdbBFactorNewVal</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">firstModelOnly</a> );</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="comment">//================================================ Remove waters if required</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#acea4abeec3e2b45524e23809a69dce9d">removeWaters</a> )</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a8993520350e1eab8f3eb041c8115cac5">ProSHADE_internal_mapManip::removeWaters</a>      ( &amp;gemmiStruct, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">firstModelOnly</a> );</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    }</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">//================================================ Get PDB COM values</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    proshade_double xCOMPdb, yCOMPdb, zCOMPdb;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a3d107e20dfeb5b5442fc3d0ba70bf2ef">ProSHADE_internal_mapManip::findPDBCOMValues</a>      ( gemmiStruct, &amp;xCOMPdb, &amp;yCOMPdb, &amp;zCOMPdb, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">firstModelOnly</a> );</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">//================================================ Find the ranges</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    proshade_single xF = 0.0f, xT = 0.0f, yF = 0.0f, yT = 0.0f, zF = 0.0f, zT = 0.0f;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ad4feb37444a93df167935cf42d1209f6">ProSHADE_internal_mapManip::determinePDBRanges</a>    ( gemmiStruct, &amp;xF, &amp;xT, &amp;yF, &amp;yT, &amp;zF, &amp;zT, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">firstModelOnly</a> );</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="comment">//================================================ Move ranges to have all FROM values 20</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    proshade_single xMov                              = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a31fb6004cbb5a70ad3c3e6aeb1816780">coOrdsExtraSpace</a> - xF );</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    proshade_single yMov                              = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a31fb6004cbb5a70ad3c3e6aeb1816780">coOrdsExtraSpace</a> - yF );</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    proshade_single zMov                              = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a31fb6004cbb5a70ad3c3e6aeb1816780">coOrdsExtraSpace</a> - zF );</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a1f9e6ab7a6db084069402d83ad152c01">ProSHADE_internal_mapManip::movePDBForMapCalc</a>     ( &amp;gemmiStruct, xMov, yMov, zMov, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">firstModelOnly</a> );</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="comment">//================================================ Set the angstrom sizes</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>                                    = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( xT - xF + ( 2.0f * settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a31fb6004cbb5a70ad3c3e6aeb1816780">coOrdsExtraSpace</a> ) );</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>                                    = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( yT - yF + ( 2.0f * settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a31fb6004cbb5a70ad3c3e6aeb1816780">coOrdsExtraSpace</a> ) );</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>                                    = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( zT - zF + ( 2.0f * settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a31fb6004cbb5a70ad3c3e6aeb1816780">coOrdsExtraSpace</a> ) );</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="comment">//================================================ Generate map from nicely placed atoms (cell size will be range + 40)</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a3bd5d0937bf5a545008b06593c5722a7">ProSHADE_internal_mapManip::generateMapFromPDB</a>    ( gemmiStruct, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a>, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, &amp;this-&gt;xTo, &amp;this-&gt;yTo, &amp;this-&gt;zTo, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#acffa14a2c2121b5b425fcabdb7b3ba6a">forceP1</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">firstModelOnly</a> );</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="comment">//================================================ Remove negative values if so required</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ad42474a333f9b605ccad7ecfb72afb2e">removeNegativeDensity</a> ) { <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; static_cast&lt; size_t &gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ ) { <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter] &lt; 0.0 ) { this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter] = 0.0; } } }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="comment">//================================================ Set the internal variables to correct values</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30edd2928e423198704adb955989960b">setPDBMapValues</a>                             ( );</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="comment">//================================================ Move map back to the original PDB location</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">ProSHADE_internal_mapManip::moveMapByIndices</a>      ( &amp;xMov, &amp;yMov, &amp;zMov, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>,</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                                                        &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>,</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                                                        &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a> );</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>      ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, xMov, yMov, zMov, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>,</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ),</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) );</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">//================================================ If specific resolution is requested, make sure the map has it</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab573ea90a16991a06a77c5343328b060">reSampleMap</a>                                 ( settings );</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="comment">//================================================ Save the original sizes</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ae6821c27e7facf63839c9fc678c9c7">xDimSizeOriginal</a>                            = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7855424ca5d51853c7fc665ecb9b935b">yDimSizeOriginal</a>                            = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a530ad7e3396cbcbc1814051031070a8b">zDimSizeOriginal</a>                            = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="comment">//================================================ Save the original index counts</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9598e9a38546e3bf260bc09c0c9366a2">xDimIndicesOriginal</a>                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ef18126c2c24edc9b6be06e0591127f">yDimIndicesOriginal</a>                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ea6522b99cf1ac72199c9eeccd30742">zDimIndicesOriginal</a>                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">//================================================ Save the original axis origins</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a43f1c4682016759ea2e24c5903dbe444">xAxisOriginOriginal</a>                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a>;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a53cffdab0d66cb88884ec4f46c19a5ff">yAxisOriginOriginal</a>                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aed1c8e0ffb847b093a736c5156f86e9b">zAxisOriginOriginal</a>                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="comment">//================================================ Compute and save the COM</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac07955296611dd411cf5ed87ced90571">findMapCOM</a>                                  ( );</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2a3fdf194eca61b1ccfa5bdd2f586e0b">originalMapXCom</a>                             = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">xCom</a>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a64323b4117a11f0971cb0d24ec95c64c">originalMapYCom</a>                             = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">yCom</a>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac00197ab71e3353cb2884be0e51d6cd3">originalMapZCom</a>                             = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">zCom</a>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aae85fef5742e6c6c9ef7bda2ff0f7d23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae85fef5742e6c6c9ef7bda2ff0f7d23">&#9670;&nbsp;</a></span>readInMAP()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::readInMAP </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>maskArr</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>maskXDim</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>maskYDim</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>maskZDim</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>weightsArr</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>weigXDim</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>weigYDim</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>weigZDim</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function for reading map data using gemmi library. </p>
<p>This function reads in the map data using the information from the settings object and saves all the results into the structure calling it. More specifically, the data are parsed from the input file, mask (if any is supplied) is applied here, the Fourier weights are applied, map re-sampling is done and then the final map details are saved for further processing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for reading in the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maskArr</td><td>An array of mask values (default nullptr) to be used instead of an input mask file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maskXDim</td><td>The size of maskArray x dimension in indices (defaults to 0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maskYDim</td><td>The size of maskArray y dimension in indices (defaults to 0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maskZDim</td><td>The size of maskArray z dimension in indices (defaults to 0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weightsArr</td><td>An array of weights (default nullptr) to be used instead of input file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weigXDim</td><td>The size of weightsArray x dimension in indices (defaults to 0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weigYDim</td><td>The size of weightsArray y dimension in indices (defaults to 0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weigZDim</td><td>The size of weightsArray z dimension in indices (defaults to 0). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l00619">619</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;{</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">//================================================ Open the file</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    gemmi::Ccp4&lt;float&gt; map;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    map.read_ccp4                                     ( gemmi::MaybeGzipped ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a>.c_str() ) );</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">//================================================ Convert to XYZ and create complete map, if need be</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    map.setup                                         ( gemmi::GridSetup::ReorderOnly, NAN );</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">//================================================ Read in the rest of the map file header</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a9677e06f0781855b9046aab1b3638831">ProSHADE_internal_io::readInMapHeader</a>             ( &amp;map,</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                                                        &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>,  &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>,  &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>,</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                                                        &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>,     &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>,     &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>,</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                                                        &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">aAngle</a>,       &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9dbcec9f32eb76625d7aa59d8c2701d9">bAngle</a>,       &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e2f99f00dd05198b508633cf7f6f080">cAngle</a>,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                                                        &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>,        &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>,        &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>,</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                                                        &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a>,  &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a>,  &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a>,</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                                                        &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">xAxisOrder</a>,   &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">yAxisOrder</a>,   &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">zAxisOrder</a>,</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                                        &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">xGridIndices</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">yGridIndices</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">zGridIndices</a> );</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="comment">//================================================ Save the map density to ProSHADE variable</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#ad93f9644c5b132193b4ddd282f50abce">ProSHADE_internal_io::readInMapData</a>               ( &amp;map, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">xAxisOrder</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">yAxisOrder</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">zAxisOrder</a> );</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">//================================================ If mask is supplied and the correct task is used</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a1e3fc8ac7658bf54776a0fbb4e8286cd">ProSHADE_internal_io::applyMask</a>                   ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a670cffe28bbdac027bffd8f5491d4266">appliedMaskFileName</a>, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a>,</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                                                        maskArr, maskXDim, maskYDim, maskZDim );</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">//================================================ Apply Fourier weights</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a189c98238a6caef5d7dfde5cde999709">ProSHADE_internal_io::applyWeights</a>                ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a9ad9534f35b1c9fcb4f94fbb4c0b97ba">fourierWeightsFileName</a>, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a>,</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                                        weightsArr, weigXDim, weigYDim, weigZDim );</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">//================================================ Remove negative values if so required</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ad42474a333f9b605ccad7ecfb72afb2e">removeNegativeDensity</a> ) { <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; static_cast&lt; size_t &gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ ) { <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter] &lt; 0.0 ) { this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter] = 0.0; } } }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">//================================================ Set resolution if need be</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a> &lt; 0.0f )</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3e7f4174b62aa402a1f6d3becd8e9dd5">setResolution</a>                       ( std::min ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a> ) / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ),</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                                                        std::min ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a> ) / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ),</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                                                                   <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> ) / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) ) ) * 2.0f );</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="comment">//================================================ Set iterators from and to</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a476092aa08dff20d64a895e7b2227b2e">figureIndexStartStop</a>                        ( );</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">//================================================ If specific resolution is requested, make sure the map has it</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab573ea90a16991a06a77c5343328b060">reSampleMap</a>                                 ( settings );</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="comment">//================================================ Save the original sizes</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ae6821c27e7facf63839c9fc678c9c7">xDimSizeOriginal</a>                            = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7855424ca5d51853c7fc665ecb9b935b">yDimSizeOriginal</a>                            = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a530ad7e3396cbcbc1814051031070a8b">zDimSizeOriginal</a>                            = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="comment">//================================================ Save the original index counts</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9598e9a38546e3bf260bc09c0c9366a2">xDimIndicesOriginal</a>                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ef18126c2c24edc9b6be06e0591127f">yDimIndicesOriginal</a>                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ea6522b99cf1ac72199c9eeccd30742">zDimIndicesOriginal</a>                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">//================================================ Save the original axis origins</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a43f1c4682016759ea2e24c5903dbe444">xAxisOriginOriginal</a>                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a53cffdab0d66cb88884ec4f46c19a5ff">yAxisOriginOriginal</a>                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a>;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aed1c8e0ffb847b093a736c5156f86e9b">zAxisOriginOriginal</a>                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">//================================================ Compute and save the COM</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac07955296611dd411cf5ed87ced90571">findMapCOM</a>                                  ( );</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2a3fdf194eca61b1ccfa5bdd2f586e0b">originalMapXCom</a>                             = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">xCom</a>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a64323b4117a11f0971cb0d24ec95c64c">originalMapYCom</a>                             = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">yCom</a>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac00197ab71e3353cb2884be0e51d6cd3">originalMapZCom</a>                             = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">zCom</a>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abd1c1b3588308f775da5c8aeba3f3e78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd1c1b3588308f775da5c8aeba3f3e78">&#9670;&nbsp;</a></span>readInPDB()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::readInPDB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function for reading pdb data. </p>
<p>This function reads in the pdb data using the information from the settings object, converts the co-ordinates onto a theoretical map and and saves all the results into the structure calling it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for reading in the map.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>For multiple models, this function works, but the map is not perfectly fitted to the PDB file. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l00700">700</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;{</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">//================================================ Set resolution if need be</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a> &lt; 0.0f )</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3e7f4174b62aa402a1f6d3becd8e9dd5">setResolution</a>                       ( 8.0 );</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">//================================================ Open PDB file for reading</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    gemmi::Structure pdbFile                          = gemmi::read_structure ( gemmi::MaybeGzipped ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a> ) );</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="comment">//================================================ Once we have Gemmi object, run the Gemmi function</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8dcc353f075b824d2f3479f487c8bd0">readInGemmi</a>                                 ( pdbFile, settings );</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a341ab1de3f949e1e4688110ed641ae13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a341ab1de3f949e1e4688110ed641ae13">&#9670;&nbsp;</a></span>readInStructure() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::readInStructure </td>
          <td>(</td>
          <td class="paramtype">gemmi::Structure&#160;</td>
          <td class="paramname"><em>gemmiStruct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>inputO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initialises the basic <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> variables and reads in a single structure from Gemmi co-ordinate object. </p>
<p>This function is basically the constructor for the <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> class. It reads in a structure from the supplied gemmi::Structure object in the same way a co-ordinate structure would be read from file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gemmiStruct</td><td>The Gemmi Structure object that should be read in. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inputO</td><td>The order of this structure in this run's input. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for reading in the map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l00567">567</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;{</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;Starting to load the structure from Gemmi object &quot;</span> &lt;&lt; inputO;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, ss.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">//================================================ Check if instance is empty</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">if</span> ( !this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac57d606fdb59d54bd3f9249941402b12">isEmpty</a> )</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Structure data class not empty.&quot;</span>, <span class="stringliteral">&quot;E000005&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;Attempted to read in structure into a ProSHADE_data\n                    : object which already does have structure read in\n                    : i.e. &quot;</span> + this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a> );</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">//================================================ Save the filename</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a>                                    = gemmiStruct.name;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">//================================================ Check what is the input format</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4052e498b4650f62bfe5ff37ed959292">fileType</a>                                    = ProSHADE_internal_io::GEMMI;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">//================================================ Save input order</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ab4a34f3a42c17f923ef131c64b4a7">inputOrder</a>                                  = inputO;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="comment">//================================================ Decide how to proceed</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8dcc353f075b824d2f3479f487c8bd0">readInGemmi</a>                                 ( gemmiStruct, settings );</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="comment">//================================================ This structure is now full</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac57d606fdb59d54bd3f9249941402b12">isEmpty</a>                                     = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Structure read in successfully.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    return ;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aab12fb2b416250b81dd69d2e86313b59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab12fb2b416250b81dd69d2e86313b59">&#9670;&nbsp;</a></span>readInStructure() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::readInStructure </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>fName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>inputO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>maskArr</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>maskXDim</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>maskYDim</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>maskZDim</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>weightsArr</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>weigXDim</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>weigYDim</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>weigZDim</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initialises the basic <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> variables and reads in a single structure. </p>
<p>This function is basically the constructor for the <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html" title="This class contains all inputed and derived data for a single structure.">ProSHADE_data</a> class. It reads in a structure (independent of the structure type) and fills in all the appropriate variables of the class.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fName</td><td>The file name of the file which should be loaded. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inputO</td><td>The order of this structure in this run's input. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for reading in the map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maskArr</td><td>An array of mask values (default nullptr) to be used instead of an input mask file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maskXDim</td><td>The size of maskArray x dimension in indices (defaults to 0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maskYDim</td><td>The size of maskArray y dimension in indices (defaults to 0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maskZDim</td><td>The size of maskArray z dimension in indices (defaults to 0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weightsArr</td><td>An array of weights (default nullptr) to be used instead of input file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weigXDim</td><td>The size of weightsArray x dimension in indices (defaults to 0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weigYDim</td><td>The size of weightsArray y dimension in indices (defaults to 0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weigZDim</td><td>The size of weightsArray z dimension in indices (defaults to 0). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l00509">509</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;{</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting to read the structure: &quot;</span> + fName, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">//================================================ Check if instance is empty</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">if</span> ( !this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac57d606fdb59d54bd3f9249941402b12">isEmpty</a> )</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Structure data class not empty.&quot;</span>, <span class="stringliteral">&quot;E000005&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;Attempted to read in structure into a ProSHADE_data\n                    : object which already does have structure read in\n                    : i.e. &quot;</span> + this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a> );</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">//================================================ Save the filename</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a>                                    = fName;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">//================================================ Check what is the input format</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4052e498b4650f62bfe5ff37ed959292">fileType</a>                                    = <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a63ae2cc7f413d224e5d651ed579e9afb">ProSHADE_internal_io::figureDataType</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a> );</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">//================================================ Save input order</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ab4a34f3a42c17f923ef131c64b4a7">inputOrder</a>                                  = inputO;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">//================================================ Decide how to proceed</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">switch</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4052e498b4650f62bfe5ff37ed959292">fileType</a> )</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordflow">case</span> ProSHADE_internal_io::UNKNOWN:</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Unknown file type.&quot;</span>, <span class="stringliteral">&quot;E000006&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;When attempting to read the file\n                    : &quot;</span> + this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a> + <span class="stringliteral">&quot;\n                    : the file extension was determined as unknown. This could\n                    : mean either that the file does not exist, or that it is\n                    : not one of the supported extensions.&quot;</span> );</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keywordflow">case</span> ProSHADE_internal_io::GEMMI:</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Unknown file type.&quot;</span>, <span class="stringliteral">&quot;E000006&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;When attempting to read the file\n                    : &quot;</span> + this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a> + <span class="stringliteral">&quot;\n                    : the file extension was determined as unknown. This could\n                    : mean either that the file does not exist, or that it is\n                    : not one of the supported extensions.&quot;</span> );</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keywordflow">case</span> ProSHADE_internal_io::PDB:</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abd1c1b3588308f775da5c8aeba3f3e78">readInPDB</a>                           ( settings );</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="keywordflow">case</span> ProSHADE_internal_io::MAP:</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae85fef5742e6c6c9ef7bda2ff0f7d23">readInMAP</a>                           ( settings, maskArr, maskXDim, maskYDim, maskZDim, weightsArr, weigXDim, weigYDim, weigZDim );</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">//================================================ This structure is now full</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac57d606fdb59d54bd3f9249941402b12">isEmpty</a>                                     = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Structure read in successfully.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    return ;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5919acc2f26efcf373db47ed96eadc38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5919acc2f26efcf373db47ed96eadc38">&#9670;&nbsp;</a></span>removePhaseInormation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::removePhaseInormation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function removes phase from the map, effectively converting it to Patterson map. </p>
<p>This function is called when the phase information needs to be removed from the internal map representation. It does the forward Fourier transform, removes the phase from the Fourier coefficients and then the inverse Fourier transform, thus resulting with the Patterson map. It does write over the original map.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map manipulation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03657">3657</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;{</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Removing phase from the map.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;    </div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;    <span class="comment">//================================================ Copy map for processing</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;    fftw_complex* mapCoeffs                           = <span class="keyword">new</span> fftw_complex[this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;    fftw_complex* pattersonMap                        = <span class="keyword">new</span> fftw_complex[this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;    </div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;    <span class="comment">//================================================ Check memory allocation</span></div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( mapCoeffs, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( pattersonMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;    </div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;    <span class="comment">//================================================ Copy data to map</span></div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; (this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>); iter++ )</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;    {</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;        pattersonMap[iter][0]                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter];</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;        pattersonMap[iter][1]                         = 0.0;</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;    }</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;    </div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;    <span class="comment">//================================================ Prepare FFTW plans</span></div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;    fftw_plan forward                                 = fftw_plan_dft_3d ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ),</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;                                                                           pattersonMap, mapCoeffs, FFTW_FORWARD,  FFTW_ESTIMATE );</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;    fftw_plan inverse                                 = fftw_plan_dft_3d ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ),</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;                                                                           mapCoeffs, pattersonMap, FFTW_BACKWARD, FFTW_ESTIMATE );</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;    </div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;    <span class="comment">//================================================ Run forward Fourier</span></div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;    fftw_execute                                      ( forward );</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;    </div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;    <span class="comment">//================================================ Remove the phase</span></div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a167f7a9dbd061752d2a099181090a3b8">ProSHADE_internal_mapManip::removeMapPhase</a>        ( mapCoeffs, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> );</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;    </div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    <span class="comment">//================================================ Run inverse Fourier</span></div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;    fftw_execute                                      ( inverse );</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;    </div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;    <span class="comment">//================================================ Save the results</span></div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;    proshade_signed mapIt, patIt, patX, patY, patZ;</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed xIt = 0; xIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ); xIt++ )</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;    {</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed yIt = 0; yIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ); yIt++ )</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;        {</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed zIt = 0; zIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); zIt++ )</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;            {</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;                <span class="comment">//==================================== Centre patterson map</span></div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;                patX = xIt - ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ) / 2 ); <span class="keywordflow">if</span> ( patX &lt; 0 ) { patX += this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>; }</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;                patY = yIt - ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) / 2 ); <span class="keywordflow">if</span> ( patY &lt; 0 ) { patY += this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>; }</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;                patZ = zIt - ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) / 2 ); <span class="keywordflow">if</span> ( patZ &lt; 0 ) { patZ += this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>; }</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;                </div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;                <span class="comment">//==================================== Find indices</span></div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;                mapIt                                 = zIt  + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( yIt  + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * xIt  );</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;                patIt                                 = patZ + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( patY + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * patX );</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;                </div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;                <span class="comment">//==================================== Copy</span></div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;                this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[mapIt]              = pattersonMap[patIt][0];</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;            }</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;        }</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;    }</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;    </div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;    <span class="keyword">delete</span>[] pattersonMap;</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;    <span class="keyword">delete</span>[] mapCoeffs;</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;    </div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;    <span class="comment">//================================================ Delete FFTW plans</span></div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;    fftw_destroy_plan                                 ( forward );</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;    fftw_destroy_plan                                 ( inverse );</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;    </div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;    <span class="comment">//================================================ Change settings to reflect Patterson map</span></div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;    <span class="keywordflow">if</span> ( !settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2019a6bae1b3e6f7d8805ae2734b769e">usePhase</a> )</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;    {</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>                               *= 2.0f;</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>                               *= 2.0f;</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>                               *= 2.0f;</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3e7f4174b62aa402a1f6d3becd8e9dd5">setResolution</a>                       ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a> * 2.0f );</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;    }</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;    </div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Phase information removed.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;    </div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;    return ;</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;    </div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a43e3cad6f93a32f92194f76f0ec76a32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43e3cad6f93a32f92194f76f0ec76a32">&#9670;&nbsp;</a></span>reportOverlayResults()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::reportOverlayResults </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double &gt; *&#160;</td>
          <td class="paramname"><em>rotationCentre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double &gt; *&#160;</td>
          <td class="paramname"><em>eulerAngles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double &gt; *&#160;</td>
          <td class="paramname"><em>finalTranslation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function reports the results of the overlay mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td><a class="el" href="class_pro_s_h_a_d_e__settings.html" title="This class stores all the settings and is passed to the executive classes instead of a multitude of p...">ProSHADE_settings</a> object specifying the details of how the computations should be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotationCentre</td><td>Pointer to vector for saving the position of the centre of rotation about which the rotation is to be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mapBoxMovement</td><td>Pointer to vector for saving the sum of all translations done internally by ProSHADE to this input map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eulerAngles</td><td>Pointer to vector where the three Euler angles will be saved into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">finalTranslation</td><td>Pointer to a vector where the translation required to move structure from origin to optimal overlay with static structure will be saved into. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04512">4512</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;{</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;    <span class="comment">//================================================ Empty line</span></div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, <span class="stringliteral">&quot;&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;    </div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;    <span class="comment">//================================================ Write out rotation centre translation results</span></div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;    std::stringstream rotCen; rotCen &lt;&lt; std::setprecision (3) &lt;&lt; std::showpos &lt;&lt; <span class="stringliteral">&quot;The rotation centre to origin translation vector is:  &quot;</span> &lt;&lt; -rotationCentre-&gt;at(0) &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; -rotationCentre-&gt;at(1) &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; -rotationCentre-&gt;at(2);</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, rotCen.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;    </div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;    <span class="comment">//================================================ Write out rotation matrix about origin</span></div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;    proshade_double* rotMat                           = <span class="keyword">new</span> proshade_double[9];</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rotMat, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a> ( eulerAngles-&gt;at(0), eulerAngles-&gt;at(1), eulerAngles-&gt;at(2), rotMat );</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;    </div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;    std::stringstream rotMatSS;  </div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;    rotMatSS &lt;&lt; std::setprecision (3) &lt;&lt; std::showpos &lt;&lt; <span class="stringliteral">&quot;The rotation matrix about origin is                 : &quot;</span> &lt;&lt; rotMat[0] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; rotMat[1] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; rotMat[2] &lt;&lt; std::endl;</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;    rotMatSS &lt;&lt; std::setprecision (3) &lt;&lt; std::showpos &lt;&lt; <span class="stringliteral">&quot;                                                    : &quot;</span> &lt;&lt; rotMat[3] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; rotMat[4] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; rotMat[5] &lt;&lt; std::endl;</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;    rotMatSS &lt;&lt; std::setprecision (3) &lt;&lt; std::showpos &lt;&lt; <span class="stringliteral">&quot;                                                    : &quot;</span> &lt;&lt; rotMat[6] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; rotMat[7] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; rotMat[8];</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, rotMatSS.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;    </div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;    <span class="keyword">delete</span>[] rotMat;</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;    </div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;    <span class="comment">//================================================ Write out origin to overlay translation results</span></div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;    std::stringstream finTrs; finTrs &lt;&lt; std::setprecision (3) &lt;&lt; std::showpos &lt;&lt; <span class="stringliteral">&quot;The rotation centre to overlay translation vector is: &quot;</span> &lt;&lt; finalTranslation-&gt;at(0) &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; finalTranslation-&gt;at(1) &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; finalTranslation-&gt;at(2);</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, finTrs.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;    </div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;    return ;</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;    </div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abea2d62360b17cddca155816d3e485e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abea2d62360b17cddca155816d3e485e8">&#9670;&nbsp;</a></span>reportSymmetryResults()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::reportSymmetryResults </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes prints the report for symmetry detection. </p>
<p>This is a very simple function which provides the basic textual output for the symmetry detection task.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map symmetry detection reporting. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03479">3479</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;{</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;    <span class="comment">//================================================ Improve this!</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac39560ba9aca9053753c158fb2adb9de">recommendedSymmetryType</a> == <span class="stringliteral">&quot;&quot;</span> )</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;    {</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, <span class="stringliteral">&quot;Did not detect any symmetry!&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;    }</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;    {</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;        std::stringstream ssHlp;</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;        std::vector&lt; proshade_double &gt; comMove        = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4bd7a9a5ea6cac4302ec1cd80922c617">getMapCOMProcessChange</a> ( );</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;        ssHlp &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Detected &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac39560ba9aca9053753c158fb2adb9de">recommendedSymmetryType</a> &lt;&lt; <span class="stringliteral">&quot; symmetry with fold &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac8e62cc8dbd40265e51143c8207b6638">recommendedSymmetryFold</a> &lt;&lt; <span class="stringliteral">&quot; about point [&quot;</span> &lt;&lt; comMove.at(0) &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; comMove.at(1) &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; comMove.at(2) &lt;&lt; <span class="stringliteral">&quot;] away from centre of mass .&quot;</span>;</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, ssHlp.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;        </div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() &gt; 0 )</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;        {</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;            ssHlp.clear(); ssHlp.str ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;            ssHlp &lt;&lt; <span class="stringliteral">&quot;  Fold       X           Y          Z           Angle        Height      Average FSC&quot;</span>;</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, ssHlp.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;        }</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign symIt = 0; symIt &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() ); symIt++ )</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;        {</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;            ssHlp.clear(); ssHlp.str ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;            ssHlp &lt;&lt; std::showpos &lt;&lt; std::fixed &lt;&lt; std::setprecision(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[0] &lt;&lt; std::setprecision(5) &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[1] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[2] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[3] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[4] &lt;&lt; <span class="stringliteral">&quot;      &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[5] &lt;&lt; <span class="stringliteral">&quot;      &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[6];</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, ssHlp.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;        }</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;        </div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;        std::stringstream hlpSS3;</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;        ssHlp.clear(); ssHlp.str ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;        hlpSS3 &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;To facilitate manual checking for symmetries, the following is a list of all detected C symmetries:&quot;</span>;</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, hlpSS3.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;        </div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.size() &gt; 0 )</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;        {</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;            ssHlp.clear(); ssHlp.str ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;            ssHlp &lt;&lt; <span class="stringliteral">&quot;  Fold       X           Y          Z           Angle        Height      Average FSC&quot;</span>;</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, ssHlp.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;        }</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign symIt = 0; symIt &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.size() ); symIt++ )</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;        {</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;            ssHlp.clear(); ssHlp.str ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;            ssHlp &lt;&lt; std::showpos &lt;&lt; std::fixed &lt;&lt; std::setprecision(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(symIt)[0] &lt;&lt; std::setprecision(5) &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(symIt)[1] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(symIt)[2] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(symIt)[3] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(symIt)[4] &lt;&lt; <span class="stringliteral">&quot;      &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(symIt)[5] &lt;&lt; <span class="stringliteral">&quot;      &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(symIt)[6];</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, ssHlp.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;        }</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;        </div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;    }</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;    </div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;    return ;</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;    </div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab573ea90a16991a06a77c5343328b060"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab573ea90a16991a06a77c5343328b060">&#9670;&nbsp;</a></span>reSampleMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::reSampleMap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function changes the internal map sampling to conform to particular resolution value. </p>
<p>This function will take the requested resolution value from the settings object and will proceed to change the internal map sampling to conform to requested resolution / 2 and therefore to the requested resolution map.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for reading in the map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01440">1440</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;{</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordflow">if</span> ( !settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab61d2183930ea26b3d49e7662052e83b">changeMapResolution</a> &amp;&amp; !settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4f49a4f2263aa12ccb1737f8dc32c9ac">changeMapResolutionTriLinear</a> ) { return ; }</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="comment">//================================================ Initialise the internal variable</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    proshade_single* changeVals                       = <span class="keyword">new</span> proshade_single[6];</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="comment">//================================================ Find COM before map re-sampling</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    proshade_double xMapCOMPreReSampl = 0.0, yMapCOMPreReSampl = 0.0, zMapCOMPreReSampl = 0.0;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aaad67127777eab70acca5952a7838d26">ProSHADE_internal_mapManip::findMAPCOMValues</a>      ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, &amp;xMapCOMPreReSampl, &amp;yMapCOMPreReSampl, &amp;zMapCOMPreReSampl, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a> );</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    </div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="comment">//================================================ Now re-sample the map</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab61d2183930ea26b3d49e7662052e83b">changeMapResolution</a> )</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    {</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ac311071faa65db4dfc1886d2a6de78ef">ProSHADE_internal_mapManip::reSampleMapToResolutionFourier</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a>, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices,</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                                                                     this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, changeVals );</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4f49a4f2263aa12ccb1737f8dc32c9ac">changeMapResolutionTriLinear</a> )</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        {</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Requested both Fourier-space and real-space map re-sampling. Defaulting to only Fourier space re-samplling.&quot;</span>, <span class="stringliteral">&quot;WM00049&quot;</span> );</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        }</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4f49a4f2263aa12ccb1737f8dc32c9ac">changeMapResolutionTriLinear</a> &amp;&amp; !settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab61d2183930ea26b3d49e7662052e83b">changeMapResolution</a> )</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    {</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a5db74cc13dd4b64cf0a8377ed078b47c">ProSHADE_internal_mapManip::reSampleMapToResolutionTrilinear</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a>, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices,</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                                                                       this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, changeVals );</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160; </div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    }</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="comment">//================================================ Set the internal values to reflect the new map size</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>                                += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[0] );</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>                                += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[1] );</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>                                += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[2] );</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            </div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">xGridIndices</a>                                = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">yGridIndices</a>                                = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">zGridIndices</a>                                = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>                                        += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[0] );</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>                                        += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[1] );</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>                                        += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[2] );</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            </div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>                                    = changeVals[3];</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>                                    = changeVals[4];</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>                                    = changeVals[5];</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="comment">//================================================ Find COM after map re-sampling and corner move</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    proshade_double xMapCOMPostReSampl = 0.0, yMapCOMPostReSampl = 0.0, zMapCOMPostReSampl = 0.0;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aaad67127777eab70acca5952a7838d26">ProSHADE_internal_mapManip::findMAPCOMValues</a>      ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, &amp;xMapCOMPostReSampl, &amp;yMapCOMPostReSampl, &amp;zMapCOMPostReSampl, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a> );</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="comment">//================================================ Figure how much the new map moved</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    proshade_single xMov                              = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( xMapCOMPostReSampl - xMapCOMPreReSampl );</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    proshade_single yMov                              = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( yMapCOMPostReSampl - yMapCOMPreReSampl );</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    proshade_single zMov                              = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( zMapCOMPostReSampl - zMapCOMPreReSampl );</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    </div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="comment">//================================================ Move by indices (this should be sufficient)</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">ProSHADE_internal_mapManip::moveMapByIndices</a>      ( &amp;xMov, &amp;yMov, &amp;zMov, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>,</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                                                        &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a>, &amp;this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a> );</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>      ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, xMov, yMov, zMov, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>,</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) );</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    </div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="keyword">delete</span>[] changeVals;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    </div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    return ;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a22caf254dfc11e52890f79a161493e6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22caf254dfc11e52890f79a161493e6e">&#9670;&nbsp;</a></span>rotateMapRealSpace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; proshade_double &gt; ProSHADE_internal_data::ProSHADE_data::rotateMapRealSpace </td>
          <td>(</td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>axX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>axY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>axZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>axAng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function rotates a map based on the given angle-axis rotation. </p>
<p>This function takes the axis and angle of the required rotation as well as a pointer to which the rotated map should be saved into and proceeds to rotate the map in real space using tri-linear interpolation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">axX</td><td>The x-axis element of the angle-axis rotation representation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axY</td><td>The y-axis element of the angle-axis rotation representation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axZ</td><td>The z-axis element of the angle-axis rotation representation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axAng</td><td>The angle about the axis by which the rotation is to be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">map</td><td>A pointer which will be set to point to the rotated map. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>The rotation centre about which the rotation was done in Angstroms. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00632">632</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;{</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordtype">bool</span> withinBounds                                 = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    proshade_double c000, c001, c010, c011, c100, c101, c110, c111, c00, c01, c10, c11, c0, c1;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordtype">size_t</span> arrPos                                     = 0;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    proshade_double xCOM, yCOM, zCOM;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    std::vector&lt; proshade_double &gt; ret;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">//================================================ Store sampling rates</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    proshade_single xSampRate                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a> / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a> - this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> );</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    proshade_single ySampRate                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a> / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a> - this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> );</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    proshade_single zSampRate                         = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a> - this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> );</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="comment">//================================================ Compute map COM</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aaad67127777eab70acca5952a7838d26">ProSHADE_internal_mapManip::findMAPCOMValues</a>      ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, &amp;xCOM, &amp;yCOM, &amp;zCOM, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a> );</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">//================================================ Allocate local variables</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    proshade_single *mins                             = <span class="keyword">new</span> proshade_single[3];</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    proshade_single *maxs                             = <span class="keyword">new</span> proshade_single[3];</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    proshade_single *rotMat                           = <span class="keyword">new</span> proshade_single[9];</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    proshade_single *rotVec;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    proshade_single *interpMins                       = <span class="keyword">new</span> proshade_single[3];</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    proshade_single *interpMaxs                       = <span class="keyword">new</span> proshade_single[3];</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    proshade_single *interpDiff                       = <span class="keyword">new</span> proshade_single[3];</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    proshade_single *movs                             = <span class="keyword">new</span> proshade_single[3];</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    map                                               = <span class="keyword">new</span> proshade_double[ this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ];</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="comment">//================================================ Check memory allocation</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( mins,       __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( maxs,       __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rotMat,     __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( interpMins, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( interpMaxs, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( interpDiff, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( movs,       __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( map,        __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="comment">//================================================ Fill map with zeroes</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; static_cast&lt; size_t &gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ ) { map[iter] = 0.0; }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">//================================================ Determine map max&#39;s and min&#39;s in terms of the hkl system</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    mins[0]                                           = std::floor ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ) / -2.0f );</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    mins[1]                                           = std::floor ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) / -2.0f );</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    mins[2]                                           = std::floor ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) / -2.0f );</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    maxs[0]                                           = -mins[0];</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    maxs[1]                                           = -mins[1];</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    maxs[2]                                           = -mins[2];</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> % 2 == 0 ) { maxs[0] -= 1.0f; }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> % 2 == 0 ) { maxs[1] -= 1.0f; }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> % 2 == 0 ) { maxs[2] -= 1.0f; }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">//================================================ Rotate about COM instead of map midpoint</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    movs[0]                                           = 0.0; <span class="comment">//( mins[0] - static_cast&lt; proshade_single &gt; ( this-&gt;xFrom ) );</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    movs[1]                                           = 0.0; <span class="comment">//( mins[1] - static_cast&lt; proshade_single &gt; ( this-&gt;yFrom ) );</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    movs[2]                                           = 0.0; <span class="comment">//( mins[2] - static_cast&lt; proshade_single &gt; ( this-&gt;zFrom ) );</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">//================================================ Save rotation centre</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;ret, <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( ( -mins[0] * xSampRate ) + ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> ) * xSampRate ) ) );</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;ret, <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( ( -mins[1] * ySampRate ) + ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> ) * ySampRate ) ) );</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;ret, <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( ( -mins[2] * zSampRate ) + ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> ) * zSampRate ) ) );</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">//================================================ Get rotation matrix from Euler angles</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a39eafef902a49cc0816a2ed675c14a49">ProSHADE_internal_maths::getRotationMatrixFromAngleAxis</a> ( rotMat, axX, axY, axZ, axAng );</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="comment">//================================================ For each point</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">for</span> ( proshade_single xIt = mins[0]; xIt &lt;= maxs[0]; xIt += 1.0f )</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordflow">for</span> ( proshade_single yIt = mins[1]; yIt &lt;= maxs[1]; yIt += 1.0f )</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            <span class="keywordflow">for</span> ( proshade_single zIt = mins[2]; zIt &lt;= maxs[2]; zIt += 1.0f )</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                <span class="comment">//==================================== Compute new point position</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                rotVec                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2f9c7716f6ab682e8548ab77efcdc444">ProSHADE_internal_maths::compute3x3MatrixVectorMultiplication</a> ( rotMat, xIt - movs[0], yIt - movs[1], zIt - movs[2] );</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                <span class="comment">//==================================== Find surrounding grid points indices and check for boundaries</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                withinBounds                          = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> posIt = 0; posIt &lt; 3; posIt++ )</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                    <span class="comment">//================================ Determine surrounding points indices in this dimension</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                    interpMins[posIt]                 = std::floor ( rotVec[posIt] );</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                    interpMaxs[posIt]                 = interpMins[posIt] + 1.0f;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                    </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    <span class="comment">//================================ Check for boundaries</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                    <span class="keywordflow">if</span> ( ( maxs[posIt] &lt; interpMins[posIt] ) || ( interpMins[posIt] &lt; mins[posIt] ) || ( maxs[posIt] &lt; interpMaxs[posIt] ) || ( interpMaxs[posIt] &lt; mins[posIt] ) )</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                    {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                        withinBounds                  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                    }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                    </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                    <span class="comment">//================================ Compute the difference from position to min index along this axis</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                    interpDiff[posIt]                 = rotVec[posIt] - interpMins[posIt];</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                <span class="keywordflow">if</span> ( !withinBounds ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                <span class="comment">//==================================== Make sure interpolation max&#39;s are within bounds</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> posIt = 0; posIt &lt; 3; posIt++ )</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                    interpMaxs[posIt]                 = std::min ( maxs[posIt], std::max ( mins[posIt], interpMaxs[posIt] ) );</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                }</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                <span class="comment">//==================================== Release memory</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                <span class="keyword">delete</span>[] rotVec;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                <span class="comment">//==================================== Find the surrounding points values from their indices</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                arrPos                                = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( ( interpMins[2] - mins[2] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( ( interpMins[1] - mins[1] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * ( interpMins[0] - mins[0] ) ) );</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                c000                                  = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[arrPos];</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                arrPos                                = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( ( interpMaxs[2] - mins[2] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( ( interpMins[1] - mins[1] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * ( interpMins[0] - mins[0] ) ) );</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                c001                                  = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[arrPos];</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                arrPos                                = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( ( interpMins[2] - mins[2] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( ( interpMaxs[1] - mins[1] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * ( interpMins[0] - mins[0] ) ) );</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                c010                                  = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[arrPos];</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                arrPos                                = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( ( interpMaxs[2] - mins[2] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( ( interpMaxs[1] - mins[1] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * ( interpMins[0] - mins[0] ) ) );</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                c011                                  = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[arrPos];</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                arrPos                                = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( ( interpMins[2] - mins[2] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( ( interpMins[1] - mins[1] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * ( interpMaxs[0] - mins[0] ) ) );</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                c100                                  = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[arrPos];</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                arrPos                                = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( ( interpMaxs[2] - mins[2] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( ( interpMins[1] - mins[1] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * ( interpMaxs[0] - mins[0] ) ) );</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                c101                                  = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[arrPos];</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                arrPos                                = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( ( interpMins[2] - mins[2] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( ( interpMaxs[1] - mins[1] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * ( interpMaxs[0] - mins[0] ) ) );</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                c110                                  = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[arrPos];</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                arrPos                                = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( ( interpMaxs[2] - mins[2] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( ( interpMaxs[1] - mins[1] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * ( interpMaxs[0] - mins[0] ) ) );</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                c111                                  = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[arrPos];</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                <span class="comment">//==================================== Interpolate along x-axis</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                c00                                   = ( c000 * ( 1.0 - <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( interpDiff[0] ) ) ) + ( c100 * <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( interpDiff[0] ) );</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                c01                                   = ( c001 * ( 1.0 - <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( interpDiff[0] ) ) ) + ( c101 * <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( interpDiff[0] ) );</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                c10                                   = ( c010 * ( 1.0 - <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( interpDiff[0] ) ) ) + ( c110 * <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( interpDiff[0] ) );</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                c11                                   = ( c011 * ( 1.0 - <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( interpDiff[0] ) ) ) + ( c111 * <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( interpDiff[0] ) );</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <span class="comment">//==================================== Interpolate along y-axis</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                c0                                    = ( c00  * ( 1.0 - <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( interpDiff[1] ) ) ) + ( c10  * <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( interpDiff[1] ) );</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                c1                                    = ( c01  * ( 1.0 - <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( interpDiff[1] ) ) ) + ( c11  * <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( interpDiff[1] ) );</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                <span class="comment">//==================================== Interpolate along z-axis</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                arrPos                                = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( ( zIt - mins[2] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( ( yIt - mins[1] ) + <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * ( xIt - mins[0] ) ) );</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                map[arrPos]                           = ( c0   * ( 1.0 - <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( interpDiff[2] ) ) ) + ( c1   * <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( interpDiff[2] ) );</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keyword">delete</span>[] mins;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keyword">delete</span>[] maxs;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keyword">delete</span>[] rotMat;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keyword">delete</span>[] interpMins;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keyword">delete</span>[] interpMaxs;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keyword">delete</span>[] interpDiff;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keyword">delete</span>[] movs;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac626ea4513155170cff98fd18e6f3b09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac626ea4513155170cff98fd18e6f3b09">&#9670;&nbsp;</a></span>rotateMapRealSpaceInPlace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; proshade_double &gt; ProSHADE_internal_data::ProSHADE_data::rotateMapRealSpaceInPlace </td>
          <td>(</td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>eulA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>eulB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>eulG</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function rotates a map based on the given Euler angles in place. </p>
<p>This function takes the Euler angles of the required rotation and proceeds to make use of the rotateMapRealSpace () function to rotate the map in real space using trilinear interpolation, replacing the original map with the rotated one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">eulerAlpha</td><td>The rotation expressed as a pointer to Euler alpha angle. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eulerBeta</td><td>The rotation expressed as a pointer to Euler beta angle. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eulerGamma</td><td>The rotation expressed as a pointer to Euler gamma angle. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>The rotation centre about which the rotation was done in Angstroms. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00805">805</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;{</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    proshade_double axX, axY, axZ, axAng, tmp, *rMat, *map;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="comment">//================================================ Allocate local memory</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    rMat =                                            <span class="keyword">new</span> proshade_double[9];</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="comment">//================================================ Check local memory allocation</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rMat, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="comment">//================================================ Convert Euler angles to rotation matrix</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a> ( eulG, eulB, eulA, rMat );</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="comment">//================================================ Transpose the rotation matrix</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    tmp     = rMat[1];</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    rMat[1] = rMat[3];</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    rMat[3] = tmp;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    tmp     = rMat[2];</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    rMat[2] = rMat[6];</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    rMat[6] = tmp;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    tmp     = rMat[5];</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    rMat[5] = rMat[7];</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    rMat[7] = tmp;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="comment">//================================================ Convert rotation matrix to angle-axis</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#aad5409074bece14a244fad191524a687">ProSHADE_internal_maths::getAxisAngleFromRotationMatrix</a> ( rMat, &amp;axX, &amp;axY, &amp;axZ, &amp;axAng );</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="comment">//================================================ Rotate the internal map</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    std::vector&lt; proshade_double &gt; ret                = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a22caf254dfc11e52890f79a161493e6e">rotateMapRealSpace</a> ( axX, axY, axZ, axAng, map );</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="comment">//================================================ Copy the rotated map in place of the internal map</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; static_cast&lt; size_t &gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ )</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter]                       = map[iter];</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="comment">//================================================ Release local memory</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keyword">delete</span>[] rMat;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keyword">delete</span>[] map;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="comment">//================================================ Save rotation centre for co-ordinates</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a923cdc6e27455ba99ce5f536932f3721">originalPdbRotCenX</a>                          = ret.at(0);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a77cabdd70039e82f8c0cbb07fefd3960">originalPdbRotCenY</a>                          = ret.at(1);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a924d0767561842716b2ac260426cdc19">originalPdbRotCenZ</a>                          = ret.at(2);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa12ba3d9d61e240ec2d91d924e6cb0d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa12ba3d9d61e240ec2d91d924e6cb0d3">&#9670;&nbsp;</a></span>rotateMapReciprocalSpace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::rotateMapReciprocalSpace </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>eulerAlpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>eulerBeta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>eulerGamma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function rotates a map based on the given Euler angles. </p>
<p>This function starts by computing the Wigner D matrices for the given Euler angles and then it proceeds to multiply the spherical harmonics coefficients with these, thus producing spherical harmonics coefficients of a rotated structure. Then, it computes the inverse spherical harmonics decomposition, thus obtaining the sphere mapped values for the rotated structure. Finally, it interpolates these sphere mapped values back to Cartesian grid, thus obtaining a map rotated by the given Euler angles.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>The settings object specifying how exactly the rotation is to be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eulerAlpha</td><td>The rotation expressed as a pointer to Euler alpha angle. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eulerBeta</td><td>The rotation expressed as a pointer to Euler beta angle. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eulerGamma</td><td>The rotation expressed as a pointer to Euler gamma angle. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00571">571</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;{</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">//================================================ Set maximum comparison bandwidth to maximum object bandwidth</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ed9b0a765739d89104eca2c1875dd4">maxCompBand</a>                                 = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>-1]-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#a331955e5674dd112f83402375dce7bc5">getLocalBandwidth</a>();</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="comment">//================================================ Save map COM after processing but before rotation</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac07955296611dd411cf5ed87ced90571">findMapCOM</a>                                  ( );</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a471ec29b27c3a402d18b20fee8035f1a">mapCOMProcessChangeX</a>                       += ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">xCom</a> - this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2a3fdf194eca61b1ccfa5bdd2f586e0b">originalMapXCom</a> );</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47bf2343b0b50267e8e3732c964b63ea">mapCOMProcessChangeY</a>                       += ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">yCom</a> - this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a64323b4117a11f0971cb0d24ec95c64c">originalMapYCom</a> );</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a487131ae5dc44f8667908bf64725b4ab">mapCOMProcessChangeZ</a>                       += ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">zCom</a> - this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac00197ab71e3353cb2884be0e51d6cd3">originalMapZCom</a> );</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">//================================================ Compute the Wigner D matrices for the Euler angles</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__wigner.html#aba7b804497a1f100d527198e88fab2b8">ProSHADE_internal_wigner::computeWignerMatricesForRotation</a> ( settings, <span class="keyword">this</span>, -eulerAlpha, eulerBeta, -eulerGamma );</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">//================================================ Initialise rotated Spherical Harmonics memory</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa978d98f77a64fb16862b67a0de634be">allocateRotatedSHMemory</a>                     ( );</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">//================================================ Multiply SH coeffs by Wigner</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad39f33c52f6d4f0db8e0d63ed0c9a2f3">computeRotatedSH</a>                            ( );</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">//================================================ Inverse the SH coeffs to shells</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac3dbae1c18d0550ee1940cadb5335684">invertSHCoefficients</a>                        ( );</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">//================================================ Find spherical cut-offs</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    std::vector&lt;proshade_double&gt; lonCO, latCO;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a78c51dc39b75ffb4731c7219b25e290b">ProSHADE_internal_overlay::computeAngularThreshold</a> ( &amp;lonCO, &amp;latCO, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a8324ed7ec9c19df21511f117df80ab11">maxBandwidth</a> * 2 );</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="comment">//================================================ Allocate memory for the rotated map</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    proshade_double *densityMapRotated                = <span class="keyword">new</span> proshade_double [this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( densityMapRotated, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iter = 0; iter &lt; static_cast&lt;unsigned int&gt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ ) { densityMapRotated[iter] = 0.0; }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">//================================================ Interpolate onto cartesian grid</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9d11953ff54d5774659117be22bdb3b3">interpolateMapFromSpheres</a>                   ( densityMapRotated );</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">//================================================ Copy map</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ )</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter]                       = densityMapRotated[iter];</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="comment">//================================================ Release rotated map (original is now rotated)</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keyword">delete</span>[] densityMapRotated;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    return ;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b0608e80f20087b24cc9498767f0894"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b0608e80f20087b24cc9498767f0894">&#9670;&nbsp;</a></span>saveDetectedSymmetries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::saveDetectedSymmetries </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>CSyms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *&#160;</td>
          <td class="paramname"><em>allCs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes the results of point group searches and saves then into the output variables. </p>
<p>This function takes the CSyms as they are returned by the <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2714fcb2c08b224ccf09d64322bd2ab2" title="This function searches the angle-axis representation of the rotation function for a cyclic point grou...">findRequestedCSymmetryFromAngleAxis()</a> or the <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa3b1a8ef870a606035102b5dcf1ce44" title="This function obtains a list of all C symmetries from the angle-axis space mapped rotation function v...">getCyclicSymmetriesListFromAngleAxis()</a> functions and re-saves then to the output variables of the <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abcf770f9177a4d2f1a94a3adb20bf790" title="This function runs the symmetry detection algorithms on this structure using the angle-axis space and...">detectSymmetryFromAngleAxisSpace()</a> function. It also releases the memory of the CSyms argument.</p>
<dl class="section warning"><dt>Warning</dt><dd>This function releases the memory of the CSyms argument.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CSyms</td><td>A pointer to vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axes</td><td>A pointer to a vector to which all the axes of the recommended symmetry (if any) will be saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allCs</td><td>A pointer to a vector to which all the detected cyclic symmetries will be saved into. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l02276">2276</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;{</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <span class="keywordtype">bool</span> isArgSameAsSettings                          = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    </div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    <span class="comment">//================================================ For each detected point group</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( CSyms-&gt;size() ); cIt++ )</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    {</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        <span class="comment">//============================================ Create vector to replace the pointer</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        std::vector&lt; proshade_double &gt; nextSym;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms-&gt;at(cIt)[0] );</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms-&gt;at(cIt)[1] );</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms-&gt;at(cIt)[2] );</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms-&gt;at(cIt)[3] );</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms-&gt;at(cIt)[4] );</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms-&gt;at(cIt)[5] );</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms-&gt;at(cIt)[6] );</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad9fbf28fda3873fc511fa2000ccba86c">ProSHADE_internal_misc::addToDoubleVectorVector</a> ( allCs, nextSym );</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        </div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        <span class="comment">//============================================ Copy the vector to output variable and if different, then also to settings object</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;        <span class="keywordflow">if</span> ( ( cIt == 0 ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.size() == 0 ) ) { isArgSameAsSettings = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        <span class="keywordflow">if</span> ( !isArgSameAsSettings ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad9fbf28fda3873fc511fa2000ccba86c">ProSHADE_internal_misc::addToDoubleVectorVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>, nextSym ); }</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        </div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        <span class="comment">//============================================ Release memory</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        nextSym.clear                                 ( );</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;        <span class="keyword">delete</span>[] CSyms-&gt;at(cIt);</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    }</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    </div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    return ;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    </div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9b0fec5092eed1ab485443c15289e14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9b0fec5092eed1ab485443c15289e14">&#9670;&nbsp;</a></span>saveRecommendedSymmetry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::saveRecommendedSymmetry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>CSym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>DSym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>TSym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>OSym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>ISym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>axes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>mapData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>origCoeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>fCoeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan *&#160;</td>
          <td class="paramname"><em>planForwardFourier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>noBins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>binIndexing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double **&#160;</td>
          <td class="paramname"><em>bindata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>binCounts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>fscByBin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes all the detected symmetry results and decides on which are to be recommended for this structure. </p>
<p>This function is the brains of symmetry detection in the sense that it decides which symmetry group ProSHADE recommends as being detected. It starts by taking all C symmetries and building a histogram of their peak heights. From this histogram, it determines a threshold which contains only the most reliable axes.</p>
<p>Next, the function tests for all axes being over this threshold for the polyhedral symmetries - I, O and T in this order. If all such axes (with appropriate folds) are found, their FSCs will be checked against the supplied (settings object) threshold (default: 0.80). If all axes pass the FSC test, then the corresponding polyhedral symmetry is determined as recommended.</p>
<p>Should no polyhedral symmetries be found, the list of detected D symmetries will be tested next with very similar approach - both axes are required to pass the peak height threshold as well as the FSC threshold. Should multiple axes pairs pass, the one with the highest fold will be decided as the recommended one.</p>
<p>Finally, if no dihedral symmetry is found, the C symmetries list will be searched, again with the peak height and FSC criteria. If multiple symmetry axes are found, the one with the highest fold will be determined as the recommended one, while if no symmetries axis passes both tests, then no symmetry will be returned as detected.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CSym</td><td>A vector of pointers to double arrays, each array being a single Cyclic symmetry entry. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DSym</td><td>A vector of pointers to double arrays, each array being a single Dihedral symmetry entry. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TSym</td><td>A vector of pointers to double arrays, all of which together form the axes of tetrahedral symmetry. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">OSym</td><td>A vector of pointers to double arrays, all of which together form the axes of octahedral symmetry. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ISym</td><td>A vector of pointers to double arrays, all of which together form the axes of icosahedral symmetry. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axes</td><td>A vector to which all the axes of the recommended symmetry (if any) will be saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mapData</td><td>FFTW complex array which will be the input for the Fourier transform done by the planForwardFourier plan. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fCoeffs</td><td>FFTW complex array where the Fourier transform coefficients will be saved into by the planForwardFourier plan. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">origCoeffs</td><td>FFTW complex array holding already compute Fourier transform of the non-rotated map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">planForwardFourier</td><td>A prepared FFTW3 plan for transforming the mapData onto fCoeffs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noBins</td><td>The number of bins as already pre-computed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">binIndexing</td><td>A map of pre-computed bin assignments for each reflection in the format as outputted by FFTW. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bindata</td><td>Pre-allocated array of dimensions noBins x 12 serving as workspace for the bin summation and FSC computation. This array is modified by the function in case the caller would be interested in these results. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">binCounts</td><td>Pre-allocated array of dimension noBins serving to store the bin sizes for FSC computation. This array is modified by the function in case the caller would be interested in these results. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fscByBin</td><td>This array will hold FSC values for each bin. This is useful in further computations, but could be internal for FSC only computation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l02558">2558</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;{</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting recommended symmetry decision procedure.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    </div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    <span class="comment">//================================================ If no C symmetries, nothing to save...</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    <span class="keywordflow">if</span> ( CSym-&gt;size() == 0 )</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    {</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    }</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    </div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    proshade_double step                              = 0.01;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    proshade_double sigma                             = 0.03;</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    proshade_signed windowSize                        = 9;</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    proshade_double IFSCAverage = 0.0, OFSCAverage = 0.0, TFSCAverage = 0.0;</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    <span class="keywordtype">bool</span> IIsBest = <span class="keyword">false</span>, OIsBest = <span class="keyword">false</span>, TIsBest = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    </div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    <span class="comment">//================================================ Find the top group minimum threshold using smoothened histogram</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    proshade_double bestHistPeakStart                 = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a26fa82e82a6a4af696cfae0581785446">ProSHADE_internal_maths::findTopGroupSmooth</a> ( CSym, 5, step, sigma, windowSize );</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    <span class="keywordflow">if</span> ( bestHistPeakStart &gt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a> ) { bestHistPeakStart = settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a>; }</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    </div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    proshade_unsign noPassed = 0; <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> cIt = 0; cIt &lt; CSym-&gt;size(); cIt++ ) { <span class="keywordflow">if</span> ( CSym-&gt;at(cIt)[5] &gt; bestHistPeakStart ) { noPassed += 1; } }</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;Smoothening has resolved in &quot;</span> &lt;&lt; noPassed &lt;&lt; <span class="stringliteral">&quot; C symmetries.&quot;</span>;</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, ss.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Starting FSC computation to confirm the C symmetries existence.&quot;</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160; </div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    <span class="comment">//================================================ Decide if I is the answer</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    <span class="keywordtype">bool</span> alreadyDecided                               = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    <span class="keywordflow">if</span> ( ISym-&gt;size() == 31 )</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    {</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;        <span class="comment">//============================================ Initialise decision vars</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;        proshade_double fscVal                        = 0.0;</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        proshade_double fscValAvg                     = 0.0;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        </div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;        <span class="comment">//============================================ Check if at least one C5 and one C3 with the correct angle have high FSC and peak height</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iIt = 0; iIt &lt; 31; iIt++ ) { fscVal = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">computeFSC</a> ( settings, CSym, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.at(iIt), mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin ); fscValAvg += fscVal; <span class="keywordflow">if</span> ( fscVal &lt; settings-&gt;fscThreshold ) { fscValAvg = 0.0; <span class="keywordflow">break</span>; } }</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;        fscValAvg                                    /= 31.0;</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;        IFSCAverage                                   = fscValAvg;</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    }</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    </div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    <span class="comment">//================================================ Decide if O is the answer</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    <span class="keywordflow">if</span> ( ( OSym-&gt;size() == 13 ) &amp;&amp; !alreadyDecided )</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    {</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;        <span class="comment">//============================================ Initialise decision vars</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        proshade_double fscVal                        = 0.0;</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        proshade_double fscValAvg                     = 0.0;</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        </div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;        <span class="comment">//============================================ Check if at least one C5 and one C3 with the correct angle have high FSC and peak height</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> oIt = 0; oIt &lt; 13; oIt++ ) { fscVal = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">computeFSC</a> ( settings, CSym, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at(oIt), mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin ); fscValAvg += fscVal; <span class="keywordflow">if</span> ( fscVal &lt; settings-&gt;fscThreshold ) { fscValAvg = 0.0; <span class="keywordflow">break</span>; } }</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;        fscValAvg                                    /= 13.0;</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;        OFSCAverage                                   = fscValAvg;</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    }</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    </div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    <span class="comment">//================================================ Decide if T is the answer</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    <span class="keywordflow">if</span> ( ( TSym-&gt;size() == 7 ) &amp;&amp; !alreadyDecided )</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    {</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;        <span class="comment">//============================================ Initialise decision vars</span></div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        proshade_double fscVal                        = 0.0;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;        proshade_double fscValAvg                     = 0.0;</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        </div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        <span class="comment">//============================================ Check if at least one C5 and one C3 with the correct angle have high FSC and peak height</span></div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> tIt = 0; tIt &lt; 7; tIt++ ) { fscVal = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">computeFSC</a> ( settings, CSym, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at(tIt), mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin ); fscValAvg += fscVal; <span class="keywordflow">if</span> ( fscVal &lt; settings-&gt;fscThreshold ) { fscValAvg = 0.0; <span class="keywordflow">break</span>; } }</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;        fscValAvg                                    /= 7.0;</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;        TFSCAverage                                   = fscValAvg;</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    }</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    </div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    <span class="comment">//================================================ If we are using phaseless detection, different threshold needs to be used due to large number of false positives</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    proshade_double newThres                          = settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a>;</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    <span class="keywordflow">if</span> ( !settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2019a6bae1b3e6f7d8805ae2734b769e">usePhase</a> )</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    { </div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;        proshade_double phaselessStep                 = 0.01;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;        proshade_double phaselessSigma                = 0.005;</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;        proshade_signed phaselessWSize                = 5;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;        newThres =                                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a26fa82e82a6a4af696cfae0581785446">ProSHADE_internal_maths::findTopGroupSmooth</a> ( CSym, 6, phaselessStep, phaselessSigma, phaselessWSize, 0.94 );</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    }</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;    </div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    <span class="comment">//================================================ Decide between polyhedral</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    <span class="keywordflow">if</span> ( ( IFSCAverage &gt; std::max( OFSCAverage * 0.9, TFSCAverage * 0.8 ) ) &amp;&amp; ( IFSCAverage &gt; newThres ) ) { IIsBest = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    <span class="keywordflow">if</span> ( ( OFSCAverage &gt; std::max( IFSCAverage * 1.1, TFSCAverage * 0.9 ) ) &amp;&amp; ( OFSCAverage &gt; newThres ) ) { OIsBest = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    <span class="keywordflow">if</span> ( ( TFSCAverage &gt; std::max( IFSCAverage * 1.2, OFSCAverage * 1.1 ) ) &amp;&amp; ( TFSCAverage &gt; newThres ) ) { TIsBest = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    <span class="keywordflow">if</span> ( !IIsBest &amp;&amp; !OIsBest &amp;&amp; !TIsBest &amp;&amp; ( std::max( IFSCAverage, std::max( OFSCAverage, TFSCAverage ) ) &gt; newThres ) )</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    {</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhsPolyI ( IFSCAverage ), lhsPolyO ( OFSCAverage ), lhsPolyT ( TFSCAverage ), rhsPolyMax ( std::max( IFSCAverage, std::max( OFSCAverage, TFSCAverage ) ) );</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        <span class="keywordflow">if</span> ( lhsPolyI.AlmostEquals( rhsPolyMax ) ) { IIsBest = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        <span class="keywordflow">if</span> ( lhsPolyO.AlmostEquals( rhsPolyMax ) ) { OIsBest = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;        <span class="keywordflow">if</span> ( lhsPolyT.AlmostEquals( rhsPolyMax ) ) { TIsBest = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    }</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    </div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;    <span class="comment">//================================================ Now we know I is best polyhedral and conforms to threshold</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    <span class="keywordflow">if</span> ( IIsBest )</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    {</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;        <span class="comment">//============================================ The decision is I</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;I&quot;</span> );</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.size() ); it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.at(it)) ); }</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.at(it)) ); } }</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;        </div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;        <span class="comment">//============================================ Done</span></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        alreadyDecided                                = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    }</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    </div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    <span class="comment">//================================================ Now we know O is best polyhedral and conforms to threshold</span></div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    <span class="keywordflow">if</span> ( OIsBest &amp;&amp; !alreadyDecided )</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    {</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;        <span class="comment">//============================================ The decision is O</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;O&quot;</span> );</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.size() ); it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at(it)) ); }</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at(it)) ); } }</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;        </div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;        <span class="comment">//============================================ Done</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;        alreadyDecided                                = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    }</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    </div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    <span class="comment">//================================================ Now we know T is best polyhedral and conforms to threshold</span></div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    <span class="keywordflow">if</span> ( TIsBest &amp;&amp; !alreadyDecided )</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    {</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;T&quot;</span> );</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.size() ); it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at(it)) ); }</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at(it)) ); } }</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;        </div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;        <span class="comment">//============================================ Done</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;        alreadyDecided                                = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    }</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160; </div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    <span class="comment">//================================================ Decide if D is the answer</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    <span class="keywordflow">if</span> ( ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.size() &gt; 0 ) &amp;&amp; ( DSym-&gt;size() &gt; 0 ) &amp;&amp; !alreadyDecided )</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    {</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;        <span class="comment">//============================================ Initialise decision vars</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;        proshade_signed bestD                         = -1;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;        proshade_unsign bestFold                      = 0;</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;        </div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;        <span class="comment">//============================================ Find FSCs</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> dIt = 0; dIt &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.size(); dIt++ )</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        {</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;            <span class="comment">//======================================== Do not consider more than top 20, takes time and is unlikely to produce anything...</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;            <span class="keywordflow">if</span> ( dIt &gt; 20 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;            </div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;            <span class="comment">//======================================== Check the peak heights</span></div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs999a ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[5] ), lhs999b ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[5] ), rhs999 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( -999.9 ) );</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;            <span class="keywordflow">if</span> ( ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[5] &lt; bestHistPeakStart ) &amp;&amp; !( lhs999a.AlmostEquals( rhs999 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;            <span class="keywordflow">if</span> ( ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[5] &lt; bestHistPeakStart ) &amp;&amp; !( lhs999b.AlmostEquals( rhs999 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;            </div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;            <span class="comment">//======================================== Find FSCs</span></div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;            this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">computeFSC</a>                          ( settings, CSym, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0), mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin );</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;            this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">computeFSC</a>                          ( settings, CSym, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1), mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin );</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;        }</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        </div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;        <span class="comment">//============================================ Find FSC top group threshold</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;        proshade_double bestHistFSCStart              = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a26fa82e82a6a4af696cfae0581785446">ProSHADE_internal_maths::findTopGroupSmooth</a> ( CSym, 6, step, sigma, windowSize );</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        </div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;        <span class="comment">//============================================ Check if both C symmetries are reliable</span></div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> dIt = 0; dIt &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.size(); dIt++ )</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;        {</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;            <span class="comment">//======================================== Check the peak heights</span></div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs999a2 ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[5] ), lhs999b2 ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[5] ), rhs999 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( -999.9 ) );</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;            <span class="keywordflow">if</span> ( ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[5] &lt; bestHistPeakStart ) &amp;&amp; !( lhs999a2.AlmostEquals( rhs999 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;            <span class="keywordflow">if</span> ( ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[5] &lt; bestHistPeakStart ) &amp;&amp; !( lhs999b2.AlmostEquals( rhs999 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;            </div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;            <span class="comment">//======================================== Does this improve the best fold?</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;            <span class="keywordflow">if</span> ( ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[0] &gt; <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( bestFold ) ) || ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[0] &gt; <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( bestFold ) ) )</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;            {</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;                <span class="comment">//==================================== Check the FSC vals</span></div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;                <span class="keywordflow">if</span> ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[6] &lt; newThres ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;                <span class="keywordflow">if</span> ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[6] &lt; newThres ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;                <span class="keywordflow">if</span> ( std::max ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[6], CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[6] ) &lt; bestHistFSCStart ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;                </div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                <span class="comment">//==================================== All good!</span></div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                bestFold                              = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( std::max ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[0], CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[0] ) );</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                bestD                                 = <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( dIt );</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;            }</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;        }</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;        </div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;        <span class="comment">//============================================ Anything?</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;        <span class="keywordflow">if</span> ( bestD != -1 )</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;        {</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;            <span class="comment">//======================================== The decision is D</span></div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>          ( <span class="stringliteral">&quot;D&quot;</span> );</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>              ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( std::max ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestD ) ).at(0))[0], CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestD ) ).at(1))[0] ) ) );</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestD ) ).at(0)) );</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestD ) ).at(1)) );</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;            <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 )</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;            {</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a>         ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestD ) ).at(0)) );</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a>         ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestD ) ).at(1)) );</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;            }</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;            </div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;            <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;            alreadyDecided                            = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;        }</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    }</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    </div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    <span class="comment">//================================================ Decide if C is the answer</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    <span class="keywordflow">if</span> ( ( CSym-&gt;size() &gt; 0 ) &amp;&amp; !alreadyDecided )</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    {</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;        <span class="comment">//============================================ Initialise decision vars</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;        proshade_signed bestC                         = -1;</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;        proshade_unsign bestFold                      = 0;</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;        </div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;        <span class="comment">//============================================ Find FSCs for C syms</span></div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> cIt = 0; cIt &lt; CSym-&gt;size(); cIt++ )</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        {</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;            <span class="comment">//======================================== Do not consider more than top 20, takes time and is unlikely to produce anything...</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;            <span class="keywordflow">if</span> ( cIt &gt; 15 ) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;            </div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;            <span class="comment">//======================================== Check the peak height</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;            <span class="keywordflow">if</span> ( CSym-&gt;at(cIt)[5]  &lt; bestHistPeakStart ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;            </div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;            <span class="comment">//======================================== Compute FSC</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;            this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">computeFSC</a>                          ( settings, CSym, cIt, mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin );</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;        }</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;        </div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;        <span class="comment">//============================================ Find FSC top group threshold</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;        proshade_double bestHistFSCStart              = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a26fa82e82a6a4af696cfae0581785446">ProSHADE_internal_maths::findTopGroupSmooth</a> ( CSym, 6, step, sigma, windowSize );</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        </div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;        <span class="comment">//============================================ Find reliable C syms</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> cIt = 0; cIt &lt; CSym-&gt;size(); cIt++ )</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;        {</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;            <span class="comment">//======================================== Check if this improves the best already found fold</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;            <span class="keywordflow">if</span> ( CSym-&gt;at(cIt)[0] &gt; <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( bestFold ) )</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;            {</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;                <span class="comment">//==================================== If FSC passes</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;                <span class="keywordflow">if</span> ( ( CSym-&gt;at(cIt)[6] &gt; newThres ) &amp;&amp; ( CSym-&gt;at(cIt)[6] &gt;= bestHistFSCStart ) )</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;                {</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;                    bestFold                          = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( CSym-&gt;at(cIt)[0] );</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                    bestC                             = <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( cIt );</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;                }</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;            }</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;        }</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;        </div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        <span class="comment">//============================================ Anything?</span></div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;        <span class="keywordflow">if</span> ( bestC != -1 )</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;        {</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;            <span class="comment">//======================================== The decision is C</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;C&quot;</span> );</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( CSym-&gt;at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestC ) )[0] ) );</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestC ) ) );</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;            <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSym-&gt;at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestC ) ) ); }</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;            </div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;            <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;            alreadyDecided                            = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;        }</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    }</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    </div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    return ;</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    </div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a599a8fa1d6d780a45a2d772413bc778e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a599a8fa1d6d780a45a2d772413bc778e">&#9670;&nbsp;</a></span>saveRequestedSymmetryC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::saveRequestedSymmetryC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>CSym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>axes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes the C symmetries and searched for the requested symmetry. </p>
<p>This is a simple search function, which searches the symmetry results for the requested symmetry fold, and if more such symmetries are found, takes the one with the highest average peak height. If the requested fold was found, it will save it to the settings object, while it will set the object to fold 0 if the requested symmetry was not found (although there may be other symmetries present).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CSym</td><td>A vector of pointers to double arrays, each array being a single Cyclic symmetry entry. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axes</td><td>A vector to which all the axes of the requested symmetry (if any) will be saved. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l02824">2824</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;{</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;    proshade_unsign bestIndex                         = 0;</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    proshade_double highestSym                        = 0.0;</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    </div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    <span class="comment">//================================================ Search for best fold</span></div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( CSym-&gt;size() ); iter++ )</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    {</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;        <span class="comment">//============================================ Check if it is tbe correct fold</span></div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSym-&gt;at(iter)[0] ), rhs1 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6dc170d9826bad9ce4a2c31a033f7f6a">requestedSymmetryFold</a> ) );</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;        <span class="keywordflow">if</span> ( !lhs1.AlmostEquals ( rhs1 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;        </div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;        <span class="comment">//============================================ If correct, is it the highest found?</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        <span class="keywordflow">if</span> ( CSym-&gt;at(iter)[5] &gt; highestSym )</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;        {</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;            highestSym                                = CSym-&gt;at(iter)[5];</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;            bestIndex                                 = iter;</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;        }</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    }</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    </div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;    <span class="comment">//================================================ Found?</span></div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;    <span class="keywordflow">if</span> ( highestSym  &gt; 0.0 )</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    {</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;C&quot;</span> );</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( CSym-&gt;at(bestIndex)[0] ) );</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at(bestIndex) );</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        </div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSym-&gt;at(bestIndex) ); }</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;    }</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    {</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    }</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;    </div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;    return ;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    </div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa200af7e84ec7a17ecfd54a45a8ffafe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa200af7e84ec7a17ecfd54a45a8ffafe">&#9670;&nbsp;</a></span>saveRequestedSymmetryD()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::saveRequestedSymmetryD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>DSym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>axes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>mapData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>origCoeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>fCoeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan *&#160;</td>
          <td class="paramname"><em>planForwardFourier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>noBins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>binIndexing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double **&#160;</td>
          <td class="paramname"><em>bindata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed *&#160;</td>
          <td class="paramname"><em>binCounts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>fscByBin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes the D symmetries and searched for the requested symmetry. </p>
<p>This is a simple search function, which searches the symmetry results for the requested symmetry fold, and if more such symmetries are found, takes the one with the highest average peak height sum. If the requested fold was found, it will save it to the settings object, while it will set the object to fold 0 if the requested symmetry was not found (albeit there may be other symmetries present).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DSym</td><td>A vector of pointers to double arrays, each array being a single Dihedral symmetry entry. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axes</td><td>A vector to which all the axes of the requested symmetry (if any) will be saved. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l02876">2876</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;{</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    proshade_unsign bestIndex                         = 0;</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    proshade_double highestSym                        = 0.0;</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    </div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    <span class="comment">//================================================ Search for best fold</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( DSym-&gt;size() ); iter++ )</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    {</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;        <span class="comment">//============================================ Check if it is tbe correct fold</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( std::max ( DSym-&gt;at(iter)[0], DSym-&gt;at(iter)[7] ) ), rhs1 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6dc170d9826bad9ce4a2c31a033f7f6a">requestedSymmetryFold</a> ) );</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;        <span class="keywordflow">if</span> ( !lhs1.AlmostEquals ( rhs1 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160; </div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;        <span class="comment">//============================================ Check if peak height is decent</span></div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs999a ( DSym-&gt;at(iter)[5] ), lhs999b ( DSym-&gt;at(iter)[12] ), rhs999 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( -999.9 ) );</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;        <span class="keywordflow">if</span> ( ( DSym-&gt;at(iter)[5]  &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a> ) &amp;&amp; !( lhs999a.AlmostEquals( rhs999 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;        <span class="keywordflow">if</span> ( ( DSym-&gt;at(iter)[12] &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a> ) &amp;&amp; !( lhs999b.AlmostEquals( rhs999 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;        </div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;        <span class="comment">//============================================ If correct, compute FSC</span></div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">computeFSC</a>                              ( settings, &amp;DSym-&gt;at(iter)[0], mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin );</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">computeFSC</a>                              ( settings, &amp;DSym-&gt;at(iter)[7], mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts, fscByBin );</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;        </div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;        <span class="comment">//============================================ If best, store it</span></div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;        <span class="keywordflow">if</span> ( ( DSym-&gt;at(iter)[6] + DSym-&gt;at(iter)[13] ) &gt; highestSym )</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;        {</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;            highestSym                                = ( DSym-&gt;at(iter)[6] + DSym-&gt;at(iter)[13] );</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;            bestIndex                                 = iter;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;        }</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    }</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    </div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    <span class="comment">//================================================ Found?</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    <span class="keywordflow">if</span> ( highestSym  &gt; 0.0 )</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    {</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;D&quot;</span> );</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( std::max ( DSym-&gt;at(bestIndex)[0], DSym-&gt;at(bestIndex)[7] ) ) );</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, &amp;DSym-&gt;at(bestIndex)[0] );</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, &amp;DSym-&gt;at(bestIndex)[7] );</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;        </div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 )</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;        {</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a>             ( &amp;DSym-&gt;at(bestIndex)[0] );</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a>             ( &amp;DSym-&gt;at(bestIndex)[7] );</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;        }</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    }</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    {</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;    }</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;    </div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;    return ;</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    </div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aca5af5c8c3b18275e65ae4ebacd9877c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca5af5c8c3b18275e65ae4ebacd9877c">&#9670;&nbsp;</a></span>setEMatrixValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::setEMatrixValue </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>order1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>order2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_complex&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows setting the E matrix value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The band indice of the E matrix to which the value should be assigned. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order1</td><td>The first order indice of the E matrix to which the value should be assigned. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order2</td><td>The second order indice of the E matrix to which the value should be assigned. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">val</td><td>The value which should be saved. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04118">4118</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;{</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[band][order1][order2][0]          = val[0];</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>[band][order1][order2][1]          = val[1];</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;    </div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;    return ;</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;    </div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e7b1d5d4164ea7a6fda53c57ac979f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e7b1d5d4164ea7a6fda53c57ac979f4">&#9670;&nbsp;</a></span>setIntegrationWeight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::setIntegrationWeight </td>
          <td>(</td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>intW</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows setting the integration weight for the object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">intW</td><td>The integration weight to be set for this object. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04087">4087</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;{</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d266289b137b48132f1456fd8fc43ea">integrationWeight</a>                           = intW;</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;    </div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;    return ;</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;    </div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a737ee01d968fef7ae1094847a0271033"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a737ee01d968fef7ae1094847a0271033">&#9670;&nbsp;</a></span>setIntegrationWeightCumul()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::setIntegrationWeightCumul </td>
          <td>(</td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>intW</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows setting the cumulative integration weight for the object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">intW</td><td>The integration weight to be added to the current value for this object. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04101">4101</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;{</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d266289b137b48132f1456fd8fc43ea">integrationWeight</a>                          += intW;</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;    </div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;    return ;</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;    </div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a30edd2928e423198704adb955989960b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30edd2928e423198704adb955989960b">&#9670;&nbsp;</a></span>setPDBMapValues()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::setPDBMapValues </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function for determining iterator start and stop positions. </p>
<p>This function is called to set the xFrom, yFrom, ..., yTo and zTo iterator values for easier further calculations. </p>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l00824">824</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;{</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="comment">//================================================ Set starts to 0 </span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>                                       = 0;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>                                       = 0;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>                                       = 0;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="comment">//================================================ Set angles to 90 degrees</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">aAngle</a>                                      = 90.0;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9dbcec9f32eb76625d7aa59d8c2701d9">bAngle</a>                                      = 90.0;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e2f99f00dd05198b508633cf7f6f080">cAngle</a>                                      = 90.0;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="comment">//================================================ Set dimension sizes in indices</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>                                 = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a> );</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>                                 = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a> );</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>                                 = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a> );</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="comment">//================================================ Set the to indices properly</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>                                        -= 1;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>                                        -= 1;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>                                        -= 1;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="comment">//================================================ Set grid indexing to cell indexing</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">xGridIndices</a>                                = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">yGridIndices</a>                                = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">zGridIndices</a>                                = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="comment">//================================================ Set axis order</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">xAxisOrder</a>                                  = 1;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">yAxisOrder</a>                                  = 2;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">zAxisOrder</a>                                  = 3;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="comment">//================================================ Set origin to the first index</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a>                                 = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a>                                 = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a>                                 = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    return ;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aca5e27540622190be41ce78157c0807e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca5e27540622190be41ce78157c0807e">&#9670;&nbsp;</a></span>setSO3CoeffValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::setSO3CoeffValue </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_complex&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows setting the SOFT coefficient values using array position and value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">position</td><td>The 1D array position at which the new value should be saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">val</td><td>Complex value to be saved into the array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04152">4152</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;{</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">so3Coeffs</a>[position][0]                      = val[0];</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">so3Coeffs</a>[position][1]                      = val[1];</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;    </div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;    return ;</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;    </div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3aa4cdcd7cc9b458d7618077dfaab02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3aa4cdcd7cc9b458d7618077dfaab02">&#9670;&nbsp;</a></span>setWignerMatrixValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::setWignerMatrixValue </td>
          <td>(</td>
          <td class="paramtype">proshade_complex&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>order1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>order2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows setting the Wigner D matrix value by its band, order1 and order2 co-ordinate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">val</td><td>proshade_complex value of the Wigner D matrix at position band, order1, order2. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The band of the Wigner D matrix value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order1</td><td>The first order of the Wigner D matrix value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order2</td><td>The second order of the Wigner D matrix value. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04170">4170</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;{</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">wignerMatrices</a>[band][order1][order2][0]     = val[0];</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">wignerMatrices</a>[band][order1][order2][1]     = val[1];</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;    </div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;    return ;</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;    </div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ada8e6f27f49afc3a0ee17758ce9e7594"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada8e6f27f49afc3a0ee17758ce9e7594">&#9670;&nbsp;</a></span>shellBandExists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProSHADE_internal_data::ProSHADE_data::shellBandExists </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>shell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>bandVal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function checks if particular shell has a particular band. </p>
<p>This function is useful for the progressive shell mapping, where it may not be clear in one part of the code whether a particular shell does or does not have a particular band value. Therefore, this function allows simple check.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">shell</td><td>The index (number) of the shell for which the check should be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bandVal</td><td>The band value which should be sought for the shell. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>True if the shell has the band, false otherwise. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03637">3637</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;{</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>[shell]-&gt;getLocalBandwidth( ) &gt;= bandVal )</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;    {</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;        <span class="keywordflow">return</span>                                        ( <span class="keyword">true</span> );</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;    }</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;    {</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;        <span class="keywordflow">return</span>                                        ( <span class="keyword">false</span> );</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;    }</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7e36b0876ff78682480a8ec22f3f5264"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e36b0876ff78682480a8ec22f3f5264">&#9670;&nbsp;</a></span>shiftToBoxCentre()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::shiftToBoxCentre </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for shifting map so that its centre of box is at required position. </p>
<p>This function takes a real world position and shifts the map so that this position is at the centre of the box. This is very useful if you know which position you want, for example, symmetry to be computed over.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for processing of the map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01075">1075</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;{</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;Moving map box centre to &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(0) &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(1) &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(2) &lt;&lt; <span class="stringliteral">&quot; .&quot;</span>;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, ss.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="comment">//================================================ Figure sampling rates</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    proshade_double xSamplingRate                     = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a> ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> );</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    proshade_double ySamplingRate                     = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a> ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> );</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    proshade_double zSamplingRate                     = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> );</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="comment">//================================================ Figure the box centre</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    proshade_double startCentreX                      = ( ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a> ) - <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> ) ) / 2.0 ) * xSamplingRate );</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    proshade_double startCentreY                      = ( ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a> ) - <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> ) ) / 2.0 ) * ySamplingRate );</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    proshade_double startCentreZ                      = ( ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a> ) - <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> ) ) / 2.0 ) * zSamplingRate );</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="comment">//================================================ Figure the requested point distance from box start</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    proshade_double boxStartX                         = settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(0) - ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> ) * xSamplingRate );</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    proshade_double boxStartY                         = settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(1) - ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> ) * ySamplingRate );</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    proshade_double boxStartZ                         = settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(2) - ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> ) * zSamplingRate );</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;   </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="comment">//================================================ Figure the shift</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    proshade_double xShift                            = startCentreX - boxStartX;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    proshade_double yShift                            = startCentreY - boxStartY;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    proshade_double zShift                            = startCentreZ - boxStartZ;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="comment">//================================================ If requested point outside of map, complain</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keywordflow">if</span> ( ( ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(0) &lt; ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> ) * xSamplingRate ) ) ||</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;           ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(0) &gt; ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> ) * xSamplingRate + <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a> ) ) ) ) ||</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;         ( ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(1) &lt; ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> ) * ySamplingRate ) ) ||</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;           ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(1) &gt; ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> ) * ySamplingRate + <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a> ) ) ) ) ||</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;         ( ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(2) &lt; ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> ) * zSamplingRate ) ) ||</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;           ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(2) &gt; ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> ) * zSamplingRate + <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> ) ) ) ) )</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    {</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Requested box centre to be co-ordinate position outside of co-ordinates range. Please re-view the requested box centre position.&quot;</span>, <span class="stringliteral">&quot;WM00068&quot;</span> );</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="comment">//================================================ Do the shift</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>      ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>,</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( xShift ),</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( yShift ),</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( zShift ),</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>,</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ),</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ),</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) );</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    </div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    std::stringstream ss2;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    ss2 &lt;&lt; <span class="stringliteral">&quot;Position &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(0) &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(1) &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">boxCentre</a>.at(2) &lt;&lt; <span class="stringliteral">&quot; set at the centre of the map box.&quot;</span>;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, ss2.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    return ;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8694002911669527ca6266c66285d57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8694002911669527ca6266c66285d57">&#9670;&nbsp;</a></span>shiftToRotationCentre()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::shiftToRotationCentre </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for shifting map so that its rotation centre is at the centre of the box. </p>
<p>This function takes the distance between the detected optimal centre of rotation (as detected by the specialised task) and the centre of the map and proceeds to shift the map so that these two positions would be the same.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for processing of the map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01140">1140</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;{</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;Shifting map rotation centre ( &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6f93b0061117d6bb3fc8cea3c4314957">centrePosition</a>.at(0) &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6f93b0061117d6bb3fc8cea3c4314957">centrePosition</a>.at(1) &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6f93b0061117d6bb3fc8cea3c4314957">centrePosition</a>.at(2) &lt;&lt; <span class="stringliteral">&quot; ) to the centre of the box.&quot;</span>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, ss.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="comment">//================================================ Do the shift</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>      ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>,</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( -settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6f93b0061117d6bb3fc8cea3c4314957">centrePosition</a>.at(0) ),</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( -settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6f93b0061117d6bb3fc8cea3c4314957">centrePosition</a>.at(1) ),</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( -settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6f93b0061117d6bb3fc8cea3c4314957">centrePosition</a>.at(2) ),</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                                                        this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize,</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;xDimIndices ),</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ),</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) );</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    std::stringstream ss2;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    ss2 &lt;&lt; <span class="stringliteral">&quot;Map shifted by &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6f93b0061117d6bb3fc8cea3c4314957">centrePosition</a>.at(0) &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6f93b0061117d6bb3fc8cea3c4314957">centrePosition</a>.at(1) &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6f93b0061117d6bb3fc8cea3c4314957">centrePosition</a>.at(2) &lt;&lt; <span class="stringliteral">&quot; A.&quot;</span>;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, ss2.str(), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">messageShift</a> );</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    return ;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f6ba75b25e201466929bfd4df75688d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f6ba75b25e201466929bfd4df75688d">&#9670;&nbsp;</a></span>so3CoeffsArrayIndex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProSHADE_internal_data::ProSHADE_data::so3CoeffsArrayIndex </td>
          <td>(</td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>order1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>order2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>band</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function gets the SO(3) coefficients array index for a particular so(3) band, order1 and order2 position. </p>
<p>It should be noted that this function assumes that the orders are in the format -l &lt; 0 &lt; l and NOT 0 &lt; 2l + 1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">order1</td><td>The first order for which the SO(3) value index is requested. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order2</td><td>The second order for which the SO(3) value index is requested. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>The band for which the SO(3) value index is requested. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">val</td><td>Index position of the SO(3) value. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04266">4266</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;{</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( so3CoefLoc ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( order1 ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( order2 ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( band ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ) ) ) );</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7170576d4823143e7dd270e0f202d0b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7170576d4823143e7dd270e0f202d0b4">&#9670;&nbsp;</a></span>translateMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::translateMap </td>
          <td>(</td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>trsX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>trsY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>trsZ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function simply translates the map by a given number of Angstroms along the three axes. </p>
<p>This function calls the internal functions to first provide the maximum possible movement by changing the frame of the map and secondly, it make the precise movement within this new frame using the Fourier translation approach.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>The settings object specifying how exactly the rotation is to be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trsX</td><td>The translation expressed as a number of angstroms to move by along the x-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trsY</td><td>The translation expressed as a number of angstroms to move by along the y-axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trsZ</td><td>The translation expressed as a number of angstroms to move by along the z-axis. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00868">868</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;{</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    proshade_single xMov                              = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( -trsX );</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    proshade_single yMov                              = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( -trsY );</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    proshade_single zMov                              = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( -trsZ );</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="comment">//================================================ Move the whole map frame to minimise the Fourier movement</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">ProSHADE_internal_mapManip::moveMapByIndices</a>      ( &amp;xMov, &amp;yMov, &amp;zMov, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">getXDimSize</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">getYDimSize</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">getZDimSize</a>(),</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4c89c860da1836b30a9b2889d3e873ed">getXFromPtr</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#adf61c328db45fcd7692d13a8cde5e092">getXToPtr</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f0d929d1e013cdd23e956d94b7a40da">getYFromPtr</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac859cbd21b93b9d2ed5f119f4ee57f3f">getYToPtr</a>(),</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afbbcec01a6ee7701e3b1d0e61730fadf">getZFromPtr</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a68eb739dd4846a1dd48032eb2cc3f49c">getZToPtr</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a1405b3974697f41c4a73da0cb52a32">getXAxisOrigin</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a298bc9a6aae624a091cd97b842a6b618">getYAxisOrigin</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aeb0242051835b508e9af193dc40a697c">getZAxisOrigin</a>() );</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="comment">//================================================ Finalise the movement by in-frame Fourier movement</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>      ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1bb8bf1e357cc25f68fe93554e44715d">getInternalMap</a>(), xMov, yMov, zMov, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">getXDimSize</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">getYDimSize</a>(), this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">getZDimSize</a>(),</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">getXDim</a>() ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">getYDim</a>() ),</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">getZDim</a>() ) );</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    return ;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a291d70d6d298ce4094b625f588c83b1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a291d70d6d298ce4094b625f588c83b1c">&#9670;&nbsp;</a></span>writeGemmi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::writeGemmi </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>fName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gemmi::Structure&#160;</td>
          <td class="paramname"><em>gemmiStruct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>euA</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>euB</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>euG</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>trsX</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>trsY</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>trsZ</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>rotX</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>rotY</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>rotZ</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>firstModel</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function writes out the gemmi::Structure object with ProSHADE type rotation and translation applied. </p>
<p>This function takes loaded gemmi::Structure object and applies specific rotation and translations to it. These are intended to be the results of ProSHADE Overlay mode compuations, but could be anything else, as long as the usage is correct. Finally, it writes out a PDB formatted file with the now positions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fName</td><td>The filename (including path) to where the output PDB file should be saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gemmiStruct</td><td>gemmi::Structure object which should be modified and written out. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">euA</td><td>The Euler angle alpha by which the co-ordinates should be rotated (leave empty if no rotation is required). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">euB</td><td>The Euler angle beta by which the co-ordinates should be rotated (leave empty if no rotation is required). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">euG</td><td>The Euler angle gamma by which the co-ordinates should be rotated (leave empty if no rotation is required). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trsX</td><td>The translation to be done along X-axis in Angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trsY</td><td>The translation to be done along Y-axis in Angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trsZ</td><td>The translation to be done along Z-axis in Angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotX</td><td>The translation to be done along X-axis in Angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotY</td><td>The translation to be done along Y-axis in Angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotZ</td><td>The translation to be done along Z-axis in Angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">firstModel</td><td>Should only the first model, or rather all of them be used? </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l00996">996</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;{</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="comment">//================================================ If the map was rotated, do the same for the co-ordinates, making sure we take into account the rotation centre of the map</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordflow">if</span> ( ( euA != 0.0 ) || ( euB != 0.0 ) || ( euG != 0.0 ) )</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="comment">//============================================ Rotate the co-ordinates</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a4c1ee71ada97967f49ae1b338d6f43f9">ProSHADE_internal_mapManip::rotatePDBCoordinates</a> ( &amp;gemmiStruct, euA, euB, euG, rotX, rotY, rotZ, firstModel );</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="comment">//================================================ Translate by required translation and the map centering (if applied)</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a2f09d5bdfb5450f2da8395f8770ef137">ProSHADE_internal_mapManip::translatePDBCoordinates</a> ( &amp;gemmiStruct, trsX, trsY, trsZ, firstModel );</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; </div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="comment">//================================================ Write the PDB file</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    std::ofstream outCoOrdFile;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    outCoOrdFile.open                                 ( fName.c_str() );</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="keywordflow">if</span> ( outCoOrdFile.is_open() )</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        gemmi::PdbWriteOptions opt;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        write_pdb                                     ( gemmiStruct, outCoOrdFile, opt );</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    }</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    {</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        std::stringstream hlpMessage;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        hlpMessage &lt;&lt; <span class="stringliteral">&quot;Failed to open the PDB file &quot;</span> &lt;&lt; fName &lt;&lt; <span class="stringliteral">&quot; for output.&quot;</span>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( hlpMessage.str().c_str(), <span class="stringliteral">&quot;EP00048&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;ProSHADE has failed to open the PDB output file. This is\n                    : likely caused by either not having the write privileges\n                    : to the required output path, or by making a mistake in\n                    : the path.&quot;</span> );</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    outCoOrdFile.close                                ( );</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    return ;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a81e6aab30488052e6bdd9b339e8124d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81e6aab30488052e6bdd9b339e8124d8">&#9670;&nbsp;</a></span>writeMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::writeMap </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>fName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>title</em> = <code>&quot;Created&#160;by&#160;ProSHADE&#160;and&#160;written&#160;by&#160;GEMMI&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em> = <code>2</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for writing out the internal structure representation in MRC MAP format. </p>
<p>This function takes all the internal map representation information from the calling object and proceeds to write all this information in MRC MAP format for visualisation and possibly further processing by other software. This function will write out axis order XYZ and spacegroup P1 irrespective of the input axis order and spacegroup.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fName</td><td>The filename (including path) to where the output MAP file should be saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">title</td><td>String with the map title to be written into the header - default value is "Created by ProSHADE and written by GEMMI" </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mode</td><td>The type of the data, leave at default 2 (mean float type) unless you specifically required other types. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l00892">892</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;{</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">//================================================ Create and prepare new Grid gemmi object</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    gemmi::Grid&lt;float&gt; mapData;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    mapData.set_unit_cell                             ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">double</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a> ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">double</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a> ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">double</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">double</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">aAngle</a> ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">double</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9dbcec9f32eb76625d7aa59d8c2701d9">bAngle</a> ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">double</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e2f99f00dd05198b508633cf7f6f080">cAngle</a> ) );</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    mapData.set_size_without_checking                 ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) );</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    mapData.axis_order                                = gemmi::AxisOrder::XYZ;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    mapData.spacegroup                                = &amp;gemmi::get_spacegroup_p1();</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="comment">//================================================ Create and prepare new Ccp4 gemmi object</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    gemmi::Ccp4&lt;float&gt; map;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    map.grid                                          = mapData;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    map.update_ccp4_header                           ( mode );</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="comment">//================================================ Fill in the header</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a2e438f3d348e3e065f798031d5a33d09">ProSHADE_internal_io::writeOutMapHeader</a>           ( &amp;map,</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>,  this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>,  this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>,</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>,     this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>,     this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>,</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">aAngle</a>,       this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9dbcec9f32eb76625d7aa59d8c2701d9">bAngle</a>,       this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e2f99f00dd05198b508633cf7f6f080">cAngle</a>,</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>,        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>,        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>,</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a>,  this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a>,  this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a>,</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">xAxisOrder</a>,   this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">yAxisOrder</a>,   this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">zAxisOrder</a>,</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                                                        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">xGridIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">yGridIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">zGridIndices</a>,</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                                                        title, mode );</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">//================================================ Copy internal map to grid</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    proshade_unsign arrPos                            = 0;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign uIt = 0; uIt &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>; uIt++ )</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign vIt = 0; vIt &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>; vIt++ )</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign wIt = 0; wIt &lt; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>; wIt++ )</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                arrPos                                = wIt + this-&gt;zDimIndices * ( vIt + this-&gt;yDimIndices * uIt );</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                map.grid.set_value                    ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( uIt ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( vIt ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( wIt ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[arrPos] ) );</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            }</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        }</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="comment">//================================================ Update the statistics in the header</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    map.update_ccp4_header                            ( mode, <span class="keyword">true</span> );</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="comment">//================================================ Write out the map</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    map.write_ccp4_map                                ( fName );</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    return ;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aac87b1a87f32a742ea2b41014dac5f7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac87b1a87f32a742ea2b41014dac5f7b">&#9670;&nbsp;</a></span>writeMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::writeMask </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>fName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for writing out a mask in MRC MAP format. </p>
<p>This function takes a mask map and the filename and proceeds to write out the mask into the requested file name in th MRC MAP format. It assumes that the mask has the same dimmensions as the map.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>The filename (including path) to where the output should be saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mask</td><td>Pointer to the mask map array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01038">1038</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;{</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="comment">//================================================ Allocate the memory</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    proshade_double* hlpMap                           = <span class="keyword">new</span> proshade_double[this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( hlpMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="comment">//================================================ Copy original map and over-write with the mask</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ )</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        hlpMap[iter]                                  = this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter];</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter]                       = mask[iter];</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="comment">//================================================ Write out the mask</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a81e6aab30488052e6bdd9b339e8124d8">writeMap</a>                                    ( fName );</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="comment">//================================================ Copy the original map values back</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ); iter++ )</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter]                       = hlpMap[iter];</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    }</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keyword">delete</span>[] hlpMap;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    return ;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6160812636f73e33c1c46a754b68a610"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6160812636f73e33c1c46a754b68a610">&#9670;&nbsp;</a></span>writeOutOverlayFiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::writeOutOverlayFiles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>eulA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>eulB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>eulG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double &gt; *&#160;</td>
          <td class="paramname"><em>rotCentre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double &gt; *&#160;</td>
          <td class="paramname"><em>ultimateTranslation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function writes out the rotated map, co-ordinates and transformation JSON file. </p>
<p>This function takes basically all the results of the overlay mode and appropriately applies them to write out the moved density map, if possible the moved co-ordinates and also the overlay operations listing JSON file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map manipulation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eulA</td><td>The Euler alpha angle value, by which the moving structure is to be rotated by. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eulB</td><td>The Euler beta angle value, by which the moving structure is to be rotated by. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eulG</td><td>The Euler gamma angle value, by which the moving structure is to be rotated by. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotCentre</td><td>The rotation centre position. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ultimateTranslation</td><td>The final translation as determined by the translation function. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l04478">4478</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;{</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;    <span class="comment">//================================================ Write out rotated map</span></div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;    std::stringstream fNameHlp;</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;    fNameHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a833f51d5da64ed09004daa4bf66c013c">overlayStructureName</a> &lt;&lt; <span class="stringliteral">&quot;.map&quot;</span>;</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a81e6aab30488052e6bdd9b339e8124d8">writeMap</a>                                    ( fNameHlp.str() );</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;     </div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;    <span class="comment">//================================================ Write out rotated co-ordinates if possible</span></div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#abc5e6a82b6b44e3666abfc190dc0bc64">ProSHADE_internal_io::isFilePDB</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a> ) )</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;    {</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;        fNameHlp.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;        fNameHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a833f51d5da64ed09004daa4bf66c013c">overlayStructureName</a> &lt;&lt; <span class="stringliteral">&quot;.pdb&quot;</span>;</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a36f99ea1e23f754d65f3612052ce5c42">writePdb</a>                                ( fNameHlp.str(), eulA, eulB, eulG, ultimateTranslation-&gt;at(0), ultimateTranslation-&gt;at(1), ultimateTranslation-&gt;at(2), rotCentre-&gt;at(0), rotCentre-&gt;at(1), rotCentre-&gt;at(2), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">firstModelOnly</a> );</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;    }</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;    </div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;    <span class="comment">//================================================ Write out the json file with the results</span></div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a9f714e15a7bc56dbe846fda6bb1d9c9e">ProSHADE_internal_io::writeRotationTranslationJSON</a> ( rotCentre-&gt;at(0), rotCentre-&gt;at(1), rotCentre-&gt;at(2),</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;                                                         eulA, eulB, eulG,</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;                                                         ultimateTranslation-&gt;at(0), ultimateTranslation-&gt;at(1), ultimateTranslation-&gt;at(2),</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;                                                         settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a30a0c63c3ab63d603776c9a16e1e4044">rotTrsJSONFile</a> );</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;    </div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;    return ;</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;    </div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a36f99ea1e23f754d65f3612052ce5c42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36f99ea1e23f754d65f3612052ce5c42">&#9670;&nbsp;</a></span>writePdb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::writePdb </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>fName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>euA</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>euB</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>euG</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>trsX</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>trsY</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>trsZ</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>rotX</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>rotY</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>rotZ</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>firstModel</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function writes out the co-ordinates file with ProSHADE type rotation and translation applied. </p>
<p>This function first checks if this internal structure originated from co-ordinate file (only if co-ordinates are provided can they be written out). If so, it will proceed to read in the original co-ordinates into gemmi::Structure object and call the gemmi writing out function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fName</td><td>The filename (including path) to where the output PDB file should be saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">euA</td><td>The Euler angle alpha by which the co-ordinates should be rotated (leave empty if no rotation is required). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">euB</td><td>The Euler angle beta by which the co-ordinates should be rotated (leave empty if no rotation is required). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">euG</td><td>The Euler angle gamma by which the co-ordinates should be rotated (leave empty if no rotation is required). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trsX</td><td>The translation to be done along X-axis in Angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trsY</td><td>The translation to be done along Y-axis in Angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trsZ</td><td>The translation to be done along Z-axis in Angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotX</td><td>The translation to be done along X-axis in Angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotY</td><td>The translation to be done along Y-axis in Angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotZ</td><td>The translation to be done along Z-axis in Angstroms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">firstModel</td><td>Should only the first model, or rather all of them be used? </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l00959">959</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;{</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="comment">//================================================ Check for co-ordinate origin</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">if</span> ( !<a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#abc5e6a82b6b44e3666abfc190dc0bc64">ProSHADE_internal_io::isFilePDB</a> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a> ) )</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    {</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Cannot write co-ordinate file if the input file did not contain co-ordinates.&quot;</span>, <span class="stringliteral">&quot;EP00047&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;You have called the WritePDB function on structure which\n                    : was created by reading in a map. This is not allowed as\n                    : ProSHADE cannot create co-ordinates from map file.&quot;</span> );</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    }</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="comment">//================================================ Open PDB file for reading</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    gemmi::Structure pdbFile                          = gemmi::read_structure ( gemmi::MaybeGzipped ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a> ) );</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="comment">//================================================ Write out using the gemmi::Structure object</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a291d70d6d298ce4094b625f588c83b1c">writeGemmi</a>                                  ( fName, pdbFile, euA, euB, euG, trsX, trsY, trsZ, rotX, rotY, rotZ, firstModel );</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    return ;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0cdec5190d4b2ae60350f0f6db751d4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cdec5190d4b2ae60350f0f6db751d4b">&#9670;&nbsp;</a></span>zeroPaddToDims()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_data::ProSHADE_data::zeroPaddToDims </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zDim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function changes the size of a structure to fit the supplied new limits. </p>
<p>This function increases the map size by symetrically adding zeroes in each required dimension. The first zero is always added AFTER the structure, so for even size increases, there will be misplacement of centre of mass. The map position in the "real" world should not change.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xDim</td><td>The X dimension size to which this structure should be padded into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDim</td><td>The Y dimension size to which this structure should be padded into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDim</td><td>The Z dimension size to which this structure should be padded into. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00433">433</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;{</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">if</span> ( ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> &gt; xDim  ) || ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> &gt; yDim  ) || ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> &gt; zDim  ) )</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Cannot zero-pad in negative direction.&quot;</span>, <span class="stringliteral">&quot;EO00034&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The requested padded size of a structure is smaller than\n                    : the current size. If the user sees this error, there is\n                    : likely a considerable bug. Please report this error.&quot;</span> );</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="comment">//================================================ If done, do nothing</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span> ( ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> == xDim  ) &amp;&amp; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> == yDim  ) &amp;&amp; ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> == zDim  ) ) { return ; }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">//================================================ Find out how many zeroes need to be added before and after</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    proshade_unsign addXPre, addYPre, addZPre, addXPost, addYPost, addZPost;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a6f02ec45f8f865fe5a7142509f48e41a">ProSHADE_internal_overlay::computeBeforeAfterZeroCounts</a> ( &amp;addXPre, &amp;addYPre, &amp;addZPre, &amp;addXPost, &amp;addYPost, &amp;addZPost, xDim, yDim, zDim, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> );</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">//================================================ Create a new map</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    proshade_double* newMap                           = <span class="keyword">new</span> proshade_double [xDim * yDim * zDim];</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">//================================================ Do the hard work</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a1e7fa43107bc9a9fce49d5954a93c962">ProSHADE_internal_overlay::paddMapWithZeroes</a>      ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, newMap, xDim, yDim, zDim, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>, this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>, addXPre, addYPre, addZPre );</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">//================================================ Create a new internal map and copy</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keyword">delete</span>[] this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>                                 = <span class="keyword">new</span> proshade_double [xDim * yDim * zDim];</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( xDim * yDim * zDim ); iter++ ) { this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>[iter] = newMap[iter]; }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keyword">delete</span>[] newMap;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">//================================================ Update map related variables</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>                                    = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( xDim ) * ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a> / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ) );</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>                                    = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( yDim ) * ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a> / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) );</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>                                    = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( zDim ) * ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a> / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) );</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>  = xDim    ; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>  = yDim    ; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>  = zDim;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">xGridIndices</a> = xDim    ; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">yGridIndices</a> = yDim    ; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">zGridIndices</a> = zDim;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>       -= addXPre ; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>       -= addYPre ; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>       -= addZPre;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>         += addXPost; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>         += addYPost; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>         += addZPost;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a> -= addXPre ; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a> -= addYPre ; this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a> -= addZPre ;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    return ;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/proshade/<a class="el" href="_pro_s_h_a_d_e__data_8hpp_source.html">ProSHADE_data.hpp</a></li>
<li>src/proshade/<a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a></li>
<li>src/proshade/<a class="el" href="_pro_s_h_a_d_e__distances_8cpp_source.html">ProSHADE_distances.cpp</a></li>
<li>src/proshade/<a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a></li>
<li>src/proshade/<a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a></li>
<li>src/proshade/<a class="el" href="_pro_s_h_a_d_e__wigner_matrices_8cpp_source.html">ProSHADE_wignerMatrices.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a3e7948fd9177bd39ed3dd2320ea2b0bc"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a3e7948fd9177bd39ed3dd2320ea2b0bc">ProSHADE_settings::noIQRsFromMedianNaivePeak</a></div><div class="ttdeci">proshade_double noIQRsFromMedianNaivePeak</div><div class="ttdoc">When doing peak searching, how many IQRs from the median the threshold for peak height should be (in ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00120">ProSHADE_settings.hpp:120</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_ac96ff1a23997199af76e58885a1ee1e2"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#ac96ff1a23997199af76e58885a1ee1e2">ProSHADE_internal_distances::normaliseEMatrices</a></div><div class="ttdeci">void normaliseEMatrices(ProSHADE_internal_data::ProSHADE_data *obj1, ProSHADE_internal_data::ProSHADE_data *obj2, ProSHADE_settings *settings)</div><div class="ttdoc">This function normalises the E matrices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00572">ProSHADE_distances.cpp:572</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__symmetry_8cpp_html_afe2404666a504704a67e634c2abe186c"><div class="ttname"><a href="_pro_s_h_a_d_e__symmetry_8cpp.html#afe2404666a504704a67e634c2abe186c">sortProSHADESymmetryByPeak</a></div><div class="ttdeci">bool sortProSHADESymmetryByPeak(proshade_double *a, proshade_double *b)</div><div class="ttdoc">This function allows using std::sort to sort vectors of ProSHADE symmetry format..</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02886">ProSHADE_symmetry.cpp:2886</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a64323b4117a11f0971cb0d24ec95c64c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a64323b4117a11f0971cb0d24ec95c64c">ProSHADE_internal_data::ProSHADE_data::originalMapYCom</a></div><div class="ttdeci">proshade_double originalMapYCom</div><div class="ttdoc">The COM of the first map to be loaded/computed without any furhter changes being reflacted along the ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00092">ProSHADE_data.hpp:92</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a8324ed7ec9c19df21511f117df80ab11"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a8324ed7ec9c19df21511f117df80ab11">ProSHADE_settings::maxBandwidth</a></div><div class="ttdeci">proshade_unsign maxBandwidth</div><div class="ttdoc">The bandwidth of spherical harmonics decomposition for the largest sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00058">ProSHADE_settings.hpp:58</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a7c88b1152378beca4ccee251f2fb5e06"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a7c88b1152378beca4ccee251f2fb5e06">ProSHADE_internal_mapManip::addExtraBoundSpace</a></div><div class="ttdeci">void addExtraBoundSpace(proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed *&amp;bounds, proshade_single extraSpace)</div><div class="ttdoc">This function takes a set of bounds and adds a given number of Angstroms to them.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01181">ProSHADE_mapManip.cpp:1181</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a7861a96d94b8f7a8eb2946729c330863"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7861a96d94b8f7a8eb2946729c330863">ProSHADE_internal_data::ProSHADE_data::mapMovFromsChangeX</a></div><div class="ttdeci">proshade_double mapMovFromsChangeX</div><div class="ttdoc">When the map is translated, the xFrom and xTo values are changed. This variable holds how much they h...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00094">ProSHADE_data.hpp:94</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ac39560ba9aca9053753c158fb2adb9de"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ac39560ba9aca9053753c158fb2adb9de">ProSHADE_settings::recommendedSymmetryType</a></div><div class="ttdeci">std::string recommendedSymmetryType</div><div class="ttdoc">The symmetry type that ProSHADE finds the best fitting for the structure. Possible values are &quot;&quot; for ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00131">ProSHADE_settings.hpp:131</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa978d98f77a64fb16862b67a0de634be"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa978d98f77a64fb16862b67a0de634be">ProSHADE_internal_data::ProSHADE_data::allocateRotatedSHMemory</a></div><div class="ttdeci">void allocateRotatedSHMemory(void)</div><div class="ttdoc">This function allocates the memory required for storing the rotated Spherical Harmonics coefficients.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00892">ProSHADE_overlay.cpp:892</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_ad4feb37444a93df167935cf42d1209f6"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ad4feb37444a93df167935cf42d1209f6">ProSHADE_internal_mapManip::determinePDBRanges</a></div><div class="ttdeci">void determinePDBRanges(gemmi::Structure pdbFile, proshade_single *xFrom, proshade_single *xTo, proshade_single *yFrom, proshade_single *yTo, proshade_single *zFrom, proshade_single *zTo, bool firstModel)</div><div class="ttdoc">Function for finding the PDB file ranges.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00072">ProSHADE_mapManip.cpp:72</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a5e5d3ccec33e4cf7204124a5647fe5c9"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5e5d3ccec33e4cf7204124a5647fe5c9">ProSHADE_internal_symmetry::findTetra3C2s</a></div><div class="ttdeci">void findTetra3C2s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_signed messageShift, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the 3 C2 symmetries with correct angles requir...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01076">ProSHADE_symmetry.cpp:1076</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae9b0d5959b0f461b3b89ffeb059400fa"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">ProSHADE_internal_data::ProSHADE_data::fileName</a></div><div class="ttdeci">std::string fileName</div><div class="ttdoc">This is the original file from which the data were obtained.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00052">ProSHADE_data.hpp:52</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a14980cdf619bcda026b9aad282c2064b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">ProSHADE_internal_data::ProSHADE_data::zFrom</a></div><div class="ttdeci">proshade_signed zFrom</div><div class="ttdoc">This is the starting index along the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00112">ProSHADE_data.hpp:112</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a18d456057604616a7cf6b68f59b4f2d0"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a18d456057604616a7cf6b68f59b4f2d0">ProSHADE_internal_symmetry::detectOctahedralSymmetry</a></div><div class="ttdeci">bool detectOctahedralSymmetry(std::vector&lt; proshade_double * &gt; *CSymList, proshade_double axErr, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and decides whether basic requirements for octahhedral s...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01273">ProSHADE_symmetry.cpp:1273</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a30a0c63c3ab63d603776c9a16e1e4044"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a30a0c63c3ab63d603776c9a16e1e4044">ProSHADE_settings::rotTrsJSONFile</a></div><div class="ttdeci">std::string rotTrsJSONFile</div><div class="ttdoc">The filename to which the rotation and translation operations are to be saved into.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00146">ProSHADE_settings.hpp:146</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aceb7facd99379a000035ce35263577d5"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">ProSHADE_internal_data::ProSHADE_data::xDimIndices</a></div><div class="ttdeci">proshade_unsign xDimIndices</div><div class="ttdoc">This is the size of the map cell x dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00065">ProSHADE_data.hpp:65</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_af4d641d62864e4adf67c1365b0960970"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">ProSHADE_internal_data::ProSHADE_data::getZDimSize</a></div><div class="ttdeci">proshade_single getZDimSize(void)</div><div class="ttdoc">This function allows access to the map size in angstroms along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03919">ProSHADE_data.cpp:3919</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_afe3659ed2939880f96701cb162d8a12d"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#afe3659ed2939880f96701cb162d8a12d">ProSHADE_internal_mapManip::changePDBBFactors</a></div><div class="ttdeci">void changePDBBFactors(gemmi::Structure *pdbFile, proshade_double newBFactorValue, bool firstModel)</div><div class="ttdoc">Function for changing the PDB B-factor values to a specific single value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00446">ProSHADE_mapManip.cpp:446</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aae85fef5742e6c6c9ef7bda2ff0f7d23"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae85fef5742e6c6c9ef7bda2ff0f7d23">ProSHADE_internal_data::ProSHADE_data::readInMAP</a></div><div class="ttdeci">void readInMAP(ProSHADE_settings *settings, proshade_double *maskArr=nullptr, proshade_unsign maskXDim=0, proshade_unsign maskYDim=0, proshade_unsign maskZDim=0, proshade_double *weightsArr=nullptr, proshade_unsign weigXDim=0, proshade_unsign weigYDim=0, proshade_unsign weigZDim=0)</div><div class="ttdoc">Function for reading map data using gemmi library.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00619">ProSHADE_data.cpp:619</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_ad14d6427df4269728627fcd880abaf31"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#ad14d6427df4269728627fcd880abaf31">ProSHADE_internal_misc::sortSymInvFoldHlp</a></div><div class="ttdeci">bool sortSymInvFoldHlp(const proshade_double *a, const proshade_double *b)</div><div class="ttdoc">This function compares two arrays of two based on the first number, sorting highest first.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00321">ProSHADE_misc.cpp:321</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a530ad7e3396cbcbc1814051031070a8b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a530ad7e3396cbcbc1814051031070a8b">ProSHADE_internal_data::ProSHADE_data::zDimSizeOriginal</a></div><div class="ttdeci">proshade_single zDimSizeOriginal</div><div class="ttdoc">This is the size of the map cell z dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00084">ProSHADE_data.hpp:84</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a8a7c6330e101fb6d729aaf6f545db9c8"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a8a7c6330e101fb6d729aaf6f545db9c8">ProSHADE_internal_maths::vectorMeanAndSD</a></div><div class="ttdeci">void vectorMeanAndSD(std::vector&lt; proshade_double &gt; *vec, proshade_double *&amp;ret)</div><div class="ttdoc">Function to get vector mean and standard deviation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00121">ProSHADE_maths.cpp:121</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_abc5e6a82b6b44e3666abfc190dc0bc64"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#abc5e6a82b6b44e3666abfc190dc0bc64">ProSHADE_internal_io::isFilePDB</a></div><div class="ttdeci">bool isFilePDB(std::string fName)</div><div class="ttdoc">Function determining if the input data type is PDB.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00032">ProSHADE_io.cpp:32</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere_html_a331955e5674dd112f83402375dce7bc5"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#a331955e5674dd112f83402375dce7bc5">ProSHADE_internal_spheres::ProSHADE_sphere::getLocalBandwidth</a></div><div class="ttdeci">proshade_unsign getLocalBandwidth(void)</div><div class="ttdoc">This function returns the local bandwidth.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l00390">ProSHADE_spheres.cpp:390</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_afcece610f52c27cadefb217f1d0c278c"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#afcece610f52c27cadefb217f1d0c278c">ProSHADE_settings::maxSymmetryFold</a></div><div class="ttdeci">proshade_unsign maxSymmetryFold</div><div class="ttdoc">The highest symmetry fold to search for.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00136">ProSHADE_settings.hpp:136</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aedb2ba02e77d5795077df91b2578ab29"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">ProSHADE_internal_data::ProSHADE_data::xGridIndices</a></div><div class="ttdeci">proshade_unsign xGridIndices</div><div class="ttdoc">As far as I know, this is identical to the xDimIndices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00068">ProSHADE_data.hpp:68</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a37f26ac4bc76e4f4c5da77dd0eace56e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37f26ac4bc76e4f4c5da77dd0eace56e">ProSHADE_internal_data::ProSHADE_data::translationMap</a></div><div class="ttdeci">proshade_complex * translationMap</div><div class="ttdoc">This is where the translation map will be held, if at all used.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00133">ProSHADE_data.hpp:133</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__data_html_ac2cdde3bc58869b04f1aa39aee9b01bc"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">ProSHADE_internal_data::joinElementsFromDifferentGroups</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; joinElementsFromDifferentGroups(std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *first, std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *second, proshade_double matrixTolerance, bool combine)</div><div class="ttdoc">This function joins two group element lists using only unique elements.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03092">ProSHADE_data.cpp:3092</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a603841095e16abd0492dfc6db052fda7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">ProSHADE_internal_data::ProSHADE_data::xAxisOrder</a></div><div class="ttdeci">proshade_unsign xAxisOrder</div><div class="ttdoc">This is the order of the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00071">ProSHADE_data.hpp:71</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_af4dec365c5650c93198d73b6d259e4e7"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af4dec365c5650c93198d73b6d259e4e7">ProSHADE_internal_symmetry::findIcos6C5s</a></div><div class="ttdeci">void findIcos6C5s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_signed messageShift, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the six C5 symmetries with given angles requir...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02032">ProSHADE_symmetry.cpp:2032</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a94b04108aa1a9406eb3c5eb61749140b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94b04108aa1a9406eb3c5eb61749140b">ProSHADE_internal_data::ProSHADE_data::rotSphericalHarmonics</a></div><div class="ttdeci">proshade_complex ** rotSphericalHarmonics</div><div class="ttdoc">A set of rotated spherical harmonics values arrays for each sphere, used only if map rotation is requ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00122">ProSHADE_data.hpp:122</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a450e03005d24cc3e58d2d05fb3bc5027"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a450e03005d24cc3e58d2d05fb3bc5027">ProSHADE_settings::determineAllSHValues</a></div><div class="ttdeci">void determineAllSHValues(proshade_unsign xDim, proshade_unsign yDim, proshade_single xDimAngs, proshade_single yDimAngs, proshade_single zDimAngs)</div><div class="ttdoc">This function determines all the required values for spherical harmonics computation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l01853">ProSHADE.cpp:1853</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5f934f331c4d3bc7c0a6f63486b2f90e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">ProSHADE_internal_data::ProSHADE_data::sphericalHarmonics</a></div><div class="ttdeci">proshade_complex ** sphericalHarmonics</div><div class="ttdoc">A set of spherical harmonics values arrays for each sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00121">ProSHADE_data.hpp:121</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a38ce8efbbe05220793b5f01f0fef07a6"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a38ce8efbbe05220793b5f01f0fef07a6">ProSHADE_internal_symmetry::predictOctaAxes</a></div><div class="ttdeci">void predictOctaAxes(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, proshade_double minPeakHeight)</div><div class="ttdoc">This function predicts all octahedral point group symmetry axes from the cyclic point groups list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02337">ProSHADE_symmetry.cpp:2337</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9d11953ff54d5774659117be22bdb3b3"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9d11953ff54d5774659117be22bdb3b3">ProSHADE_internal_data::ProSHADE_data::interpolateMapFromSpheres</a></div><div class="ttdeci">void interpolateMapFromSpheres(proshade_double *&amp;densityMapRotated)</div><div class="ttdoc">This function interpolates the density map from the sphere mapped data.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l01114">ProSHADE_overlay.cpp:1114</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8e2f99f00dd05198b508633cf7f6f080"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e2f99f00dd05198b508633cf7f6f080">ProSHADE_internal_data::ProSHADE_data::cAngle</a></div><div class="ttdeci">proshade_single cAngle</div><div class="ttdoc">This is the angle c of the map cell in degrees.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00064">ProSHADE_data.hpp:64</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_aef7a2435e9d3616d860aeee2d94dba55"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aef7a2435e9d3616d860aeee2d94dba55">ProSHADE_internal_symmetry::predictTetraAxes</a></div><div class="ttdeci">void predictTetraAxes(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, proshade_double minPeakHeight)</div><div class="ttdoc">This function predicts all tetrahedral point group symmetry axes from the cyclic point groups list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03558">ProSHADE_symmetry.cpp:3558</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a33312dd4333617b460628e4db4bf41fc"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a33312dd4333617b460628e4db4bf41fc">ProSHADE_internal_data::ProSHADE_data::so3CoeffsInverse</a></div><div class="ttdeci">proshade_complex * so3CoeffsInverse</div><div class="ttdoc">The inverse coefficients obtained by inverse SO(3) Fourier Transform (SOFT) - i.e....</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00130">ProSHADE_data.hpp:130</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8a1405b3974697f41c4a73da0cb52a32"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a1405b3974697f41c4a73da0cb52a32">ProSHADE_internal_data::ProSHADE_data::getXAxisOrigin</a></div><div class="ttdeci">proshade_signed * getXAxisOrigin(void)</div><div class="ttdoc">This function allows access to the map X axis origin value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04019">ProSHADE_data.cpp:4019</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a262d9e21cd6b81b8bda35ec22eb363dd"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a></div><div class="ttdeci">proshade_signed addAxisUnlessSame(proshade_unsign fold, proshade_double axX, proshade_double axY, proshade_double axZ, proshade_double axHeight, proshade_double averageFSC, std::vector&lt; proshade_double * &gt; *prosp, proshade_double axErr)</div><div class="ttdoc">This function simply creates a new axis from information in aruments and tests if no such axis alread...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01657">ProSHADE_symmetry.cpp:1657</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a668381d94a927275b3d839549475c7da"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">ProSHADE_internal_data::ProSHADE_data::yCom</a></div><div class="ttdeci">proshade_double yCom</div><div class="ttdoc">The COM of the map after processing along the Y-axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00078">ProSHADE_data.hpp:78</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a633435d4c8a7fd6533016c00ad9ba791"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a633435d4c8a7fd6533016c00ad9ba791">ProSHADE_settings::boundsExtraSpace</a></div><div class="ttdeci">proshade_single boundsExtraSpace</div><div class="ttdoc">The number of extra angstroms to be added to all re-boxing bounds just for safety.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00093">ProSHADE_settings.hpp:93</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a></div><div class="ttdoc">This class contains all inputed data for the rotation function angle-axis converted spheres.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8hpp_source.html#l00057">ProSHADE_maths.hpp:58</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__exception_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a></div><div class="ttdoc">This class is the representation of ProSHADE exception.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__exceptions_8hpp_source.html#l00036">ProSHADE_exceptions.hpp:37</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a33c650c19a6954800bba6b3a8f5842e6"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a33c650c19a6954800bba6b3a8f5842e6">ProSHADE_internal_symmetry::findPredictedAxesHeights</a></div><div class="ttdeci">void findPredictedAxesHeights(std::vector&lt; proshade_double * &gt; *ret, ProSHADE_internal_data::ProSHADE_data *dataObj, ProSHADE_settings *settings)</div><div class="ttdoc">This function finds the rotation function value for all axes supplied in the ret parameter.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03022">ProSHADE_symmetry.cpp:3022</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a618c04a2c1d7f0a506d0bb3d7a0da444"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">ProSHADE_settings::allDetectedDAxes</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; allDetectedDAxes</div><div class="ttdoc">The vector of all detected dihedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00156">ProSHADE_settings.hpp:156</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a51c87d0b415c8eaa517dbb9b5496e7e9"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a51c87d0b415c8eaa517dbb9b5496e7e9">ProSHADE_settings::blurFactor</a></div><div class="ttdeci">proshade_single blurFactor</div><div class="ttdoc">This is the amount by which B-factors should be increased to create the blurred map for masking.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00078">ProSHADE_settings.hpp:78</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a0b0608e80f20087b24cc9498767f0894"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0b0608e80f20087b24cc9498767f0894">ProSHADE_internal_data::ProSHADE_data::saveDetectedSymmetries</a></div><div class="ttdeci">void saveDetectedSymmetries(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSyms, std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *allCs)</div><div class="ttdoc">This function takes the results of point group searches and saves then into the output variables.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02276">ProSHADE_data.cpp:2276</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a7c941c912cd17ad86057b8d7a15b9a21"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a7c941c912cd17ad86057b8d7a15b9a21">ProSHADE_settings::maskMap</a></div><div class="ttdeci">bool maskMap</div><div class="ttdoc">Should the map be masked from noise?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00080">ProSHADE_settings.hpp:80</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a6dc170d9826bad9ce4a2c31a033f7f6a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a6dc170d9826bad9ce4a2c31a033f7f6a">ProSHADE_settings::requestedSymmetryFold</a></div><div class="ttdeci">proshade_unsign requestedSymmetryFold</div><div class="ttdoc">The fold of the requested symmetry (only applicable to C and D symmetry types).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00134">ProSHADE_settings.hpp:134</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ab59297b3604ced939e30eaacd2eaaccb"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">ProSHADE_settings::requestedSymmetryType</a></div><div class="ttdeci">std::string requestedSymmetryType</div><div class="ttdoc">The symmetry type requested by the user. Allowed values are C, D, T, O and I.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00133">ProSHADE_settings.hpp:133</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a4f8698493efda1aa3e057c266d5c697b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4f8698493efda1aa3e057c266d5c697b">ProSHADE_internal_data::ProSHADE_data::allocateRRPMemory</a></div><div class="ttdeci">void allocateRRPMemory()</div><div class="ttdoc">This function allocates the required memory for the RRP matrices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00031">ProSHADE_distances.cpp:31</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a51d7b9d87d536ef0c48d820872bc9185"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">ProSHADE_internal_data::ProSHADE_data::getXDimSize</a></div><div class="ttdeci">proshade_single getXDimSize(void)</div><div class="ttdoc">This function allows access to the map size in angstroms along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03899">ProSHADE_data.cpp:3899</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a86e2bb172f766ab4a620df482d2fe481"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a86e2bb172f766ab4a620df482d2fe481">ProSHADE_internal_misc::addToUnsignVectorVector</a></div><div class="ttdeci">void addToUnsignVectorVector(std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; *vecToAddTo, std::vector&lt; proshade_unsign &gt; elementToAdd)</div><div class="ttdoc">Adds the element to the vector of vectors.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00211">ProSHADE_misc.cpp:211</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1bb8bf1e357cc25f68fe93554e44715d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1bb8bf1e357cc25f68fe93554e44715d">ProSHADE_internal_data::ProSHADE_data::getInternalMap</a></div><div class="ttdeci">proshade_double *&amp; getInternalMap(void)</div><div class="ttdoc">This function allows access to the first map array value address.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04049">ProSHADE_data.cpp:4049</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a411b398b06557387320b56c6b8233fc4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">ProSHADE_internal_data::ProSHADE_data::noSpheres</a></div><div class="ttdeci">proshade_unsign noSpheres</div><div class="ttdoc">The number of spheres with map projected onto them.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00119">ProSHADE_data.hpp:119</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ad42474a333f9b605ccad7ecfb72afb2e"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ad42474a333f9b605ccad7ecfb72afb2e">ProSHADE_settings::removeNegativeDensity</a></div><div class="ttdeci">bool removeNegativeDensity</div><div class="ttdoc">Should the negative density be removed from input files?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00047">ProSHADE_settings.hpp:47</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae477e3c0d7b866e6069d8603950afe51"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">ProSHADE_internal_data::ProSHADE_data::getYDimSize</a></div><div class="ttdeci">proshade_single getYDimSize(void)</div><div class="ttdoc">This function allows access to the map size in angstroms along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03909">ProSHADE_data.cpp:3909</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a99ab4a34f3a42c17f923ef131c64b4a7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ab4a34f3a42c17f923ef131c64b4a7">ProSHADE_internal_data::ProSHADE_data::inputOrder</a></div><div class="ttdeci">proshade_unsign inputOrder</div><div class="ttdoc">This value is the input order - it is useful to know for writing out files, so that they would not ov...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00140">ProSHADE_data.hpp:140</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a42699d52d1be0d24e58deea4e25439bf"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a42699d52d1be0d24e58deea4e25439bf">ProSHADE_internal_mapManip::getMaskFromBlurr</a></div><div class="ttdeci">void getMaskFromBlurr(proshade_double *&amp;blurMap, proshade_double *&amp;outMap, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_single noIQRs)</div><div class="ttdoc">Function for computing mask from blurred map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01074">ProSHADE_mapManip.cpp:1074</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a20fd31138680dd622058732eba31dca5"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">ProSHADE_internal_data::ProSHADE_data::zDimSize</a></div><div class="ttdeci">proshade_single zDimSize</div><div class="ttdoc">This is the size of the map cell z dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00061">ProSHADE_data.hpp:61</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad5416490eb3eba7539d08a5b324fbadb"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">ProSHADE_internal_data::ProSHADE_data::so3Coeffs</a></div><div class="ttdeci">proshade_complex * so3Coeffs</div><div class="ttdoc">The coefficients obtained by SO(3) Fourier Transform (SOFT), in this case derived from the E matrices...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00129">ProSHADE_data.hpp:129</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a29445fb6221eed35a32147814a3f58d5"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a29445fb6221eed35a32147814a3f58d5">ProSHADE_settings::saveMask</a></div><div class="ttdeci">bool saveMask</div><div class="ttdoc">Should the mask be saved?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00084">ProSHADE_settings.hpp:84</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a7d0a63b2ac89e4f0df85ce5053c6bd87"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">ProSHADE_settings::requestedResolution</a></div><div class="ttdeci">proshade_single requestedResolution</div><div class="ttdoc">The resolution to which the calculations are to be done.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00050">ProSHADE_settings.hpp:50</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_a6e15740000a0079151a2d24dbbdebb2e"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#a6e15740000a0079151a2d24dbbdebb2e">ProSHADE_internal_distances::isBandWithinShell</a></div><div class="ttdeci">bool isBandWithinShell(proshade_unsign bandInQuestion, proshade_unsign shellInQuestion, ProSHADE_internal_spheres::ProSHADE_sphere **spheres)</div><div class="ttdoc">This function checks if a band is available for a given shell.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00139">ProSHADE_distances.cpp:139</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a471ec29b27c3a402d18b20fee8035f1a"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a471ec29b27c3a402d18b20fee8035f1a">ProSHADE_internal_data::ProSHADE_data::mapCOMProcessChangeX</a></div><div class="ttdeci">proshade_double mapCOMProcessChangeX</div><div class="ttdoc">The change in X axis between the creation of the structure (originalMapXCom) and just before rotation...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00097">ProSHADE_data.hpp:97</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ac914dc8b6ee2e35286beabb1b6611b74"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">ProSHADE_settings::minSymPeak</a></div><div class="ttdeci">proshade_double minSymPeak</div><div class="ttdoc">Minimum average peak for symmetry axis to be considered as &quot;real&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00130">ProSHADE_settings.hpp:130</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_aaad67127777eab70acca5952a7838d26"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aaad67127777eab70acca5952a7838d26">ProSHADE_internal_mapManip::findMAPCOMValues</a></div><div class="ttdeci">void findMAPCOMValues(proshade_double *map, proshade_double *xCom, proshade_double *yCom, proshade_double *zCom, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed xFrom, proshade_signed xTo, proshade_signed yFrom, proshade_signed yTo, proshade_signed zFrom, proshade_signed zTo)</div><div class="ttdoc">This function finds the Centre of Mass for a map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00240">ProSHADE_mapManip.cpp:240</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_afdac8ed8f140bdcd289ee666b61789d4"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#afdac8ed8f140bdcd289ee666b61789d4">ProSHADE_internal_mapManip::blurSharpenMap</a></div><div class="ttdeci">void blurSharpenMap(proshade_double *&amp;map, proshade_double *&amp;maskedMap, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_single blurringFactor)</div><div class="ttdoc">Function for blurring/sharpening maps.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00974">ProSHADE_mapManip.cpp:974</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2a3fdf194eca61b1ccfa5bdd2f586e0b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2a3fdf194eca61b1ccfa5bdd2f586e0b">ProSHADE_internal_data::ProSHADE_data::originalMapXCom</a></div><div class="ttdeci">proshade_double originalMapXCom</div><div class="ttdoc">The COM of the first map to be loaded/computed without any furhter changes being reflacted along the ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00091">ProSHADE_data.hpp:91</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_aaacee048ce8a3489edc77afcb54f0ca0"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">ProSHADE_settings::setDetectedSymmetry</a></div><div class="ttdeci">void setDetectedSymmetry(proshade_double *sym)</div><div class="ttdoc">Sets the final detected symmetry axes information.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l01553">ProSHADE.cpp:1553</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a1e3fc8ac7658bf54776a0fbb4e8286cd"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a1e3fc8ac7658bf54776a0fbb4e8286cd">ProSHADE_internal_io::applyMask</a></div><div class="ttdeci">void applyMask(proshade_double *&amp;map, std::string maskFile, proshade_unsign xDimInds, proshade_unsign yDimInds, proshade_unsign zDimInds, proshade_signed verbose, proshade_signed messageShift, proshade_double *maskArray=nullptr, proshade_unsign maXInds=0, proshade_unsign maYInds=0, proshade_unsign maZInds=0)</div><div class="ttdoc">This function reads and applies the mask to the map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00295">ProSHADE_io.cpp:295</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9598e9a38546e3bf260bc09c0c9366a2"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9598e9a38546e3bf260bc09c0c9366a2">ProSHADE_internal_data::ProSHADE_data::xDimIndicesOriginal</a></div><div class="ttdeci">proshade_unsign xDimIndicesOriginal</div><div class="ttdoc">This is the size of the map cell x dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00085">ProSHADE_data.hpp:85</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a94dfbe2867f4e294dbb49284881fcb2a"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a></div><div class="ttdeci">void moveMapByFourier(proshade_double *&amp;map, proshade_single xMov, proshade_single yMov, proshade_single zMov, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed xDim, proshade_signed yDim, proshade_signed zDim)</div><div class="ttdoc">Function for moving map back to original PDB location by using Fourier transformation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00813">ProSHADE_mapManip.cpp:813</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a2f1e4debc49664de8842d1b42be74d2d"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a2f1e4debc49664de8842d1b42be74d2d">ProSHADE_settings::progressiveSphereMapping</a></div><div class="ttdeci">bool progressiveSphereMapping</div><div class="ttdoc">If true, each shell will have its own angular resolution dependent on the actual number of map points...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00107">ProSHADE_settings.hpp:107</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a1f9e6ab7a6db084069402d83ad152c01"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a1f9e6ab7a6db084069402d83ad152c01">ProSHADE_internal_mapManip::movePDBForMapCalc</a></div><div class="ttdeci">void movePDBForMapCalc(gemmi::Structure *pdbFile, proshade_single xMov, proshade_single yMov, proshade_single zMov, bool firstModel)</div><div class="ttdoc">Function for moving co-ordinate atoms to better suit theoretical map computation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00575">ProSHADE_mapManip.cpp:575</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a42e4b11981a2d3a518cb3c70e5470fb2"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a42e4b11981a2d3a518cb3c70e5470fb2">ProSHADE_settings::maxSphereDists</a></div><div class="ttdeci">proshade_single maxSphereDists</div><div class="ttdoc">The distance between spheres in spherical mapping for the largest sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00065">ProSHADE_settings.hpp:65</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a367d0cd13e3d7a2648488980220ca69b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">ProSHADE_internal_data::ProSHADE_data::maxShellBand</a></div><div class="ttdeci">proshade_unsign maxShellBand</div><div class="ttdoc">The maximum band for any shell of the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00123">ProSHADE_data.hpp:123</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a77cabdd70039e82f8c0cbb07fefd3960"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a77cabdd70039e82f8c0cbb07fefd3960">ProSHADE_internal_data::ProSHADE_data::originalPdbRotCenY</a></div><div class="ttdeci">proshade_double originalPdbRotCenY</div><div class="ttdoc">The centre of rotation as it relates to the original PDB positions (and not the ProSHADE internal map...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00103">ProSHADE_data.hpp:103</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a188b648a0ad28b598d682ca14f288dc4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a188b648a0ad28b598d682ca14f288dc4">ProSHADE_internal_data::ProSHADE_data::getSpherePositions</a></div><div class="ttdeci">void getSpherePositions(ProSHADE_settings *settings)</div><div class="ttdoc">This function determines the sphere positions (radii) for sphere mapping.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01746">ProSHADE_data.cpp:1746</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa67115a6b234764c958899863fb60b54"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa67115a6b234764c958899863fb60b54">ProSHADE_internal_data::ProSHADE_data::invertMirrorMap</a></div><div class="ttdeci">void invertMirrorMap(ProSHADE_settings *settings)</div><div class="ttdoc">Function for inverting the map to its mirror image.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01175">ProSHADE_data.cpp:1175</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_abd9fe573a48f499dd7d1df4f779222f1"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a></div><div class="ttdeci">void getRotationMatrixFromEulerZXZAngles(proshade_double eulerAlpha, proshade_double eulerBeta, proshade_double eulerGamma, proshade_double *matrix)</div><div class="ttdoc">Function to find the rotation matrix from Euler angles (ZXZ convention).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01020">ProSHADE_maths.cpp:1020</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1fdc5b9df47ff8de3a5f2f6e6ce233a5"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1fdc5b9df47ff8de3a5f2f6e6ce233a5">ProSHADE_internal_data::ProSHADE_data::getDihedralSymmetriesList</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; getDihedralSymmetriesList(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSymList)</div><div class="ttdoc">This function obtains a list of all D symmetries from already computed C symmetries list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00302">ProSHADE_symmetry.cpp:302</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__data_8cpp_html_aa430bcd7dc43633680907360656b7799"><div class="ttname"><a href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a></div><div class="ttdeci">bool checkElementsFormGroup(std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *elements, proshade_double matrixTolerance)</div><div class="ttdoc">This function checks if all group element products produce another group element.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03051">ProSHADE_data.cpp:3051</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a4bd7a9a5ea6cac4302ec1cd80922c617"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4bd7a9a5ea6cac4302ec1cd80922c617">ProSHADE_internal_data::ProSHADE_data::getMapCOMProcessChange</a></div><div class="ttdeci">std::vector&lt; proshade_double &gt; getMapCOMProcessChange(void)</div><div class="ttdoc">This function allows access to the translation caused by structure processing.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04069">ProSHADE_data.cpp:4069</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__overlay_html_a6f02ec45f8f865fe5a7142509f48e41a"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__overlay.html#a6f02ec45f8f865fe5a7142509f48e41a">ProSHADE_internal_overlay::computeBeforeAfterZeroCounts</a></div><div class="ttdeci">void computeBeforeAfterZeroCounts(proshade_unsign *addXPre, proshade_unsign *addYPre, proshade_unsign *addZPre, proshade_unsign *addXPost, proshade_unsign *addYPost, proshade_unsign *addZPost, proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_unsign xDimIndices, proshade_unsign yDimIndices, proshade_unsign zDimIndices)</div><div class="ttdoc">This function finds the number of zeroes to be added after and before the structure along each dimens...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00492">ProSHADE_overlay.cpp:492</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa200af7e84ec7a17ecfd54a45a8ffafe"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa200af7e84ec7a17ecfd54a45a8ffafe">ProSHADE_internal_data::ProSHADE_data::saveRequestedSymmetryD</a></div><div class="ttdeci">void saveRequestedSymmetryD(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *DSym, std::vector&lt; proshade_double * &gt; *axes, fftw_complex *mapData, fftw_complex *origCoeffs, fftw_complex *fCoeffs, fftw_plan *planForwardFourier, proshade_signed noBins, proshade_signed *binIndexing, proshade_double **bindata, proshade_signed *binCounts, proshade_double *&amp;fscByBin)</div><div class="ttdoc">This function takes the D symmetries and searched for the requested symmetry.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02876">ProSHADE_data.cpp:2876</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a487131ae5dc44f8667908bf64725b4ab"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a487131ae5dc44f8667908bf64725b4ab">ProSHADE_internal_data::ProSHADE_data::mapCOMProcessChangeZ</a></div><div class="ttdeci">proshade_double mapCOMProcessChangeZ</div><div class="ttdoc">The change in Z axis between the creation of the structure (originalMapZCom) and just before rotation...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00099">ProSHADE_data.hpp:99</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a7c96697585083a53f83556e70e4faca8"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a7c96697585083a53f83556e70e4faca8">ProSHADE_settings::maskingThresholdIQRs</a></div><div class="ttdeci">proshade_single maskingThresholdIQRs</div><div class="ttdoc">Number of inter-quartile ranges from the median to be used for thresholding the blurred map for maski...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00079">ProSHADE_settings.hpp:79</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a2019a6bae1b3e6f7d8805ae2734b769e"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a2019a6bae1b3e6f7d8805ae2734b769e">ProSHADE_settings::usePhase</a></div><div class="ttdeci">bool usePhase</div><div class="ttdoc">If true, the full data will be used, if false, Patterson maps will be used instead and phased data wi...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00062">ProSHADE_settings.hpp:62</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1ae6821c27e7facf63839c9fc678c9c7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ae6821c27e7facf63839c9fc678c9c7">ProSHADE_internal_data::ProSHADE_data::xDimSizeOriginal</a></div><div class="ttdeci">proshade_single xDimSizeOriginal</div><div class="ttdoc">This is the size of the map cell x dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00082">ProSHADE_data.hpp:82</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ae42ba1e294d1887c71b763f9bb5519cc"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">ProSHADE_settings::allDetectedTAxes</a></div><div class="ttdeci">std::vector&lt; proshade_unsign &gt; allDetectedTAxes</div><div class="ttdoc">The vector of all detected tetrahedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00157">ProSHADE_settings.hpp:157</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__messages_html_addbb90f2b4199441f60e241ac850daa2"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a></div><div class="ttdeci">void printWarningMessage(proshade_signed verbose, std::string message, std::string warnCode)</div><div class="ttdoc">General stderr message printing (used for warnings).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__messages_8cpp_source.html#l00102">ProSHADE_messages.cpp:102</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a63ae2cc7f413d224e5d651ed579e9afb"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a63ae2cc7f413d224e5d651ed579e9afb">ProSHADE_internal_io::figureDataType</a></div><div class="ttdeci">InputType figureDataType(std::string fName)</div><div class="ttdoc">Function determining input data type.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00923">ProSHADE_io.cpp:923</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a5db74cc13dd4b64cf0a8377ed078b47c"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a5db74cc13dd4b64cf0a8377ed078b47c">ProSHADE_internal_mapManip::reSampleMapToResolutionTrilinear</a></div><div class="ttdeci">void reSampleMapToResolutionTrilinear(proshade_double *&amp;map, proshade_single resolution, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_single *&amp;corrs)</div><div class="ttdoc">This function re-samples a map to conform to given resolution using tri-linear interpolation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01217">ProSHADE_mapManip.cpp:1217</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aed1c8e0ffb847b093a736c5156f86e9b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aed1c8e0ffb847b093a736c5156f86e9b">ProSHADE_internal_data::ProSHADE_data::zAxisOriginOriginal</a></div><div class="ttdeci">proshade_signed zAxisOriginOriginal</div><div class="ttdoc">This is the origin position along the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00090">ProSHADE_data.hpp:90</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html">ProSHADE_internal_spheres::ProSHADE_sphere</a></div><div class="ttdoc">This class contains all inputed and derived data for a single sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spheres_8hpp_source.html#l00048">ProSHADE_spheres.hpp:49</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere_html_aca3c4a9ccce4508de9e292c4628d703e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#aca3c4a9ccce4508de9e292c4628d703e">ProSHADE_internal_spheres::ProSHADE_sphere::getRotatedMappedData</a></div><div class="ttdeci">proshade_double getRotatedMappedData(proshade_unsign pos)</div><div class="ttdoc">This function gets the rotated mapped data value for a particular position.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l00627">ProSHADE_spheres.cpp:627</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_affb17d9099f0b85b3af04a78d5c670f4"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#affb17d9099f0b85b3af04a78d5c670f4">ProSHADE_settings::maskFileName</a></div><div class="ttdeci">std::string maskFileName</div><div class="ttdoc">The filename to which mask should be saved.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00085">ProSHADE_settings.hpp:85</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a4d869a528d0af64bc3688a9a48514061"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">ProSHADE_settings::allDetectedOAxes</a></div><div class="ttdeci">std::vector&lt; proshade_unsign &gt; allDetectedOAxes</div><div class="ttdoc">The vector of all detected octahedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00158">ProSHADE_settings.hpp:158</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__overlay_html_a448b6438ea9979e18af75f419f175603"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__overlay.html#a448b6438ea9979e18af75f419f175603">ProSHADE_internal_overlay::freeTranslationFunctionMemory</a></div><div class="ttdeci">void freeTranslationFunctionMemory(fftw_complex *&amp;tmpIn1, fftw_complex *&amp;tmpOut1, fftw_complex *&amp;tmpIn2, fftw_complex *&amp;tmpOut2, fftw_complex *&amp;resOut, fftw_plan &amp;forwardFourierObj1, fftw_plan &amp;forwardFourierObj2, fftw_plan &amp;inverseFourierCombo)</div><div class="ttdoc">This function releases the memory for the Fourier transforms required for translation function comput...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00406">ProSHADE_overlay.cpp:406</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a82b2d8f8c05da2eccb5561e6455b4d44"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">ProSHADE_internal_data::ProSHADE_data::eMatrices</a></div><div class="ttdeci">proshade_complex *** eMatrices</div><div class="ttdoc">The trace sigma and full rotation function c*conj(c) integral tables.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00127">ProSHADE_data.hpp:127</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a80ff45ef40549fb6a1d80b70865fc807"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a80ff45ef40549fb6a1d80b70865fc807">ProSHADE_internal_data::ProSHADE_data::centreMapOnCOM</a></div><div class="ttdeci">void centreMapOnCOM(ProSHADE_settings *settings)</div><div class="ttdoc">This function shits the map so that its COM is in the centre of the map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01520">ProSHADE_data.cpp:1520</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a4c89c860da1836b30a9b2889d3e873ed"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4c89c860da1836b30a9b2889d3e873ed">ProSHADE_internal_data::ProSHADE_data::getXFromPtr</a></div><div class="ttdeci">proshade_signed * getXFromPtr(void)</div><div class="ttdoc">This function allows access to the map start along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03959">ProSHADE_data.cpp:3959</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a89094c73ae033812d4df0bd846e03442"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">ProSHADE_settings::verbose</a></div><div class="ttdeci">proshade_signed verbose</div><div class="ttdoc">Should the software report on the progress, or just be quiet? Value between -1 (nothing) and 4 (loud)</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00149">ProSHADE_settings.hpp:149</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ab4da4e87f23a07702dcf32470ec740df"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">ProSHADE_internal_data::ProSHADE_data::yDimIndices</a></div><div class="ttdeci">proshade_unsign yDimIndices</div><div class="ttdoc">This is the size of the map cell y dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00066">ProSHADE_data.hpp:66</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a43f1c4682016759ea2e24c5903dbe444"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a43f1c4682016759ea2e24c5903dbe444">ProSHADE_internal_data::ProSHADE_data::xAxisOriginOriginal</a></div><div class="ttdeci">proshade_signed xAxisOriginOriginal</div><div class="ttdoc">This is the origin position along the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00088">ProSHADE_data.hpp:88</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a286453ecf4904c2957e792a24567af6b"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a286453ecf4904c2957e792a24567af6b">ProSHADE_settings::messageShift</a></div><div class="ttdeci">proshade_signed messageShift</div><div class="ttdoc">This value allows shifting the messages to create more readable log for sub-processes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00150">ProSHADE_settings.hpp:150</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3d56e4edf14f91833ddfe8908887b506"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">ProSHADE_internal_data::ProSHADE_data::yGridIndices</a></div><div class="ttdeci">proshade_unsign yGridIndices</div><div class="ttdoc">As far as I know, this is identical to the yDimIndices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00069">ProSHADE_data.hpp:69</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a4f49a4f2263aa12ccb1737f8dc32c9ac"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a4f49a4f2263aa12ccb1737f8dc32c9ac">ProSHADE_settings::changeMapResolutionTriLinear</a></div><div class="ttdeci">bool changeMapResolutionTriLinear</div><div class="ttdoc">Should maps be re-sampled to obtain the required resolution?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00052">ProSHADE_settings.hpp:52</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a57a45df67d87117582f0810ca9f48695"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">ProSHADE_internal_data::ProSHADE_data::zAxisOrigin</a></div><div class="ttdeci">proshade_signed zAxisOrigin</div><div class="ttdoc">This is the origin position along the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00076">ProSHADE_data.hpp:76</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a68c3eafaeea1c1873c33525f337f9d0b"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a></div><div class="ttdeci">void addToDoubleVector(std::vector&lt; proshade_double &gt; *vecToAddTo, proshade_double elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00077">ProSHADE_misc.cpp:77</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad8694002911669527ca6266c66285d57"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad8694002911669527ca6266c66285d57">ProSHADE_internal_data::ProSHADE_data::shiftToRotationCentre</a></div><div class="ttdeci">void shiftToRotationCentre(ProSHADE_settings *settings)</div><div class="ttdoc">Function for shifting map so that its rotation centre is at the centre of the box.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01140">ProSHADE_data.cpp:1140</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a30edd2928e423198704adb955989960b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30edd2928e423198704adb955989960b">ProSHADE_internal_data::ProSHADE_data::setPDBMapValues</a></div><div class="ttdeci">void setPDBMapValues(void)</div><div class="ttdoc">Function for determining iterator start and stop positions.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00824">ProSHADE_data.cpp:824</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac07955296611dd411cf5ed87ced90571"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac07955296611dd411cf5ed87ced90571">ProSHADE_internal_data::ProSHADE_data::findMapCOM</a></div><div class="ttdeci">void findMapCOM(void)</div><div class="ttdoc">This function finds the centre of mass of the internal map representation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03535">ProSHADE_data.cpp:3535</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1ef18126c2c24edc9b6be06e0591127f"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ef18126c2c24edc9b6be06e0591127f">ProSHADE_internal_data::ProSHADE_data::yDimIndicesOriginal</a></div><div class="ttdeci">proshade_unsign yDimIndicesOriginal</div><div class="ttdoc">This is the size of the map cell y dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00086">ProSHADE_data.hpp:86</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3bc44913222e67ab861dd1e5838c1ae1"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">ProSHADE_internal_data::ProSHADE_data::getXDim</a></div><div class="ttdeci">proshade_unsign getXDim(void)</div><div class="ttdoc">This function allows access to the map size in indices along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03929">ProSHADE_data.cpp:3929</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a8993520350e1eab8f3eb041c8115cac5"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a8993520350e1eab8f3eb041c8115cac5">ProSHADE_internal_mapManip::removeWaters</a></div><div class="ttdeci">void removeWaters(gemmi::Structure *pdbFile, bool firstModel)</div><div class="ttdoc">This function removed all waters from PDB input file.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00506">ProSHADE_mapManip.cpp:506</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_afb183823a47a73d459a5bae16042bf4e"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#afb183823a47a73d459a5bae16042bf4e">ProSHADE_settings::useBiCubicInterpolationOnPeaks</a></div><div class="ttdeci">bool useBiCubicInterpolationOnPeaks</div><div class="ttdoc">This variable switch decides whether best symmetry is detected from peak indices, or whether bicubic ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00135">ProSHADE_settings.hpp:135</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9548e8ff07c6a74bbe2353f647fb6a79"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9548e8ff07c6a74bbe2353f647fb6a79">ProSHADE_internal_data::ProSHADE_data::originalPdbTransX</a></div><div class="ttdeci">proshade_double originalPdbTransX</div><div class="ttdoc">The optimal translation vector as it relates to the original PDB positions (and not the ProSHADE inte...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00105">ProSHADE_data.hpp:105</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__symmetry_8cpp_html_af62700fc94d2901ec61928d01773ea57"><div class="ttname"><a href="_pro_s_h_a_d_e__symmetry_8cpp.html#af62700fc94d2901ec61928d01773ea57">determinePeakThreshold</a></div><div class="ttdeci">proshade_double determinePeakThreshold(std::vector&lt; proshade_double &gt; inArr, proshade_double noIQRsFromMedian)</div><div class="ttdoc">This function takes a vector of values and determines the threshold for removing noise from it.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00071">ProSHADE_symmetry.cpp:71</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a930e25e9377cf418f6eab71fa2837255"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">ProSHADE_internal_data::ProSHADE_data::zTo</a></div><div class="ttdeci">proshade_signed zTo</div><div class="ttdoc">This is the final index along the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00115">ProSHADE_data.hpp:115</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a42419398083b05da19ebfb3cfa5cdc34"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a42419398083b05da19ebfb3cfa5cdc34">ProSHADE_internal_data::ProSHADE_data::computeFSC</a></div><div class="ttdeci">proshade_double computeFSC(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSym, size_t symIndex, fftw_complex *mapData, fftw_complex *fCoeffs, fftw_complex *origCoeffs, fftw_plan *planForwardFourier, proshade_signed noBins, proshade_signed *binIndexing, proshade_double **&amp;bindata, proshade_signed *&amp;binCounts, proshade_double *&amp;fscByBin)</div><div class="ttdoc">This function computes FSC for any given axis in the supplied CSym symmetry axes vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02391">ProSHADE_data.cpp:2391</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac40e8210bd69b598a67c6a3e0a9ecf16"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">ProSHADE_internal_data::ProSHADE_data::xTo</a></div><div class="ttdeci">proshade_signed xTo</div><div class="ttdoc">This is the final index along the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00113">ProSHADE_data.hpp:113</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aac87b1a87f32a742ea2b41014dac5f7b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aac87b1a87f32a742ea2b41014dac5f7b">ProSHADE_internal_data::ProSHADE_data::writeMask</a></div><div class="ttdeci">void writeMask(std::string fName, proshade_double *mask)</div><div class="ttdoc">Function for writing out a mask in MRC MAP format.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01038">ProSHADE_data.cpp:1038</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5d266289b137b48132f1456fd8fc43ea"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d266289b137b48132f1456fd8fc43ea">ProSHADE_internal_data::ProSHADE_data::integrationWeight</a></div><div class="ttdeci">proshade_double integrationWeight</div><div class="ttdoc">The Pearson's c.c. type weighting for the integration.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00128">ProSHADE_data.hpp:128</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a4af89abc1c94e4a6df28c7b31f576551"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">ProSHADE_settings::peakThresholdMin</a></div><div class="ttdeci">proshade_double peakThresholdMin</div><div class="ttdoc">The threshold for peak height above which axes are considered possible.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00138">ProSHADE_settings.hpp:138</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2860d3acb4d9e5ec6fca0b58ae33845f"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">ProSHADE_internal_data::ProSHADE_data::xAxisOrigin</a></div><div class="ttdeci">proshade_signed xAxisOrigin</div><div class="ttdoc">This is the origin position along the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00074">ProSHADE_data.hpp:74</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5241ee8b8b9d9915e1ef92e3edab202d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5241ee8b8b9d9915e1ef92e3edab202d">ProSHADE_internal_data::ProSHADE_data::originalPdbTransY</a></div><div class="ttdeci">proshade_double originalPdbTransY</div><div class="ttdoc">The optimal translation vector as it relates to the original PDB positions (and not the ProSHADE inte...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00106">ProSHADE_data.hpp:106</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__wigner_html_aba7b804497a1f100d527198e88fab2b8"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__wigner.html#aba7b804497a1f100d527198e88fab2b8">ProSHADE_internal_wigner::computeWignerMatricesForRotation</a></div><div class="ttdeci">void computeWignerMatricesForRotation(ProSHADE_settings *settings, ProSHADE_internal_data::ProSHADE_data *obj, proshade_double eulerAlpha, proshade_double eulerBeta, proshade_double eulerGamma)</div><div class="ttdoc">This function computes the Wigner D matrices for a particular set of Euler angles.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__wigner_matrices_8cpp_source.html#l00258">ProSHADE_wignerMatrices.cpp:258</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_af8b72cbc56a4f72d0557e01a8101d435"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">ProSHADE_internal_data::ProSHADE_data::rrpMatrices</a></div><div class="ttdeci">proshade_double *** rrpMatrices</div><div class="ttdoc">The energy levels descriptor shell correlation tables.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00126">ProSHADE_data.hpp:126</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a47b4953dae84a5ab54dadd33d7805887"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">ProSHADE_internal_data::ProSHADE_data::yTo</a></div><div class="ttdeci">proshade_signed yTo</div><div class="ttdoc">This is the final index along the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00114">ProSHADE_data.hpp:114</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_acffa14a2c2121b5b425fcabdb7b3ba6a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#acffa14a2c2121b5b425fcabdb7b3ba6a">ProSHADE_settings::forceP1</a></div><div class="ttdeci">bool forceP1</div><div class="ttdoc">Should the P1 spacegroup be forced on the input PDB files?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00044">ProSHADE_settings.hpp:44</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aff65990df92e49b7636134feb56be8f9"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">ProSHADE_internal_data::ProSHADE_data::xDimSize</a></div><div class="ttdeci">proshade_single xDimSize</div><div class="ttdoc">This is the size of the map cell x dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00059">ProSHADE_data.hpp:59</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_ab53cd7561731d9426989f5ace523826a"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ab53cd7561731d9426989f5ace523826a">ProSHADE_internal_symmetry::findIcos10C3s</a></div><div class="ttdeci">void findIcos10C3s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_signed messageShift, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the ten C3 symmetries with correct angles requ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02451">ProSHADE_symmetry.cpp:2451</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a2ac3b534f974de25b092e9d48d9f7dea"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a></div><div class="ttdeci">proshade_double computeDotProduct(proshade_double *x1, proshade_double *y1, proshade_double *z1, proshade_double *x2, proshade_double *y2, proshade_double *z2)</div><div class="ttdoc">Simple 3D vector dot product computation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01788">ProSHADE_maths.cpp:1788</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad39f33c52f6d4f0db8e0d63ed0c9a2f3"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad39f33c52f6d4f0db8e0d63ed0c9a2f3">ProSHADE_internal_data::ProSHADE_data::computeRotatedSH</a></div><div class="ttdeci">void computeRotatedSH(void)</div><div class="ttdoc">This function multiplies the objects spherical harmonics with the Wigner D matrices,...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00920">ProSHADE_overlay.cpp:920</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a3d107e20dfeb5b5442fc3d0ba70bf2ef"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a3d107e20dfeb5b5442fc3d0ba70bf2ef">ProSHADE_internal_mapManip::findPDBCOMValues</a></div><div class="ttdeci">void findPDBCOMValues(gemmi::Structure pdbFile, proshade_double *xCom, proshade_double *yCom, proshade_double *zCom, bool firstModel)</div><div class="ttdoc">This function finds the Centre of Mass for the co-ordinate file.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00157">ProSHADE_mapManip.cpp:157</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1658311301e365cf17721e864b829c28"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1658311301e365cf17721e864b829c28">ProSHADE_internal_data::ProSHADE_data::mapMovFromsChangeY</a></div><div class="ttdeci">proshade_double mapMovFromsChangeY</div><div class="ttdoc">When the map is translated, the yFrom and yTo values are changed. This variable holds how much they h...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00095">ProSHADE_data.hpp:95</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3e2a50d383cdba4b6f6f3d1293c4174b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">ProSHADE_internal_data::ProSHADE_data::yAxisOrigin</a></div><div class="ttdeci">proshade_signed yAxisOrigin</div><div class="ttdoc">This is the origin position along the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00075">ProSHADE_data.hpp:75</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__peak_search_html_ae8a54558e9c9c28568c441a601811449"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__peak_search.html#ae8a54558e9c9c28568c441a601811449">ProSHADE_internal_peakSearch::getBestPeakEulerAngsNaive</a></div><div class="ttdeci">void getBestPeakEulerAngsNaive(proshade_complex *map, proshade_unsign dim, proshade_double *eulA, proshade_double *eulB, proshade_double *eulG, ProSHADE_settings *settings)</div><div class="ttdoc">This function finds the highest peaks optimised Euler angles using the &quot;naive&quot; approach.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__peak_search_8cpp_source.html#l00352">ProSHADE_peakSearch.cpp:352</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad9b0fec5092eed1ab485443c15289e14"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad9b0fec5092eed1ab485443c15289e14">ProSHADE_internal_data::ProSHADE_data::saveRecommendedSymmetry</a></div><div class="ttdeci">void saveRecommendedSymmetry(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSym, std::vector&lt; proshade_double * &gt; *DSym, std::vector&lt; proshade_double * &gt; *TSym, std::vector&lt; proshade_double * &gt; *OSym, std::vector&lt; proshade_double * &gt; *ISym, std::vector&lt; proshade_double * &gt; *axes, fftw_complex *mapData, fftw_complex *origCoeffs, fftw_complex *fCoeffs, fftw_plan *planForwardFourier, proshade_signed noBins, proshade_signed *binIndexing, proshade_double **bindata, proshade_signed *binCounts, proshade_double *&amp;fscByBin)</div><div class="ttdoc">This function takes all the detected symmetry results and decides on which are to be recommended for ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02558">ProSHADE_data.cpp:2558</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_aff0d8344fdd83482e5531eadedaac550"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a></div><div class="ttdeci">void deepCopyAxisToDblPtrVector(std::vector&lt; proshade_double * &gt; *dblPtrVec, proshade_double *axis)</div><div class="ttdoc">Does a deep copy of a double array to a vector of double arrays.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00335">ProSHADE_misc.cpp:335</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9302095b8642b8d5088cf8f1793d1990"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">ProSHADE_internal_data::ProSHADE_data::yAxisOrder</a></div><div class="ttdeci">proshade_unsign yAxisOrder</div><div class="ttdoc">This is the order of the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00072">ProSHADE_data.hpp:72</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8aa6fbd67df9911e886f9001a0ef8bc2"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">ProSHADE_internal_data::ProSHADE_data::internalMap</a></div><div class="ttdeci">proshade_double * internalMap</div><div class="ttdoc">The internal map data representation, which may be amended as the run progresses.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00056">ProSHADE_data.hpp:56</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a36f99ea1e23f754d65f3612052ce5c42"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a36f99ea1e23f754d65f3612052ce5c42">ProSHADE_internal_data::ProSHADE_data::writePdb</a></div><div class="ttdeci">void writePdb(std::string fName, proshade_double euA=0.0, proshade_double euB=0.0, proshade_double euG=0.0, proshade_double trsX=0.0, proshade_double trsY=0.0, proshade_double trsZ=0.0, proshade_double rotX=0.0, proshade_double rotY=0.0, proshade_double rotZ=0.0, bool firstModel=true)</div><div class="ttdoc">This function writes out the co-ordinates file with ProSHADE type rotation and translation applied.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00959">ProSHADE_data.cpp:959</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1ea6522b99cf1ac72199c9eeccd30742"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ea6522b99cf1ac72199c9eeccd30742">ProSHADE_internal_data::ProSHADE_data::zDimIndicesOriginal</a></div><div class="ttdeci">proshade_unsign zDimIndicesOriginal</div><div class="ttdoc">This is the size of the map cell z dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00087">ProSHADE_data.hpp:87</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_abc59a55f5ed21de90e351005c58a871e"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#abc59a55f5ed21de90e351005c58a871e">ProSHADE_internal_maths::complexMultiplicationConjugRealOnly</a></div><div class="ttdeci">proshade_double complexMultiplicationConjugRealOnly(proshade_double *r1, proshade_double *i1, proshade_double *r2, proshade_double *i2)</div><div class="ttdoc">Function to conjuggate multiply two complex numbers and return the real part only.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00103">ProSHADE_maths.cpp:103</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afef6a064a54eb016776cb0879efb0b31"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">ProSHADE_internal_data::ProSHADE_data::xFrom</a></div><div class="ttdeci">proshade_signed xFrom</div><div class="ttdoc">This is the starting index along the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00110">ProSHADE_data.hpp:110</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a39eafef902a49cc0816a2ed675c14a49"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a39eafef902a49cc0816a2ed675c14a49">ProSHADE_internal_maths::getRotationMatrixFromAngleAxis</a></div><div class="ttdeci">void getRotationMatrixFromAngleAxis(proshade_double *rotMat, proshade_double x, proshade_double y, proshade_double z, proshade_double ang)</div><div class="ttdoc">This function converts the axis-angle representation to the rotation matrix representation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01459">ProSHADE_maths.cpp:1459</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a81e6aab30488052e6bdd9b339e8124d8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a81e6aab30488052e6bdd9b339e8124d8">ProSHADE_internal_data::ProSHADE_data::writeMap</a></div><div class="ttdeci">void writeMap(std::string fName, std::string title=&quot;Created by ProSHADE and written by GEMMI&quot;, int mode=2)</div><div class="ttdoc">Function for writing out the internal structure representation in MRC MAP format.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00892">ProSHADE_data.cpp:892</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a152b43815a3d3debd4b60751d9c8afdd"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">ProSHADE_internal_data::ProSHADE_data::getMaxBand</a></div><div class="ttdeci">proshade_unsign getMaxBand(void)</div><div class="ttdoc">This function returns the maximum band value for the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03611">ProSHADE_data.cpp:3611</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a7e36b0876ff78682480a8ec22f3f5264"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7e36b0876ff78682480a8ec22f3f5264">ProSHADE_internal_data::ProSHADE_data::shiftToBoxCentre</a></div><div class="ttdeci">void shiftToBoxCentre(ProSHADE_settings *settings)</div><div class="ttdoc">Function for shifting map so that its centre of box is at required position.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01075">ProSHADE_data.cpp:1075</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a670cffe28bbdac027bffd8f5491d4266"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a670cffe28bbdac027bffd8f5491d4266">ProSHADE_settings::appliedMaskFileName</a></div><div class="ttdeci">std::string appliedMaskFileName</div><div class="ttdoc">The filename from which mask data will be read from.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00086">ProSHADE_settings.hpp:86</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_afc48122cd1adf605eb8f7479cd197585"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#afc48122cd1adf605eb8f7479cd197585">ProSHADE_internal_misc::sortISymByPeak</a></div><div class="ttdeci">bool sortISymByPeak(const std::vector&lt; proshade_double * &gt; a, const std::vector&lt; proshade_double * &gt; b)</div><div class="ttdoc">This function compares two vectors of arrays based on the sum of the fifth column,...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00279">ProSHADE_misc.cpp:279</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac3dbae1c18d0550ee1940cadb5335684"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac3dbae1c18d0550ee1940cadb5335684">ProSHADE_internal_data::ProSHADE_data::invertSHCoefficients</a></div><div class="ttdeci">void invertSHCoefficients(void)</div><div class="ttdoc">This function computes the shell mapped data from inverting the Spherical Harmonics coefficients.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l01021">ProSHADE_overlay.cpp:1021</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a4f09b90de1f15b345ee7998ff31327f3"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a4f09b90de1f15b345ee7998ff31327f3">ProSHADE_internal_symmetry::detectIcosahedralSymmetry</a></div><div class="ttdeci">bool detectIcosahedralSymmetry(std::vector&lt; proshade_double * &gt; *CSymList, proshade_double axErr, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and decides whether basic requirements for isosahedral s...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01971">ProSHADE_symmetry.cpp:1971</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a31fb6004cbb5a70ad3c3e6aeb1816780"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a31fb6004cbb5a70ad3c3e6aeb1816780">ProSHADE_settings::coOrdsExtraSpace</a></div><div class="ttdeci">proshade_single coOrdsExtraSpace</div><div class="ttdoc">This number of Angstroms will be added before and any co-ordinates to make sure there is no atom dire...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00104">ProSHADE_settings.hpp:104</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a0d796061e73e8635f75fc6921b98ad66"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a0d796061e73e8635f75fc6921b98ad66">ProSHADE_settings::normaliseMap</a></div><div class="ttdeci">bool normaliseMap</div><div class="ttdoc">Should the map be normalised to mean 0 sd 1?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00072">ProSHADE_settings.hpp:72</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a291d70d6d298ce4094b625f588c83b1c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a291d70d6d298ce4094b625f588c83b1c">ProSHADE_internal_data::ProSHADE_data::writeGemmi</a></div><div class="ttdeci">void writeGemmi(std::string fName, gemmi::Structure gemmiStruct, proshade_double euA=0.0, proshade_double euB=0.0, proshade_double euG=0.0, proshade_double trsX=0.0, proshade_double trsY=0.0, proshade_double trsZ=0.0, proshade_double rotX=0.0, proshade_double rotY=0.0, proshade_double rotZ=0.0, bool firstModel=true)</div><div class="ttdoc">This function writes out the gemmi::Structure object with ProSHADE type rotation and translation appl...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00996">ProSHADE_data.cpp:996</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_afb42ec0cd0f8abb54327c0e2c3025ed1"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">ProSHADE_settings::addExtraSpace</a></div><div class="ttdeci">proshade_single addExtraSpace</div><div class="ttdoc">If this value is non-zero, this many angstroms of empty space will be added to the internal map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00103">ProSHADE_settings.hpp:103</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a50c884973add562558803a45991bbf19"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">ProSHADE_internal_data::ProSHADE_data::getYDim</a></div><div class="ttdeci">proshade_unsign getYDim(void)</div><div class="ttdoc">This function allows access to the map size in indices along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03939">ProSHADE_data.cpp:3939</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_ab32d795fc4057093f27e5981551f5d99"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#ab32d795fc4057093f27e5981551f5d99">ProSHADE_internal_maths::computeFSC</a></div><div class="ttdeci">proshade_double computeFSC(fftw_complex *fCoeffs1, fftw_complex *fCoeffs2, proshade_unsign xInds, proshade_unsign yInds, proshade_unsign zInds, proshade_signed noBins, proshade_signed *binIndexing, proshade_double **&amp;binData, proshade_signed *&amp;binCounts, proshade_double *&amp;fscByBin)</div><div class="ttdoc">This function computes the FSC.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l03347">ProSHADE_maths.cpp:3347</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a99ed9b0a765739d89104eca2c1875dd4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ed9b0a765739d89104eca2c1875dd4">ProSHADE_internal_data::ProSHADE_data::maxCompBand</a></div><div class="ttdeci">proshade_unsign maxCompBand</div><div class="ttdoc">The largest comparison band - this variable tells how large arrays will be allocated for the comparis...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00132">ProSHADE_data.hpp:132</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a7caf87603d759cb0de1b0bd834ae8f6d"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a7caf87603d759cb0de1b0bd834ae8f6d">ProSHADE_internal_maths::findHighestValueInMap</a></div><div class="ttdeci">void findHighestValueInMap(fftw_complex *resIn, proshade_unsign xD, proshade_unsign yD, proshade_unsign zD, proshade_double *trsX, proshade_double *trsY, proshade_double *trsZ, proshade_double *mapPeak)</div><div class="ttdoc">This function simply finds the highest value in fftw_complex map and returns its position and value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l03912">ProSHADE_maths.cpp:3912</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a0122be830893f5d82bab742be54d1ee7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0122be830893f5d82bab742be54d1ee7">ProSHADE_internal_data::ProSHADE_data::maskMap</a></div><div class="ttdeci">void maskMap(ProSHADE_settings *settings)</div><div class="ttdoc">Function for computing the map mask using blurring and X IQRs from median.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01276">ProSHADE_data.cpp:1276</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_ac2650a79c20be34894c23d73ffaae750"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ac2650a79c20be34894c23d73ffaae750">ProSHADE_internal_mapManip::getNonZeroBounds</a></div><div class="ttdeci">void getNonZeroBounds(proshade_double *map, proshade_signed xDim, proshade_signed yDim, proshade_signed zDim, proshade_signed *&amp;ret)</div><div class="ttdoc">Function for finding the map boundaries enclosing positive only values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01124">ProSHADE_mapManip.cpp:1124</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a59fbe922fd7fd7aa5c72ca459e4242d0"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">ProSHADE_internal_data::ProSHADE_data::xCom</a></div><div class="ttdeci">proshade_double xCom</div><div class="ttdoc">The COM of the map after processing along the X-axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00077">ProSHADE_data.hpp:77</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_aad5409074bece14a244fad191524a687"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#aad5409074bece14a244fad191524a687">ProSHADE_internal_maths::getAxisAngleFromRotationMatrix</a></div><div class="ttdeci">void getAxisAngleFromRotationMatrix(proshade_double *rotMat, proshade_double *x, proshade_double *y, proshade_double *z, proshade_double *ang, proshade_signed verbose=1)</div><div class="ttdoc">This function converts rotation matrix to the axis-angle representation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01084">ProSHADE_maths.cpp:1084</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a53120c9e4f3f1f69f80d7c966dff2cb7"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">ProSHADE_settings::fscThreshold</a></div><div class="ttdeci">proshade_double fscThreshold</div><div class="ttdoc">The threshold for FSC value under which the axis is considered to be likely noise.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00137">ProSHADE_settings.hpp:137</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_af8dcc353f075b824d2f3479f487c8bd0"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8dcc353f075b824d2f3479f487c8bd0">ProSHADE_internal_data::ProSHADE_data::readInGemmi</a></div><div class="ttdeci">void readInGemmi(gemmi::Structure gemmiStruct, ProSHADE_settings *settings)</div><div class="ttdoc">Function for reading co-ordinate data from Gemmi object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00735">ProSHADE_data.cpp:735</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_aa2702798938d50ec2a55e46cbc31333e"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#aa2702798938d50ec2a55e46cbc31333e">ProSHADE_internal_maths::binReciprocalSpaceReflections</a></div><div class="ttdeci">void binReciprocalSpaceReflections(proshade_unsign xInds, proshade_unsign yInds, proshade_unsign zInds, proshade_signed *noBin, proshade_signed *&amp;binIndexing)</div><div class="ttdoc">This function does binning of the reciprocal space reflections.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l03199">ProSHADE_maths.cpp:3199</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aee571cb10ce61ab11680b1ebd5e23eb7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aee571cb10ce61ab11680b1ebd5e23eb7">ProSHADE_internal_data::ProSHADE_data::originalPdbTransZ</a></div><div class="ttdeci">proshade_double originalPdbTransZ</div><div class="ttdoc">The optimal translation vector as it relates to the original PDB positions (and not the ProSHADE inte...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00107">ProSHADE_data.hpp:107</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a931aa4c10c426c3b8041bd4e838b0678"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a931aa4c10c426c3b8041bd4e838b0678">ProSHADE_internal_data::ProSHADE_data::getPredictedTetrahedralSymmetriesList</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; getPredictedTetrahedralSymmetriesList(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSymList)</div><div class="ttdoc">This function predicts a list of all T symmetry axes from the already computed C symmetries list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03505">ProSHADE_symmetry.cpp:3505</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a1db775b80f6ce426bb98d87f8ba99d72"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a1db775b80f6ce426bb98d87f8ba99d72">ProSHADE_internal_symmetry::findOcta4C3s</a></div><div class="ttdeci">void findOcta4C3s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_signed messageShift, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the four C3 symmetries with correct angles req...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01398">ProSHADE_symmetry.cpp:1398</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_ad93f9644c5b132193b4ddd282f50abce"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#ad93f9644c5b132193b4ddd282f50abce">ProSHADE_internal_io::readInMapData</a></div><div class="ttdeci">void readInMapData(gemmi::Ccp4&lt; float &gt; *gemmiMap, proshade_double *&amp;map, proshade_unsign xDimInds, proshade_unsign yDimInds, proshade_unsign zDimInds, proshade_unsign xAxOrder, proshade_unsign yAxOrder, proshade_unsign zAxOrder)</div><div class="ttdoc">This function converts the gemmi Ccp4 object data to ProSHADE internal map representation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00178">ProSHADE_io.cpp:178</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_add48230d67bd69305df058d29a588507"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#add48230d67bd69305df058d29a588507">ProSHADE_internal_distances::computeEMatrices</a></div><div class="ttdeci">void computeEMatrices(ProSHADE_internal_data::ProSHADE_data *obj1, ProSHADE_internal_data::ProSHADE_data *obj2, ProSHADE_settings *settings)</div><div class="ttdoc">This function computes the complete E matrices and their weights between any two objects.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00510">ProSHADE_distances.cpp:510</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae27a3e92905ca9d5f9a32c4eaacc64ae"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae27a3e92905ca9d5f9a32c4eaacc64ae">ProSHADE_internal_data::ProSHADE_data::getTranslationFnPointer</a></div><div class="ttdeci">proshade_complex * getTranslationFnPointer(void)</div><div class="ttdoc">This function allows access to the translation function through a pointer.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04059">ProSHADE_data.cpp:4059</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a974bbe07f5435f052df4592825ed7aba"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">ProSHADE_settings::setRecommendedSymmetry</a></div><div class="ttdeci">void setRecommendedSymmetry(std::string val)</div><div class="ttdoc">Sets the ProSHADE detected symmetry type.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l01469">ProSHADE.cpp:1469</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a64ba4ba55d58078eeea8b70311e4ab49"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a64ba4ba55d58078eeea8b70311e4ab49">ProSHADE_internal_maths::combineFourierForTranslation</a></div><div class="ttdeci">void combineFourierForTranslation(fftw_complex *tmpOut1, fftw_complex *tmpOut2, fftw_complex *&amp;resOut, proshade_unsign xD, proshade_unsign yD, proshade_unsign zD)</div><div class="ttdoc">This function combines Fourier coefficients of two structures in a way, so that inverse Fourier of th...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l03865">ProSHADE_maths.cpp:3865</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a668c168ea0037312025b860b9b5be415"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">ProSHADE_internal_data::ProSHADE_data::zCom</a></div><div class="ttdeci">proshade_double zCom</div><div class="ttdoc">The COM of the map after processing along the Z-axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00079">ProSHADE_data.hpp:79</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a31b57e51f48e58828883b04b612dcf55"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">ProSHADE_internal_data::ProSHADE_data::spherePos</a></div><div class="ttdeci">std::vector&lt; proshade_single &gt; spherePos</div><div class="ttdoc">Vector of sphere radii from the centre of the map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00118">ProSHADE_data.hpp:118</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a0d205c102e722997ab1f0953f76a288a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a0d205c102e722997ab1f0953f76a288a">ProSHADE_settings::invertMap</a></div><div class="ttdeci">bool invertMap</div><div class="ttdoc">Should the map be inverted? Only use this if you think you have the wrong hand in your map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00075">ProSHADE_settings.hpp:75</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a034af93b9152fb2db675d5632a4ebc6d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">ProSHADE_internal_data::ProSHADE_data::getZDim</a></div><div class="ttdeci">proshade_unsign getZDim(void)</div><div class="ttdoc">This function allows access to the map size in indices along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03949">ProSHADE_data.cpp:3949</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a6f93b0061117d6bb3fc8cea3c4314957"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a6f93b0061117d6bb3fc8cea3c4314957">ProSHADE_settings::centrePosition</a></div><div class="ttdeci">std::vector&lt; proshade_double &gt; centrePosition</div><div class="ttdoc">The position of the centre of the map in &quot;real space&quot; co-ordinates.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00142">ProSHADE_settings.hpp:142</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a167f7a9dbd061752d2a099181090a3b8"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a167f7a9dbd061752d2a099181090a3b8">ProSHADE_internal_mapManip::removeMapPhase</a></div><div class="ttdeci">void removeMapPhase(fftw_complex *&amp;mapCoeffs, proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim)</div><div class="ttdoc">This function removes the phase from reciprocal (frequency) map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01681">ProSHADE_mapManip.cpp:1681</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a827e3241fa6401027e0526fffb8b281d"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a827e3241fa6401027e0526fffb8b281d">ProSHADE_settings::boundsSimilarityThreshold</a></div><div class="ttdeci">proshade_signed boundsSimilarityThreshold</div><div class="ttdoc">Number of indices which can be added just to make sure same size in indices is achieved.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00094">ProSHADE_settings.hpp:94</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a26fa82e82a6a4af696cfae0581785446"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a26fa82e82a6a4af696cfae0581785446">ProSHADE_internal_maths::findTopGroupSmooth</a></div><div class="ttdeci">proshade_double findTopGroupSmooth(std::vector&lt; proshade_double * &gt; *CSym, size_t peakPos, proshade_double step, proshade_double sigma, proshade_signed windowSize, proshade_double maxLim=0.9)</div><div class="ttdoc">This function finds a subgroup of axes with distinctly higher correlation value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l03743">ProSHADE_maths.cpp:3743</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__overlay_html_a78c51dc39b75ffb4731c7219b25e290b"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__overlay.html#a78c51dc39b75ffb4731c7219b25e290b">ProSHADE_internal_overlay::computeAngularThreshold</a></div><div class="ttdeci">void computeAngularThreshold(std::vector&lt; proshade_double &gt; *lonCO, std::vector&lt; proshade_double &gt; *latCO, proshade_unsign angRes)</div><div class="ttdoc">This function computes the angular thresholds for longitude and lattitude angles.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l01091">ProSHADE_overlay.cpp:1091</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__overlay_html_ac173210899aeeae2e207f9acdd7670a7"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__overlay.html#ac173210899aeeae2e207f9acdd7670a7">ProSHADE_internal_overlay::initialiseInverseSHComputation</a></div><div class="ttdeci">void initialiseInverseSHComputation(proshade_unsign shBand, double *&amp;sigR, double *&amp;sigI, double *&amp;rcoeffs, double *&amp;icoeffs, double *&amp;weights, double *&amp;workspace, fftw_plan &amp;idctPlan, fftw_plan &amp;ifftPlan)</div><div class="ttdoc">This function initialises internal variables for inverse Spherical Harmonics computation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00975">ProSHADE_overlay.cpp:975</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ab61d2183930ea26b3d49e7662052e83b"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ab61d2183930ea26b3d49e7662052e83b">ProSHADE_settings::changeMapResolution</a></div><div class="ttdeci">bool changeMapResolution</div><div class="ttdoc">Should maps be re-sampled to obtain the required resolution?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00051">ProSHADE_settings.hpp:51</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a9f714e15a7bc56dbe846fda6bb1d9c9e"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a9f714e15a7bc56dbe846fda6bb1d9c9e">ProSHADE_internal_io::writeRotationTranslationJSON</a></div><div class="ttdeci">void writeRotationTranslationJSON(proshade_double trsX1, proshade_double trsY1, proshade_double trsZ1, proshade_double eulA, proshade_double eulB, proshade_double eulG, proshade_double trsX2, proshade_double trsY2, proshade_double trsZ2, std::string fileName)</div><div class="ttdoc">Function for writing out the optimal rotation and translation into a JSON file.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00965">ProSHADE_io.cpp:965</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a682749f30d2fd19842d96e9b870d76ab"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a682749f30d2fd19842d96e9b870d76ab">ProSHADE_internal_data::ProSHADE_data::mapMovFromsChangeZ</a></div><div class="ttdeci">proshade_double mapMovFromsChangeZ</div><div class="ttdoc">When the map is translated, the zFrom and zTo values are changed. This variable holds how much they h...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00096">ProSHADE_data.hpp:96</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__data_8cpp_html_a188746757d4fe33cc7bca307aa367bc7"><div class="ttname"><a href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">axesToGroupTypeSanityCheck</a></div><div class="ttdeci">void axesToGroupTypeSanityCheck(proshade_unsign requiredAxes, proshade_unsign obtainedAxes, std::string groupType)</div><div class="ttdoc">This function checks that the required and obtained numbers of axes are correct, printing error if th...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03003">ProSHADE_data.cpp:3003</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_a3cdde76bf20d9cd5d756ffde2d3dc854"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#a3cdde76bf20d9cd5d756ffde2d3dc854">ProSHADE_internal_distances::computeInverseSOFTTransform</a></div><div class="ttdeci">void computeInverseSOFTTransform(ProSHADE_internal_data::ProSHADE_data *obj1, ProSHADE_internal_data::ProSHADE_data *obj2, ProSHADE_settings *settings)</div><div class="ttdoc">This function computes the inverse SO(3) transform.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00854">ProSHADE_distances.cpp:854</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup</a></div><div class="ttdoc">This class contains peak groups detected in the rotation function mapped spheres.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spheres_8hpp_source.html#l00128">ProSHADE_spheres.hpp:129</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a833f51d5da64ed09004daa4bf66c013c"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a833f51d5da64ed09004daa4bf66c013c">ProSHADE_settings::overlayStructureName</a></div><div class="ttdeci">std::string overlayStructureName</div><div class="ttdoc">The filename to which the rotated and translated moving structure is to be saved.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00145">ProSHADE_settings.hpp:145</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a2380a3710f7dbe672519c3adda30f7cd"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a2380a3710f7dbe672519c3adda30f7cd">ProSHADE_internal_maths::isAxisUnique</a></div><div class="ttdeci">bool isAxisUnique(std::vector&lt; proshade_double * &gt; *CSymList, proshade_double *axis, proshade_double tolerance=0.1, bool improve=false)</div><div class="ttdoc">This function checks if new axis is unique, or already detected.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l02974">ProSHADE_maths.cpp:2974</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afe04510c67e9dc9c19efaef8463b6e6e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afe04510c67e9dc9c19efaef8463b6e6e">ProSHADE_internal_data::ProSHADE_data::getMapValue</a></div><div class="ttdeci">proshade_double getMapValue(proshade_unsign pos)</div><div class="ttdoc">This function returns the internal map representation value of a particular array position.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03601">ProSHADE_data.cpp:3601</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac859cbd21b93b9d2ed5f119f4ee57f3f"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac859cbd21b93b9d2ed5f119f4ee57f3f">ProSHADE_internal_data::ProSHADE_data::getYToPtr</a></div><div class="ttdeci">proshade_signed * getYToPtr(void)</div><div class="ttdoc">This function allows access to the map last position along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03999">ProSHADE_data.cpp:3999</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a37c9037721c1ad28ad6421a31dbcd8d8"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a37c9037721c1ad28ad6421a31dbcd8d8">ProSHADE_settings::moveToCOM</a></div><div class="ttdeci">bool moveToCOM</div><div class="ttdoc">Logical value stating whether the structure should be moved to have its Centre Of Mass (COM) in the m...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00099">ProSHADE_settings.hpp:99</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a26b57d39529ca69a117aceead6b12680"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a26b57d39529ca69a117aceead6b12680">ProSHADE_settings::peakNeighbours</a></div><div class="ttdeci">proshade_unsign peakNeighbours</div><div class="ttdoc">Number of points in any direction that have to be lower than the considered index in order to conside...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00119">ProSHADE_settings.hpp:119</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a618fc0fc9ca71ec70500c99c7e6231f4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">ProSHADE_internal_data::ProSHADE_data::wignerMatrices</a></div><div class="ttdeci">proshade_complex *** wignerMatrices</div><div class="ttdoc">These matrices are computed for a particular rotation to be done in spherical harmonics.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00131">ProSHADE_data.hpp:131</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a4052e498b4650f62bfe5ff37ed959292"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4052e498b4650f62bfe5ff37ed959292">ProSHADE_internal_data::ProSHADE_data::fileType</a></div><div class="ttdeci">ProSHADE_internal_io::InputType fileType</div><div class="ttdoc">This is the type of the input file.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00053">ProSHADE_data.hpp:53</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a22caf254dfc11e52890f79a161493e6e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a22caf254dfc11e52890f79a161493e6e">ProSHADE_internal_data::ProSHADE_data::rotateMapRealSpace</a></div><div class="ttdeci">std::vector&lt; proshade_double &gt; rotateMapRealSpace(proshade_double axX, proshade_double axY, proshade_double axZ, proshade_double axAng, proshade_double *&amp;map)</div><div class="ttdoc">This function rotates a map based on the given angle-axis rotation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00632">ProSHADE_overlay.cpp:632</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aeb0242051835b508e9af193dc40a697c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aeb0242051835b508e9af193dc40a697c">ProSHADE_internal_data::ProSHADE_data::getZAxisOrigin</a></div><div class="ttdeci">proshade_signed * getZAxisOrigin(void)</div><div class="ttdoc">This function allows access to the map Z axis origin value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04039">ProSHADE_data.cpp:4039</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a2e438f3d348e3e065f798031d5a33d09"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a2e438f3d348e3e065f798031d5a33d09">ProSHADE_internal_io::writeOutMapHeader</a></div><div class="ttdeci">void writeOutMapHeader(gemmi::Ccp4&lt; float &gt; *map, proshade_unsign xDimInds, proshade_unsign yDimInds, proshade_unsign zDimInds, proshade_single xDim, proshade_single yDim, proshade_single zDim, proshade_single aAng, proshade_single bAng, proshade_single cAng, proshade_signed xFrom, proshade_signed yFrom, proshade_signed zFrom, proshade_signed xAxOrigin, proshade_signed yAxOrigin, proshade_signed zAxOrigin, proshade_unsign xAxOrder, proshade_unsign yAxOrder, proshade_unsign zAxOrder, proshade_unsign xGridInds, proshade_unsign yGridInds, proshade_unsign zGridInds, std::string title, int mode)</div><div class="ttdoc">This function parses the CCP4 MAP file header as read in by gemmi.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00873">ProSHADE_io.cpp:873</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a50df80b02427f9f55a2c7af033a9fb93"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a></div><div class="ttdeci">proshade_signed myRound(proshade_double x)</div><div class="ttdoc">Calls the appropriate version of round function depending on compiler version.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00031">ProSHADE_mapManip.cpp:31</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a7855424ca5d51853c7fc665ecb9b935b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7855424ca5d51853c7fc665ecb9b935b">ProSHADE_internal_data::ProSHADE_data::yDimSizeOriginal</a></div><div class="ttdeci">proshade_single yDimSizeOriginal</div><div class="ttdoc">This is the size of the map cell y dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00083">ProSHADE_data.hpp:83</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a2f9c7716f6ab682e8548ab77efcdc444"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a2f9c7716f6ab682e8548ab77efcdc444">ProSHADE_internal_maths::compute3x3MatrixVectorMultiplication</a></div><div class="ttdeci">proshade_double * compute3x3MatrixVectorMultiplication(proshade_double *mat, proshade_double x, proshade_double y, proshade_double z)</div><div class="ttdoc">Function for computing a 3x3 matrix to 3x1 vector multiplication.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01898">ProSHADE_maths.cpp:1898</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a550c839b5ce7b53ccee5e6da1cf001af"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">ProSHADE_internal_data::ProSHADE_data::zAxisOrder</a></div><div class="ttdeci">proshade_unsign zAxisOrder</div><div class="ttdoc">This is the order of the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00073">ProSHADE_data.hpp:73</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_aeb9acf2a6f2f23b72424f01417c9ead3"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aeb9acf2a6f2f23b72424f01417c9ead3">ProSHADE_internal_mapManip::beautifyBoundaries</a></div><div class="ttdeci">void beautifyBoundaries(proshade_signed *&amp;bounds, proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_signed boundsDiffThres)</div><div class="ttdoc">Function for modifying boundaries to a mathematically more pleasant values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01966">ProSHADE_mapManip.cpp:1966</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ab573ea90a16991a06a77c5343328b060"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab573ea90a16991a06a77c5343328b060">ProSHADE_internal_data::ProSHADE_data::reSampleMap</a></div><div class="ttdeci">void reSampleMap(ProSHADE_settings *settings)</div><div class="ttdoc">This function changes the internal map sampling to conform to particular resolution value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01440">ProSHADE_data.cpp:1440</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_aa6c69d8fbdf79ef0f5f4b867dcbbe86f"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#aa6c69d8fbdf79ef0f5f4b867dcbbe86f">ProSHADE_settings::boxCentre</a></div><div class="ttdeci">std::vector&lt; proshade_double &gt; boxCentre</div><div class="ttdoc">If box centre is to be in any other location, this variable will hold the real space location that sh...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00100">ProSHADE_settings.hpp:100</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a4c1ee71ada97967f49ae1b338d6f43f9"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a4c1ee71ada97967f49ae1b338d6f43f9">ProSHADE_internal_mapManip::rotatePDBCoordinates</a></div><div class="ttdeci">void rotatePDBCoordinates(gemmi::Structure *pdbFile, proshade_double euA, proshade_double euB, proshade_double euG, proshade_double xCom, proshade_double yCom, proshade_double zCom, bool firstModel)</div><div class="ttdoc">Function for rotating the PDB file co-ordinates by Euler angles.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00298">ProSHADE_mapManip.cpp:298</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a7f24f5b37a7810ce379fce1b71877a0e"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a7f24f5b37a7810ce379fce1b71877a0e">ProSHADE_internal_symmetry::findOcta6C2s</a></div><div class="ttdeci">void findOcta6C2s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_signed messageShift, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the six C2 symmetries with correct angles requ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01481">ProSHADE_symmetry.cpp:1481</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a3bd5d0937bf5a545008b06593c5722a7"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a3bd5d0937bf5a545008b06593c5722a7">ProSHADE_internal_mapManip::generateMapFromPDB</a></div><div class="ttdeci">void generateMapFromPDB(gemmi::Structure pdbFile, proshade_double *&amp;map, proshade_single requestedResolution, proshade_single xCell, proshade_single yCell, proshade_single zCell, proshade_signed *xTo, proshade_signed *yTo, proshade_signed *zTo, bool forceP1, bool firstModel)</div><div class="ttdoc">This function generates a theoretical map from co-ordinate input files.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00646">ProSHADE_mapManip.cpp:646</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_af556836aa9286c1571196de442a6b493"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a></div><div class="ttdeci">void checkMemoryAllocation(chVar checkVar, std::string fileP, unsigned int lineP, std::string funcP, std::string infoP=&quot;This error may occurs when ProSHADE requests memory to be\n                    : allocated to it and this operation fails. This could\n                    : happen when not enough memory is available, either due to\n                    : other processes using a lot of memory, or when the machine\n                    : does not have sufficient memory available. Re-run to see\n                    : if this problem persists.&quot;)</div><div class="ttdoc">Checks if memory was allocated properly.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8hpp_source.html#l00068">ProSHADE_misc.hpp:68</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_adf61c328db45fcd7692d13a8cde5e092"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#adf61c328db45fcd7692d13a8cde5e092">ProSHADE_internal_data::ProSHADE_data::getXToPtr</a></div><div class="ttdeci">proshade_signed * getXToPtr(void)</div><div class="ttdoc">This function allows access to the map last position along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03989">ProSHADE_data.cpp:3989</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5f0d929d1e013cdd23e956d94b7a40da"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f0d929d1e013cdd23e956d94b7a40da">ProSHADE_internal_data::ProSHADE_data::getYFromPtr</a></div><div class="ttdeci">proshade_signed * getYFromPtr(void)</div><div class="ttdoc">This function allows access to the map start along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03969">ProSHADE_data.cpp:3969</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a2f09d5bdfb5450f2da8395f8770ef137"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a2f09d5bdfb5450f2da8395f8770ef137">ProSHADE_internal_mapManip::translatePDBCoordinates</a></div><div class="ttdeci">void translatePDBCoordinates(gemmi::Structure *pdbFile, proshade_double transX, proshade_double transY, proshade_double transZ, bool firstModel)</div><div class="ttdoc">Function for translating the PDB file co-ordinates by given distances in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00383">ProSHADE_mapManip.cpp:383</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a47bf2343b0b50267e8e3732c964b63ea"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47bf2343b0b50267e8e3732c964b63ea">ProSHADE_internal_data::ProSHADE_data::mapCOMProcessChangeY</a></div><div class="ttdeci">proshade_double mapCOMProcessChangeY</div><div class="ttdoc">The change in Y axis between the creation of the structure (originalMapYCom) and just before rotation...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00098">ProSHADE_data.hpp:98</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9dbcec9f32eb76625d7aa59d8c2701d9"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9dbcec9f32eb76625d7aa59d8c2701d9">ProSHADE_internal_data::ProSHADE_data::bAngle</a></div><div class="ttdeci">proshade_single bAngle</div><div class="ttdoc">This is the angle b of the map cell in degrees.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00063">ProSHADE_data.hpp:63</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_acf6c5376edac98e54ef0e418cd05d706"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#acf6c5376edac98e54ef0e418cd05d706">ProSHADE_internal_maths::getEulerZXZFromSOFTPosition</a></div><div class="ttdeci">void getEulerZXZFromSOFTPosition(proshade_signed band, proshade_signed x, proshade_signed y, proshade_signed z, proshade_double *eulerAlpha, proshade_double *eulerBeta, proshade_double *eulerGamma)</div><div class="ttdoc">Function to find Euler angles (ZXZ convention) from index position in the inverse SOFT map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00963">ProSHADE_maths.cpp:963</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a53cffdab0d66cb88884ec4f46c19a5ff"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a53cffdab0d66cb88884ec4f46c19a5ff">ProSHADE_internal_data::ProSHADE_data::yAxisOriginOriginal</a></div><div class="ttdeci">proshade_signed yAxisOriginOriginal</div><div class="ttdoc">This is the origin position along the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00089">ProSHADE_data.hpp:89</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_ab0ac919dd609bc6bded806c0f78201fd"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ab0ac919dd609bc6bded806c0f78201fd">ProSHADE_internal_symmetry::saveDSymmetry</a></div><div class="ttdeci">void saveDSymmetry(std::vector&lt; proshade_double * &gt; *ret, std::vector&lt; proshade_double * &gt; *CSymList, proshade_unsign axisOne, proshade_unsign axisTwo)</div><div class="ttdoc">This function saves a detected dihedral symmetry to the dihedral symmetries list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00383">ProSHADE_symmetry.cpp:383</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a31e25079d4a20a0d6442c7fb36fdeaea"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a31e25079d4a20a0d6442c7fb36fdeaea">ProSHADE_internal_symmetry::findOcta3C4s</a></div><div class="ttdeci">void findOcta3C4s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_signed messageShift, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the 3 C4 symmetries with perpendicular angles ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01331">ProSHADE_symmetry.cpp:1331</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa75beee618649d6fd9dc850a5a66a551"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">ProSHADE_internal_data::ProSHADE_data::aAngle</a></div><div class="ttdeci">proshade_single aAngle</div><div class="ttdoc">This is the angle a of the map cell in degrees.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00062">ProSHADE_data.hpp:62</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_ad9fbf28fda3873fc511fa2000ccba86c"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#ad9fbf28fda3873fc511fa2000ccba86c">ProSHADE_internal_misc::addToDoubleVectorVector</a></div><div class="ttdeci">void addToDoubleVectorVector(std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *vecToAddTo, std::vector&lt; proshade_double &gt; elementToAdd)</div><div class="ttdoc">Adds the element to the vector of vectors.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00233">ProSHADE_misc.cpp:233</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a476092aa08dff20d64a895e7b2227b2e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a476092aa08dff20d64a895e7b2227b2e">ProSHADE_internal_data::ProSHADE_data::figureIndexStartStop</a></div><div class="ttdeci">void figureIndexStartStop(void)</div><div class="ttdoc">Function for determining iterator start and stop positions.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00870">ProSHADE_data.cpp:870</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac57d606fdb59d54bd3f9249941402b12"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac57d606fdb59d54bd3f9249941402b12">ProSHADE_internal_data::ProSHADE_data::isEmpty</a></div><div class="ttdeci">bool isEmpty</div><div class="ttdoc">This variable stated whether the class contains any information.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00139">ProSHADE_data.hpp:139</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__overlay_html_a5f5eacf55d707e1d80d3df360fc0fe91"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__overlay.html#a5f5eacf55d707e1d80d3df360fc0fe91">ProSHADE_internal_overlay::allocateTranslationFunctionMemory</a></div><div class="ttdeci">void allocateTranslationFunctionMemory(fftw_complex *&amp;tmpIn1, fftw_complex *&amp;tmpOut1, fftw_complex *&amp;tmpIn2, fftw_complex *&amp;tmpOut2, fftw_complex *&amp;resIn, fftw_complex *&amp;resOut, fftw_plan &amp;forwardFourierObj1, fftw_plan &amp;forwardFourierObj2, fftw_plan &amp;inverseFourierCombo, proshade_unsign xD, proshade_unsign yD, proshade_unsign zD)</div><div class="ttdoc">This function allocates the memory for the Fourier transforms required for translation function compu...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00367">ProSHADE_overlay.cpp:367</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae97b54a34689c1dceae47a5e8e94bbb0"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae97b54a34689c1dceae47a5e8e94bbb0">ProSHADE_internal_data::ProSHADE_data::getPredictedOctahedralSymmetriesList</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; getPredictedOctahedralSymmetriesList(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSymList)</div><div class="ttdoc">This function predicts a list of all O symmetry axes from the already computed C symmetries list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01927">ProSHADE_symmetry.cpp:1927</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a5d4e5e34da6e4a9ed4a67cca16491c17"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5d4e5e34da6e4a9ed4a67cca16491c17">ProSHADE_internal_symmetry::findTetra4C3s</a></div><div class="ttdeci">void findTetra4C3s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_signed messageShift, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the 4 C3 symmetries with correct angles requir...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00539">ProSHADE_symmetry.cpp:539</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2eb10989a2f8d46b849cdaf8410b68be"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">ProSHADE_internal_data::ProSHADE_data::getInvSO3Coeffs</a></div><div class="ttdeci">proshade_complex * getInvSO3Coeffs(void)</div><div class="ttdoc">This function allows access to the inverse SO(3) coefficients array.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03847">ProSHADE_data.cpp:3847</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_aa4957b0a47193ef1042028dc22b350f6"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">ProSHADE_settings::allDetectedIAxes</a></div><div class="ttdeci">std::vector&lt; proshade_unsign &gt; allDetectedIAxes</div><div class="ttdoc">The vector of all detected icosahedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00159">ProSHADE_settings.hpp:159</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_aa3e24ef5a66fa7204a2ba9c27f2f12b9"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#aa3e24ef5a66fa7204a2ba9c27f2f12b9">ProSHADE_settings::forceBounds</a></div><div class="ttdeci">proshade_signed * forceBounds</div><div class="ttdoc">These will be the boundaries to be forced upon the map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00096">ProSHADE_settings.hpp:96</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a9ad9534f35b1c9fcb4f94fbb4c0b97ba"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a9ad9534f35b1c9fcb4f94fbb4c0b97ba">ProSHADE_settings::fourierWeightsFileName</a></div><div class="ttdeci">std::string fourierWeightsFileName</div><div class="ttdoc">The filename from which Fourier weights data will be read from.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00089">ProSHADE_settings.hpp:89</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a42b012ec753ebd1d87a0b6f557e97d1a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">ProSHADE_settings::detectedSymmetry</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; detectedSymmetry</div><div class="ttdoc">The vector of detected symmetry axes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00154">ProSHADE_settings.hpp:154</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5d47aafdd2ec9912225c3c44e2bbc4d8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">ProSHADE_internal_data::ProSHADE_data::yFrom</a></div><div class="ttdeci">proshade_signed yFrom</div><div class="ttdoc">This is the starting index along the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00111">ProSHADE_data.hpp:111</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ac8e62cc8dbd40265e51143c8207b6638"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ac8e62cc8dbd40265e51143c8207b6638">ProSHADE_settings::recommendedSymmetryFold</a></div><div class="ttdeci">proshade_unsign recommendedSymmetryFold</div><div class="ttdoc">The fold of the recommended symmetry C or D type, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00132">ProSHADE_settings.hpp:132</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a16336bdf0b391c953a549d3df115d691"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a></div><div class="ttdeci">void addToUnsignVector(std::vector&lt; proshade_unsign &gt; *vecToAddTo, proshade_unsign elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00099">ProSHADE_misc.cpp:99</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_ac311071faa65db4dfc1886d2a6de78ef"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ac311071faa65db4dfc1886d2a6de78ef">ProSHADE_internal_mapManip::reSampleMapToResolutionFourier</a></div><div class="ttdeci">void reSampleMapToResolutionFourier(proshade_double *&amp;map, proshade_single resolution, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_single *&amp;corrs)</div><div class="ttdoc">This function re-samples a map to conform to given resolution using Fourier.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01427">ProSHADE_mapManip.cpp:1427</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_aa373379d6fa4ebebb0f62e66384186e1"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aa373379d6fa4ebebb0f62e66384186e1">ProSHADE_internal_mapManip::copyMapByBounds</a></div><div class="ttdeci">void copyMapByBounds(proshade_signed xFrom, proshade_signed xTo, proshade_signed yFrom, proshade_signed yTo, proshade_signed zFrom, proshade_signed zTo, proshade_signed origXFrom, proshade_signed origYFrom, proshade_signed origZFrom, proshade_unsign yDimIndices, proshade_unsign zDimIndices, proshade_unsign origXDimIndices, proshade_unsign origYDimIndices, proshade_unsign origZDimIndices, proshade_double *&amp;newMap, proshade_double *origMap)</div><div class="ttdoc">This function copies an old map to a new map with different boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l02132">ProSHADE_mapManip.cpp:2132</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad9a02d8d68aac021572b764651aad0f1"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad9a02d8d68aac021572b764651aad0f1">ProSHADE_internal_data::ProSHADE_data::getPredictedIcosahedralSymmetriesList</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_double * &gt; &gt; getPredictedIcosahedralSymmetriesList(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSymList)</div><div class="ttdoc">This function predicts a list of all I symmetry axes from the already computed C symmetries list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01880">ProSHADE_symmetry.cpp:1880</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a298bc9a6aae624a091cd97b842a6b618"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a298bc9a6aae624a091cd97b842a6b618">ProSHADE_internal_data::ProSHADE_data::getYAxisOrigin</a></div><div class="ttdeci">proshade_signed * getYAxisOrigin(void)</div><div class="ttdoc">This function allows access to the map Y axis origin value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04029">ProSHADE_data.cpp:4029</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afa3b1a8ef870a606035102b5dcf1ce44"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa3b1a8ef870a606035102b5dcf1ce44">ProSHADE_internal_data::ProSHADE_data::getCyclicSymmetriesListFromAngleAxis</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; getCyclicSymmetriesListFromAngleAxis(ProSHADE_settings *settings)</div><div class="ttdoc">This function obtains a list of all C symmetries from the angle-axis space mapped rotation function v...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02770">ProSHADE_symmetry.cpp:2770</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a924d0767561842716b2ac260426cdc19"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a924d0767561842716b2ac260426cdc19">ProSHADE_internal_data::ProSHADE_data::originalPdbRotCenZ</a></div><div class="ttdeci">proshade_double originalPdbRotCenZ</div><div class="ttdoc">The centre of rotation as it relates to the original PDB positions (and not the ProSHADE internal map...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00104">ProSHADE_data.hpp:104</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__overlay_html_aed7eab7c65fccfa0690ef475ae4e2e9e"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__overlay.html#aed7eab7c65fccfa0690ef475ae4e2e9e">ProSHADE_internal_overlay::computeTranslationsFromPeak</a></div><div class="ttdeci">void computeTranslationsFromPeak(ProSHADE_internal_data::ProSHADE_data *staticStructure, ProSHADE_internal_data::ProSHADE_data *movingStructure, proshade_double *trsX, proshade_double *trsY, proshade_double *trsZ)</div><div class="ttdoc">This function computes the translation in Angstroms that corresponds to the translation function peak...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00220">ProSHADE_overlay.cpp:220</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__overlay_html_a1e7fa43107bc9a9fce49d5954a93c962"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__overlay.html#a1e7fa43107bc9a9fce49d5954a93c962">ProSHADE_internal_overlay::paddMapWithZeroes</a></div><div class="ttdeci">void paddMapWithZeroes(proshade_double *oldMap, proshade_double *&amp;newMap, proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_unsign xDimIndices, proshade_unsign yDimIndices, proshade_unsign zDimIndices, proshade_unsign addXPre, proshade_unsign addYPre, proshade_unsign addZPre)</div><div class="ttdoc">This function adds zeroes before and after the central map and copies the central map values into a n...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00521">ProSHADE_overlay.cpp:521</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a2d19df22d740c51de6edafbf679ae3fd"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a2d19df22d740c51de6edafbf679ae3fd">ProSHADE_internal_misc::addToSingleVector</a></div><div class="ttdeci">void addToSingleVector(std::vector&lt; proshade_single &gt; *vecToAddTo, proshade_single elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00055">ProSHADE_misc.cpp:55</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a0ee28b12499554d8dff8752cd5ef072a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">ProSHADE_settings::firstModelOnly</a></div><div class="ttdeci">bool firstModelOnly</div><div class="ttdoc">Shoud only the first PDB model be used, or should all models be used?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00046">ProSHADE_settings.hpp:46</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a422414bb07db89a5c797f371a5448c0e"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a422414bb07db89a5c797f371a5448c0e">ProSHADE_internal_symmetry::findIcos15C2s</a></div><div class="ttdeci">void findIcos15C2s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_signed messageShift, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the fifteen C3 symmetries with correct angles ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02524">ProSHADE_symmetry.cpp:2524</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__data_8cpp_html_ae2a2bd26e2e081130593c7783c54f293"><div class="ttname"><a href="_pro_s_h_a_d_e__data_8cpp.html#ae2a2bd26e2e081130593c7783c54f293">sortProSHADESymmetryByFSC</a></div><div class="ttdeci">bool sortProSHADESymmetryByFSC(proshade_double *a, proshade_double *b)</div><div class="ttdoc">This function allows using std::sort to sort vectors of ProSHADE symmetry format.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01887">ProSHADE_data.cpp:1887</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a4627b03c4064d3de15efb3ebbf57ed78"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">ProSHADE_settings::axisErrTolerance</a></div><div class="ttdeci">proshade_double axisErrTolerance</div><div class="ttdoc">Allowed error on vector axis in in dot product ( acos ( 1 - axErr ) is the allowed difference in radi...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00128">ProSHADE_settings.hpp:128</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a1f0d2cb45fee521ddb2d0bc30beff3ec"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a1f0d2cb45fee521ddb2d0bc30beff3ec">ProSHADE_settings::useSameBounds</a></div><div class="ttdeci">bool useSameBounds</div><div class="ttdoc">Switch to say that the same boundaries as used for the first should be used for all input maps.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00095">ProSHADE_settings.hpp:95</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad1f180d58f829e2c0fc50569b2425d56"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">ProSHADE_internal_data::ProSHADE_data::zDimIndices</a></div><div class="ttdeci">proshade_unsign zDimIndices</div><div class="ttdoc">This is the size of the map cell z dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00067">ProSHADE_data.hpp:67</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__data_html_a0b4a8747c321a46b5acf4206feba6c86"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">ProSHADE_internal_data::computeGroupElementsForGroup</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; computeGroupElementsForGroup(proshade_double xAx, proshade_double yAx, proshade_double zAx, proshade_signed fold)</div><div class="ttdoc">This function computes the group elements as rotation matrices (except for the identity element) for ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02939">ProSHADE_data.cpp:2939</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a3cac1bd635aabf3a3370fc26dfa0f49a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a3cac1bd635aabf3a3370fc26dfa0f49a">ProSHADE_settings::pdbBFactorNewVal</a></div><div class="ttdeci">proshade_double pdbBFactorNewVal</div><div class="ttdoc">Change all PDB B-factors to this value (for smooth maps).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00055">ProSHADE_settings.hpp:55</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere_html_a125477466283ee2e9b30d0299fc8e501"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#a125477466283ee2e9b30d0299fc8e501">ProSHADE_internal_spheres::ProSHADE_sphere::allocateRotatedMap</a></div><div class="ttdeci">void allocateRotatedMap(void)</div><div class="ttdoc">This function allocates the rotated map memory.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l00596">ProSHADE_spheres.cpp:596</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a67d6eadd10e10c0b46f1f2e43df7db99"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">ProSHADE_internal_data::ProSHADE_data::zGridIndices</a></div><div class="ttdeci">proshade_unsign zGridIndices</div><div class="ttdoc">As far as I know, this is identical to the zDimIndices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00070">ProSHADE_data.hpp:70</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a96a407a325278aec10d10a15c480c077"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">ProSHADE_settings::setRecommendedFold</a></div><div class="ttdeci">void setRecommendedFold(proshade_unsign val)</div><div class="ttdoc">Sets the ProSHADE detected symmetry fold.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l01492">ProSHADE.cpp:1492</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_afacb5240b508ea28b64cacf395b47dba"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#afacb5240b508ea28b64cacf395b47dba">ProSHADE_internal_distances::generateSO3CoeffsFromEMatrices</a></div><div class="ttdeci">void generateSO3CoeffsFromEMatrices(ProSHADE_internal_data::ProSHADE_data *obj1, ProSHADE_internal_data::ProSHADE_data *obj2, ProSHADE_settings *settings)</div><div class="ttdoc">This function converts the E matrices to SO(3) coefficients.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00701">ProSHADE_distances.cpp:701</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a189c98238a6caef5d7dfde5cde999709"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a189c98238a6caef5d7dfde5cde999709">ProSHADE_internal_io::applyWeights</a></div><div class="ttdeci">void applyWeights(proshade_double *&amp;map, std::string weightsFile, proshade_unsign xDimInds, proshade_unsign yDimInds, proshade_unsign zDimInds, proshade_signed verbose, proshade_signed messageShift, proshade_double *weightsArray=nullptr, proshade_unsign waXInds=0, proshade_unsign waYInds=0, proshade_unsign waZInds=0)</div><div class="ttdoc">This function reads and applies the Fourier weights to the map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00566">ProSHADE_io.cpp:566</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a192954646aa4b895b5fc522e79ea38cf"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a192954646aa4b895b5fc522e79ea38cf">ProSHADE_settings::setVariablesLeftOnAuto</a></div><div class="ttdeci">void setVariablesLeftOnAuto(void)</div><div class="ttdoc">Function to determine general values that the user left on auto-determination.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l00503">ProSHADE.cpp:503</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_acea4abeec3e2b45524e23809a69dce9d"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#acea4abeec3e2b45524e23809a69dce9d">ProSHADE_settings::removeWaters</a></div><div class="ttdeci">bool removeWaters</div><div class="ttdoc">Should all waters be removed from input PDB files?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00045">ProSHADE_settings.hpp:45</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa414664dde18320cc52075640590d51d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">ProSHADE_internal_data::ProSHADE_data::spheres</a></div><div class="ttdeci">ProSHADE_internal_spheres::ProSHADE_sphere ** spheres</div><div class="ttdoc">The set of concentric spheres to which the intermal density map has been projected.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00120">ProSHADE_data.hpp:120</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a255bdb77824ce0fddc2454d5823219e1"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a255bdb77824ce0fddc2454d5823219e1">ProSHADE_internal_data::ProSHADE_data::normaliseMap</a></div><div class="ttdeci">void normaliseMap(ProSHADE_settings *settings)</div><div class="ttdoc">Function for normalising the map values to mean 0 and sd 1..</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01229">ProSHADE_data.cpp:1229</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2714fcb2c08b224ccf09d64322bd2ab2"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2714fcb2c08b224ccf09d64322bd2ab2">ProSHADE_internal_data::ProSHADE_data::findRequestedCSymmetryFromAngleAxis</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; findRequestedCSymmetryFromAngleAxis(ProSHADE_settings *settings, proshade_unsign fold, proshade_double *peakThres)</div><div class="ttdoc">This function searches the angle-axis representation of the rotation function for a cyclic point grou...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02909">ProSHADE_symmetry.cpp:2909</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a2454c19169bb38d616e52b99f1dc4495"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a2454c19169bb38d616e52b99f1dc4495">ProSHADE_internal_maths::findAllPrimes</a></div><div class="ttdeci">std::vector&lt; proshade_unsign &gt; findAllPrimes(proshade_unsign upTo)</div><div class="ttdoc">This function finds all prime numbers up to the supplied limit.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l03058">ProSHADE_maths.cpp:3058</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a923cdc6e27455ba99ce5f536932f3721"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a923cdc6e27455ba99ce5f536932f3721">ProSHADE_internal_data::ProSHADE_data::originalPdbRotCenX</a></div><div class="ttdeci">proshade_double originalPdbRotCenX</div><div class="ttdoc">The centre of rotation as it relates to the original PDB positions (and not the ProSHADE internal map...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00102">ProSHADE_data.hpp:102</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac00197ab71e3353cb2884be0e51d6cd3"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac00197ab71e3353cb2884be0e51d6cd3">ProSHADE_internal_data::ProSHADE_data::originalMapZCom</a></div><div class="ttdeci">proshade_double originalMapZCom</div><div class="ttdoc">The COM of the first map to be loaded/computed without any furhter changes being reflacted along the ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00093">ProSHADE_data.hpp:93</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__messages_html_a4f98d32ed17424a1d8bf451a68370e20"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a></div><div class="ttdeci">void printProgressMessage(proshade_signed verbose, proshade_signed messageLevel, std::string message, proshade_signed messageShift=0)</div><div class="ttdoc">General stdout message printing.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__messages_8cpp_source.html#l00071">ProSHADE_messages.cpp:71</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a37b2746ce3f6560446b4eb45ba552084"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">ProSHADE_internal_data::ProSHADE_data::yDimSize</a></div><div class="ttdeci">proshade_single yDimSize</div><div class="ttdoc">This is the size of the map cell y dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00060">ProSHADE_data.hpp:60</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a3e7f4174b62aa402a1f6d3becd8e9dd5"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a3e7f4174b62aa402a1f6d3becd8e9dd5">ProSHADE_settings::setResolution</a></div><div class="ttdeci">void setResolution(proshade_single resolution)</div><div class="ttdoc">Sets the requested resolution in the appropriate variable.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l00549">ProSHADE.cpp:549</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a2ac59de43dacdd96c7f89811f80d2e7e"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">ProSHADE_settings::allDetectedCAxes</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; allDetectedCAxes</div><div class="ttdoc">The vector of all detected cyclic symmetry axes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00155">ProSHADE_settings.hpp:155</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5919acc2f26efcf373db47ed96eadc38"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5919acc2f26efcf373db47ed96eadc38">ProSHADE_internal_data::ProSHADE_data::removePhaseInormation</a></div><div class="ttdeci">void removePhaseInormation(ProSHADE_settings *settings)</div><div class="ttdoc">This function removes phase from the map, effectively converting it to Patterson map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03657">ProSHADE_data.cpp:3657</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a037825616c60bef58075284449872642"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">ProSHADE_internal_mapManip::moveMapByIndices</a></div><div class="ttdeci">void moveMapByIndices(proshade_single *xMov, proshade_single *yMov, proshade_single *zMov, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed *xFrom, proshade_signed *xTo, proshade_signed *yFrom, proshade_signed *yTo, proshade_signed *zFrom, proshade_signed *zTo, proshade_signed *xOrigin, proshade_signed *yOrigin, proshade_signed *zOrigin)</div><div class="ttdoc">Function for moving map back to original PDB location by changing the indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00765">ProSHADE_mapManip.cpp:765</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a9677e06f0781855b9046aab1b3638831"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a9677e06f0781855b9046aab1b3638831">ProSHADE_internal_io::readInMapHeader</a></div><div class="ttdeci">void readInMapHeader(gemmi::Ccp4&lt; float &gt; *map, proshade_unsign *xDimInds, proshade_unsign *yDimInds, proshade_unsign *zDimInds, proshade_single *xDim, proshade_single *yDim, proshade_single *zDim, proshade_single *aAng, proshade_single *bAng, proshade_single *cAng, proshade_signed *xFrom, proshade_signed *yFrom, proshade_signed *zFrom, proshade_signed *xAxOrigin, proshade_signed *yAxOrigin, proshade_signed *zAxOrigin, proshade_unsign *xAxOrder, proshade_unsign *yAxOrder, proshade_unsign *zAxOrder, proshade_unsign *xGridInds, proshade_unsign *yGridInds, proshade_unsign *zGridInds)</div><div class="ttdoc">This function parses the CCP4 MAP file header as read in by gemmi.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00109">ProSHADE_io.cpp:109</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a3d484590819881311b611ab08c2ce9b0"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a3d484590819881311b611ab08c2ce9b0">ProSHADE_settings::fastISearch</a></div><div class="ttdeci">bool fastISearch</div><div class="ttdoc">Should FSC be computed for all possible I matches, or just for the best one according to FR?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00139">ProSHADE_settings.hpp:139</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a16d3cf24f73eafc1d5b8ef9e204aaf8d"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a16d3cf24f73eafc1d5b8ef9e204aaf8d">ProSHADE_internal_symmetry::predictIcosAxes</a></div><div class="ttdeci">void predictIcosAxes(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; std::vector&lt; proshade_double * &gt; &gt; *ret, proshade_double axErr, proshade_double minPeakHeight)</div><div class="ttdoc">This function predicts all possible icosahedral point groups symmetry axes from the cyclic point grou...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02154">ProSHADE_symmetry.cpp:2154</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae2f2469c7d252c5e87d7bf9976b9b796"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae2f2469c7d252c5e87d7bf9976b9b796">ProSHADE_internal_data::ProSHADE_data::getAllGroupElements</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; getAllGroupElements(ProSHADE_settings *settings, std::vector&lt; proshade_unsign &gt; axesList, std::string groupType=&quot;&quot;, proshade_double matrixTolerance=0.05)</div><div class="ttdoc">This function returns the group elements as rotation matrices of any defined point group.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03151">ProSHADE_data.cpp:3151</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a7a402c710af1af5fabf7505848dad047"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7a402c710af1af5fabf7505848dad047">ProSHADE_internal_data::ProSHADE_data::addExtraSpace</a></div><div class="ttdeci">void addExtraSpace(ProSHADE_settings *settings)</div><div class="ttdoc">This function increases the size of the map so that it can add empty space around it.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01585">ProSHADE_data.cpp:1585</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a37925ac477480c718451debb01a9c74a"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a37925ac477480c718451debb01a9c74a">ProSHADE_internal_symmetry::detectTetrahedralSymmetry</a></div><div class="ttdeci">bool detectTetrahedralSymmetry(std::vector&lt; proshade_double * &gt; *CSymList, proshade_double axErr, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and decides whether basic requirements for tetrahedral s...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00488">ProSHADE_symmetry.cpp:488</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a2e915d310892aea124046acd14db4a84"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a2e915d310892aea124046acd14db4a84">ProSHADE_internal_misc::sortSymHlpInv</a></div><div class="ttdeci">bool sortSymHlpInv(const proshade_double *a, const proshade_double *b)</div><div class="ttdoc">This function compares two arrays of two based on the fifth number, sorting highest first.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00266">ProSHADE_misc.cpp:266</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a60e14917f99e745c35cc400475ad6ca5"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a></div><div class="ttdeci">void addToStringVector(std::vector&lt; std::string &gt; *vecToAddTo, std::string elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00033">ProSHADE_misc.cpp:33</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__spherical_harmonics_html_a3fa7caeb0d21183a39d7cca2d889c437"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__spherical_harmonics.html#a3fa7caeb0d21183a39d7cca2d889c437">ProSHADE_internal_sphericalHarmonics::computeSphericalHarmonics</a></div><div class="ttdeci">void computeSphericalHarmonics(proshade_unsign band, proshade_double *sphereMappedData, proshade_complex *&amp;shArray)</div><div class="ttdoc">This function computes the spherical harmonics of a aingle shell, saving them in supplied pointer.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spherical_harmonics_8cpp_source.html#l00394">ProSHADE_sphericalHarmonics.cpp:394</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_abd1c1b3588308f775da5c8aeba3f3e78"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abd1c1b3588308f775da5c8aeba3f3e78">ProSHADE_internal_data::ProSHADE_data::readInPDB</a></div><div class="ttdeci">void readInPDB(ProSHADE_settings *settings)</div><div class="ttdoc">Function for reading pdb data.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00700">ProSHADE_data.cpp:700</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere_html_a050b2c9c5a64d16fb47257f9abb19c8b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html#a050b2c9c5a64d16fb47257f9abb19c8b">ProSHADE_internal_spheres::ProSHADE_sphere::setRotatedMappedData</a></div><div class="ttdeci">void setRotatedMappedData(proshade_unsign pos, proshade_double value)</div><div class="ttdoc">This function sets the rotated mapped data value to the given position.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l00613">ProSHADE_spheres.cpp:613</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_acf2c2c9634a9e641270f8889624c3752"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#acf2c2c9634a9e641270f8889624c3752">ProSHADE_internal_data::ProSHADE_data::prepareFSCFourierMemory</a></div><div class="ttdeci">void prepareFSCFourierMemory(fftw_complex *&amp;mapData, fftw_complex *&amp;origCoeffs, fftw_complex *&amp;fCoeffs, proshade_signed *&amp;binIndexing, proshade_signed *noBins, proshade_double **&amp;bindata, proshade_signed *&amp;binCounts, fftw_plan *planForwardFourier, proshade_double *&amp;fscByBin)</div><div class="ttdoc">This function allocates the memory and makes all preparations required for FSC computation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02320">ProSHADE_data.cpp:2320</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afbbcec01a6ee7701e3b1d0e61730fadf"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afbbcec01a6ee7701e3b1d0e61730fadf">ProSHADE_internal_data::ProSHADE_data::getZFromPtr</a></div><div class="ttdeci">proshade_signed * getZFromPtr(void)</div><div class="ttdoc">This function allows access to the map start along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03979">ProSHADE_data.cpp:3979</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a68eb739dd4846a1dd48032eb2cc3f49c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a68eb739dd4846a1dd48032eb2cc3f49c">ProSHADE_internal_data::ProSHADE_data::getZToPtr</a></div><div class="ttdeci">proshade_signed * getZToPtr(void)</div><div class="ttdoc">This function allows access to the map last position along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04009">ProSHADE_data.cpp:4009</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_pro_s_h_a_d_e__internal__data.html">ProSHADE_internal_data</a></li><li class="navelem"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_data</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
