<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ProSHADE: src/proshade/ProSHADE_data.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ProSHADE
   &#160;<span id="projectnumber">0.7.6.0 (JUL 2021)</span>
   </div>
   <div id="projectbrief">Protein Shape Detection</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_pro_s_h_a_d_e__data_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ProSHADE_data.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_pro_s_h_a_d_e__data_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//==================================================== ProSHADE</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_pro_s_h_a_d_e__data_8hpp.html">ProSHADE_data.hpp</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//==================================================== Do not use the following flags for the included files - this causes a lot of warnings that have nothing to do with ProSHADE</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#if defined ( __GNUC__ )</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic push</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic ignored &quot;-Wpedantic&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic ignored &quot;-Wshadow&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic ignored &quot;-Wall&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic ignored &quot;-Wextra&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic ignored &quot;-Wdouble-promotion&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic ignored &quot;-Wconversion&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//==================================================== Do not use the following flags for the included files - this causes a lot of warnings that have nothing to do with ProSHADE</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#if defined ( __clang__ )</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">    #pragma clang diagnostic push</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">    #pragma clang diagnostic ignored &quot;-Wpedantic&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">    #pragma clang diagnostic ignored &quot;-Wshadow&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">    #pragma clang diagnostic ignored &quot;-Wall&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">    #pragma clang diagnostic ignored &quot;-Wextra&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">    #pragma clang diagnostic ignored &quot;-Wdouble-promotion&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">    #pragma clang diagnostic ignored &quot;-Weverything&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//==================================================== Remove MSVC C4996 Warnings caused by Gemmi code</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#if defined ( _MSC_VER )</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">    #pragma warning ( disable:4996 )</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//==================================================== Gemmi PDB output - this cannot be with the rest of includes for some stb_sprintf library related reasons ...</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#define GEMMI_WRITE_IMPLEMENTATION</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &lt;gemmi/to_pdb.hpp&gt;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//==================================================== Enable MSVC C4996 Warnings for the rest of the code</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#if defined ( _MSC_VER )</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">    #pragma warning ( default:4996 )</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">//==================================================== Now the flags can be restored and used as per the CMakeLists.txt file.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#if defined ( __GNUC__ )</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic pop</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//==================================================== Now the flags can be restored and used as per the CMakeLists.txt file.</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#if defined ( __clang__ )</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">    #pragma clang diagnostic pop</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//==================================================== Forward declarations</span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html">   74</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html">ProSHADE_internal_symmetry</a></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;{</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    proshade_signed <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">addAxisUnlessSame</a> ( proshade_unsign fold, proshade_double axX, proshade_double axY, proshade_double axZ, proshade_double axHeight, proshade_double averageFSC, std::vector&lt; proshade_double* &gt;* prosp, proshade_double axErr );</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">//==================================================== Local functions prototypes</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">axesToGroupTypeSanityCheck</a>                ( proshade_unsign requiredAxes, proshade_unsign obtainedAxes, std::string groupType );</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keywordtype">bool</span>        <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#ae56351defa0ee4f5777b61e58150aba4">checkElementAlreadyExists</a>                 ( std::vector&lt;std::vector&lt; proshade_double &gt; &gt;* elements, std::vector&lt; proshade_double &gt;* elem, proshade_double matrixTolerance );</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keywordtype">bool</span>        <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a>                    ( std::vector&lt;std::vector&lt; proshade_double &gt; &gt;* elements, proshade_double matrixTolerance );</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keywordtype">bool</span>        <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#ae2a2bd26e2e081130593c7783c54f293">sortProSHADESymmetryByFSC</a>                 ( proshade_double* a, proshade_double* b );</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a549bd90e8cdb71762a48aec59a313dd3">   93</a></span>&#160;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a549bd90e8cdb71762a48aec59a313dd3">ProSHADE_internal_data::ProSHADE_data::ProSHADE_data</a> ( )</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// ... Variables regarding input file</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a>                                    = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4052e498b4650f62bfe5ff37ed959292">fileType</a>                                    = ProSHADE_internal_io::UNKNOWN;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// ... Variables regarding map</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>                                 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// ... Variables regarding map information</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>                                    = 0.0;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>                                    = 0.0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>                                    = 0.0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">aAngle</a>                                      = 0.0;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9dbcec9f32eb76625d7aa59d8c2701d9">bAngle</a>                                      = 0.0;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e2f99f00dd05198b508633cf7f6f080">cAngle</a>                                      = 0.0;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>                                 = 0;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>                                 = 0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>                                 = 0;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">xGridIndices</a>                                = 0;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">yGridIndices</a>                                = 0;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">zGridIndices</a>                                = 0;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">xAxisOrder</a>                                  = 1;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">yAxisOrder</a>                                  = 2;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">zAxisOrder</a>                                  = 3;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a>                                 = 0;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a>                                 = 0;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a>                                 = 0;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">xCom</a>                                        = 0.0;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">yCom</a>                                        = 0.0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">zCom</a>                                        = 0.0;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// ... Variables regarding original input values (i.e. these do not change with ProSHADE manipulations)</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ae6821c27e7facf63839c9fc678c9c7">xDimSizeOriginal</a>                            = 0.0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7855424ca5d51853c7fc665ecb9b935b">yDimSizeOriginal</a>                            = 0.0;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a530ad7e3396cbcbc1814051031070a8b">zDimSizeOriginal</a>                            = 0.0;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9598e9a38546e3bf260bc09c0c9366a2">xDimIndicesOriginal</a>                         = 0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ef18126c2c24edc9b6be06e0591127f">yDimIndicesOriginal</a>                         = 0;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ea6522b99cf1ac72199c9eeccd30742">zDimIndicesOriginal</a>                         = 0;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a43f1c4682016759ea2e24c5903dbe444">xAxisOriginOriginal</a>                         = 0;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a53cffdab0d66cb88884ec4f46c19a5ff">yAxisOriginOriginal</a>                         = 0;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aed1c8e0ffb847b093a736c5156f86e9b">zAxisOriginOriginal</a>                         = 0;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2a3fdf194eca61b1ccfa5bdd2f586e0b">originalMapXCom</a>                             = 0.0;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a64323b4117a11f0971cb0d24ec95c64c">originalMapYCom</a>                             = 0.0;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac00197ab71e3353cb2884be0e51d6cd3">originalMapZCom</a>                             = 0.0;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7861a96d94b8f7a8eb2946729c330863">mapMovFromsChangeX</a>                          = 0.0;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1658311301e365cf17721e864b829c28">mapMovFromsChangeY</a>                          = 0.0;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a682749f30d2fd19842d96e9b870d76ab">mapMovFromsChangeZ</a>                          = 0.0;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a471ec29b27c3a402d18b20fee8035f1a">mapCOMProcessChangeX</a>                        = 0.0;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47bf2343b0b50267e8e3732c964b63ea">mapCOMProcessChangeY</a>                        = 0.0;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a487131ae5dc44f8667908bf64725b4ab">mapCOMProcessChangeZ</a>                        = 0.0;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// ... Variables regarding rotation and translation of original input files</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a923cdc6e27455ba99ce5f536932f3721">originalPdbRotCenX</a>                          = 0.0;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a77cabdd70039e82f8c0cbb07fefd3960">originalPdbRotCenY</a>                          = 0.0;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a924d0767561842716b2ac260426cdc19">originalPdbRotCenZ</a>                          = 0.0;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9548e8ff07c6a74bbe2353f647fb6a79">originalPdbTransX</a>                           = 0.0;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5241ee8b8b9d9915e1ef92e3edab202d">originalPdbTransY</a>                           = 0.0;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aee571cb10ce61ab11680b1ebd5e23eb7">originalPdbTransZ</a>                           = 0.0;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// ... Variables regarding iterator positions</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>                                       = 0;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>                                       = 0;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>                                       = 0;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>                                         = 0;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>                                         = 0;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>                                         = 0;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// ... Variables regarding SH mapping spheres</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">spherePos</a>                                   = std::vector&lt;proshade_single&gt; ( );</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">noSpheres</a>                                   = 0;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">spheres</a>                                     = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">sphericalHarmonics</a>                          = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94b04108aa1a9406eb3c5eb61749140b">rotSphericalHarmonics</a>                       = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a>                                = 0;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// ... Variables regarding shape distance computations</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">rrpMatrices</a>                                 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">eMatrices</a>                                   = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">so3Coeffs</a>                                   = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a33312dd4333617b460628e4db4bf41fc">so3CoeffsInverse</a>                            = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">wignerMatrices</a>                              = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d266289b137b48132f1456fd8fc43ea">integrationWeight</a>                           = 0.0;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ed9b0a765739d89104eca2c1875dd4">maxCompBand</a>                                 = 0;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37f26ac4bc76e4f4c5da77dd0eace56e">translationMap</a>                              = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// ... Control variables</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac57d606fdb59d54bd3f9249941402b12">isEmpty</a>                                     = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7afb32f0574cb707876c4502680dfd80">  214</a></span>&#160;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a549bd90e8cdb71762a48aec59a313dd3">ProSHADE_internal_data::ProSHADE_data::ProSHADE_data</a> ( std::string strName, <span class="keywordtype">double</span> *mapVals, <span class="keywordtype">int</span> len, proshade_single xDmSz, proshade_single yDmSz, proshade_single zDmSz, proshade_unsign xDmInd, proshade_unsign yDmInd, proshade_unsign zDmInd, proshade_signed xFr, proshade_signed yFr, proshade_signed zFr, proshade_signed xT, proshade_signed yT, proshade_signed zT, proshade_unsign inputO )</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// ... Variables regarding input file</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    this-&gt;fileName                                    = strName;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    this-&gt;fileType                                    = ProSHADE_internal_io::MAP;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// ... Variables regarding map</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    this-&gt;internalMap                                 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// ... Variables regarding map information</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    this-&gt;xDimSize                                    = xDmSz;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    this-&gt;yDimSize                                    = yDmSz;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    this-&gt;zDimSize                                    = zDmSz;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    this-&gt;aAngle                                      = 90.0;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    this-&gt;bAngle                                      = 90.0;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    this-&gt;cAngle                                      = 90.0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    this-&gt;xDimIndices                                 = xDmInd;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    this-&gt;yDimIndices                                 = yDmInd;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    this-&gt;zDimIndices                                 = zDmInd;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    this-&gt;xGridIndices                                = xDmInd;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    this-&gt;yGridIndices                                = yDmInd;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    this-&gt;zGridIndices                                = zDmInd;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    this-&gt;xAxisOrder                                  = 1;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    this-&gt;yAxisOrder                                  = 2;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    this-&gt;zAxisOrder                                  = 3;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    this-&gt;xAxisOrigin                                 = xFr;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    this-&gt;yAxisOrigin                                 = yFr;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    this-&gt;zAxisOrigin                                 = zFr;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    this-&gt;xCom                                        = 0.0;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    this-&gt;yCom                                        = 0.0;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    this-&gt;zCom                                        = 0.0;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">// ... Variables regarding original input values (i.e. these do not change with ProSHADE manipulations)</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    this-&gt;xDimSizeOriginal                            = 0.0;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    this-&gt;yDimSizeOriginal                            = 0.0;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    this-&gt;zDimSizeOriginal                            = 0.0;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    this-&gt;xDimIndicesOriginal                         = 0;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    this-&gt;yDimIndicesOriginal                         = 0;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    this-&gt;zDimIndicesOriginal                         = 0;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    this-&gt;xAxisOriginOriginal                         = 0;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    this-&gt;yAxisOriginOriginal                         = 0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    this-&gt;zAxisOriginOriginal                         = 0;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    this-&gt;originalMapXCom                             = 0.0;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    this-&gt;originalMapYCom                             = 0.0;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    this-&gt;originalMapZCom                             = 0.0;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    this-&gt;mapMovFromsChangeX                          = 0.0;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    this-&gt;mapMovFromsChangeY                          = 0.0;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    this-&gt;mapMovFromsChangeZ                          = 0.0;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    this-&gt;mapCOMProcessChangeX                        = 0.0;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    this-&gt;mapCOMProcessChangeY                        = 0.0;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    this-&gt;mapCOMProcessChangeZ                        = 0.0;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">// ... Variables regarding rotation and translation of original input files</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    this-&gt;originalPdbRotCenX                          = 0.0;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    this-&gt;originalPdbRotCenY                          = 0.0;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    this-&gt;originalPdbRotCenZ                          = 0.0;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    this-&gt;originalPdbTransX                           = 0.0;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    this-&gt;originalPdbTransY                           = 0.0;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    this-&gt;originalPdbTransZ                           = 0.0;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">// ... Variables regarding iterator positions</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    this-&gt;xFrom                                       = xFr;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    this-&gt;yFrom                                       = yFr;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    this-&gt;zFrom                                       = zFr;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    this-&gt;xTo                                         = xT;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    this-&gt;yTo                                         = yT;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    this-&gt;zTo                                         = zT;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// ... Variables regarding SH mapping spheres</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    this-&gt;spherePos                                   = std::vector&lt;proshade_single&gt; ( );</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    this-&gt;noSpheres                                   = 0;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    this-&gt;spheres                                     = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    this-&gt;sphericalHarmonics                          = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    this-&gt;rotSphericalHarmonics                       = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    this-&gt;maxShellBand                                = 0;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// ... Variables regarding shape distance computations</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    this-&gt;rrpMatrices                                 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    this-&gt;eMatrices                                   = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    this-&gt;so3Coeffs                                   = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    this-&gt;so3CoeffsInverse                            = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    this-&gt;wignerMatrices                              = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    this-&gt;integrationWeight                           = 0.0;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    this-&gt;maxCompBand                                 = 0;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    this-&gt;translationMap                              = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">// ... Control variables</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    this-&gt;isEmpty                                     = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    this-&gt;inputOrder                                  = inputO;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">//================================================ Sanity checks</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( len ) != ( xDmInd * yDmInd * zDmInd ) )</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Structure class input map has wrong dimensions.&quot;</span>, <span class="stringliteral">&quot;EP00044&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied map array size has different dimensions to\n                    : the required map dimensions.&quot;</span> );</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">if</span> ( ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( xT - xFr ) != <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( xDmInd - 1 ) ) ||</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;         ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( yT - yFr ) != <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( yDmInd - 1 ) ) ||</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;         ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( zT - zFr ) != <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( zDmInd - 1 ) ) )</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Structure class input dimensions not in line with map\n                    : to/from indices.&quot;</span>, <span class="stringliteral">&quot;EP00045&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied map information does not add up. The\n                    : dimensions are not in line with the indexing start/stop\n                    : position distances and therefore proper map indexing\n                    : cannot be done. Please check the input values.&quot;</span> );</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">//================================================ Allocate the map memory</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    this-&gt;internalMap                                 = <span class="keyword">new</span> proshade_double [this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;internalMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">//================================================ Copy the values into the map</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    proshade_unsign arrPos                            = 0;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign xIt = 0; xIt &lt; this-&gt;xDimIndices; xIt++ )</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign yIt = 0; yIt &lt; this-&gt;yDimIndices; yIt++ )</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign zIt = 0; zIt &lt; this-&gt;zDimIndices; zIt++ )</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                arrPos                                = zIt + this-&gt;zDimIndices * ( yIt + this-&gt;yDimIndices * xIt );</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                this-&gt;internalMap[arrPos]             = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( mapVals[arrPos] );</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">//================================================ Release memory (it was allocated by the PyBind11 lambda function and needs to be released)</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keyword">delete</span>[] mapVals;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a485495727d37abd66295bab95d368438">  349</a></span>&#160;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a485495727d37abd66295bab95d368438">ProSHADE_internal_data::ProSHADE_data::~ProSHADE_data</a> ( )</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;{</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">//================================================ Release the internal map</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;internalMap != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keyword">delete</span>[] this-&gt;internalMap;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">//================================================ Release the sphere mapping</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;spheres != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; this-&gt;noSpheres; iter++ )</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;spheres[iter] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <span class="keyword">delete</span> this-&gt;spheres[iter];</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                this-&gt;spheres[iter]                   = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keyword">delete</span>[] this-&gt;spheres;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">//================================================ Release the spherical harmonics</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;sphericalHarmonics != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; this-&gt;noSpheres; iter++ )</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;sphericalHarmonics[iter] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                <span class="keyword">delete</span>[] this-&gt;sphericalHarmonics[iter];</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                this-&gt;sphericalHarmonics[iter]        = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keyword">delete</span>[] this-&gt;sphericalHarmonics;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">//================================================ Release the rotated spherical harmonics</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;rotSphericalHarmonics != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; this-&gt;noSpheres; iter++ )</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;rotSphericalHarmonics[iter] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <span class="keyword">delete</span>[] this-&gt;rotSphericalHarmonics[iter];</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                this-&gt;rotSphericalHarmonics[iter]     = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keyword">delete</span>[] this-&gt;rotSphericalHarmonics;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">//================================================ Release the RRP matrices (pre-computation for the energy levels descriptor)</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;rrpMatrices != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign bwIt = 0; bwIt &lt; this-&gt;maxShellBand; bwIt++ )</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;rrpMatrices[bwIt] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign shIt = 0; shIt &lt; this-&gt;noSpheres; shIt++ )</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    <span class="keywordflow">if</span> ( this-&gt;rrpMatrices[bwIt][shIt] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        <span class="keyword">delete</span>[] this-&gt;rrpMatrices[bwIt][shIt];</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <span class="keyword">delete</span>[] this-&gt;rrpMatrices[bwIt];</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keyword">delete</span>[] this-&gt;rrpMatrices;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">//================================================ Release the E matrices</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;eMatrices != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign bandIter = 0; bandIter &lt; this-&gt;maxCompBand; bandIter++ )</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;eMatrices[bandIter] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign band2Iter = 0; band2Iter &lt; static_cast&lt;proshade_unsign&gt; ( ( bandIter * 2 ) + 1 ); band2Iter++ )</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    <span class="keywordflow">if</span> ( this-&gt;eMatrices[bandIter][band2Iter] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                    {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                        <span class="keyword">delete</span>[] this-&gt;eMatrices[bandIter][band2Iter];</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                    }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                <span class="keyword">delete</span>[] this-&gt;eMatrices[bandIter];</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keyword">delete</span>[] this-&gt;eMatrices;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">//================================================ Release SOFT and inverse SOFT coefficients</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;so3Coeffs != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keyword">delete</span>[] this-&gt;so3Coeffs;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;so3CoeffsInverse != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keyword">delete</span>[] this-&gt;so3CoeffsInverse;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">//================================================ Release Wigner matrices</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;wignerMatrices != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign bandIter = 1; bandIter &lt; this-&gt;maxCompBand; bandIter++ )</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;wignerMatrices[bandIter] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign order1Iter = 0; order1Iter &lt; ( (bandIter * 2) + 1 ); order1Iter++ )</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                    <span class="keywordflow">if</span> ( this-&gt;wignerMatrices[bandIter][order1Iter] != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                        <span class="keyword">delete</span>[] this-&gt;wignerMatrices[bandIter][order1Iter];</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                    }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                <span class="keyword">delete</span>[] this-&gt;wignerMatrices[bandIter];</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keyword">delete</span>[] wignerMatrices;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">//================================================ Release translation map</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;translationMap != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keyword">delete</span>[] this-&gt;translationMap;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">//================================================ Release the angle-axis space rotation function</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;sphereMappedRotFun.size() &gt; 0 )</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign spIt = 0; spIt &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;sphereMappedRotFun.size() ); spIt++ )</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="keyword">delete</span> this-&gt;sphereMappedRotFun.at(spIt);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;}</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59f2f2ce1bfdb90432c5a29600fdd9e6">  501</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59f2f2ce1bfdb90432c5a29600fdd9e6">ProSHADE_internal_data::ProSHADE_data::readInStructure</a> ( std::string fName, proshade_unsign inputO, <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;{</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting to read the structure: &quot;</span> + fName );</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">//================================================ Check if instance is empty</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">if</span> ( !this-&gt;isEmpty )</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Structure data class not empty.&quot;</span>, <span class="stringliteral">&quot;E000005&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;Attempted to read in structure into a ProSHADE_data\n                    : object which already does have structure read in\n                    : i.e. &quot;</span> + this-&gt;fileName );</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">//================================================ Save the filename</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    this-&gt;fileName                                    = fName;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">//================================================ Check what is the input format</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    this-&gt;fileType                                    = <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a63ae2cc7f413d224e5d651ed579e9afb">ProSHADE_internal_io::figureDataType</a> ( this-&gt;fileName );</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">//================================================ Save input order</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    this-&gt;inputOrder                                  = inputO;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="comment">//================================================ Decide how to proceed</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">switch</span> ( this-&gt;fileType )</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordflow">case</span> ProSHADE_internal_io::UNKNOWN:</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Unknown file type.&quot;</span>, <span class="stringliteral">&quot;E000006&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;When attempting to read the file\n                    : &quot;</span> + this-&gt;fileName + <span class="stringliteral">&quot;\n                    : the file extension was determined as unknown. This could\n                    : mean either that the file does not exist, or that it is\n                    : not one of the supported extensions.&quot;</span> );</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">case</span> ProSHADE_internal_io::PDB:</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            this-&gt;readInPDB                           ( settings );</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordflow">case</span> ProSHADE_internal_io::MAP:</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            this-&gt;readInMAP                           ( settings );</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">//================================================ This structure is now full</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    this-&gt;isEmpty                                     = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Structure read in successfully.&quot;</span> );</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    return ;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;}</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a07fb6e354dcd90dc70f8b4fa8bba0c33">  554</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a07fb6e354dcd90dc70f8b4fa8bba0c33">ProSHADE_internal_data::ProSHADE_data::readInMAP</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;{</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">//================================================ Open the file</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    gemmi::Ccp4&lt;float&gt; map;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    map.read_ccp4                                     ( gemmi::MaybeGzipped ( this-&gt;fileName.c_str() ) );</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">//================================================ Convert to XYZ and create complete map, if need be</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    map.setup                                         ( gemmi::GridSetup::ReorderOnly, NAN );</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">//================================================ Read in the rest of the map file header</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a9677e06f0781855b9046aab1b3638831">ProSHADE_internal_io::readInMapHeader</a>             ( &amp;map,</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                                        &amp;this-&gt;xDimIndices,  &amp;this-&gt;yDimIndices,  &amp;this-&gt;zDimIndices,</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                                                        &amp;this-&gt;xDimSize,     &amp;this-&gt;yDimSize,     &amp;this-&gt;zDimSize,</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                                                        &amp;this-&gt;aAngle,       &amp;this-&gt;bAngle,       &amp;this-&gt;cAngle,</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                                                        &amp;this-&gt;xFrom,        &amp;this-&gt;yFrom,        &amp;this-&gt;zFrom,</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                                                        &amp;this-&gt;xAxisOrigin,  &amp;this-&gt;yAxisOrigin,  &amp;this-&gt;zAxisOrigin,</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                                                        &amp;this-&gt;xAxisOrder,   &amp;this-&gt;yAxisOrder,   &amp;this-&gt;zAxisOrder,</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                                                        &amp;this-&gt;xGridIndices, &amp;this-&gt;yGridIndices, &amp;this-&gt;zGridIndices );</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">//================================================ Save the map density to ProSHADE variable</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#ad93f9644c5b132193b4ddd282f50abce">ProSHADE_internal_io::readInMapData</a>               ( &amp;map, this-&gt;internalMap, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, this-&gt;xAxisOrder, this-&gt;yAxisOrder, this-&gt;zAxisOrder );</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="comment">//================================================ If mask is supplied and the correct task is used</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">if</span> ( ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a670cffe28bbdac027bffd8f5491d4266">appliedMaskFileName</a> != <span class="stringliteral">&quot;&quot;</span> ) &amp;&amp; ( ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb39c3bb75f1b925175f9f6b09ada148">task</a> == MapManip ) || ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb39c3bb75f1b925175f9f6b09ada148">task</a> == Symmetry ) ) )</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        std::stringstream hlpSS;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;Reading mask file &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a670cffe28bbdac027bffd8f5491d4266">appliedMaskFileName</a>;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, hlpSS.str() );</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="comment">//============================================ Open the mask</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        gemmi::Ccp4&lt;float&gt; mask;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        mask.read_ccp4                                ( gemmi::MaybeGzipped ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a670cffe28bbdac027bffd8f5491d4266">appliedMaskFileName</a>.c_str() ) );</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="comment">//============================================ Convert to XYZ and create complete mask, if need be</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        mask.setup                                    ( gemmi::GridSetup::ReorderOnly, 0 );</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="comment">//============================================ Read in the rest of the mask file header</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        proshade_unsign xDI, yDI, zDI, xAOR, yAOR, zAOR, xGI, yGI, zGI;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        proshade_single xDS, yDS, zDS, aA, bA, cA;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        proshade_signed xF, yF, zF, xAO, yAO, zAO;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a9677e06f0781855b9046aab1b3638831">ProSHADE_internal_io::readInMapHeader</a>         ( &amp;mask,</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                                        &amp;xDI,  &amp;yDI,  &amp;zDI,</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                                        &amp;xDS,  &amp;yDS,  &amp;zDS,</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                                        &amp;aA,   &amp;bA,   &amp;cA,</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                                        &amp;xF,   &amp;yF,   &amp;zF,</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                                        &amp;xAO,  &amp;yAO,  &amp;zAO,</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                                        &amp;xAOR, &amp;yAOR, &amp;zAOR,</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                                        &amp;xGI,  &amp;yGI,  &amp;zGI );</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="comment">//============================================ Sanity check</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="keywordflow">if</span> ( ( this-&gt;xDimIndices != xDI ) || ( this-&gt;yDimIndices != yDI ) || ( this-&gt;zDimIndices != zDI ) )</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a>                  ( <span class="stringliteral">&quot;The supplied map mask has different dimensions than the\n                    : density map.&quot;</span>, <span class="stringliteral">&quot;EM00065&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;Most likely the mask is not the correct mask for this map,\n                    : as it has different dimensions from the density map.\n                    : Please review that the supplied map and mask form a pair.&quot;</span> );</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="comment">//============================================ Save the mask values to ProSHADE variable</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        proshade_double* internalMask = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#ad93f9644c5b132193b4ddd282f50abce">ProSHADE_internal_io::readInMapData</a>           ( &amp;mask, internalMask, xDI, yDI, zDI, xAOR, yAOR, zAOR );</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="comment">//============================================ Apply the mask to the map</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; static_cast&lt; size_t &gt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ ) { this-&gt;internalMap[iter] *= internalMask[iter]; }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="comment">//============================================ Release the memory</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keyword">delete</span>[] internalMask;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, <span class="stringliteral">&quot;Mask read in and applied successfully.&quot;</span> );</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">//================================================ Remove negative values if so required</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ad42474a333f9b605ccad7ecfb72afb2e">removeNegativeDensity</a> ) { <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; static_cast&lt; size_t &gt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ ) { <span class="keywordflow">if</span> ( this-&gt;internalMap[iter] &lt; 0.0 ) { this-&gt;internalMap[iter] = 0.0; } } }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">//================================================ Set resolution if need be</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a> &lt; 0.0f )</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3e7f4174b62aa402a1f6d3becd8e9dd5">setResolution</a>                       ( std::min ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimSize ) / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimIndices ),</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                                                        std::min ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimSize ) / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimIndices ),</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                                                                   <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimSize ) / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) ) ) * 2.0f );</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">//================================================ Set iterators from and to</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    this-&gt;figureIndexStartStop                        ( );</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="comment">//================================================ If specific resolution is requested, make sure the map has it</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab61d2183930ea26b3d49e7662052e83b">changeMapResolution</a> || settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4f49a4f2263aa12ccb1737f8dc32c9ac">changeMapResolutionTriLinear</a> )</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="comment">//============================================ Before re-sampling sampling rate</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        proshade_single xSampRate                     = this-&gt;xDimSize / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xTo - this-&gt;xFrom );</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        proshade_single ySampRate                     = this-&gt;yDimSize / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yTo - this-&gt;yFrom );</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        proshade_single zSampRate                     = this-&gt;zDimSize / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zTo - this-&gt;zFrom );</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="comment">//============================================ Bofore re-sampling first index position</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        proshade_single xStartPosBefore               = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xFrom ) * xSampRate;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        proshade_single yStartPosBefore               = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yFrom ) * ySampRate;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        proshade_single zStartPosBefore               = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zFrom ) * zSampRate;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="comment">//============================================ Find COM before map re-sampling</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        proshade_double xMapCOMPreReSampl = 0.0, yMapCOMPreReSampl = 0.0, zMapCOMPreReSampl = 0.0;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aaad67127777eab70acca5952a7838d26">ProSHADE_internal_mapManip::findMAPCOMValues</a>  ( this-&gt;internalMap, &amp;xMapCOMPreReSampl, &amp;yMapCOMPreReSampl, &amp;zMapCOMPreReSampl, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, this-&gt;xFrom, this-&gt;xTo, this-&gt;yFrom, this-&gt;yTo, this-&gt;zFrom, this-&gt;zTo );</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="comment">//============================================ Re-sample map</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        this-&gt;reSampleMap                             ( settings );</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="comment">//============================================ After re-sampling sampling rate</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        xSampRate                                     = this-&gt;xDimSize / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xTo - this-&gt;xFrom );</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        ySampRate                                     = this-&gt;yDimSize / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yTo - this-&gt;yFrom );</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        zSampRate                                     = this-&gt;zDimSize / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zTo - this-&gt;zFrom );</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="comment">//============================================ After re-sampling first index position</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        proshade_single xStartPosAfter                = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xFrom ) * xSampRate;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        proshade_single yStartPosAfter                = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yFrom ) * ySampRate;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        proshade_single zStartPosAfter                = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zFrom ) * zSampRate;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="comment">//============================================ Translate by change in corners to make the boxes as similarly placed as possible</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        proshade_single xMov                          = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( xStartPosAfter - xStartPosBefore );</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        proshade_single yMov                          = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( yStartPosAfter - yStartPosBefore );</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        proshade_single zMov                          = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( zStartPosAfter - zStartPosBefore );</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">ProSHADE_internal_mapManip::moveMapByIndices</a>  ( &amp;xMov, &amp;yMov, &amp;zMov, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize,</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                                        &amp;this-&gt;xFrom, &amp;this-&gt;xTo, &amp;this-&gt;yFrom, &amp;this-&gt;yTo, &amp;this-&gt;zFrom, &amp;this-&gt;zTo,</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                                                        &amp;this-&gt;xAxisOrigin, &amp;this-&gt;yAxisOrigin, &amp;this-&gt;zAxisOrigin );</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="comment">//============================================ Find COM after map re-sampling and corner move</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        proshade_double xMapCOMPostReSampl = 0.0, yMapCOMPostReSampl = 0.0, zMapCOMPostReSampl = 0.0;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aaad67127777eab70acca5952a7838d26">ProSHADE_internal_mapManip::findMAPCOMValues</a>  ( this-&gt;internalMap, &amp;xMapCOMPostReSampl, &amp;yMapCOMPostReSampl, &amp;zMapCOMPostReSampl, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, this-&gt;xFrom, this-&gt;xTo, this-&gt;yFrom, this-&gt;yTo, this-&gt;zFrom, this-&gt;zTo );</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="comment">//============================================ Match the COMs to get as close position of the re-sampled structure to the original as possible</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>  ( this-&gt;internalMap,</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( xMapCOMPreReSampl - xMapCOMPostReSampl ),</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( yMapCOMPreReSampl - yMapCOMPostReSampl ),</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( zMapCOMPreReSampl - zMapCOMPostReSampl ),</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                                        this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize,</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;xDimIndices ),</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ),</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) );</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">//================================================ Save the original sizes</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    this-&gt;xDimSizeOriginal                            = this-&gt;xDimSize;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    this-&gt;yDimSizeOriginal                            = this-&gt;yDimSize;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    this-&gt;zDimSizeOriginal                            = this-&gt;zDimSize;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">//================================================ Save the original index counts</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    this-&gt;xDimIndicesOriginal                         = this-&gt;xDimIndices;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    this-&gt;yDimIndicesOriginal                         = this-&gt;yDimIndices;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    this-&gt;zDimIndicesOriginal                         = this-&gt;zDimIndices;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">//================================================ Save the original axis origins</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    this-&gt;xAxisOriginOriginal                         = this-&gt;xAxisOrigin;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    this-&gt;yAxisOriginOriginal                         = this-&gt;yAxisOrigin;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    this-&gt;zAxisOriginOriginal                         = this-&gt;zAxisOrigin;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">//================================================ Compute and save the COM</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    this-&gt;findMapCOM                                  ( );</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    this-&gt;originalMapXCom                             = this-&gt;xCom;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    this-&gt;originalMapYCom                             = this-&gt;yCom;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    this-&gt;originalMapZCom                             = this-&gt;zCom;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;}</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abd1c1b3588308f775da5c8aeba3f3e78">  725</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abd1c1b3588308f775da5c8aeba3f3e78">ProSHADE_internal_data::ProSHADE_data::readInPDB</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;{</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="comment">//================================================ Set resolution if need be</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a> &lt; 0.0f )</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3e7f4174b62aa402a1f6d3becd8e9dd5">setResolution</a>                       ( 8.0 );</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="comment">//================================================ Open PDB file for reading</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    gemmi::Structure pdbFile                          = gemmi::read_structure ( gemmi::MaybeGzipped ( this-&gt;fileName ) );</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="comment">//================================================ Change B-factors if need be</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3cac1bd635aabf3a3370fc26dfa0f49a">pdbBFactorNewVal</a> &gt;= 0.0 )</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#afe3659ed2939880f96701cb162d8a12d">ProSHADE_internal_mapManip::changePDBBFactors</a> ( &amp;pdbFile, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3cac1bd635aabf3a3370fc26dfa0f49a">pdbBFactorNewVal</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">firstModelOnly</a> );</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="comment">//================================================ Remove waters if required</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#acea4abeec3e2b45524e23809a69dce9d">removeWaters</a> )</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a8993520350e1eab8f3eb041c8115cac5">ProSHADE_internal_mapManip::removeWaters</a>      ( &amp;pdbFile, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">firstModelOnly</a> );</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    }</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">//================================================ Get PDB COM values</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    proshade_double xCOMPdb, yCOMPdb, zCOMPdb;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a3d107e20dfeb5b5442fc3d0ba70bf2ef">ProSHADE_internal_mapManip::findPDBCOMValues</a>      ( pdbFile, &amp;xCOMPdb, &amp;yCOMPdb, &amp;zCOMPdb, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">firstModelOnly</a> );</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="comment">//================================================ Find the ranges</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    proshade_single xF, xT, yF, yT, zF, zT;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ad4feb37444a93df167935cf42d1209f6">ProSHADE_internal_mapManip::determinePDBRanges</a>    ( pdbFile, &amp;xF, &amp;xT, &amp;yF, &amp;yT, &amp;zF, &amp;zT, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">firstModelOnly</a> );</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="comment">//================================================ Move ranges to have all FROM values 20</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    proshade_single xMov                              = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( 20.0f - xF );</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    proshade_single yMov                              = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( 20.0f - yF );</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    proshade_single zMov                              = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( 20.0f - zF );</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a1f9e6ab7a6db084069402d83ad152c01">ProSHADE_internal_mapManip::movePDBForMapCalc</a>     ( &amp;pdbFile, xMov, yMov, zMov, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">firstModelOnly</a> );</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="comment">//================================================ Set the angstrom sizes</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    this-&gt;xDimSize                                    = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( xT - xF + 40.0f );</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    this-&gt;yDimSize                                    = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( yT - yF + 40.0f );</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    this-&gt;zDimSize                                    = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( zT - zF + 40.0f );</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">//================================================ Generate map from nicely placed atoms (cell size will be range + 40)</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a3bd5d0937bf5a545008b06593c5722a7">ProSHADE_internal_mapManip::generateMapFromPDB</a>    ( pdbFile, this-&gt;internalMap, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a>, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, &amp;this-&gt;xTo, &amp;this-&gt;yTo, &amp;this-&gt;zTo, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#acffa14a2c2121b5b425fcabdb7b3ba6a">forceP1</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">firstModelOnly</a> );</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="comment">//================================================ Remove negative values if so required</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ad42474a333f9b605ccad7ecfb72afb2e">removeNegativeDensity</a> ) { <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; static_cast&lt; size_t &gt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ ) { <span class="keywordflow">if</span> ( this-&gt;internalMap[iter] &lt; 0.0 ) { this-&gt;internalMap[iter] = 0.0; } } }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">//================================================ Set the internal variables to correct values</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    this-&gt;setPDBMapValues                             ( );</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="comment">//================================================ Compute reverse movement based on COMs. If there is more than 1 models, simply moving back the xyzMov is not enough.</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    proshade_double xCOMMap, yCOMMap, zCOMMap;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aaad67127777eab70acca5952a7838d26">ProSHADE_internal_mapManip::findMAPCOMValues</a>      ( this-&gt;internalMap, &amp;xCOMMap, &amp;yCOMMap, &amp;zCOMMap,</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                                                        this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize,</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                                                        this-&gt;xFrom, this-&gt;xTo, this-&gt;yFrom, this-&gt;yTo, this-&gt;zFrom, this-&gt;zTo );</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">if</span> ( pdbFile.models.size() &gt; 1 )</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        xMov                                          = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( xCOMMap - xCOMPdb );</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        yMov                                          = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( yCOMMap - yCOMPdb );</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        zMov                                          = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( zCOMMap - zCOMPdb );</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="comment">//================================================ Move map back to the original PDB location</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">ProSHADE_internal_mapManip::moveMapByIndices</a>      ( &amp;xMov, &amp;yMov, &amp;zMov, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize,</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                                        &amp;this-&gt;xFrom, &amp;this-&gt;xTo, &amp;this-&gt;yFrom, &amp;this-&gt;yTo, &amp;this-&gt;zFrom, &amp;this-&gt;zTo,</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                                                        &amp;this-&gt;xAxisOrigin, &amp;this-&gt;yAxisOrigin, &amp;this-&gt;zAxisOrigin );</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>      ( this-&gt;internalMap, xMov, yMov, zMov, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize,</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;xDimIndices ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ),</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) );</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="comment">//================================================ If specific resolution is requested, make sure the map has it</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab61d2183930ea26b3d49e7662052e83b">changeMapResolution</a> || settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4f49a4f2263aa12ccb1737f8dc32c9ac">changeMapResolutionTriLinear</a> )</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="comment">//============================================ Before re-sampling sampling rate</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        proshade_single xSampRate                     = this-&gt;xDimSize / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xTo - this-&gt;xFrom );</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        proshade_single ySampRate                     = this-&gt;yDimSize / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yTo - this-&gt;yFrom );</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        proshade_single zSampRate                     = this-&gt;zDimSize / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zTo - this-&gt;zFrom );</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="comment">//============================================ Bofore re-sampling first index position</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        proshade_single xStartPosBefore               = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xFrom ) * xSampRate;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        proshade_single yStartPosBefore               = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yFrom ) * ySampRate;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        proshade_single zStartPosBefore               = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zFrom ) * zSampRate;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="comment">//============================================ Find COM before map re-sampling</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        proshade_double xMapCOMPreReSampl = 0.0, yMapCOMPreReSampl = 0.0, zMapCOMPreReSampl = 0.0;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aaad67127777eab70acca5952a7838d26">ProSHADE_internal_mapManip::findMAPCOMValues</a>  ( this-&gt;internalMap, &amp;xMapCOMPreReSampl, &amp;yMapCOMPreReSampl, &amp;zMapCOMPreReSampl, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, this-&gt;xFrom, this-&gt;xTo, this-&gt;yFrom, this-&gt;yTo, this-&gt;zFrom, this-&gt;zTo );</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="comment">//============================================ Re-sample map</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        this-&gt;reSampleMap                             ( settings );</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="comment">//============================================ After re-sampling sampling rate</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        xSampRate                                     = this-&gt;xDimSize / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xTo - this-&gt;xFrom );</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        ySampRate                                     = this-&gt;yDimSize / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yTo - this-&gt;yFrom );</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        zSampRate                                     = this-&gt;zDimSize / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zTo - this-&gt;zFrom );</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="comment">//============================================ After re-sampling first index position</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        proshade_single xStartPosAfter                = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xFrom ) * xSampRate;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        proshade_single yStartPosAfter                = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yFrom ) * ySampRate;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        proshade_single zStartPosAfter                = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zFrom ) * zSampRate;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="comment">//============================================ Translate by change in corners to make the boxes as similarly placed as possible</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        proshade_single xMovHlp                       = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( xStartPosAfter - xStartPosBefore );</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        proshade_single yMovHlp                       = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( yStartPosAfter - yStartPosBefore );</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        proshade_single zMovHlp                       = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( zStartPosAfter - zStartPosBefore );</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">ProSHADE_internal_mapManip::moveMapByIndices</a>  ( &amp;xMovHlp, &amp;yMovHlp, &amp;zMovHlp, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize,</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                                                        &amp;this-&gt;xFrom, &amp;this-&gt;xTo, &amp;this-&gt;yFrom, &amp;this-&gt;yTo, &amp;this-&gt;zFrom, &amp;this-&gt;zTo,</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                                                        &amp;this-&gt;xAxisOrigin, &amp;this-&gt;yAxisOrigin, &amp;this-&gt;zAxisOrigin );</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment">//============================================ Find COM after map re-sampling and corner move</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        proshade_double xMapCOMPostReSampl = 0.0, yMapCOMPostReSampl = 0.0, zMapCOMPostReSampl = 0.0;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aaad67127777eab70acca5952a7838d26">ProSHADE_internal_mapManip::findMAPCOMValues</a>  ( this-&gt;internalMap, &amp;xMapCOMPostReSampl, &amp;yMapCOMPostReSampl, &amp;zMapCOMPostReSampl, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, this-&gt;xFrom, this-&gt;xTo, this-&gt;yFrom, this-&gt;yTo, this-&gt;zFrom, this-&gt;zTo );</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="comment">//============================================ Match the COMs to get as close position of the re-sampled structure to the original as possible</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>  ( this-&gt;internalMap,</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( xMapCOMPreReSampl - xMapCOMPostReSampl ),</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( yMapCOMPreReSampl - yMapCOMPostReSampl ),</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( zMapCOMPreReSampl - zMapCOMPostReSampl ),</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                                                        this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize,</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;xDimIndices ),</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ),</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) );</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="comment">//================================================ Save the original sizes</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    this-&gt;xDimSizeOriginal                            = this-&gt;xDimSize;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    this-&gt;yDimSizeOriginal                            = this-&gt;yDimSize;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    this-&gt;zDimSizeOriginal                            = this-&gt;zDimSize;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="comment">//================================================ Save the original index counts</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    this-&gt;xDimIndicesOriginal                         = this-&gt;xDimIndices;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    this-&gt;yDimIndicesOriginal                         = this-&gt;yDimIndices;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    this-&gt;zDimIndicesOriginal                         = this-&gt;zDimIndices;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="comment">//================================================ Save the original axis origins</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    this-&gt;xAxisOriginOriginal                         = this-&gt;xAxisOrigin;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    this-&gt;yAxisOriginOriginal                         = this-&gt;yAxisOrigin;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    this-&gt;zAxisOriginOriginal                         = this-&gt;zAxisOrigin;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">//================================================ Compute and save the COM</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    this-&gt;findMapCOM                                  ( );</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    this-&gt;originalMapXCom                             = this-&gt;xCom;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    this-&gt;originalMapYCom                             = this-&gt;yCom;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    this-&gt;originalMapZCom                             = this-&gt;zCom;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;}</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30edd2928e423198704adb955989960b">  880</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30edd2928e423198704adb955989960b">ProSHADE_internal_data::ProSHADE_data::setPDBMapValues</a> ( <span class="keywordtype">void</span> )</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;{</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">//================================================ Set starts to 0 </span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    this-&gt;xFrom                                       = 0;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    this-&gt;yFrom                                       = 0;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    this-&gt;zFrom                                       = 0;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="comment">//================================================ Set angles to 90 degrees</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    this-&gt;aAngle                                      = 90.0;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    this-&gt;bAngle                                      = 90.0;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    this-&gt;cAngle                                      = 90.0;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    </div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">//================================================ Set dimension sizes in indices</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    this-&gt;xDimIndices                                 = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( this-&gt;xTo );</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    this-&gt;yDimIndices                                 = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( this-&gt;yTo );</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    this-&gt;zDimIndices                                 = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( this-&gt;zTo );</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="comment">//================================================ Set the to indices properly</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    this-&gt;xTo                                        -= 1;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    this-&gt;yTo                                        -= 1;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    this-&gt;zTo                                        -= 1;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="comment">//================================================ Set grid indexing to cell indexing</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    this-&gt;xGridIndices                                = this-&gt;xDimIndices;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    this-&gt;yGridIndices                                = this-&gt;yDimIndices;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    this-&gt;zGridIndices                                = this-&gt;zDimIndices;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="comment">//================================================ Set axis order</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    this-&gt;xAxisOrder                                  = 1;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    this-&gt;yAxisOrder                                  = 2;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    this-&gt;zAxisOrder                                  = 3;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">//================================================ Set origin to the first index</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    this-&gt;xAxisOrigin                                 = this-&gt;xFrom;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    this-&gt;yAxisOrigin                                 = this-&gt;yFrom;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    this-&gt;zAxisOrigin                                 = this-&gt;zFrom;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    return ;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;}</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a476092aa08dff20d64a895e7b2227b2e">  926</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a476092aa08dff20d64a895e7b2227b2e">ProSHADE_internal_data::ProSHADE_data::figureIndexStartStop</a> ( <span class="keywordtype">void</span> )</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;{</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="comment">//================================================ Set ends to origin + size - 1</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    this-&gt;xTo                                         = this-&gt;xFrom + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;xDimIndices ) - 1;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    this-&gt;yTo                                         = this-&gt;yFrom + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) - 1;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    this-&gt;zTo                                         = this-&gt;zFrom + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) - 1;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    return ;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;}</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a81e6aab30488052e6bdd9b339e8124d8">  948</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a81e6aab30488052e6bdd9b339e8124d8">ProSHADE_internal_data::ProSHADE_data::writeMap</a> ( std::string fName, std::string title, <span class="keywordtype">int</span> mode )</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;{</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="comment">//================================================ Create and prepare new Grid gemmi object</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    gemmi::Grid&lt;float&gt; mapData;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    mapData.set_unit_cell                             ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">double</span> <span class="keyword">&gt;</span> ( this-&gt;xDimSize ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">double</span> <span class="keyword">&gt;</span> ( this-&gt;yDimSize ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">double</span> <span class="keyword">&gt;</span> ( this-&gt;zDimSize ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">double</span> <span class="keyword">&gt;</span> ( this-&gt;aAngle ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">double</span> <span class="keyword">&gt;</span> ( this-&gt;bAngle ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">double</span> <span class="keyword">&gt;</span> ( this-&gt;cAngle ) );</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    mapData.set_size_without_checking                 ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;xDimIndices ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) );</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    mapData.axis_order                                = gemmi::AxisOrder::XYZ;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    mapData.spacegroup                                = &amp;gemmi::get_spacegroup_p1();</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="comment">//================================================ Create and prepare new Ccp4 gemmi object</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    gemmi::Ccp4&lt;float&gt; map;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    map.grid                                          = mapData;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    map.update_ccp4_header                           ( mode );</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="comment">//================================================ Fill in the header</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a2e438f3d348e3e065f798031d5a33d09">ProSHADE_internal_io::writeOutMapHeader</a>           ( &amp;map,</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                                                        this-&gt;xDimIndices,  this-&gt;yDimIndices,  this-&gt;zDimIndices,</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                                                        this-&gt;xDimSize,     this-&gt;yDimSize,     this-&gt;zDimSize,</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                                                        this-&gt;aAngle,       this-&gt;bAngle,       this-&gt;cAngle,</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                                                        this-&gt;xFrom,        this-&gt;yFrom,        this-&gt;zFrom,</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                                                        this-&gt;xAxisOrigin,  this-&gt;yAxisOrigin,  this-&gt;zAxisOrigin,</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                                                        this-&gt;xAxisOrder,   this-&gt;yAxisOrder,   this-&gt;zAxisOrder,</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                                                        this-&gt;xGridIndices, this-&gt;yGridIndices, this-&gt;zGridIndices,</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                                                        title, mode );</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">//================================================ Copy internal map to grid</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    proshade_unsign arrPos                            = 0;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign uIt = 0; uIt &lt; this-&gt;xDimIndices; uIt++ )</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign vIt = 0; vIt &lt; this-&gt;yDimIndices; vIt++ )</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign wIt = 0; wIt &lt; this-&gt;zDimIndices; wIt++ )</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                arrPos                                = wIt + this-&gt;zDimIndices * ( vIt + this-&gt;yDimIndices * uIt );</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                map.grid.set_value                    ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( uIt ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( vIt ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( wIt ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span> ( this-&gt;internalMap[arrPos] ) );</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        }</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="comment">//================================================ Update the statistics in the header</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    map.update_ccp4_header                            ( mode, <span class="keyword">true</span> );</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="comment">//================================================ Write out the map</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    map.write_ccp4_map                                ( fName );</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    return ;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;}</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; </div>
<div class="line"><a name="l01013"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0322fb97dcd3c0495f98963210f36c27"> 1013</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0322fb97dcd3c0495f98963210f36c27">ProSHADE_internal_data::ProSHADE_data::writePdb</a> ( std::string fName, proshade_double euA, proshade_double euB, proshade_double euG, proshade_double trsX, proshade_double trsY, proshade_double trsZ, <span class="keywordtype">bool</span> firstModel )</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;{</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="comment">//================================================ Check for co-ordinate origin</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="keywordflow">if</span> ( !<a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#abc5e6a82b6b44e3666abfc190dc0bc64">ProSHADE_internal_io::isFilePDB</a> ( this-&gt;fileName ) )</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Cannot write co-ordinate file if the input file did not contain co-ordinates.&quot;</span>, <span class="stringliteral">&quot;EP00047&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;You have called the WritePDB function on structure which\n                    : was created by reading in a map. This is not allowed as\n                    : ProSHADE cannot create co-ordinates from map file.&quot;</span> );</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="comment">//================================================ Open PDB file for reading</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    gemmi::Structure pdbFile                          = gemmi::read_structure ( gemmi::MaybeGzipped ( this-&gt;fileName ) );</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="comment">//================================================ If the map was rotated, do the same for the co-ordinates, making sure we take into account the rotation centre of the map</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">if</span> ( ( euA != 0.0 ) || ( euB != 0.0 ) || ( euG != 0.0 ) )</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    {        </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <span class="comment">//============================================ Rotate the co-ordinates</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a4c1ee71ada97967f49ae1b338d6f43f9">ProSHADE_internal_mapManip::rotatePDBCoordinates</a> ( &amp;pdbFile, euA, euB, euG, this-&gt;originalPdbRotCenX, this-&gt;originalPdbRotCenY, this-&gt;originalPdbRotCenZ, firstModel );</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="comment">//================================================ Translate by required translation and the map centering (if applied)</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a2f09d5bdfb5450f2da8395f8770ef137">ProSHADE_internal_mapManip::translatePDBCoordinates</a> ( &amp;pdbFile, trsX, trsY, trsZ, firstModel );</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="comment">//================================================ Write the PDB file</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    std::ofstream outCoOrdFile;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    outCoOrdFile.open                                 ( fName.c_str() );</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="keywordflow">if</span> ( outCoOrdFile.is_open() )</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        gemmi::PdbWriteOptions opt;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        write_pdb                                     ( pdbFile, outCoOrdFile, opt );</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    }</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        std::stringstream hlpMessage;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        hlpMessage &lt;&lt; <span class="stringliteral">&quot;Failed to open the PDB file &quot;</span> &lt;&lt; fName &lt;&lt; <span class="stringliteral">&quot; for output.&quot;</span>;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( hlpMessage.str().c_str(), <span class="stringliteral">&quot;EP00048&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;ProSHADE has failed to open the PDB output file. This is\n                    : likely caused by either not having the write privileges\n                    : to the required output path, or by making a mistake in\n                    : the path.&quot;</span> );</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    outCoOrdFile.close                                ( );</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    return ;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;}</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aac87b1a87f32a742ea2b41014dac5f7b"> 1064</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aac87b1a87f32a742ea2b41014dac5f7b">ProSHADE_internal_data::ProSHADE_data::writeMask</a> ( std::string fName, proshade_double* mask )</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;{</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">//================================================ Allocate the memory</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    proshade_double* hlpMap                           = <span class="keyword">new</span> proshade_double[this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( hlpMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="comment">//================================================ Copy original map and over-write with the mask</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    {</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        hlpMap[iter]                                  = this-&gt;internalMap[iter];</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        this-&gt;internalMap[iter]                       = mask[iter];</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">//================================================ Write out the mask</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    this-&gt;writeMap                                    ( fName );</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="comment">//================================================ Copy the original map values back</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        this-&gt;internalMap[iter]                       = hlpMap[iter];</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keyword">delete</span>[] hlpMap;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    return ;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;}</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa67115a6b234764c958899863fb60b54"> 1101</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa67115a6b234764c958899863fb60b54">ProSHADE_internal_data::ProSHADE_data::invertMirrorMap</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;{</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map inversion.&quot;</span> );</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    proshade_signed arrayPos, invPos;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="comment">//================================================ Create helper map</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    proshade_double* hlpMap                           = <span class="keyword">new</span> proshade_double [this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( hlpMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="comment">//================================================ Save map values to the helper map</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        hlpMap[iter]                                  = this-&gt;internalMap[iter];</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    }</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="comment">//================================================ Invert the values</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed xIt = 0; xIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;xDimIndices ); xIt++ )</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed yIt = 0; yIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;yDimIndices ); yIt++ )</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        {</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed zIt = 0; zIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;zDimIndices ); zIt++ )</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                <span class="comment">//==================================== Var init</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                arrayPos                              = zIt + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) * ( yIt + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) * xIt );</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                invPos                                = ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;zDimIndices - 1 ) - zIt ) + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) * ( ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;yDimIndices - 1 ) - yIt ) + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) * ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;xDimIndices - 1 ) - xIt ) );</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                </div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                <span class="comment">//==================================== And save</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                this-&gt;internalMap[invPos]             = hlpMap[arrayPos];</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            }</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        }</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keyword">delete</span>[] hlpMap;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Map inversion completed.&quot;</span> );</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    </div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    return ;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;}</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a255bdb77824ce0fddc2454d5823219e1"> 1155</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a255bdb77824ce0fddc2454d5823219e1">ProSHADE_internal_data::ProSHADE_data::normaliseMap</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;{</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map normalisation.&quot;</span> );</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="comment">//================================================ Initialise vector of map values</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    std::vector&lt;proshade_double&gt; mapVals              ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices, 0.0 );</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="comment">//================================================ Get all map values</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    {</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        mapVals.at(iter)                              = this-&gt;internalMap[iter];</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    }</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="comment">//================================================ Get mean and sd</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    proshade_double* meanSD                           = <span class="keyword">new</span> proshade_double[2];</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a8a7c6330e101fb6d729aaf6f545db9c8">ProSHADE_internal_maths::vectorMeanAndSD</a>          ( &amp;mapVals, meanSD );</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="comment">//================================================ Normalise the values</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        this-&gt;internalMap[iter]                       = ( this-&gt;internalMap[iter] - meanSD[0] ) / meanSD[1];</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    }</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="comment">//================================================ Clear the vector</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    mapVals.clear                                     ( );</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    </div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keyword">delete</span>[] meanSD;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Map normalisation completed.&quot;</span> );</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    return ;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    </div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;}</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0122be830893f5d82bab742be54d1ee7"> 1202</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0122be830893f5d82bab742be54d1ee7">ProSHADE_internal_data::ProSHADE_data::maskMap</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;{</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Computing mask.&quot;</span> );</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="comment">//================================================ Initialise the blurred map</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    proshade_double* blurredMap                       = <span class="keyword">new</span> proshade_double[this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( blurredMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="comment">//================================================ Compute blurred map</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#afdac8ed8f140bdcd289ee666b61789d4">ProSHADE_internal_mapManip::blurSharpenMap</a>        ( this-&gt;internalMap, blurredMap, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices,</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                                                        this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a51c87d0b415c8eaa517dbb9b5496e7e9">blurFactor</a> );</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    </div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="comment">//================================================ Compute mask from blurred map and save it into the original map</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a42699d52d1be0d24e58deea4e25439bf">ProSHADE_internal_mapManip::getMaskFromBlurr</a>      ( blurredMap, this-&gt;internalMap, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7c96697585083a53f83556e70e4faca8">maskingThresholdIQRs</a> );</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="comment">//================================================ Print the mask if need be</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a29445fb6221eed35a32147814a3f58d5">saveMask</a> ) {  <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#affb17d9099f0b85b3af04a78d5c670f4">maskFileName</a> == <span class="stringliteral">&quot;&quot;</span> ) { this-&gt;writeMask ( <span class="stringliteral">&quot;proshade_mask.map&quot;</span>, blurredMap ); } <span class="keywordflow">else</span> { std::stringstream ss; ss &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#affb17d9099f0b85b3af04a78d5c670f4">maskFileName</a> &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; this-&gt;inputOrder &lt;&lt; <span class="stringliteral">&quot;.map&quot;</span>; this-&gt;writeMask ( ss.str(), blurredMap ); } }</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    </div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keyword">delete</span>[] blurredMap;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    </div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Mask computed.&quot;</span> );</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    return ;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;}</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01242"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac0dc9f3ed79cc98719e6b727bb8bb982"> 1242</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac0dc9f3ed79cc98719e6b727bb8bb982">ProSHADE_internal_data::ProSHADE_data::getReBoxBoundaries</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, proshade_signed*&amp; ret )</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;{</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Finding new boundaries.&quot;</span> );</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    </div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="comment">//================================================ If same bounds as first one are required, test if possible and return these instead</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a1f0d2cb45fee521ddb2d0bc30beff3ec">useSameBounds</a> &amp;&amp; ( this-&gt;inputOrder != 0 ) )</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    {</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 6; iter++ ) { ret[iter] = settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa3e24ef5a66fa7204a2ba9c27f2f12b9">forceBounds</a>[iter]; }</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="comment">//================================================ In this case, bounds need to be found de novo</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    {</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="comment">//============================================ Find the non-zero bounds</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ac2650a79c20be34894c23d73ffaae750">ProSHADE_internal_mapManip::getNonZeroBounds</a>  ( this-&gt;internalMap,</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;xDimIndices ),</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ),</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ),</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                                                        ret );</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        <span class="comment">//============================================ Add the extra space</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a7c88b1152378beca4ccee251f2fb5e06">ProSHADE_internal_mapManip::addExtraBoundSpace</a> ( this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices,</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                                                         this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a633435d4c8a7fd6533016c00ad9ba791">boundsExtraSpace</a> );</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        </div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="comment">//============================================ Beautify boundaries</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aeb9acf2a6f2f23b72424f01417c9ead3">ProSHADE_internal_mapManip::beautifyBoundaries</a> ( ret, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a827e3241fa6401027e0526fffb8b281d">boundsSimilarityThreshold</a> );</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <span class="comment">//============================================ Report function results</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        std::stringstream ssHlp;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        ssHlp &lt;&lt; <span class="stringliteral">&quot;New boundaries are: &quot;</span> &lt;&lt; ret[1] - ret[0] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; ret[3] - ret[2] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; ret[5] - ret[4] + 1;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, ssHlp.str() );</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        </div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <span class="comment">//============================================ If need be, save boundaries to be used for all other structure</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a1f0d2cb45fee521ddb2d0bc30beff3ec">useSameBounds</a> &amp;&amp; ( this-&gt;inputOrder == 0 ) )</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        {</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 6; iter++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa3e24ef5a66fa7204a2ba9c27f2f12b9">forceBounds</a>[iter] = ret[iter]; }</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        }</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    }</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;New boundaries determined.&quot;</span> );</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    </div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    return ;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;}</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; </div>
<div class="line"><a name="l01300"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3349a7f6ffecc3ffd4e09192eb919248"> 1300</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3349a7f6ffecc3ffd4e09192eb919248">ProSHADE_internal_data::ProSHADE_data::createNewMapFromBounds</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_data</a>*&amp; newStr, proshade_signed* newBounds )</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;{</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Creating new structure according to the new  bounds.&quot;</span> );</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="comment">//================================================ Fill in basic info</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">fileName</a>                                  = <span class="stringliteral">&quot;N/A&quot;</span>;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4052e498b4650f62bfe5ff37ed959292">fileType</a>                                  = ProSHADE_internal_io::MAP;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    </div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="comment">//================================================ Fill in new structure values</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>                               = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( newBounds[1] ) - <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( newBounds[0] ) + 1;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>                               = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( newBounds[3] ) - <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( newBounds[2] ) + 1;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>                               = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( newBounds[5] ) - <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( newBounds[4] ) + 1;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">aAngle</a>                                    = this-&gt;aAngle;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9dbcec9f32eb76625d7aa59d8c2701d9">bAngle</a>                                    = this-&gt;aAngle;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e2f99f00dd05198b508633cf7f6f080">cAngle</a>                                    = this-&gt;aAngle;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;            </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">xDimSize</a>                                  = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> ) * ( this-&gt;xDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimIndices ) );</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">yDimSize</a>                                  = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> ) * ( this-&gt;yDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) );</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">zDimSize</a>                                  = <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a> ) * ( this-&gt;zDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) );</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">xGridIndices</a>                              = newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a>;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">yGridIndices</a>                              = newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">zGridIndices</a>                              = newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            </div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">xAxisOrder</a>                                = this-&gt;xAxisOrder;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">yAxisOrder</a>                                = this-&gt;yAxisOrder;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">zAxisOrder</a>                                = this-&gt;zAxisOrder;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">xAxisOrigin</a>                               = this-&gt;xAxisOrigin + newBounds[0];</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">yAxisOrigin</a>                               = this-&gt;yAxisOrigin + newBounds[2];</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">zAxisOrigin</a>                               = this-&gt;zAxisOrigin + newBounds[4];</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            </div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>                                     = this-&gt;xFrom + newBounds[0];</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>                                     = this-&gt;yFrom + newBounds[2];</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>                                     = this-&gt;zFrom + newBounds[4];</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;            </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>                                       = this-&gt;xTo - ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;xDimIndices - 1 ) - newBounds[1] );</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>                                       = this-&gt;yTo - ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;yDimIndices - 1 ) - newBounds[3] );</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>                                       = this-&gt;zTo - ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;zDimIndices - 1 ) - newBounds[5] );</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    </div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <span class="comment">//================================================ Allocate new structure map</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>                               = <span class="keyword">new</span> proshade_double[newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">xDimIndices</a> * newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a> * newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>];</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    </div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="comment">//================================================ Copy the map</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aa373379d6fa4ebebb0f62e66384186e1">ProSHADE_internal_mapManip::copyMapByBounds</a>       ( newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">xTo</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">yTo</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">zTo</a>,</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                                                        this-&gt;xFrom, this-&gt;yFrom, this-&gt;zFrom, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">yDimIndices</a>, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">zDimIndices</a>,</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                                                        this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, newStr-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">internalMap</a>, this-&gt;internalMap );</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    </div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;New structure created.&quot;</span> );</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    return ;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    </div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;}</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160; </div>
<div class="line"><a name="l01366"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab573ea90a16991a06a77c5343328b060"> 1366</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab573ea90a16991a06a77c5343328b060">ProSHADE_internal_data::ProSHADE_data::reSampleMap</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;{</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="comment">//================================================ Initialise the return variable</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    proshade_single* changeVals                       = <span class="keyword">new</span> proshade_single[6];</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    </div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="comment">//================================================ Now re-sample the map</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab61d2183930ea26b3d49e7662052e83b">changeMapResolution</a> )</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    {</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ac311071faa65db4dfc1886d2a6de78ef">ProSHADE_internal_mapManip::reSampleMapToResolutionFourier</a> ( this-&gt;internalMap, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a>, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices,</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                                                                     this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, changeVals );</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        </div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4f49a4f2263aa12ccb1737f8dc32c9ac">changeMapResolutionTriLinear</a> )</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Requested both Fourier-space and real-space map re-sampling. Defaulting to only Fourier space re-samplling.&quot;</span>, <span class="stringliteral">&quot;WM00049&quot;</span> );</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    }</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4f49a4f2263aa12ccb1737f8dc32c9ac">changeMapResolutionTriLinear</a> &amp;&amp; !settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab61d2183930ea26b3d49e7662052e83b">changeMapResolution</a> )</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a5db74cc13dd4b64cf0a8377ed078b47c">ProSHADE_internal_mapManip::reSampleMapToResolutionTrilinear</a> ( this-&gt;internalMap, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">requestedResolution</a>, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices,</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                                                                       this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, changeVals );</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    </div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="comment">//================================================ Set the internal values to reflect the new map size</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    this-&gt;xDimIndices                                += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[0] );</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    this-&gt;yDimIndices                                += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[1] );</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    this-&gt;zDimIndices                                += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[2] );</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;            </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    this-&gt;xGridIndices                                = this-&gt;xDimIndices;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    this-&gt;yGridIndices                                = this-&gt;yDimIndices;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    this-&gt;zGridIndices                                = this-&gt;zDimIndices;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    this-&gt;xTo                                        += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[0] );</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    this-&gt;yTo                                        += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[1] );</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    this-&gt;zTo                                        += <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>  ( changeVals[2] );</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;            </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    this-&gt;xDimSize                                    = changeVals[3];</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    this-&gt;yDimSize                                    = changeVals[4];</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    this-&gt;zDimSize                                    = changeVals[5];</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160; </div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="comment">//================================================ Figure how much the new map moved</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    proshade_single xMov                              = -( ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xFrom ) * ( this-&gt;xDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimIndices ) - changeVals[0] ) ) -</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                                                           ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xFrom ) * ( this-&gt;xDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimIndices ) ) ) );</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    proshade_single yMov                              = -( ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yFrom ) * ( this-&gt;yDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) - changeVals[1] ) ) -</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                                                           ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yFrom ) * ( this-&gt;yDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) ) ) );</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    proshade_single zMov                              = -( ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zFrom ) * ( this-&gt;zDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) - changeVals[2] ) ) -</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                                                           ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zFrom ) * ( this-&gt;zDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) ) ) );</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="comment">//================================================ Move by indices (this should be sufficient)</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">ProSHADE_internal_mapManip::moveMapByIndices</a>      ( &amp;xMov, &amp;yMov, &amp;zMov, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, &amp;this-&gt;xFrom, &amp;this-&gt;xTo,</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                                                        &amp;this-&gt;yFrom, &amp;this-&gt;yTo, &amp;this-&gt;zFrom, &amp;this-&gt;zTo, &amp;this-&gt;xAxisOrigin, &amp;this-&gt;yAxisOrigin, &amp;this-&gt;zAxisOrigin );</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>      ( this-&gt;internalMap, xMov, yMov, zMov, this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize,</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;xDimIndices ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) );</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    </div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keyword">delete</span>[] changeVals;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    return ;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;}</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160; </div>
<div class="line"><a name="l01438"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a80ff45ef40549fb6a1d80b70865fc807"> 1438</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a80ff45ef40549fb6a1d80b70865fc807">ProSHADE_internal_data::ProSHADE_data::centreMapOnCOM</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;{</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Centering map onto its COM.&quot;</span> );</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    </div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    proshade_double xCOM                              = 0.0;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    proshade_double yCOM                              = 0.0;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    proshade_double zCOM                              = 0.0;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="comment">//================================================ Find the COM location</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aaad67127777eab70acca5952a7838d26">ProSHADE_internal_mapManip::findMAPCOMValues</a>      ( this-&gt;internalMap, &amp;xCOM, &amp;yCOM, &amp;zCOM,</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                                                        this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;xDimSize, this-&gt;xFrom,</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                                                        this-&gt;xTo, this-&gt;yFrom, this-&gt;yTo, this-&gt;zFrom, this-&gt;zTo );</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    </div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="comment">//================================================ Find the sampling rates</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    proshade_single xSampRate                         = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xDimSize ) / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xTo - this-&gt;xFrom );</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    proshade_single ySampRate                         = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yDimSize ) / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yTo - this-&gt;yFrom );</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    proshade_single zSampRate                         = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zDimSize ) / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zTo - this-&gt;zFrom );</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="comment">//================================================ Convert to position in indices starting from 0</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    xCOM                                             /= <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( xSampRate );</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    yCOM                                             /= <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( ySampRate );</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    zCOM                                             /= <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( zSampRate );</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;         </div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    xCOM                                             -= <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;xFrom );</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    yCOM                                             -= <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;yFrom );</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    zCOM                                             -= <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;zFrom );</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    </div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="comment">//================================================ Find distance from COM to map centre in Angstroms</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    proshade_double xDist                             = ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;xDimIndices ) / 2.0 ) - xCOM ) * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;xDimSize ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;xDimIndices );</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    proshade_double yDist                             = ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) / 2.0 ) - yCOM ) * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;yDimSize ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;yDimIndices );</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    proshade_double zDist                             = ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) / 2.0 ) - zCOM ) * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;zDimSize ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;zDimIndices );</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="comment">//================================================ Move the map within the box</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>      ( this-&gt;internalMap,</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( xDist ),</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( yDist ),</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( zDist ),</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                                                        this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize,</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;xDimIndices ),</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ),</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                                                        <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) );</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="comment">//================================================ Note the change due to centering</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    this-&gt;mapCOMProcessChangeX                       -= xDist;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    this-&gt;mapCOMProcessChangeY                       -= yDist;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    this-&gt;mapCOMProcessChangeZ                       -= zDist;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Map centered.&quot;</span> );</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    </div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    return ;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;}</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01503"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7a402c710af1af5fabf7505848dad047"> 1503</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7a402c710af1af5fabf7505848dad047">ProSHADE_internal_data::ProSHADE_data::addExtraSpace</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;{</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot;Adding extra &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">addExtraSpace</a> &lt;&lt; <span class="stringliteral">&quot; angstroms.&quot;</span>;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1,  hlpSS.str() );</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="comment">//================================================ Figure how much indices need to change</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    proshade_unsign xAddIndices                       = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">addExtraSpace</a> / this-&gt;xDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimIndices ) ) );</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    proshade_unsign yAddIndices                       = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">addExtraSpace</a> / this-&gt;yDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) ) );</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    proshade_unsign zAddIndices                       = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">addExtraSpace</a> / this-&gt;zDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) ) );</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    </div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="comment">//================================================ Update internal data variables</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    this-&gt;xDimSize                                   += 2 * <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( xAddIndices ) * this-&gt;xDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;xDimIndices );</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    this-&gt;yDimSize                                   += 2 * <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( yAddIndices ) * this-&gt;yDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;yDimIndices );</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    this-&gt;zDimSize                                   += 2 * <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( zAddIndices ) * this-&gt;zDimSize / <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( this-&gt;zDimIndices );</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;            </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    this-&gt;xDimIndices                                += 2 * xAddIndices;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    this-&gt;yDimIndices                                += 2 * yAddIndices;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    this-&gt;zDimIndices                                += 2 * zAddIndices;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    this-&gt;xGridIndices                                = this-&gt;xDimIndices;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    this-&gt;yGridIndices                                = this-&gt;yDimIndices;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    this-&gt;zGridIndices                                = this-&gt;zDimIndices;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;            </div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    this-&gt;xAxisOrigin                                -= xAddIndices;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    this-&gt;yAxisOrigin                                -= yAddIndices;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    this-&gt;zAxisOrigin                                -= zAddIndices;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    this-&gt;xFrom                                      -= xAddIndices;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    this-&gt;yFrom                                      -= yAddIndices;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    this-&gt;zFrom                                      -= zAddIndices;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;            </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    this-&gt;xTo                                        += xAddIndices;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    this-&gt;yTo                                        += yAddIndices;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    this-&gt;zTo                                        += zAddIndices;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="comment">//================================================ Allocate new map</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    proshade_double* newMap                           = <span class="keyword">new</span> proshade_double[this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( newMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    </div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="comment">//================================================ Set new map to zeroes</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    {</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        newMap[iter]                                  = 0.0;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    }</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    </div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    <span class="comment">//================================================ Update the map</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    proshade_unsign newMapIndex, oldMapIndex;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign xIt = 0; xIt &lt; (this-&gt;xDimIndices - xAddIndices); xIt++ )</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    {</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        <span class="comment">//============================================ Check if point is applicable</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        <span class="keywordflow">if</span> ( xIt &lt; xAddIndices ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign yIt = 0; yIt &lt; (this-&gt;yDimIndices - yAddIndices); yIt++ )</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        {</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            <span class="comment">//======================================== Check if point is applicable</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;            <span class="keywordflow">if</span> ( yIt &lt; yAddIndices ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;            </div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign zIt = 0; zIt &lt; (this-&gt;zDimIndices - zAddIndices); zIt++ )</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;            {</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                <span class="comment">//==================================== Check if point is applicable</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                <span class="keywordflow">if</span> ( zIt &lt; zAddIndices ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                </div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                <span class="comment">//==================================== Var init</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                newMapIndex                           = zIt + this-&gt;zDimIndices * ( yIt + this-&gt;yDimIndices * xIt );</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                oldMapIndex                           = (zIt - zAddIndices) + (this-&gt;zDimIndices - ( 2 * zAddIndices ) ) * ( (yIt - yAddIndices) + (this-&gt;yDimIndices - ( 2 * yAddIndices ) ) * (xIt - xAddIndices) );</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                </div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                newMap[newMapIndex]                   = this-&gt;internalMap[oldMapIndex];</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;            }</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        }</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    }</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <span class="comment">//================================================ Copy new to old</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keyword">delete</span>[] this-&gt;internalMap;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    </div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    this-&gt;internalMap                                 = <span class="keyword">new</span> proshade_double[this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;internalMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    </div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        this-&gt;internalMap[iter]                       = newMap[iter];</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    }</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="keyword">delete</span>[] newMap;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    </div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Extra space added.&quot;</span> );</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    return ;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    </div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;}</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; </div>
<div class="line"><a name="l01612"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afcb4202e9ffea1b99c59f73faf06d899"> 1612</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afcb4202e9ffea1b99c59f73faf06d899">ProSHADE_internal_data::ProSHADE_data::processInternalMap</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;{</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="comment">//================================================ Invert map</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0d205c102e722997ab1f0953f76a288a">invertMap</a> ) { this-&gt;invertMirrorMap ( settings ); }</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map inversion (mirror image) not requested.&quot;</span> ); }</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160; </div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="comment">//================================================ Normalise map</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0d796061e73e8635f75fc6921b98ad66">normaliseMap</a> ) { this-&gt;normaliseMap ( settings ); }</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map normalisation not requested.&quot;</span> ); }</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160; </div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="comment">//================================================ Compute mask</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a7c941c912cd17ad86057b8d7a15b9a21">maskMap</a> ) { this-&gt;maskMap ( settings ); }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Masking not requested.&quot;</span> ); }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160; </div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="comment">//================================================ Centre map</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a37c9037721c1ad28ad6421a31dbcd8d8">moveToCOM</a> ) { this-&gt;centreMapOnCOM ( settings ); }</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Map centering not requested.&quot;</span> ); }</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    </div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="comment">//================================================ Add extra space</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">addExtraSpace</a> != 0.0f ) { this-&gt;addExtraSpace ( settings ); }</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Extra space not requested.&quot;</span> ); }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    </div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="comment">//================================================ Remove phase, if required</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="keywordflow">if</span> ( !settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2019a6bae1b3e6f7d8805ae2734b769e">usePhase</a> ) { this-&gt;removePhaseInormation ( settings ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Phase information removed from the data.&quot;</span> ); }</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Phase information retained in the data.&quot;</span> ); }</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="comment">//================================================ Set settings values which were left on AUTO by user and will not be set later</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a192954646aa4b895b5fc522e79ea38cf">setVariablesLeftOnAuto</a>                  ( );</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        </div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    return ;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    </div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;}</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160; </div>
<div class="line"><a name="l01655"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a188b648a0ad28b598d682ca14f288dc4"> 1655</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a188b648a0ad28b598d682ca14f288dc4">ProSHADE_internal_data::ProSHADE_data::getSpherePositions</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;{</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="comment">//================================================ Check the current settings value is set to auto</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;spherePos.size() != 0 )</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    {</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        std::stringstream hlpSS;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;The sphere distances were determined as &quot;</span> &lt;&lt; this-&gt;spherePos.at(0);</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 1; iter &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;spherePos.size() ); iter++ ) { hlpSS &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; this-&gt;spherePos.at(iter); }</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot; Angstroms.&quot;</span>;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, hlpSS.str() );</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        return ;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    }</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    </div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <span class="comment">//================================================ Find maximum diagonal</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    proshade_unsign maxDim                            = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( std::max ( this-&gt;xDimSize, std::max ( this-&gt;yDimSize, this-&gt;zDimSize ) ) );</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    proshade_unsign minDim                            = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( std::min ( this-&gt;xDimSize, std::min ( this-&gt;yDimSize, this-&gt;zDimSize ) ) );</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    proshade_unsign midDim                            = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( 0 );</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="keywordflow">if</span>      ( ( this-&gt;xDimSize &lt; <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( maxDim ) ) &amp;&amp; ( this-&gt;xDimSize &gt; <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( minDim ) ) ) { midDim = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( this-&gt;xDimSize ); }</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ( this-&gt;yDimSize &lt; <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( maxDim ) ) &amp;&amp; ( this-&gt;yDimSize &gt; <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( minDim ) ) ) { midDim = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( this-&gt;yDimSize ); }</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keywordflow">else</span>                                                                                                                                         { midDim = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( this-&gt;zDimSize ); }</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    </div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    proshade_single maxDiag                           = <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( std::sqrt ( std::pow ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( maxDim ), 2.0 ) +</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                                                                                                     std::pow ( <span class="keyword">static_cast&lt;</span>proshade_single<span class="keyword">&gt;</span> ( midDim ), 2.0 ) ) );</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    </div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="comment">//================================================ Set between the points</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keywordflow">for</span> ( proshade_single iter = 0.5f; ( iter * settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42e4b11981a2d3a518cb3c70e5470fb2">maxSphereDists</a> ) &lt; ( maxDiag / 2.0f ); iter += 1.0f )</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    {</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a2d19df22d740c51de6edafbf679ae3fd">ProSHADE_internal_misc::addToSingleVector</a>     ( &amp;this-&gt;spherePos, ( iter * settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42e4b11981a2d3a518cb3c70e5470fb2">maxSphereDists</a> ) );</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    }</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    </div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="comment">//================================================ Save the number of spheres</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    this-&gt;noSpheres                                   = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( this-&gt;spherePos.size() );</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    </div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot;The sphere distances were determined as &quot;</span> &lt;&lt; this-&gt;spherePos.at(0);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 1; iter &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;spherePos.size() ); iter++ ) { hlpSS &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; this-&gt;spherePos.at(iter); }</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot; Angstroms.&quot;</span>;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, hlpSS.str() );</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    </div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    return ;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160; </div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;}</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160; </div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160; </div>
<div class="line"><a name="l01712"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a56bfcfacedabd84ec54aa2843d59e014"> 1712</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a56bfcfacedabd84ec54aa2843d59e014">ProSHADE_internal_data::ProSHADE_data::mapToSpheres</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;{</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting sphere mapping procedure.&quot;</span> );</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    </div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="comment">//================================================ Determine spherical harmonics variables</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a450e03005d24cc3e58d2d05fb3bc5027">determineAllSHValues</a>                    ( this-&gt;xDimIndices, this-&gt;yDimIndices,</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                                                        this-&gt;xDimSize,    this-&gt;yDimSize,    this-&gt;zDimSize );</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Sphere settings determined.&quot;</span> );</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    </div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <span class="comment">//================================================ Find number of spheres supported</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    this-&gt;getSpherePositions                          ( settings );</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Sphere positions obtained.&quot;</span> );</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    </div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="comment">//================================================ Create sphere objects and map the density</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    this-&gt;spheres                                     = <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html">ProSHADE_internal_spheres::ProSHADE_sphere</a>* [ this-&gt;noSpheres ];</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;spherePos.size() ); iter++ )</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    {</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        ss &lt;&lt; <span class="stringliteral">&quot;Now mapping sphere &quot;</span> &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot; .&quot;</span>;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, ss.str() );</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        </div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        this-&gt;spheres[iter]                           = <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html">ProSHADE_internal_spheres::ProSHADE_sphere</a> ( this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices,</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                                                                                                         this-&gt;xDimSize, this-&gt;yDimSize, this-&gt;zDimSize, iter,</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                                                                                                        &amp;this-&gt;spherePos, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2f1e4debc49664de8842d1b42be74d2d">progressiveSphereMapping</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a8324ed7ec9c19df21511f117df80ab11">maxBandwidth</a>,</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                                                                                                         this-&gt;internalMap, &amp;this-&gt;maxShellBand );</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    }</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    </div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Sphere mapping procedure completed.&quot;</span> );</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    </div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    return ;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    </div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;}</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160; </div>
<div class="line"><a name="l01756"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23f9a5f8f6fb7cf0f0324bc1d83d6090"> 1756</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23f9a5f8f6fb7cf0f0324bc1d83d6090">ProSHADE_internal_data::ProSHADE_data::computeSphericalHarmonics</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;{</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting spherical harmonics decomposition.&quot;</span> );</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    </div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <span class="comment">//================================================ Initialise memory</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    this-&gt;sphericalHarmonics                          = <span class="keyword">new</span> proshade_complex* [this-&gt;noSpheres];</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;sphericalHarmonics, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; this-&gt;noSpheres; iter++ )</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        this-&gt;sphericalHarmonics[iter]                = <span class="keyword">new</span> proshade_complex [(this-&gt;spheres[iter]-&gt;getLocalBandwidth() * 2) * (this-&gt;spheres[iter]-&gt;getLocalBandwidth() * 2)];</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( this-&gt;sphericalHarmonics[iter], __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    }</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    </div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">//================================================ Compute the spherical harmonics</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; this-&gt;noSpheres; iter++ )</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    {</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        ss &lt;&lt; <span class="stringliteral">&quot;Now decomposing sphere &quot;</span> &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot;. &quot;</span> &lt;&lt; <span class="stringliteral">&quot;( Band is: &quot;</span> &lt;&lt; this-&gt;spheres[iter]-&gt;getLocalBandwidth() &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, ss.str() );</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        </div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        <span class="comment">//============================================ Compute</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__spherical_harmonics.html#a3fa7caeb0d21183a39d7cca2d889c437">ProSHADE_internal_sphericalHarmonics::computeSphericalHarmonics</a> ( this-&gt;spheres[iter]-&gt;getLocalBandwidth(), this-&gt;spheres[iter]-&gt;getMappedData(), this-&gt;sphericalHarmonics[iter] );</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    }</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    </div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Spherical harmonics decomposition complete.&quot;</span> );</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    </div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    return ;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    </div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;}</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160; </div>
<div class="line"><a name="l01801"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afac05cfadc141435c4fc4a568ecffe29"> 1801</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afac05cfadc141435c4fc4a568ecffe29">ProSHADE_internal_data::ProSHADE_data::detectSymmetryInStructure</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* axes, std::vector &lt; std::vector&lt; proshade_double &gt; &gt;* allCs )</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;{</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="comment">//================================================ Prepare FSC computation memory and variables</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    fftw_complex *mapData, *origCoeffs, *fCoeffs;</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    fftw_plan planForwardFourier;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    proshade_double **bindata;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    proshade_signed *binIndexing, *binCounts, noBins;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    this-&gt;prepareFSCFourierMemory                     ( mapData, origCoeffs, fCoeffs, binIndexing, &amp;noBins, bindata, binCounts, &amp;planForwardFourier );</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    </div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    std::vector&lt; proshade_double* &gt; CSyms             = this-&gt;getCyclicSymmetriesList ( settings );</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="comment">//================================================ Was any particular symmetry requested?</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;&quot;</span> )</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    {</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        <span class="comment">//============================================ Run the symmetry detection functions for C, D, T, O and I symmetries</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        std::vector&lt; proshade_double* &gt; DSyms         = this-&gt;getDihedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        std::vector&lt; proshade_double* &gt; ISyms         = this-&gt;getIcosahedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        std::vector&lt; proshade_double* &gt; OSyms; std::vector&lt; proshade_double* &gt; TSyms;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        <span class="keywordflow">if</span> ( ISyms.size() &lt; 31 ) {  OSyms = this-&gt;getOctahedralSymmetriesList ( settings, &amp;CSyms ); <span class="keywordflow">if</span> ( OSyms.size() &lt; 13 ) { TSyms = this-&gt;getTetrahedralSymmetriesList ( settings, &amp;CSyms ); } }</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        </div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;        <span class="comment">//============================================ Decide on recommended symmetry</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        this-&gt;saveRecommendedSymmetry                 ( settings, &amp;CSyms, &amp;DSyms, &amp;TSyms, &amp;OSyms, &amp;ISyms, axes, mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts );</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    }</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    </div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;C&quot;</span> )</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    {</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        <span class="comment">//============================================ Run only the C symmetry detection and search for requested fold</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;        this-&gt;saveRequestedSymmetryC                  ( settings, &amp;CSyms, axes );</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    }</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    </div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;D&quot;</span> )</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    {</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        <span class="comment">//============================================ Run only the D symmetry detection and search for requested fold</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        std::vector&lt; proshade_double* &gt; DSyms         = this-&gt;getDihedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        this-&gt;saveRequestedSymmetryD                  ( settings, &amp;DSyms, axes, mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts );</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    }</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    </div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;T&quot;</span> )</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    {</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;        <span class="comment">//============================================ Run only the T symmetry detection and search for requested fold</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        std::vector&lt; proshade_double* &gt; TSyms         = this-&gt;getTetrahedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        <span class="keywordflow">if</span> ( TSyms.size() == 7 )              { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a> ( <span class="stringliteral">&quot;T&quot;</span> ); <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( TSyms.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( TSyms.at(it) ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, TSyms.at(it) ); } }</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;        <span class="keywordflow">else</span>                                  { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a> ( <span class="stringliteral">&quot;&quot;</span> ); }</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    }</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    </div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;O&quot;</span> )</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    {</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;        <span class="comment">//============================================ Run only the O symmetry detection and search for requested fold</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        std::vector&lt; proshade_double* &gt; OSyms         = this-&gt;getOctahedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        <span class="keywordflow">if</span> ( OSyms.size() == 13 )             { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a> ( <span class="stringliteral">&quot;O&quot;</span> ); <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( OSyms.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( OSyms.at(it) ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, OSyms.at(it) ); } }</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        <span class="keywordflow">else</span>                                  { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a> ( <span class="stringliteral">&quot;&quot;</span> ); }</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    }</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    </div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;I&quot;</span> )</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    {</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;        <span class="comment">//============================================ Run only the T symmetry detection and search for requested fold</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        std::vector&lt; proshade_double* &gt; ISyms         = this-&gt;getIcosahedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        <span class="keywordflow">if</span> ( ISyms.size() == 31 )             { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a> ( <span class="stringliteral">&quot;I&quot;</span> ); <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( ISyms.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( ISyms.at(it) ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, ISyms.at(it) ); } }</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        <span class="keywordflow">else</span>                                  { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a> ( <span class="stringliteral">&quot;&quot;</span> ); }</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    }</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    </div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="keywordflow">if</span> ( ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;C&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;D&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;T&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;O&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;I&quot;</span> ) )</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    {</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Requested symmetry supplied, but not recognised.&quot;</span>, <span class="stringliteral">&quot;ES00032&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;There are only the following value allowed for the\n                    : symmetry type request: \&quot;C\&quot;, \&quot;D\&quot;, \&quot;T\&quot;, \&quot;O\&quot; and \&quot;I\&quot;. Any\n                    : other value will result in this error.&quot;</span> );</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    }</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    </div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="comment">//================================================ Save C symmetries to argument and if different from settings, to the settings as well</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <span class="keywordtype">bool</span> isArgSameAsSettings                          = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( CSyms.size() ); cIt++ )</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    {</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        std::vector&lt; proshade_double &gt; nextSym;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms.at(cIt)[0] );</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms.at(cIt)[1] );</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms.at(cIt)[2] );</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms.at(cIt)[3] );</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms.at(cIt)[4] );</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms.at(cIt)[5] );</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad9fbf28fda3873fc511fa2000ccba86c">ProSHADE_internal_misc::addToDoubleVectorVector</a> ( allCs, nextSym );</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        <span class="keywordflow">if</span> ( ( cIt == 0 ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.size() == 0 ) ) { isArgSameAsSettings = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        <span class="keywordflow">if</span> ( !isArgSameAsSettings ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad9fbf28fda3873fc511fa2000ccba86c">ProSHADE_internal_misc::addToDoubleVectorVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>, nextSym ); }</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160; </div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        nextSym.clear                                 ( );</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    }</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160; </div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( CSyms.size() ); it++ ) { <span class="keyword">delete</span>[] CSyms.at(it); }</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <span class="comment">//================================================ Release memory after FSC computation</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="keyword">delete</span>[] mapData;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="keyword">delete</span>[] origCoeffs;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keyword">delete</span>[] fCoeffs;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    fftw_destroy_plan                                 ( planForwardFourier );</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keyword">delete</span>[] binIndexing;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> binIt = 0; binIt &lt; static_cast&lt; size_t &gt; ( noBins ); binIt++ ) { <span class="keyword">delete</span>[] bindata[binIt]; }</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    <span class="keyword">delete</span>[] bindata;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="keyword">delete</span>[] binCounts;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    return ;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    </div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;}</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160; </div>
<div class="line"><a name="l01914"></a><span class="lineno"><a class="line" href="_pro_s_h_a_d_e__data_8cpp.html#ae2a2bd26e2e081130593c7783c54f293"> 1914</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#ae2a2bd26e2e081130593c7783c54f293">sortProSHADESymmetryByFSC</a> ( proshade_double* a, proshade_double* b)</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;{</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keywordflow">return</span> ( a[6] &gt; b[6] );</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160; </div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;}</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160; </div>
<div class="line"><a name="l01934"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abcf770f9177a4d2f1a94a3adb20bf790"> 1934</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abcf770f9177a4d2f1a94a3adb20bf790">ProSHADE_internal_data::ProSHADE_data::detectSymmetryFromAngleAxisSpace</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* axes, std::vector &lt; std::vector&lt; proshade_double &gt; &gt;* allCs )</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;{</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="comment">//================================================ Modify axis tolerance and matrix tolerance by sampling, if required by user</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;axisErrToleranceDefault )</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    {</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>                    = std::min ( std::max ( 0.01, ( 2.0 * M_PI ) / <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;maxShellBand ) ), 0.05 );</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    }</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    </div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <span class="comment">//================================================ Prepare FSC computation memory and variables</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    fftw_complex *mapData, *origCoeffs, *fCoeffs;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    fftw_plan planForwardFourier;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    proshade_double **bindata;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    proshade_signed *binIndexing, *binCounts, noBins;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    this-&gt;prepareFSCFourierMemory                     ( mapData, origCoeffs, fCoeffs, binIndexing, &amp;noBins, bindata, binCounts, &amp;planForwardFourier );</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    </div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <span class="comment">//================================================  If C was requested, we will do it immediately - this allows for a significant speed-up.</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;C&quot;</span> )</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    {</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        std::stringstream hlpSS;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;Starting detection of cyclic point group C&quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6dc170d9826bad9ce4a2c31a033f7f6a">requestedSymmetryFold</a>;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, hlpSS.str() );</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        </div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        <span class="comment">//============================================ Do simplified search only in the applicable data</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;        proshade_double symThres                      = 0.0;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        std::vector&lt; proshade_double* &gt; CSyms         = this-&gt;findRequestedCSymmetryFromAngleAxis ( settings, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6dc170d9826bad9ce4a2c31a033f7f6a">requestedSymmetryFold</a>, &amp;symThres );</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        </div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        <span class="comment">//============================================ Deal with the rotation function 0 1 0 PI issue</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        <span class="keywordtype">bool</span> possible010PIIssue                       = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; CSyms.size(); iter++ ) { <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2380a3710f7dbe672519c3adda30f7cd">ProSHADE_internal_maths::isAxisUnique</a> ( &amp;CSyms, 0.0, 1.0, 0.0, 2.0, 0.1 ) ) { possible010PIIssue = <span class="keyword">true</span>; } }</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        <span class="keywordflow">if</span> ( possible010PIIssue )</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        {</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;            proshade_double* addAxis                  = <span class="keyword">new</span> proshade_double[7];</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;            addAxis[0] = 2.0; addAxis[1] = 0.0; addAxis[2] = 1.0; addAxis[3] = 0.0; addAxis[4] = M_PI; addAxis[5] = -999.9; addAxis[6] = -1.0;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( &amp;CSyms, addAxis );</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;            <span class="keyword">delete</span>[] addAxis;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        }</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        </div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        <span class="comment">//============================================ Compute FSC for all possible axes</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> cIt = 0; cIt &lt; CSyms.size(); cIt++ ) { <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs ( CSyms.at(cIt)[5] ), rhs ( -999.9 ); <span class="keywordflow">if</span> ( ( CSyms.at(cIt)[5] &gt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a> ) || ( lhs.AlmostEquals ( rhs ) ) ) { this-&gt;<a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">computeFSC</a> ( settings, &amp;CSyms, cIt, mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts ); } }</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        </div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="comment">//============================================ Sort by FSC</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        std::sort                                     ( CSyms.begin(), CSyms.end(), <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#ae2a2bd26e2e081130593c7783c54f293">sortProSHADESymmetryByFSC</a> );</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        </div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        <span class="comment">//============================================ Save the best axis as the recommended one</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { <span class="keywordflow">if</span> ( CSyms.size() &gt; 0 ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSyms.at(0) ); } }</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        <span class="keywordflow">if</span> ( CSyms.size() &gt; 0 )</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        {</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;            <span class="keywordtype">bool</span> passedTests                          = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> cIt = 0; cIt &lt; CSyms.size(); cIt++ )</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;            {</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                <span class="keywordflow">if</span> ( CSyms.at(0)[6] &gt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> )</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                {</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                    settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>  ( <span class="stringliteral">&quot;C&quot;</span> );</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                    settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>      ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6dc170d9826bad9ce4a2c31a033f7f6a">requestedSymmetryFold</a> );</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                    </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSyms.at(0) );</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                    this-&gt;saveDetectedSymmetries      ( settings, &amp;CSyms, allCs );</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;                    </div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;                    passedTests                       = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                }</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;            }</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;            </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;            <span class="keywordflow">if</span> ( !passedTests )</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;            {</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>      ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>          ( 0 );</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;            }</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        }</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        {</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>          ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>              ( 0 );</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        }</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        </div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        <span class="comment">//============================================ Release memory after FSC computation</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        <span class="keyword">delete</span>[] mapData;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        <span class="keyword">delete</span>[] origCoeffs;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        <span class="keyword">delete</span>[] fCoeffs;</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;        fftw_destroy_plan                             ( planForwardFourier );</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        <span class="keyword">delete</span>[] binIndexing;</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> binIt = 0; binIt &lt; static_cast&lt; size_t &gt; ( noBins ); binIt++ ) { <span class="keyword">delete</span>[] bindata[binIt]; }</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        <span class="keyword">delete</span>[] bindata;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        <span class="keyword">delete</span>[] binCounts;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        </div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        <span class="comment">//============================================ Done</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;        return ;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    }</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    </div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting C symmetry detection.&quot;</span> );</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160; </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    std::vector&lt; proshade_double* &gt; CSyms             = getCyclicSymmetriesListFromAngleAxis ( settings );</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    </div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="comment">//============================================ Deal with the rotation function 0 1 0 PI issue</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="keywordtype">bool</span> possible010PIIssue                       = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; CSyms.size(); iter++ ) { <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2380a3710f7dbe672519c3adda30f7cd">ProSHADE_internal_maths::isAxisUnique</a> ( &amp;CSyms, 0.0, 1.0, 0.0, 2.0, 0.1 ) ) { possible010PIIssue = <span class="keyword">true</span>; } }</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="keywordflow">if</span> ( possible010PIIssue )</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    {</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        proshade_double* addAxis                  = <span class="keyword">new</span> proshade_double[7];</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;        addAxis[0] = 2.0; addAxis[1] = 0.0; addAxis[2] = 1.0; addAxis[3] = 0.0; addAxis[4] = M_PI; addAxis[5] = -999.9; addAxis[6] = -1.0;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( &amp;CSyms, addAxis );</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;        <span class="keyword">delete</span>[] addAxis;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    }</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    </div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> cIt = 0; cIt &lt; CSyms.size(); cIt++ ) { <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs ( CSyms.at(cIt)[5] ), rhs ( -999.9 ); <span class="keywordflow">if</span> ( lhs.AlmostEquals ( rhs ) ) { this-&gt;<a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">computeFSC</a> ( settings, &amp;CSyms, cIt, mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts ); } }</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    </div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;Detected &quot;</span> &lt;&lt; CSyms.size() &lt;&lt; <span class="stringliteral">&quot; C symmetries.&quot;</span>;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, ss.str() );</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    </div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="comment">//================================================ Sanity check - was the rotation function mapped properly?</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;sphereMappedRotFun.size() &lt; 1 )</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    {</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Rotation function was not converted into angle-axis space.&quot;</span>, <span class="stringliteral">&quot;ES00062&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;It seems that the convertRotationFunction() function was\n                    : not yet called. Therefore, there are no data to detect the\n                    : symmetry from; please call the convertRotationFunction()\n                    : function before the detectSymmetryFromAngleAxisSpace()\n                    : function.&quot;</span> );</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    }</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    </div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    <span class="comment">//================================================ Sanity check - was any symmetry requested?</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <span class="keywordflow">if</span> ( ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;C&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;D&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;T&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;O&quot;</span> ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> != <span class="stringliteral">&quot;I&quot;</span> ) )</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    {</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Requested symmetry supplied, but not recognised.&quot;</span>, <span class="stringliteral">&quot;ES00032&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;There are only the following value allowed for the\n                    : symmetry type request: \&quot;C\&quot;, \&quot;D\&quot;, \&quot;T\&quot;, \&quot;O\&quot; and \&quot;I\&quot;. Any\n                    : other value will result in this error.&quot;</span> );</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    }</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    </div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <span class="comment">//================================================ Are we doing general search?</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;&quot;</span> )</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    {</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        <span class="comment">//============================================ Run the symmetry detection functions for C, D, T, O and I symmetries</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;        std::vector&lt; proshade_double* &gt; DSyms         = this-&gt;getDihedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        std::vector&lt; proshade_double* &gt; ISyms;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;        std::vector&lt; proshade_double* &gt; OSyms         = this-&gt;getPredictedOctahedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        std::vector&lt; proshade_double* &gt; TSyms         = this-&gt;getPredictedTetrahedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;        </div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        <span class="comment">//============================================ Find which of the I groups is the correct one</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        proshade_double fscMax                        = 0.0;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;        <span class="keywordtype">size_t</span> fscMaxInd                              = 0;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;        std::vector &lt; std::vector&lt; proshade_double* &gt; &gt; ISymsHlp = this-&gt;getPredictedIcosahedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        </div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> icoIt = 0; icoIt &lt; ISymsHlp.size(); icoIt++ )</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        {</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;            <span class="comment">//======================================== Is this a complete icosahedron?</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;            <span class="keywordflow">if</span> ( ISymsHlp.at(icoIt).size() != 31 )    { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;            </div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;            <span class="comment">//======================================== Initialise decision vars</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;            proshade_double fscVal                    = 0.0;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;            proshade_double fscValAvg                 = 0.0;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;            </div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;            <span class="comment">//======================================== For each axis</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> aIt = 0; aIt &lt; ISymsHlp.at(icoIt).size(); aIt++ )</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;            {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                <span class="comment">//==================================== Match to CSyms</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;                proshade_signed matchedPos            = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( ISymsHlp.at(icoIt).at(aIt)[0] ), ISymsHlp.at(icoIt).at(aIt)[1], ISymsHlp.at(icoIt).at(aIt)[2], ISymsHlp.at(icoIt).at(aIt)[3], ISymsHlp.at(icoIt).at(aIt)[5], ISymsHlp.at(icoIt).at(aIt)[6], &amp;CSyms, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a> );</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                </div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                <span class="comment">//==================================== Compute FSC</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                fscVal                                = this-&gt;<a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">computeFSC</a> ( settings, &amp;CSyms, <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( matchedPos ), mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts );</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                ISymsHlp.at(fscMaxInd).at(aIt)[6]     = fscVal;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                fscValAvg                            += fscVal;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;            }</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;            </div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;            <span class="comment">//==================================== Get FSC average over all axes</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;            fscValAvg                            /= 31.0;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;            </div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;            <span class="comment">//======================================== Is this the best</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;            <span class="keywordflow">if</span> ( fscValAvg &gt; fscMax )</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;            {</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                fscMax                                = fscValAvg;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;                fscMaxInd                             = icoIt;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;            }</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        }</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;        </div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;        <span class="comment">//============================================ If C3 and C5 are found and have correct angle (must have if they are both in ISym)</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;        <span class="keywordflow">if</span> ( fscMax &gt;= ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> * 0.7 ) )</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;        {</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;            <span class="comment">//======================================== Add predicted axes to detected C axes list and also to the settings Icosahedral symmetry list</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign retIt = 0; retIt &lt; static_cast &lt; proshade_unsign &gt; ( ISymsHlp.at(fscMaxInd).size() ); retIt++ )</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;            {</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                <span class="comment">//==================================== Add the correct index to the settings object</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;                proshade_signed matchedPos            = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( ISymsHlp.at(fscMaxInd).at(retIt)[0] ), ISymsHlp.at(fscMaxInd).at(retIt)[1], ISymsHlp.at(fscMaxInd).at(retIt)[2], ISymsHlp.at(fscMaxInd).at(retIt)[3], ISymsHlp.at(fscMaxInd).at(retIt)[5], ISymsHlp.at(fscMaxInd).at(retIt)[6], &amp;CSyms, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a> );</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>, <span class="keyword">static_cast &lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( matchedPos ) );</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                </div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                <span class="comment">//==================================== Set ISyms for saving</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( &amp;ISyms, ISymsHlp.at(fscMaxInd).at(retIt) );</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;            }</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        }</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        </div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        <span class="comment">//============================================ Decide on recommended symmetry</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;        this-&gt;saveRecommendedSymmetry                 ( settings, &amp;CSyms, &amp;DSyms, &amp;TSyms, &amp;OSyms, &amp;ISyms, axes, mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts );</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    }</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    </div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;D&quot;</span> )</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    {</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        <span class="comment">//============================================ Run only the D symmetry detection and search for requested fold</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;        std::vector&lt; proshade_double* &gt; DSyms         = this-&gt;getDihedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;        this-&gt;saveRequestedSymmetryD                  ( settings, &amp;DSyms, axes, mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts );</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    }</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    </div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;T&quot;</span> )</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    {</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;        <span class="comment">//============================================ Run only the T symmetry detection</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        std::vector&lt; proshade_double* &gt; TSyms         = this-&gt;getPredictedTetrahedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        </div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        <span class="keywordflow">if</span> ( TSyms.size() == 7 )</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;        {</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;            <span class="comment">//======================================== Initialise decision vars</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;            proshade_double fscVal                    = 0.0;</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;            proshade_double fscValAvg                 = 0.0;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;            </div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;            <span class="comment">//======================================== Check if axes have high enough FSC and peak height</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> tIt = 0; tIt &lt; 7; tIt++ ) { <span class="keywordflow">if</span> ( CSyms.at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at(tIt))[5] &gt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a> ) { fscVal = this-&gt;<a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">computeFSC</a> ( settings, &amp;CSyms, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at(tIt), mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts ); fscValAvg += fscVal; } }</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;            fscValAvg                                /= 7.0;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;            </div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;            <span class="comment">//======================================== If C3 and C5 are found and have correct angle (must have if they are both in ISym)</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;            <span class="keywordflow">if</span> ( fscValAvg &gt;= ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> * 0.8 ) )</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;            {</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                <span class="comment">//==================================== The decision is T</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>      ( <span class="stringliteral">&quot;T&quot;</span> );</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>          ( 0 );</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.size() ); it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSyms.at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at(it)) ); }</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSyms.at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at(it)) ); } }</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;            }</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        }</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    }</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    </div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;O&quot;</span> )</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    {</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;        <span class="comment">//============================================ Run only the O symmetry detection</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;        std::vector&lt; proshade_double* &gt; OSyms         = this-&gt;getPredictedOctahedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;        </div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;        <span class="keywordflow">if</span> ( OSyms.size() == 13 )</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;        {</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;            <span class="comment">//======================================== Initialise decision vars</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;            proshade_double fscVal                    = 0.0;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;            proshade_double fscValAvg                 = 0.0;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;            </div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;            <span class="comment">//======================================== Check if at least one C5 and one C3 with the correct angle have high FSC and peak height</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> oIt = 0; oIt &lt; 13; oIt++ ) { <span class="keywordflow">if</span> ( CSyms.at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at(oIt))[5] &gt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a> ) { fscVal = this-&gt;<a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">computeFSC</a> ( settings, &amp;CSyms, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at(oIt), mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts ); fscValAvg += fscVal; } }</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;            fscValAvg                                /= 13.0;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;            </div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;            <span class="comment">//======================================== If C3 and C5 are found and have correct angle (must have if they are both in ISym)</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;            <span class="keywordflow">if</span> ( fscValAvg &gt;= ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> * 0.8 ) )</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;            {</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                <span class="comment">//==================================== The decision is O</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>      ( <span class="stringliteral">&quot;O&quot;</span> );</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>          ( 0 );</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.size() ); it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSyms.at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at(it)) ); }</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSyms.at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at(it)) ); } }</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;            }</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        }</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    }</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    </div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">requestedSymmetryType</a> == <span class="stringliteral">&quot;I&quot;</span> )</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    {</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;        <span class="comment">//============================================ Find which of the I groups is the correct one</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        proshade_double fscMax                        = 0.0;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;        <span class="keywordtype">size_t</span> fscMaxInd                              = 0;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        std::vector &lt; std::vector&lt; proshade_double* &gt; &gt; ISymsHlp = this-&gt;getPredictedIcosahedralSymmetriesList ( settings, &amp;CSyms );</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;        std::vector&lt; proshade_double* &gt; ISyms;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        </div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> icoIt = 0; icoIt &lt; ISymsHlp.size(); icoIt++ )</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;        {</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;            <span class="comment">//======================================== Is this a complete icosahedron?</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;            <span class="keywordflow">if</span> ( ISymsHlp.at(icoIt).size() != 31 )    { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;            </div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;            <span class="comment">//======================================== Initialise decision vars</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            proshade_double fscVal                    = 0.0;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;            proshade_double fscValAvg                 = 0.0;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;            </div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;            <span class="comment">//======================================== For each axis</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> aIt = 0; aIt &lt; ISymsHlp.at(icoIt).size(); aIt++ )</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;            {</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                <span class="comment">//==================================== Match to CSyms</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;                proshade_signed matchedPos            = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( ISymsHlp.at(icoIt).at(aIt)[0] ), ISymsHlp.at(icoIt).at(aIt)[1], ISymsHlp.at(icoIt).at(aIt)[2], ISymsHlp.at(icoIt).at(aIt)[3], ISymsHlp.at(icoIt).at(aIt)[5], ISymsHlp.at(icoIt).at(aIt)[6], &amp;CSyms, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a> );</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                </div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                <span class="comment">//==================================== Compute FSC</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                fscVal                                = this-&gt;<a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">computeFSC</a> ( settings, &amp;CSyms, <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( matchedPos ), mapData, fCoeffs, origCoeffs, &amp;planForwardFourier, noBins, binIndexing, bindata, binCounts );</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                ISymsHlp.at(fscMaxInd).at(aIt)[6]     = fscVal;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                fscValAvg                            += fscVal;</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            }</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;            </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;            <span class="comment">//==================================== Get FSC average over all axes</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            fscValAvg                            /= 31.0;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;            </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;            <span class="comment">//======================================== Is this the best</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;            <span class="keywordflow">if</span> ( fscValAvg &gt; fscMax )</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;            {</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                fscMax                                = fscValAvg;</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                fscMaxInd                             = icoIt;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;            }</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;        }</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        </div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        <span class="comment">//============================================ If C3 and C5 are found and have correct angle (must have if they are both in ISym)</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        <span class="keywordflow">if</span> ( fscMax &gt;= ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> * 0.7 ) )</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        {</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;            <span class="comment">//======================================== Add predicted axes to detected C axes list and also to the settings Icosahedral symmetry list</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign retIt = 0; retIt &lt; static_cast &lt; proshade_unsign &gt; ( ISymsHlp.at(fscMaxInd).size() ); retIt++ )</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;            {</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                <span class="comment">//==================================== Add the correct index to the settings object</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                proshade_signed matchedPos            = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( ISymsHlp.at(fscMaxInd).at(retIt)[0] ), ISymsHlp.at(fscMaxInd).at(retIt)[1], ISymsHlp.at(fscMaxInd).at(retIt)[2], ISymsHlp.at(fscMaxInd).at(retIt)[3], ISymsHlp.at(fscMaxInd).at(retIt)[5], ISymsHlp.at(fscMaxInd).at(retIt)[6], &amp;CSyms, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a> );</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>, <span class="keyword">static_cast &lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( matchedPos ) );</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                </div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                <span class="comment">//==================================== Set ISyms for saving</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( &amp;ISyms, ISymsHlp.at(fscMaxInd).at(retIt) );</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;            }</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        }</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        </div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        <span class="comment">//============================================ Delete all memory from ISymsHlp</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> gIt = 0; gIt &lt; ISymsHlp.size(); gIt++ ) { <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> aIt = 0; aIt &lt; ISymsHlp.at(gIt).size(); aIt++ ) { <span class="keyword">delete</span>[] ISymsHlp.at(gIt).at(aIt); } }</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        </div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;        <span class="comment">//============================================ If C3 and C5 are found and have correct angle (must have if they are both in ISym)</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;        <span class="keywordflow">if</span> ( fscMax &gt;= ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> * 0.7 ) )</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        {</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;            <span class="comment">//======================================== The decision is I</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>          ( <span class="stringliteral">&quot;I&quot;</span> );</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>              ( 0 );</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> it = 0; it &lt; ISyms.size(); it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, ISyms.at(it) ); }</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;            <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSyms.at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.at(it)) ); } }</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        }</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    }</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    </div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="comment">//================================================ Save C symmetries to argument and if different from settings, to the settings as well</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    this-&gt;saveDetectedSymmetries                      ( settings, &amp;CSyms, allCs );</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    </div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="comment">//================================================ Release memory after FSC computation</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <span class="keyword">delete</span>[] mapData;</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    <span class="keyword">delete</span>[] origCoeffs;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    <span class="keyword">delete</span>[] fCoeffs;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    fftw_destroy_plan                                 ( planForwardFourier );</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    <span class="keyword">delete</span>[] binIndexing;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> binIt = 0; binIt &lt; static_cast&lt; size_t &gt; ( noBins ); binIt++ ) { <span class="keyword">delete</span>[] bindata[binIt]; }</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    <span class="keyword">delete</span>[] bindata;</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    <span class="keyword">delete</span>[] binCounts;</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    </div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    return ;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    </div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;}</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160; </div>
<div class="line"><a name="l02286"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0b0608e80f20087b24cc9498767f0894"> 2286</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0b0608e80f20087b24cc9498767f0894">ProSHADE_internal_data::ProSHADE_data::saveDetectedSymmetries</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* CSyms, std::vector &lt; std::vector&lt; proshade_double &gt; &gt;* allCs )</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;{</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    <span class="keywordtype">bool</span> isArgSameAsSettings                          = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    </div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    <span class="comment">//================================================ For each detected point group</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( CSyms-&gt;size() ); cIt++ )</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    {</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        <span class="comment">//============================================ Create vector to replace the pointer</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        std::vector&lt; proshade_double &gt; nextSym;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms-&gt;at(cIt)[0] );</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms-&gt;at(cIt)[1] );</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms-&gt;at(cIt)[2] );</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms-&gt;at(cIt)[3] );</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms-&gt;at(cIt)[4] );</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms-&gt;at(cIt)[5] );</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;nextSym, CSyms-&gt;at(cIt)[6] );</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad9fbf28fda3873fc511fa2000ccba86c">ProSHADE_internal_misc::addToDoubleVectorVector</a> ( allCs, nextSym );</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160; </div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        <span class="comment">//============================================ Copy the vector to output variable and if different, then also to settings object</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        <span class="keywordflow">if</span> ( ( cIt == 0 ) &amp;&amp; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.size() == 0 ) ) { isArgSameAsSettings = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        <span class="keywordflow">if</span> ( !isArgSameAsSettings ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad9fbf28fda3873fc511fa2000ccba86c">ProSHADE_internal_misc::addToDoubleVectorVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>, nextSym ); }</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160; </div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        <span class="comment">//============================================ Release memory</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;        nextSym.clear                                 ( );</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;        <span class="keyword">delete</span>[] CSyms-&gt;at(cIt);</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    }</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    </div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    return ;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    </div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;}</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160; </div>
<div class="line"><a name="l02332"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a671ebb0985408bff451ec359b4df79b9"> 2332</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a671ebb0985408bff451ec359b4df79b9">ProSHADE_internal_data::ProSHADE_data::findTopGroupSmooth</a> ( std::vector&lt; proshade_double* &gt;* CSym, <span class="keywordtype">size_t</span> peakPos, proshade_double step, proshade_double sigma, proshade_signed windowSize )</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;{</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    proshade_double threshold                         = 0.0;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    proshade_signed totSize                           = <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( ( 1.0 / step ) + 1 );</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    std::vector&lt; std::pair &lt; proshade_double, proshade_unsign &gt; &gt; vals;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    std::vector&lt; proshade_double &gt; hist               ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( totSize ), 0.0 );</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    proshade_unsign histPos                           = 0;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    </div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    <span class="comment">//================================================ Make sure window size is odd</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    <span class="keywordflow">if</span> ( windowSize % 2 == 0 )                        { windowSize += 1; }</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    </div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    <span class="comment">//================================================ Get vector of pairs of peak heights and indices in CSym array</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign symIt = 0; symIt &lt; static_cast&lt;proshade_unsign&gt; ( CSym-&gt;size() ); symIt++ ) { vals.emplace_back ( std::pair &lt; proshade_double, proshade_unsign &gt; ( CSym-&gt;at(symIt)[peakPos], symIt ) ); }</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    </div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    <span class="comment">//================================================ Convert all found heights to histogram from 0.0 to 1.0 by step</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    <span class="keywordflow">for</span> ( proshade_double it = 0.0; it &lt;= 1.0; it = it + step )</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    {</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign symIt = 0; symIt &lt; static_cast&lt;proshade_unsign&gt; ( vals.size() ); symIt++ )</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;        {</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            <span class="comment">//======================================== Is this height in the range?</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            <span class="keywordflow">if</span> ( ( vals.at(symIt).first &gt; it ) &amp;&amp; ( vals.at(symIt).first &lt;= ( it + step ) ) ) { hist.at(histPos) += 1.0; }</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;        }</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;        </div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;        <span class="comment">//============================================ Update counter and continue</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;        histPos                                      += 1;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    }</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    </div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    <span class="comment">//================================================ Smoothen the distribution</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    std::vector&lt; proshade_double &gt; smoothened         = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#aa2da3e6dc4d41b8f09b47982fe74b3ea">ProSHADE_internal_maths::smoothen1D</a> ( step, windowSize, sigma, hist );</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    </div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    <span class="comment">//================================================ Find peaks in smoothened data</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    std::vector&lt; proshade_signed &gt; peaks              = <a class="code" href="namespace_pro_s_h_a_d_e__internal__peak_search.html#a3728cebdcc0cad1dff8c83dabaeed31c">ProSHADE_internal_peakSearch::findPeaks1D</a> ( smoothened );</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    </div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    <span class="comment">//================================================ Take best peaks surroundings and produce a new set of &quot;high&quot; axes</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    proshade_signed bestHistPos;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    <span class="keywordflow">if</span> ( peaks.size() &gt; 0 ) { bestHistPos = peaks.at(peaks.size()-1) + ( ( windowSize - 1 ) / 2 ); }</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    <span class="keywordflow">else</span>                    { bestHistPos = 0.0; }</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    </div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;    threshold                                         = ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( bestHistPos ) * step ) - ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( windowSize ) * step );</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    </div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    <span class="keywordflow">return</span>                                            ( threshold );</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    </div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;}</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160; </div>
<div class="line"><a name="l02388"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51b1eb3cb274c1c68e85cf3cca0c25b7"> 2388</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51b1eb3cb274c1c68e85cf3cca0c25b7">ProSHADE_internal_data::ProSHADE_data::prepareFSCFourierMemory</a> ( fftw_complex*&amp; mapData, fftw_complex*&amp; origCoeffs, fftw_complex*&amp; fCoeffs, proshade_signed*&amp; binIndexing, proshade_signed* noBins, proshade_double**&amp; bindata, proshade_signed*&amp; binCounts, fftw_plan* planForwardFourier )</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;{</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    <span class="comment">//================================================ Decide number of bins and allocate which reflection belongs to which bin</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#aa2702798938d50ec2a55e46cbc31333e">ProSHADE_internal_maths::binReciprocalSpaceReflections</a> ( this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, noBins, binIndexing );</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    </div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    <span class="comment">//================================================ Allocate memory for FSC sums</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    bindata                                           = <span class="keyword">new</span> proshade_double*[*noBins];</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    binCounts                                         = <span class="keyword">new</span> proshade_signed [*noBins];</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    </div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    <span class="comment">//================================================ Allcate memory for bin sumation</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> binIt = 0; binIt &lt; static_cast&lt; size_t &gt; ( *noBins ); binIt++ )</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    {</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        bindata[binIt]                                = <span class="keyword">new</span> proshade_double[12];</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( bindata[binIt], __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    }</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    </div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    <span class="comment">//================================================ Allocate memory for Fourier transform imputs and outputs</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    mapData                                           = <span class="keyword">new</span> fftw_complex [this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    origCoeffs                                        = <span class="keyword">new</span> fftw_complex [this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    fCoeffs                                           = <span class="keyword">new</span> fftw_complex [this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    </div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    <span class="comment">//================================================ Check memory allocation</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( mapData,       __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( origCoeffs,    __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( fCoeffs,       __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( bindata,       __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( binCounts,     __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    </div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    <span class="comment">//================================================ Prepare memory for Fourier transform</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;   *planForwardFourier                                = fftw_plan_dft_3d ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;xDimIndices ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ), mapData, fCoeffs, FFTW_FORWARD,  FFTW_ESTIMATE );</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    </div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <span class="comment">//================================================ Compute Fourier transform of the original map</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; static_cast&lt; size_t &gt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ ) { mapData[iter][0] = this-&gt;internalMap[iter]; mapData[iter][1] = 0.0; }</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    fftw_execute                                      ( *planForwardFourier );</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; static_cast&lt; size_t &gt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ ) { origCoeffs[iter][0] = fCoeffs[iter][0]; origCoeffs[iter][1] = fCoeffs[iter][1]; }</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    </div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    return ;</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    </div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;}</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160; </div>
<div class="line"><a name="l02456"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a60643383ab239888adeee6e757876c80"> 2456</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a60643383ab239888adeee6e757876c80">ProSHADE_internal_data::ProSHADE_data::computeFSC</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* CSym, <span class="keywordtype">size_t</span> symIndex, fftw_complex* mapData, fftw_complex* fCoeffs, fftw_complex* origCoeffs, fftw_plan* planForwardFourier, proshade_signed noBins, proshade_signed *binIndexing, proshade_double**&amp; bindata, proshade_signed*&amp; binCounts )</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;{</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    <span class="keywordflow">if</span> ( symIndex &gt;= CSym-&gt;size() )</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    {</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;The supplied symmetry axes vector does not contain element number &quot;</span> &lt;&lt; symIndex &lt;&lt; <span class="stringliteral">&quot;. Returning FSC 0.0.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;        <span class="keywordflow">return</span>                                        ( -2.0 );</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    }</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    </div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    <span class="comment">//================================================ Ignore if already computed</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSym-&gt;at(symIndex)[6] ), rhs1 ( -1.0 );</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    <span class="keywordflow">if</span> ( !lhs1.AlmostEquals ( rhs1 ) ) { <span class="keywordflow">return</span> ( CSym-&gt;at(symIndex)[6] ); }</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    </div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    std::stringstream ss2;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    ss2 &lt;&lt; <span class="stringliteral">&quot;Computing FSC for symmetry C&quot;</span> &lt;&lt; CSym-&gt;at(symIndex)[0] &lt;&lt; <span class="stringliteral">&quot; ( &quot;</span> &lt;&lt; CSym-&gt;at(symIndex)[1] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; CSym-&gt;at(symIndex)[2] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; CSym-&gt;at(symIndex)[3] &lt;&lt; <span class="stringliteral">&quot; ) with peak height &quot;</span> &lt;&lt; CSym-&gt;at(symIndex)[5];</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, ss2.str() );</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    </div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    proshade_double *rotMap;</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    </div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    <span class="comment">//================================================ For each rotation along the axis</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    proshade_double averageFSC                        = 0.0;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    <span class="keywordflow">for</span> ( proshade_double rotIter = 1.0; rotIter &lt; CSym-&gt;at(symIndex)[0]; rotIter += 1.0 )</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    {</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;        <span class="comment">//============================================ Get rotated map by the smallest fold angle along the symmetry axis</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        this-&gt;rotateMapRealSpace                      ( CSym-&gt;at(symIndex)[1], CSym-&gt;at(symIndex)[2], CSym-&gt;at(symIndex)[3], ( ( 2.0 * M_PI ) / CSym-&gt;at(symIndex)[0] ) * rotIter, rotMap );</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;        </div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;        <span class="comment">//============================================ Get Fourier for the rotated map</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; static_cast&lt; size_t &gt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ ) { mapData[iter][0] = rotMap[iter]; mapData[iter][1] = 0.0; }</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;        fftw_execute                                  ( *planForwardFourier );</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;        </div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;        <span class="comment">//============================================ Clean FSC computation memory</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> binIt = 0; binIt &lt; static_cast&lt; size_t &gt; ( noBins ); binIt++ ) { <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> valIt = 0; valIt &lt; 12; valIt++ ) { bindata[binIt][valIt] = 0.0; } }</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> binIt = 0; binIt &lt; static_cast&lt; size_t &gt; ( noBins ); binIt++ ) { binCounts[binIt] = 0; }</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        </div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        <span class="comment">//============================================ Compute FSC</span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;        averageFSC                                   += <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">ProSHADE_internal_maths::computeFSC</a> ( origCoeffs, fCoeffs, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, noBins, binIndexing, bindata, binCounts );</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        </div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;        <span class="comment">//============================================ Release memory</span></div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;        <span class="keyword">delete</span>[] rotMap;</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    }</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;    </div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;    <span class="comment">//================================================ Convert sum to average</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    averageFSC                                       /= ( CSym-&gt;at(symIndex)[0] - 1.0 );</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    </div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    <span class="comment">//================================================ Save result to the axis</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    CSym-&gt;at(symIndex)[6]                             = averageFSC;</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    </div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    std::stringstream ss3;</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    ss3 &lt;&lt; <span class="stringliteral">&quot;FSC value is &quot;</span> &lt;&lt; averageFSC &lt;&lt; <span class="stringliteral">&quot; .&quot;</span>;</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 5, ss3.str() );</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    </div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    <span class="keywordflow">return</span>                                            ( averageFSC );</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    </div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;}</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160; </div>
<div class="line"><a name="l02541"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2b60ba4e2dd8ef4918b6f0ea5316a009"> 2541</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a60643383ab239888adeee6e757876c80">ProSHADE_internal_data::ProSHADE_data::computeFSC</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, proshade_double* sym, fftw_complex* mapData, fftw_complex* fCoeffs, fftw_complex* origCoeffs, fftw_plan* planForwardFourier, proshade_signed noBins, proshade_signed *binIndexing, proshade_double**&amp; bindata, proshade_signed*&amp; binCounts )</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;{</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    <span class="comment">//================================================ Ignore if already computed</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( sym[6] ), rhs1 ( -1.0 );</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    <span class="keywordflow">if</span> ( !lhs1.AlmostEquals ( rhs1 ) ) { <span class="keywordflow">return</span> ( sym[6] ); }</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    </div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    std::stringstream ss2;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    ss2 &lt;&lt; <span class="stringliteral">&quot;Computing FSC for symmetry C&quot;</span> &lt;&lt; sym[0] &lt;&lt; <span class="stringliteral">&quot; ( &quot;</span> &lt;&lt; sym[1] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; sym[2] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; sym[3] &lt;&lt; <span class="stringliteral">&quot; ) with peak height &quot;</span> &lt;&lt; sym[5];</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, ss2.str() );</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;    </div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    proshade_double *rotMap;</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    </div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    <span class="comment">//================================================ For each rotation along the axis</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    proshade_double averageFSC                        = 0.0;</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    <span class="keywordflow">for</span> ( proshade_double rotIter = 1.0; rotIter &lt; sym[0]; rotIter += 1.0 )</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    {</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;        <span class="comment">//============================================ Get rotated map by the smallest fold angle along the symmetry axis</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;        this-&gt;rotateMapRealSpace                      ( sym[1], sym[2], sym[3], ( ( 2.0 * M_PI ) / sym[0] ) * rotIter, rotMap );</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        </div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;        <span class="comment">//============================================ Get Fourier for the rotated map</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iter = 0; iter &lt; static_cast&lt; size_t &gt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ ) { mapData[iter][0] = rotMap[iter]; mapData[iter][1] = 0.0; }</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        fftw_execute                                  ( *planForwardFourier );</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;        </div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        <span class="comment">//============================================ Clean FSC computation memory</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> binIt = 0; binIt &lt; static_cast&lt; size_t &gt; ( noBins ); binIt++ ) { <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> valIt = 0; valIt &lt; 12; valIt++ ) { bindata[binIt][valIt] = 0.0; } }</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> binIt = 0; binIt &lt; static_cast&lt; size_t &gt; ( noBins ); binIt++ ) { binCounts[binIt] = 0; }</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;        </div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;        <span class="comment">//============================================ Compute FSC</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        averageFSC                                   += <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">ProSHADE_internal_maths::computeFSC</a> ( origCoeffs, fCoeffs, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices, noBins, binIndexing, bindata, binCounts );</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;        </div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;        <span class="comment">//============================================ Release memory</span></div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;        <span class="keyword">delete</span>[] rotMap;</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    }</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    </div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    <span class="comment">//================================================ Convert sum to average</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    averageFSC                                       /= ( sym[0] - 1.0 );</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    </div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    <span class="comment">//================================================ Save result to the axis</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    sym[6]                                            = averageFSC;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    </div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    std::stringstream ss3;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    ss3 &lt;&lt; <span class="stringliteral">&quot;FSC value is &quot;</span> &lt;&lt; averageFSC &lt;&lt; <span class="stringliteral">&quot; .&quot;</span>;</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 5, ss3.str() );</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    </div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    <span class="keywordflow">return</span>                                            ( averageFSC );</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    </div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;}</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160; </div>
<div class="line"><a name="l02627"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a262b3b0e1129d4d3a5830a8982395f01"> 2627</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a262b3b0e1129d4d3a5830a8982395f01">ProSHADE_internal_data::ProSHADE_data::saveRecommendedSymmetry</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* CSym, std::vector&lt; proshade_double* &gt;* DSym, std::vector&lt; proshade_double* &gt;* TSym, std::vector&lt; proshade_double* &gt;* OSym, std::vector&lt; proshade_double* &gt;* ISym, std::vector&lt; proshade_double* &gt;* axes, fftw_complex* mapData, fftw_complex* origCoeffs, fftw_complex* fCoeffs, fftw_plan* planForwardFourier, proshade_signed noBins, proshade_signed* binIndexing, proshade_double** bindata, proshade_signed* binCounts )</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;{</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting recommended symmetry decision procedure.&quot;</span> );</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    </div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    <span class="comment">//================================================ If no C symmetries, nothing to save...</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    <span class="keywordflow">if</span> ( CSym-&gt;size() == 0 )</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    {</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;    }</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    </div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    <span class="comment">//================================================ Find the top group minimum threshold using smoothened histogram</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    proshade_double step                              = 0.01;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    proshade_double sigma                             = 0.03;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    proshade_signed windowSize                        = 9;</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    proshade_double bestHistPeakStart                 = this-&gt;findTopGroupSmooth ( CSym, 5, step, sigma, windowSize );</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    <span class="keywordflow">if</span> ( bestHistPeakStart &gt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a> ) { bestHistPeakStart = settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a>; }</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    </div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    proshade_unsign noPassed = 0; <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> cIt = 0; cIt &lt; CSym-&gt;size(); cIt++ ) { <span class="keywordflow">if</span> ( CSym-&gt;at(cIt)[5] &gt; bestHistPeakStart ) { noPassed += 1; } }</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;Smoothening has resolved in &quot;</span> &lt;&lt; noPassed &lt;&lt; <span class="stringliteral">&quot; C symmetries.&quot;</span>;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, ss.str() );</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Starting FSC computation to confirm the C symmetries existence.&quot;</span> );</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160; </div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    <span class="comment">//================================================ Decide if I is the answer</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    <span class="keywordtype">bool</span> alreadyDecided                               = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    <span class="keywordflow">if</span> ( ISym-&gt;size() == 31 )</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    {</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;        <span class="comment">//============================================ Initialise decision vars</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;        proshade_double fscVal                        = 0.0;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;        proshade_double fscValAvg                     = 0.0;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        </div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;        <span class="comment">//============================================ Check if at least one C5 and one C3 with the correct angle have high FSC and peak height</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> iIt = 0; iIt &lt; 31; iIt++ ) { <span class="keywordflow">if</span> ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.at(iIt))[5] &gt; bestHistPeakStart ) { fscVal = this-&gt;<a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">computeFSC</a> ( settings, CSym, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.at(iIt), mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts ); fscValAvg += fscVal; } }</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        fscValAvg                                    /= 31.0;</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;        </div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;        <span class="comment">//============================================ If C3 and C5 are found and have correct angle (must have if they are both in ISym)</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;        <span class="keywordflow">if</span> ( fscValAvg &gt;= ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> * 0.85 ) )</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;        {</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;            <span class="comment">//======================================== The decision is I</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>          ( <span class="stringliteral">&quot;I&quot;</span> );</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>              ( 0 );</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.size() ); it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.at(it)) ); }</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;            <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>.at(it)) ); } }</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;            </div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;            <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;            alreadyDecided                            = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;        }</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    }</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    </div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    <span class="comment">//================================================ Decide if O is the answer</span></div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    <span class="keywordflow">if</span> ( ( OSym-&gt;size() == 13 ) &amp;&amp; !alreadyDecided )</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;    {</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;        <span class="comment">//============================================ Initialise decision vars</span></div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;        proshade_double fscVal                        = 0.0;</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;        proshade_double fscValAvg                     = 0.0;</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;        </div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;        <span class="comment">//============================================ Check if at least one C5 and one C3 with the correct angle have high FSC and peak height</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> oIt = 0; oIt &lt; 13; oIt++ ) { <span class="keywordflow">if</span> ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at(oIt))[5] &gt; bestHistPeakStart ) { fscVal = this-&gt;<a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">computeFSC</a> ( settings, CSym, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at(oIt), mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts ); fscValAvg += fscVal; } }</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;        fscValAvg                                    /= 13.0;</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;        </div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;        <span class="comment">//============================================ If C3 and C5 are found and have correct angle (must have if they are both in ISym)</span></div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;        <span class="keywordflow">if</span> ( fscValAvg &gt;= ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> * 0.85 ) )</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;        {</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;            <span class="comment">//======================================== The decision is O</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>          ( <span class="stringliteral">&quot;O&quot;</span> );</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>              ( 0 );</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.size() ); it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at(it)) ); }</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;            <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>.at(it)) ); } }</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;            </div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;            <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;            alreadyDecided                            = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;        }</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    }</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    </div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    <span class="comment">//================================================ Decide if T is the answer</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    <span class="keywordflow">if</span> ( ( TSym-&gt;size() == 7 ) &amp;&amp; !alreadyDecided )</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    {</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;        <span class="comment">//============================================ Initialise decision vars</span></div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;        proshade_double fscVal                        = 0.0;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;        proshade_double fscValAvg                     = 0.0;</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        </div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;        <span class="comment">//============================================ Check if at least one C5 and one C3 with the correct angle have high FSC and peak height</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> tIt = 0; tIt &lt; 7; tIt++ ) { <span class="keywordflow">if</span> ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at(tIt))[5] &gt; bestHistPeakStart ) { fscVal = this-&gt;<a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">computeFSC</a> ( settings, CSym, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at(tIt), mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts ); fscValAvg += fscVal; } }</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        fscValAvg                                    /= 7.0;</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;        </div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;        <span class="comment">//============================================ If C3 and C5 are found and have correct angle (must have if they are both in ISym)</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;        <span class="keywordflow">if</span> ( fscValAvg &gt;= ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> * 0.85 ) )</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;        {</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;            <span class="comment">//======================================== The decision is T</span></div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>          ( <span class="stringliteral">&quot;T&quot;</span> );</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>              ( 0 );</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.size() ); it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at(it)) ); }</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;            <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.size() ); it++ ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>.at(it)) ); } }</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;            </div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;            <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;            alreadyDecided                            = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;        }</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;    }</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160; </div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    <span class="comment">//================================================ Decide if D is the answer</span></div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    <span class="keywordflow">if</span> ( ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.size() &gt; 0 ) &amp;&amp; ( DSym-&gt;size() &gt; 0 ) &amp;&amp; !alreadyDecided )</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;    {</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;        <span class="comment">//============================================ Initialise decision vars</span></div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;        proshade_signed bestD                         = -1;</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;        proshade_unsign bestFold                      = 0;</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;        </div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;        <span class="comment">//============================================ Find FSCs</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> dIt = 0; dIt &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.size(); dIt++ )</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;        {</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;            <span class="comment">//======================================== Do not consider more than top 20, takes time and is unlikely to produce anything...</span></div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;            <span class="keywordflow">if</span> ( dIt &gt; 20 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;            </div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;            <span class="comment">//======================================== Check the peak heights</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs999a ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[5] ), lhs999b ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[5] ), rhs999 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( -999.9 ) );</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;            <span class="keywordflow">if</span> ( ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[5] &lt; bestHistPeakStart ) &amp;&amp; !( lhs999a.AlmostEquals( rhs999 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;            <span class="keywordflow">if</span> ( ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[5] &lt; bestHistPeakStart ) &amp;&amp; !( lhs999b.AlmostEquals( rhs999 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;            </div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;            <span class="comment">//======================================== Find FSCs</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;            this-&gt;<a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">computeFSC</a>                          ( settings, CSym, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0), mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts );</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;            this-&gt;<a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">computeFSC</a>                          ( settings, CSym, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1), mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts );</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;        }</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;        </div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;        <span class="comment">//============================================ Find FSC top group threshold</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;        proshade_double bestHistFSCStart              = this-&gt;findTopGroupSmooth ( CSym, 6, step, sigma, windowSize );</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        </div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;        <span class="comment">//============================================ Check if both C symmetries are reliable</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> dIt = 0; dIt &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.size(); dIt++ )</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;        {</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;            <span class="comment">//======================================== Check the peak heights</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs999a2 ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[5] ), lhs999b2 ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[5] ), rhs999 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( -999.9 ) );</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;            <span class="keywordflow">if</span> ( ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[5] &lt; bestHistPeakStart ) &amp;&amp; !( lhs999a2.AlmostEquals( rhs999 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;            <span class="keywordflow">if</span> ( ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[5] &lt; bestHistPeakStart ) &amp;&amp; !( lhs999b2.AlmostEquals( rhs999 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;            </div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;            <span class="comment">//======================================== Does this improve the best fold?</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;            <span class="keywordflow">if</span> ( ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[0] &gt; <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( bestFold ) ) || ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[0] &gt; <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( bestFold ) ) )</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;            {</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                <span class="comment">//==================================== Check the FSC vals</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;                <span class="keywordflow">if</span> ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[6] &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                <span class="keywordflow">if</span> ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[6] &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                <span class="keywordflow">if</span> ( std::max ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[6], CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[6] ) &lt; bestHistFSCStart ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;                </div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                <span class="comment">//==================================== All good!</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                bestFold                              = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( std::max ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(0))[0], CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at(dIt).at(1))[0] ) );</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;                bestD                                 = <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( dIt );</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;            }</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;        }</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;        </div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        <span class="comment">//============================================ Anything?</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;        <span class="keywordflow">if</span> ( bestD != -1 )</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        {</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;            <span class="comment">//======================================== The decision is D</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>          ( <span class="stringliteral">&quot;D&quot;</span> );</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>              ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( std::max ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestD ) ).at(0))[0], CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestD ) ).at(1))[0] ) ) );</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestD ) ).at(0)) );</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestD ) ).at(1)) );</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;            <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 )</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;            {</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a>         ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestD ) ).at(0)) );</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a>         ( CSym-&gt;at(settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>.at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestD ) ).at(1)) );</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;            }</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;            </div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;            <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;            alreadyDecided                            = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        }</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;    }</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    </div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;    <span class="comment">//================================================ Decide if C is the answer</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;    <span class="keywordflow">if</span> ( ( CSym-&gt;size() &gt; 0 ) &amp;&amp; !alreadyDecided )</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;    {</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;        <span class="comment">//============================================ Initialise decision vars</span></div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;        proshade_signed bestC                         = -1;</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;        proshade_unsign bestFold                      = 0;</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;        </div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;        <span class="comment">//============================================ Find FSCs for C syms</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> cIt = 0; cIt &lt; CSym-&gt;size(); cIt++ )</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;        {</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;            <span class="comment">//======================================== Do not consider more than top 20, takes time and is unlikely to produce anything...</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;            <span class="keywordflow">if</span> ( cIt &gt; 20 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;            </div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;            <span class="comment">//======================================== Check the peak height</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;            <span class="keywordflow">if</span> ( CSym-&gt;at(cIt)[5]  &lt; bestHistPeakStart ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;            </div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;            <span class="comment">//======================================== Compute FSC</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;            this-&gt;<a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">computeFSC</a>                          ( settings, CSym, cIt, mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts );</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;        }</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;        </div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;        <span class="comment">//============================================ Find FSC top group threshold</span></div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        proshade_double bestHistFSCStart              = this-&gt;findTopGroupSmooth ( CSym, 6, step, sigma, windowSize );</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;        </div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        <span class="comment">//============================================ Find reliable C syms</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> cIt = 0; cIt &lt; CSym-&gt;size(); cIt++ )</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;        {</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;            <span class="comment">//======================================== Check if this improves the best already found fold</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;            <span class="keywordflow">if</span> ( CSym-&gt;at(cIt)[0] &gt; <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( bestFold ) )</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;            {</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;                <span class="comment">//==================================== If FSC passes</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;                <span class="keywordflow">if</span> ( ( CSym-&gt;at(cIt)[6] &gt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">fscThreshold</a> ) &amp;&amp; ( CSym-&gt;at(cIt)[6] &gt;= bestHistFSCStart ) )</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;                {</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;                    bestFold                          = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( CSym-&gt;at(cIt)[0] );</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;                    bestC                             = <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( cIt );</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;                }</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;            }</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;        }</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        </div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;        <span class="comment">//============================================ Anything?</span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;        <span class="keywordflow">if</span> ( bestC != -1 )</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;        {</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;            <span class="comment">//======================================== The decision is C</span></div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;C&quot;</span> );</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( CSym-&gt;at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestC ) )[0] ) );</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestC ) ) );</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;            <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSym-&gt;at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( bestC ) ) ); }</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;            </div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;            <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;            alreadyDecided                            = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;        }</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    }</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    </div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    return ;</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    </div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;}</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160; </div>
<div class="line"><a name="l02865"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a599a8fa1d6d780a45a2d772413bc778e"> 2865</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a599a8fa1d6d780a45a2d772413bc778e">ProSHADE_internal_data::ProSHADE_data::saveRequestedSymmetryC</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* CSym, std::vector&lt; proshade_double* &gt;* axes )</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;{</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;    proshade_unsign bestIndex                         = 0;</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    proshade_double highestSym                        = 0.0;</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;    </div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    <span class="comment">//================================================ Search for best fold</span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( CSym-&gt;size() ); iter++ )</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    {</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;        <span class="comment">//============================================ Check if it is tbe correct fold</span></div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSym-&gt;at(iter)[0] ), rhs1 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6dc170d9826bad9ce4a2c31a033f7f6a">requestedSymmetryFold</a> ) );</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;        <span class="keywordflow">if</span> ( !lhs1.AlmostEquals ( rhs1 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;        </div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;        <span class="comment">//============================================ If correct, is it the highest found?</span></div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;        <span class="keywordflow">if</span> ( CSym-&gt;at(iter)[5] &gt; highestSym )</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;        {</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;            highestSym                                = CSym-&gt;at(iter)[5];</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;            bestIndex                                 = iter;</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;        }</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    }</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    </div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    <span class="comment">//================================================ Found?</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    <span class="keywordflow">if</span> ( highestSym  &gt; 0.0 )</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    {</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;C&quot;</span> );</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( CSym-&gt;at(bestIndex)[0] ) );</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, CSym-&gt;at(bestIndex) );</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;        </div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 ) { settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a> ( CSym-&gt;at(bestIndex) ); }</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    }</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    {</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    }</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    </div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;    return ;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    </div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;}</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160; </div>
<div class="line"><a name="l02917"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51fec3f0a115640181f6e7ce102e4b37"> 2917</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51fec3f0a115640181f6e7ce102e4b37">ProSHADE_internal_data::ProSHADE_data::saveRequestedSymmetryD</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* DSym, std::vector&lt; proshade_double* &gt;* axes, fftw_complex* mapData, fftw_complex* origCoeffs, fftw_complex* fCoeffs, fftw_plan* planForwardFourier, proshade_signed noBins, proshade_signed* binIndexing, proshade_double** bindata, proshade_signed* binCounts )</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;{</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    proshade_unsign bestIndex                         = 0;</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    proshade_double highestSym                        = 0.0;</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    </div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    <span class="comment">//================================================ Search for best fold</span></div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( DSym-&gt;size() ); iter++ )</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;    {</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        <span class="comment">//============================================ Check if it is tbe correct fold</span></div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( std::max ( DSym-&gt;at(iter)[0], DSym-&gt;at(iter)[7] ) ), rhs1 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a6dc170d9826bad9ce4a2c31a033f7f6a">requestedSymmetryFold</a> ) );</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;        <span class="keywordflow">if</span> ( !lhs1.AlmostEquals ( rhs1 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160; </div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;        <span class="comment">//============================================ Check if peak height is decent</span></div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs999a ( DSym-&gt;at(iter)[5] ), lhs999b ( DSym-&gt;at(iter)[12] ), rhs999 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( -999.9 ) );</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;        <span class="keywordflow">if</span> ( ( DSym-&gt;at(iter)[5]  &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a> ) &amp;&amp; !( lhs999a.AlmostEquals( rhs999 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;        <span class="keywordflow">if</span> ( ( DSym-&gt;at(iter)[12] &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">peakThresholdMin</a> ) &amp;&amp; !( lhs999b.AlmostEquals( rhs999 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;        </div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;        <span class="comment">//============================================ If correct, compute FSC</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;        this-&gt;<a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">computeFSC</a>                              ( settings, &amp;DSym-&gt;at(iter)[0], mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts );</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;        this-&gt;<a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">computeFSC</a>                              ( settings, &amp;DSym-&gt;at(iter)[7], mapData, fCoeffs, origCoeffs, planForwardFourier, noBins, binIndexing, bindata, binCounts );</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;        </div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;        <span class="comment">//============================================ If best, store it</span></div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;        <span class="keywordflow">if</span> ( ( DSym-&gt;at(iter)[6] + DSym-&gt;at(iter)[13] ) &gt; highestSym )</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;        {</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;            highestSym                                = ( DSym-&gt;at(iter)[6] + DSym-&gt;at(iter)[13] );</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;            bestIndex                                 = iter;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;        }</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    }</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    </div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;    <span class="comment">//================================================ Found?</span></div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;    <span class="keywordflow">if</span> ( highestSym  &gt; 0.0 )</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;    {</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;D&quot;</span> );</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( std::max ( DSym-&gt;at(bestIndex)[0], DSym-&gt;at(bestIndex)[7] ) ) );</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, &amp;DSym-&gt;at(bestIndex)[0] );</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( axes, &amp;DSym-&gt;at(bestIndex)[7] );</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;        </div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() == 0 )</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;        {</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a>             ( &amp;DSym-&gt;at(bestIndex)[0] );</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;            settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">setDetectedSymmetry</a>             ( &amp;DSym-&gt;at(bestIndex)[7] );</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;        }</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;    }</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    {</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">setRecommendedSymmetry</a>              ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;        settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">setRecommendedFold</a>                  ( 0 );</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    }</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    </div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;    return ;</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    </div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;}</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160; </div>
<div class="line"><a name="l02980"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86"> 2980</a></span>&#160;std::vector&lt;std::vector&lt; proshade_double &gt; &gt; <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">ProSHADE_internal_data::computeGroupElementsForGroup</a> ( proshade_double xAx, proshade_double yAx, proshade_double zAx, proshade_signed fold )</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;{</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;    std::vector&lt; proshade_double &gt; angList;</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;    std::vector&lt;std::vector&lt; proshade_double &gt; &gt; ret;</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;    </div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;    <span class="comment">//================================================ Allocate memory</span></div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;    proshade_double* rotMat                           = <span class="keyword">new</span> proshade_double[9];</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rotMat, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;    </div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;    </div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;    <span class="comment">//================================================ Normalise the axis to have magnitude of 1.0</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;    proshade_double normF                             = std::sqrt( std::pow ( xAx, 2.0 ) + std::pow ( yAx, 2.0 ) + std::pow ( zAx, 2.0 ) );</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;    xAx                                              /= normF;</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;    yAx                                              /= normF;</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;    zAx                                              /= normF;</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    </div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;    <span class="comment">//================================================ Determine the list of angles</span></div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;    <span class="keywordflow">if</span> ( fold % 2 == 0 )</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;    {</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;        <span class="comment">//============================================ If fold is even, add the negative angles</span></div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;        <span class="keywordflow">for</span> ( proshade_double iter = <span class="keyword">static_cast &lt;</span> proshade_double <span class="keyword">&gt;</span> ( -( ( fold / 2 ) - 1 ) ); iter &lt;= static_cast &lt; proshade_double &gt; ( fold / 2 ); iter++ )</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;        {</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a> ( &amp;angList, ( ( 2.0 * M_PI ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( fold ) ) * iter );</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;        }</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    }</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    {</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;        <span class="comment">//============================================ If fold is odd, do the same as for even, but start one index earlier</span></div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;        <span class="keywordflow">for</span> ( proshade_double iter = <span class="keyword">static_cast &lt;</span> proshade_double <span class="keyword">&gt;</span> ( -fold / 2 ); iter &lt;= static_cast &lt; proshade_double &gt; ( fold / 2 ); iter++ )</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;        {</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a> ( &amp;angList, ( ( 2.0 * M_PI ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( fold ) ) * iter );</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;        }</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;    }</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;    </div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;    <span class="comment">//================================================ For each detected angle</span></div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast &lt; proshade_unsign &gt; ( angList.size() ); iter++ )</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;    {</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;        <span class="comment">//============================================ Compute the rotation matrix</span></div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a39eafef902a49cc0816a2ed675c14a49">ProSHADE_internal_maths::getRotationMatrixFromAngleAxis</a> ( rotMat, xAx, yAx, zAx, angList.at(iter) );</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;        </div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;        <span class="comment">//============================================ Convert to vector of vectors of doubles and save to ret</span></div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;        std::vector &lt; proshade_double &gt; retEl;</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign matIt = 0; matIt &lt; 9; matIt++ )</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;        {</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a> ( &amp;retEl, rotMat[matIt] );</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;        }</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad9fbf28fda3873fc511fa2000ccba86c">ProSHADE_internal_misc::addToDoubleVectorVector</a> ( &amp;ret, retEl );</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;    }</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    </div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    <span class="keyword">delete</span>[] rotMat;</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    </div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;    </div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;}</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160; </div>
<div class="line"><a name="l03044"></a><span class="lineno"><a class="line" href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7"> 3044</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">axesToGroupTypeSanityCheck</a> ( proshade_unsign requiredAxes, proshade_unsign obtainedAxes, std::string groupType )</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;{</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;    <span class="keywordflow">if</span> ( obtainedAxes != requiredAxes )</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    {</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;        std::stringstream hlpSS;</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;The supplied number of axes for group element\n                    : detection ( &gt;&quot;</span> &lt;&lt; obtainedAxes &lt;&lt; <span class="stringliteral">&quot;&lt; ) does not match the group type ( &gt;&quot;</span> &lt;&lt; groupType &lt;&lt; <span class="stringliteral">&quot;&lt; ).&quot;</span>;</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Mismatch between supplied number of axes and\n                    : symmetry type.&quot;</span>, <span class="stringliteral">&quot;ES00059&quot;</span>, __FILE__, __LINE__, __func__, hlpSS.str() );</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;    }</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    </div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    return ;</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    </div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;}</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160; </div>
<div class="line"><a name="l03066"></a><span class="lineno"><a class="line" href="_pro_s_h_a_d_e__data_8cpp.html#ae56351defa0ee4f5777b61e58150aba4"> 3066</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#ae56351defa0ee4f5777b61e58150aba4">checkElementAlreadyExists</a> ( std::vector&lt;std::vector&lt; proshade_double &gt; &gt;* elements, std::vector&lt; proshade_double &gt;* elem, proshade_double matrixTolerance )</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;{</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;    <span class="keywordtype">bool</span> elementFound                                 = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;    </div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;    <span class="comment">//================================================ For each existing element</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign elIt = 0; elIt &lt; static_cast&lt;proshade_unsign&gt; ( elements-&gt;size() ); elIt++ )</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;    {</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a4348a7a36275c9cea20b5c27093c9b7e">ProSHADE_internal_maths::rotationMatrixSimilarity</a> ( &amp;elements-&gt;at(elIt), elem, matrixTolerance ) )</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;        {</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;            elementFound                              = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;        }</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;    }</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;    </div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;    <span class="keywordflow">return</span>                                            ( elementFound );</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    </div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;}</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160; </div>
<div class="line"><a name="l03092"></a><span class="lineno"><a class="line" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799"> 3092</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a> ( std::vector&lt;std::vector&lt; proshade_double &gt; &gt;* elements, proshade_double matrixTolerance )</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;{</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    <span class="keywordtype">bool</span> isGroup                                      = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;    </div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    <span class="comment">//================================================ Multiply all group element pairs</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign gr1 = 0; gr1 &lt; static_cast&lt;proshade_unsign&gt; ( elements-&gt;size() ); gr1++ )</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;    {</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign gr2 = 1; gr2 &lt; static_cast&lt;proshade_unsign&gt; ( elements-&gt;size() ); gr2++ )</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;        {</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;            <span class="comment">//======================================== Use unique pairs only</span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;            <span class="keywordflow">if</span> ( gr1 &gt;= gr2 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;            </div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;            <span class="comment">//======================================== Multiply the two rotation matrices</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;            std::vector&lt; proshade_double &gt; product    = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a18222a942e5fff8eecd15f1235c609e1">ProSHADE_internal_maths::multiplyGroupElementMatrices</a> ( &amp;elements-&gt;at(gr1), &amp;elements-&gt;at(gr2) );</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;        </div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;            <span class="comment">//======================================== Check the group already contains the produces as an element</span></div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;            <span class="keywordflow">if</span> ( !<a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#ae56351defa0ee4f5777b61e58150aba4">checkElementAlreadyExists</a> ( elements, &amp;product, matrixTolerance ) )</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;            {</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;                isGroup                               = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;            }</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;        }</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;        </div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;        <span class="comment">//============================================ Stop if problem was found</span></div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;        <span class="keywordflow">if</span> ( !isGroup ) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    }</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;    </div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;    <span class="keywordflow">return</span>                                            ( isGroup );</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    </div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;}</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160; </div>
<div class="line"><a name="l03133"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc"> 3133</a></span>&#160;std::vector&lt;std::vector&lt; proshade_double &gt; &gt; <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">ProSHADE_internal_data::joinElementsFromDifferentGroups</a> ( std::vector&lt;std::vector&lt; proshade_double &gt; &gt;* first, std::vector&lt;std::vector&lt; proshade_double &gt; &gt;* second, proshade_double matrixTolerance, <span class="keywordtype">bool</span> combine )</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;{</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;    std::vector&lt; std::vector&lt; proshade_double &gt; &gt; ret;</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;    </div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;    <span class="comment">//================================================ Add the first list to ret, checking for uniqueness</span></div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign elIt = 0; elIt &lt; static_cast&lt;proshade_unsign&gt; ( first-&gt;size() ); elIt++ )</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;    {</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;        <span class="keywordflow">if</span> ( !<a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#ae56351defa0ee4f5777b61e58150aba4">checkElementAlreadyExists</a>( &amp;ret, &amp;first-&gt;at(elIt), matrixTolerance ) )</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;        {</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad9fbf28fda3873fc511fa2000ccba86c">ProSHADE_internal_misc::addToDoubleVectorVector</a> ( &amp;ret, first-&gt;at(elIt) );</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;        }</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    }</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;    </div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;    <span class="comment">//================================================ Add the second list to ret, checking for uniqueness</span></div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign elIt = 0; elIt &lt; static_cast&lt;proshade_unsign&gt; ( second-&gt;size() ); elIt++ )</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;    {</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;        <span class="keywordflow">if</span> ( !<a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#ae56351defa0ee4f5777b61e58150aba4">checkElementAlreadyExists</a>( &amp;ret, &amp;second-&gt;at(elIt), matrixTolerance ) )</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;        {</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad9fbf28fda3873fc511fa2000ccba86c">ProSHADE_internal_misc::addToDoubleVectorVector</a> ( &amp;ret, second-&gt;at(elIt) );</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;        }</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;    }</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;    </div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    <span class="comment">//================================================ Multiply all combinations of first and second and check for uniqueness</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;    <span class="keywordflow">if</span> ( combine )</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;    {</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign gr1 = 0; gr1 &lt; static_cast&lt;proshade_unsign&gt; ( first-&gt;size() ); gr1++ )</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;        {</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign gr2 = 0; gr2 &lt; static_cast&lt;proshade_unsign&gt; ( second-&gt;size() ); gr2++ )</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;            {</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;                <span class="comment">//==================================== Multiply the two rotation matrices</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;                std::vector&lt; proshade_double &gt; product = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a18222a942e5fff8eecd15f1235c609e1">ProSHADE_internal_maths::multiplyGroupElementMatrices</a> ( &amp;first-&gt;at(gr1), &amp;second-&gt;at(gr2) );</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160; </div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;                <span class="comment">//==================================== Add</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;                <span class="keywordflow">if</span> ( !<a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#ae56351defa0ee4f5777b61e58150aba4">checkElementAlreadyExists</a>( &amp;ret, &amp;product, matrixTolerance ) )</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;                {</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad9fbf28fda3873fc511fa2000ccba86c">ProSHADE_internal_misc::addToDoubleVectorVector</a> ( &amp;ret, product );</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;                }</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160; </div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;            }</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;        }</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;    }</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;    </div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;    </div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;}</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160; </div>
<div class="line"><a name="l03199"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae2f2469c7d252c5e87d7bf9976b9b796"> 3199</a></span>&#160;std::vector&lt;std::vector&lt; proshade_double &gt; &gt; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae2f2469c7d252c5e87d7bf9976b9b796">ProSHADE_internal_data::ProSHADE_data::getAllGroupElements</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_unsign &gt; axesList, std::string groupType, proshade_double matrixTolerance )</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;{</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    std::vector&lt;std::vector&lt; proshade_double &gt; &gt; ret;</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    </div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;    <span class="comment">//================================================ Select which symmetry type are we computing for</span></div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;    <span class="keywordflow">if</span> ( groupType == <span class="stringliteral">&quot;C&quot;</span> )</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    {</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;        <span class="comment">//============================================ Sanity check</span></div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;        <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">axesToGroupTypeSanityCheck</a>                    ( 1, <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( axesList.size() ), groupType );</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;        </div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;        <span class="comment">//============================================ Generate elements</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;        ret                                           = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(0)).at(1),</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;                                                                                       settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(0)).at(2),</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;                                                                                       settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(0)).at(3),</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;                                                                                       <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(0)).at(0) ) );</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160; </div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;        <span class="comment">//============================================ Check the element to form a group</span></div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a> ( &amp;ret, matrixTolerance ) ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;        {</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Computed point group elements do not form a group.&quot;</span>, <span class="stringliteral">&quot;ES00060&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied cyclic groups list does not form a group and\n                    : therefore such group&#39;s elements cannot be obtained. Please\n                    : check the cyclic groups list supplied to the\n                    : getAllGroupElements() function.&quot;</span> );</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;        }</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    }</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( groupType == <span class="stringliteral">&quot;D&quot;</span> )</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;    {</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;        <span class="comment">//============================================ Sanity check</span></div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;        <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">axesToGroupTypeSanityCheck</a>                    ( 2, <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( axesList.size() ), groupType );</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;        </div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;        <span class="comment">//============================================ Generate elements for both axes</span></div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;        std::vector&lt;std::vector&lt; proshade_double &gt; &gt; first  = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(0)).at(1),</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;                                                                                             settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(0)).at(2),</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;                                                                                             settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(0)).at(3),</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;                                                                                             <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(0)).at(0) ) );</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;        std::vector&lt;std::vector&lt; proshade_double &gt; &gt; second = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(1)).at(1),</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;                                                                                             settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(1)).at(2),</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;                                                                                             settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(1)).at(3),</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;                                                                                             <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(1)).at(0) ) );</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;        </div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;        <span class="comment">//============================================ Join the element lists</span></div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;        ret                                           = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;first, &amp;second, matrixTolerance, <span class="keyword">true</span> );</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;        </div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;        <span class="comment">//============================================ Check the element to form a group</span></div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a> ( &amp;ret, matrixTolerance ) ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;        {</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Computed point group elements do not form a group.&quot;</span>, <span class="stringliteral">&quot;ES00060&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied cyclic groups list does not form a group and\n                    : therefore such group&#39;s elements cannot be obtained. Please\n                    : check the cyclic groups list supplied to the\n                    : getAllGroupElements() function.&quot;</span> );</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;        }</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;    }</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( groupType == <span class="stringliteral">&quot;T&quot;</span> )</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;    {</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;        <span class="comment">//============================================ Sanity check</span></div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;        <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">axesToGroupTypeSanityCheck</a>                    ( 7, <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( axesList.size() ), groupType );</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;        </div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;        <span class="comment">//============================================ Generate elements for all four C3 axes first</span></div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;        {</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;            <span class="comment">//======================================== If this is a C3 axis</span></div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ), rhs1 ( 3.0 );</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;            {</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;                </div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;            }</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;        }</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;        </div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;        <span class="comment">//============================================ Generate elements for all three C2 axes second</span></div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;        {</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;            <span class="comment">//======================================== If this is a C3 axis</span></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ), rhs1 ( 2.0 );</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;            {</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;                </div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;            }</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;        }</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;        </div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;        <span class="comment">//============================================ Check the element to form a group</span></div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a> ( &amp;ret, matrixTolerance ) ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;        {</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Computed point group elements do not form a group.&quot;</span>, <span class="stringliteral">&quot;ES00060&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied cyclic groups list does not form a group and\n                    : therefore such group&#39;s elements cannot be obtained. Please\n                    : check the cyclic groups list supplied to the\n                    : getAllGroupElements() function.&quot;</span> );</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;        }</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;    }</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( groupType == <span class="stringliteral">&quot;O&quot;</span> )</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;    {</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;        <span class="comment">//============================================ Sanity check</span></div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;        <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">axesToGroupTypeSanityCheck</a>                    ( 13, <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( axesList.size() ), groupType );</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;        </div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;        <span class="comment">//============================================ Generate elements for all three C4 axes first</span></div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;        {</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;            <span class="comment">//======================================== If this is a C3 axis</span></div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ), rhs1 ( 4.0 );</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;            {</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160; </div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;            }</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;        }</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160; </div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;        <span class="comment">//============================================ Generate elements for all four C3 axes first</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;        {</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;            <span class="comment">//======================================== If this is a C3 axis</span></div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ), rhs1 ( 3.0 );</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;            {</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160; </div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;            }</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;        }</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;        </div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;        <span class="comment">//============================================ Generate elements for all six C2 axes next</span></div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;        {</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;            <span class="comment">//======================================== If this is a C3 axis</span></div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ), rhs1 ( 2.0 );</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;            {</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160; </div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;            }</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;        }</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160; </div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;        <span class="comment">//============================================ Check the element to form a group</span></div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a> ( &amp;ret, matrixTolerance ) ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;        {</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Computed point group elements do not form a group.&quot;</span>, <span class="stringliteral">&quot;ES00060&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied cyclic groups list does not form a group and\n                    : therefore such group&#39;s elements cannot be obtained. Please\n                    : check the cyclic groups list supplied to the\n                    : getAllGroupElements() function.&quot;</span> );</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;        }</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;    }</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( groupType == <span class="stringliteral">&quot;I&quot;</span> )</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;    {</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;        <span class="comment">//============================================ Sanity check</span></div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;        <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">axesToGroupTypeSanityCheck</a>                    ( 31, <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( axesList.size() ), groupType );</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;        </div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;        <span class="comment">//============================================ Generate elements for all six C5 axes first</span></div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;        {</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;            <span class="comment">//======================================== If this is a C5 axis</span></div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ), rhs1 ( 5.0 );</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;            {</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160; </div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;            }</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;        }</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;        </div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;        <span class="comment">//============================================ Generate elements for all ten C3 axes next</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;        {</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;            <span class="comment">//======================================== If this is a C3 axis</span></div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ), rhs1 ( 3.0 );</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;            {</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160; </div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;            }</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;        }</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;        </div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;        <span class="comment">//============================================ Generate elements for all fifteen C2 axes lastly</span></div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;        {</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;            <span class="comment">//======================================== If this is a C3 axis</span></div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ), rhs1 ( 2.0 );</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;            <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;            {</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;                <span class="comment">//==================================== Generate the elements</span></div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;                std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;                                                                                                  settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;                                                                                                  <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160; </div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;                <span class="comment">//==================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;                ret                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">false</span> );</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;            }</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;        }</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160; </div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;        <span class="comment">//============================================ Check the element to form a group</span></div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a> ( &amp;ret, matrixTolerance ) ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;        {</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Computed point group elements do not form a group.&quot;</span>, <span class="stringliteral">&quot;ES00060&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied cyclic groups list does not form a group and\n                    : therefore such group&#39;s elements cannot be obtained. Please\n                    : check the cyclic groups list supplied to the\n                    : getAllGroupElements() function.&quot;</span> );</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;        }</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;    }</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( groupType == <span class="stringliteral">&quot;X&quot;</span> )</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;    {</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;        <span class="comment">//============================================ User forced no checking for unspecified symmetry</span></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( axesList.size() ); grIt++ )</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;        {</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;            <span class="comment">//======================================== Compute group elements</span></div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;            std::vector&lt;std::vector&lt; proshade_double &gt; &gt; els = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">computeGroupElementsForGroup</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(1),</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;                                                                                              settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(2),</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;                                                                                              settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(3),</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;                                                                                              <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(axesList.at(grIt)).at(0) ) );</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;            </div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;            <span class="comment">//======================================== Join the elements to any already found</span></div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;            ret                                       = <a class="code" href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">joinElementsFromDifferentGroups</a> ( &amp;els, &amp;ret, matrixTolerance, <span class="keyword">true</span> );</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;        }</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;        </div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;        <span class="comment">//============================================ Check the element to form a group</span></div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a> ( &amp;ret, matrixTolerance ) ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;        {</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Computed point group elements do not form a group.&quot;</span>, <span class="stringliteral">&quot;ES00060&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;The supplied cyclic groups list does not form a group and\n                    : therefore such group&#39;s elements cannot be obtained. Please\n                    : check the cyclic groups list supplied to the\n                    : getAllGroupElements() function.&quot;</span> );</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;        }</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;    }</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;    {</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;        std::stringstream hlpSS;</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;Unknown symmetry type: &gt;&quot;</span> &lt;&lt; groupType &lt;&lt; <span class="stringliteral">&quot;&lt;&quot;</span>;</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( hlpSS.str().c_str(), <span class="stringliteral">&quot;ES00058&quot;</span>, __FILE__, __LINE__, __func__, <span class="stringliteral">&quot;Function getAllGroupElements was called with symmetry type\n                    : value outside of the allowed values C, D, T, O, I\n                    : or empty for using all supplied axes.&quot;</span> );</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;    }</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160; </div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;}</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160; </div>
<div class="line"><a name="l03466"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac3fbad5b8628112ace798950e6068bd4"> 3466</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac3fbad5b8628112ace798950e6068bd4">ProSHADE_internal_data::ProSHADE_data::deepCopyMap</a> ( proshade_double*&amp; saveTo, proshade_signed verbose )</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;{</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;    <span class="keywordflow">if</span> ( saveTo != <span class="keyword">nullptr</span> )</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;    {</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( verbose, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! The deep copy pointer is not set to NULL. Cannot proceed and returning unmodified pointer.&quot;</span>, <span class="stringliteral">&quot;WB00040&quot;</span> );</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;        return ;</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;    }</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;    </div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;    <span class="comment">//================================================ Allocate the memory</span></div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;    saveTo                                            = <span class="keyword">new</span> proshade_double[this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;    </div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;    <span class="comment">//================================================ Check memory allocation</span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( saveTo, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;    </div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;    <span class="comment">//================================================ Copy internal map to the new pointer</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; ( this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices ); iter++ )</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;    {</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;        saveTo[iter]                                  = this-&gt;internalMap[iter];</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;    }</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;    </div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;    return ;</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;    </div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;}</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160; </div>
<div class="line"><a name="l03498"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abea2d62360b17cddca155816d3e485e8"> 3498</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abea2d62360b17cddca155816d3e485e8">ProSHADE_internal_data::ProSHADE_data::reportSymmetryResults</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;{</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;    <span class="comment">//================================================ Improve this!</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;    <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac39560ba9aca9053753c158fb2adb9de">recommendedSymmetryType</a> == <span class="stringliteral">&quot;&quot;</span> )</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;    {</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, <span class="stringliteral">&quot;Did not detect any symmetry!&quot;</span> );</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;    }</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;    {</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;        std::stringstream ssHlp;</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;        std::vector&lt; proshade_double &gt; comMove        = this-&gt;getMapCOMProcessChange ( );</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;        ssHlp &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Detected &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac39560ba9aca9053753c158fb2adb9de">recommendedSymmetryType</a> &lt;&lt; <span class="stringliteral">&quot; symmetry with fold &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac8e62cc8dbd40265e51143c8207b6638">recommendedSymmetryFold</a> &lt;&lt; <span class="stringliteral">&quot; about point [&quot;</span> &lt;&lt; comMove.at(0) &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; comMove.at(1) &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; comMove.at(2) &lt;&lt; <span class="stringliteral">&quot;] away from centre of mass .&quot;</span>;</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, ssHlp.str() );</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;        </div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() &gt; 0 )</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;        {</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;            ssHlp.clear(); ssHlp.str ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;            ssHlp &lt;&lt; <span class="stringliteral">&quot;  Fold       X           Y          Z           Angle        Height      Average FSC&quot;</span>;</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, ssHlp.str() );</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;        }</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign symIt = 0; symIt &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() ); symIt++ )</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;        {</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;            ssHlp.clear(); ssHlp.str ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;            ssHlp &lt;&lt; std::showpos &lt;&lt; std::fixed &lt;&lt; std::setprecision(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[0] &lt;&lt; std::setprecision(5) &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[1] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[2] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[3] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[4] &lt;&lt; <span class="stringliteral">&quot;      &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[5] &lt;&lt; <span class="stringliteral">&quot;      &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(symIt)[6];</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, ssHlp.str() );</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;        }</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;        </div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;        std::stringstream hlpSS3;</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;        ssHlp.clear(); ssHlp.str ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;        hlpSS3 &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;To facilitate manual checking for symmetries, the following is a list of all detected C symmetries:&quot;</span>;</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, hlpSS3.str() );</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;        </div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;        <span class="keywordflow">if</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.size() &gt; 0 )</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;        {</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;            ssHlp.clear(); ssHlp.str ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;            ssHlp &lt;&lt; <span class="stringliteral">&quot;  Fold       X           Y          Z           Angle        Height      Average FSC&quot;</span>;</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, ssHlp.str() );</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;        }</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign symIt = 0; symIt &lt; static_cast&lt;proshade_unsign&gt; ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.size() ); symIt++ )</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;        {</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;            ssHlp.clear(); ssHlp.str ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;            ssHlp &lt;&lt; std::showpos &lt;&lt; std::fixed &lt;&lt; std::setprecision(0) &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(symIt)[0] &lt;&lt; std::setprecision(5) &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(symIt)[1] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(symIt)[2] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(symIt)[3] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(symIt)[4] &lt;&lt; <span class="stringliteral">&quot;      &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(symIt)[5] &lt;&lt; <span class="stringliteral">&quot;      &quot;</span> &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">allDetectedCAxes</a>.at(symIt)[6];</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, ssHlp.str() );</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;        }</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;        </div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    }</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;    </div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;    return ;</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;    </div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;}</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160; </div>
<div class="line"><a name="l03554"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac07955296611dd411cf5ed87ced90571"> 3554</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac07955296611dd411cf5ed87ced90571">ProSHADE_internal_data::ProSHADE_data::findMapCOM</a> ( )</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;{</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;    this-&gt;xCom                                        = 0.0;</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;    this-&gt;yCom                                        = 0.0;</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;    this-&gt;zCom                                        = 0.0;</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;    proshade_double totNonZeroPoints                  = 0.0;</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;    proshade_signed mapIt                             = 0;</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;    </div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;    <span class="comment">//================================================ Compute COM from 0 ; 0 ; 0</span></div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed xIt = 0; xIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;xDimIndices ); xIt++ )</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;    {</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed yIt = 0; yIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;yDimIndices ); yIt++ )</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;        {</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed zIt = 0; zIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;zDimIndices ); zIt++ )</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;            {</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;                <span class="comment">//==================================== Find map index</span></div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;                mapIt                                 = zIt  + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) * ( yIt  + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) * xIt  );</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;                </div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;                <span class="comment">//==================================== Use only positive density</span></div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;                <span class="keywordflow">if</span> ( this-&gt;internalMap[mapIt] &lt;= 0.0 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;                </div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;                <span class="comment">//==================================== Compute Index COM</span></div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;                this-&gt;xCom                           += this-&gt;internalMap[mapIt] * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( xIt + this-&gt;xFrom );</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;                this-&gt;yCom                           += this-&gt;internalMap[mapIt] * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( yIt + this-&gt;yFrom );</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;                this-&gt;zCom                           += this-&gt;internalMap[mapIt] * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( zIt + this-&gt;zFrom );</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;                totNonZeroPoints                     += this-&gt;internalMap[mapIt];</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;            }</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;        }</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;    }</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;    </div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;    this-&gt;xCom                                       /= totNonZeroPoints;</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;    this-&gt;yCom                                       /= totNonZeroPoints;</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;    this-&gt;zCom                                       /= totNonZeroPoints;</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;    </div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    <span class="comment">//================================================ Convert to real world</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;    this-&gt;xCom         = <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xFrom ) * ( this-&gt;xDimSizeOriginal / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xDimIndicesOriginal ) ) ) +</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;                                                        ( ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xCom ) - <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xFrom ) ) *</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;                                                        ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xDimSizeOriginal ) / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;xDimIndicesOriginal ) ) ) );</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;    this-&gt;yCom         = <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yFrom ) * ( this-&gt;yDimSizeOriginal / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yDimIndicesOriginal ) ) ) +</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;                                                        ( ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yCom ) - <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yFrom ) ) *</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;                                                        ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yDimSizeOriginal ) / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;yDimIndicesOriginal ) ) ) );</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;    this-&gt;zCom         = <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zFrom ) * ( this-&gt;zDimSizeOriginal / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zDimIndicesOriginal ) ) ) +</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;                                                        ( ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zCom ) - <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zFrom ) ) *</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;                                                        ( <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zDimSizeOriginal ) / <span class="keyword">static_cast&lt;</span> proshade_single <span class="keyword">&gt;</span> ( this-&gt;zDimIndicesOriginal ) ) ) );</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;    </div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;    return ;</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;    </div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;}</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160; </div>
<div class="line"><a name="l03609"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef"> 3609</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">ProSHADE_internal_data::ProSHADE_data::getMaxSpheres</a> ( )</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;{</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;noSpheres );</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;}</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160; </div>
<div class="line"><a name="l03620"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afe04510c67e9dc9c19efaef8463b6e6e"> 3620</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afe04510c67e9dc9c19efaef8463b6e6e">ProSHADE_internal_data::ProSHADE_data::getMapValue</a> ( proshade_unsign pos )</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;{</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;internalMap[pos] );</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;}</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160; </div>
<div class="line"><a name="l03630"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd"> 3630</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">ProSHADE_internal_data::ProSHADE_data::getMaxBand</a> ( )</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;{</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;maxShellBand );</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;}</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160; </div>
<div class="line"><a name="l03640"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa35ae5ccd9d4b22bcc028f609cd1c3e"> 3640</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa35ae5ccd9d4b22bcc028f609cd1c3e">ProSHADE_internal_data::ProSHADE_data::getRRPValue</a> ( proshade_unsign band, proshade_unsign sh1, proshade_unsign sh2 )</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;{</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;rrpMatrices[band][sh1][sh2] );</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;}</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160; </div>
<div class="line"><a name="l03656"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ada8e6f27f49afc3a0ee17758ce9e7594"> 3656</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ada8e6f27f49afc3a0ee17758ce9e7594">ProSHADE_internal_data::ProSHADE_data::shellBandExists</a> ( proshade_unsign shell, proshade_unsign bandVal )</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;{</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;spheres[shell]-&gt;getLocalBandwidth( ) &gt;= bandVal )</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;    {</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;        <span class="keywordflow">return</span>                                        ( <span class="keyword">true</span> );</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;    }</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;    {</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;        <span class="keywordflow">return</span>                                        ( <span class="keyword">false</span> );</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;    }</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;}</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160; </div>
<div class="line"><a name="l03676"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5919acc2f26efcf373db47ed96eadc38"> 3676</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5919acc2f26efcf373db47ed96eadc38">ProSHADE_internal_data::ProSHADE_data::removePhaseInormation</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;{</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;    <span class="comment">//================================================ Report function start</span></div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Centering map onto its COM.&quot;</span> );</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;    </div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;    <span class="comment">//================================================ Copy map for processing</span></div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;    fftw_complex* mapCoeffs                           = <span class="keyword">new</span> fftw_complex[this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;    fftw_complex* pattersonMap                        = <span class="keyword">new</span> fftw_complex[this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices];</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;    </div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;    <span class="comment">//================================================ Check memory allocation</span></div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( mapCoeffs, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( pattersonMap, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;    </div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    <span class="comment">//================================================ Copy data to mask</span></div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; (this-&gt;xDimIndices * this-&gt;yDimIndices * this-&gt;zDimIndices); iter++ )</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;    {</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;        pattersonMap[iter][0]                         = this-&gt;internalMap[iter];</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;        pattersonMap[iter][1]                         = 0.0;</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;    }</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;    </div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;    <span class="comment">//================================================ Prepare FFTW plans</span></div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;    fftw_plan forward                                 = fftw_plan_dft_3d ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;xDimIndices ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ),</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;                                                                           pattersonMap, mapCoeffs, FFTW_FORWARD,  FFTW_ESTIMATE );</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;    fftw_plan inverse                                 = fftw_plan_dft_3d ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;xDimIndices ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ),</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;                                                                           mapCoeffs, pattersonMap, FFTW_BACKWARD, FFTW_ESTIMATE );</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;    </div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;    <span class="comment">//================================================ Run forward Fourier</span></div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;    fftw_execute                                      ( forward );</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;    </div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;    <span class="comment">//================================================ Remove the phase</span></div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a167f7a9dbd061752d2a099181090a3b8">ProSHADE_internal_mapManip::removeMapPhase</a>        ( mapCoeffs, this-&gt;xDimIndices, this-&gt;yDimIndices, this-&gt;zDimIndices );</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;    </div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;    <span class="comment">//================================================ Run inverse Fourier</span></div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;    fftw_execute                                      ( inverse );</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;    </div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;    <span class="comment">//================================================ Save the results</span></div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;    proshade_signed mapIt, patIt, patX, patY, patZ;</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed xIt = 0; xIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;xDimIndices ); xIt++ )</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;    {</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed yIt = 0; yIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;yDimIndices ); yIt++ )</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;        {</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed zIt = 0; zIt &lt; static_cast&lt;proshade_signed&gt; ( this-&gt;zDimIndices ); zIt++ )</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;            {</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;                <span class="comment">//==================================== Centre patterson map</span></div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;                patX = xIt - ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( this-&gt;xDimIndices ) / 2 ); <span class="keywordflow">if</span> ( patX &lt; 0 ) { patX += this-&gt;xDimIndices; }</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;                patY = yIt - ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) / 2 ); <span class="keywordflow">if</span> ( patY &lt; 0 ) { patY += this-&gt;yDimIndices; }</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;                patZ = zIt - ( <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) / 2 ); <span class="keywordflow">if</span> ( patZ &lt; 0 ) { patZ += this-&gt;zDimIndices; }</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;                </div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;                <span class="comment">//==================================== Find indices</span></div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;                mapIt                                 = zIt  + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) * ( yIt  + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) * xIt  );</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;                patIt                                 = patZ + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;zDimIndices ) * ( patY + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;yDimIndices ) * patX );</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;                </div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;                <span class="comment">//==================================== Copy</span></div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;                this-&gt;internalMap[mapIt]              = pattersonMap[patIt][0];</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;            }</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;        }</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;    }</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;    </div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;    <span class="keyword">delete</span>[] pattersonMap;</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;    <span class="keyword">delete</span>[] mapCoeffs;</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;    </div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;    <span class="comment">//================================================ Delete FFTW plans</span></div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;    fftw_destroy_plan                                 ( forward );</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;    fftw_destroy_plan                                 ( inverse );</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;    </div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;    <span class="comment">//================================================ Report function completion</span></div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Phase information removed.&quot;</span> );</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;    </div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;    return ;</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;    </div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;}</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160; </div>
<div class="line"><a name="l03754"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5c0df68cd21b4f56abd1008065ca3573"> 3754</a></span>&#160;proshade_double* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5c0df68cd21b4f56abd1008065ca3573">ProSHADE_internal_data::ProSHADE_data::getRealSphHarmValue</a> ( proshade_unsign band, proshade_unsign order, proshade_unsign shell )</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;{</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;sphericalHarmonics[shell][seanindex ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( order ) - <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( band ),</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;                                                                                                     <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( band ),</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;                                                                                                     <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;spheres[shell]-&gt;getLocalBandwidth() ) )][0] );</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;    </div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;}</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160; </div>
<div class="line"><a name="l03767"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae8444b6c9ca3207d32bbf2a68c7b610"> 3767</a></span>&#160;proshade_double* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae8444b6c9ca3207d32bbf2a68c7b610">ProSHADE_internal_data::ProSHADE_data::getImagSphHarmValue</a> ( proshade_unsign band, proshade_unsign order, proshade_unsign shell )</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;{</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;sphericalHarmonics[shell][seanindex ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( order ) - <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( band ),</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;                                                                                                     <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( band ),</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;                                                                                                     <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;spheres[shell]-&gt;getLocalBandwidth() ) )][1] );</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;    </div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;}</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160; </div>
<div class="line"><a name="l03780"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23620b34a604aca7db4d8b21f6d2d09a"> 3780</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23620b34a604aca7db4d8b21f6d2d09a">ProSHADE_internal_data::ProSHADE_data::getAnySphereRadius</a> ( proshade_unsign shell )</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;{</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;spheres[shell]-&gt;getShellRadius() );</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;    </div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;}</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160; </div>
<div class="line"><a name="l03791"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa150cfc5715420cf3d2e28c8af3631c4"> 3791</a></span>&#160;proshade_double <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa150cfc5715420cf3d2e28c8af3631c4">ProSHADE_internal_data::ProSHADE_data::getIntegrationWeight</a>  ( <span class="keywordtype">void</span> )</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;{</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;integrationWeight );</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;    </div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;}</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160; </div>
<div class="line"><a name="l03803"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a898b48c1135e7a37f64f55e2367f0391"> 3803</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a898b48c1135e7a37f64f55e2367f0391">ProSHADE_internal_data::ProSHADE_data::getShellBandwidth</a> ( proshade_unsign shell )</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;{</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;spheres[shell]-&gt;getLocalBandwidth ( ) );</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;    </div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;}</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160; </div>
<div class="line"><a name="l03815"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a38d47eb11eafa106c65867ceec62a3fc"> 3815</a></span>&#160;proshade_single <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a38d47eb11eafa106c65867ceec62a3fc">ProSHADE_internal_data::ProSHADE_data::getSpherePosValue</a> ( proshade_unsign shell )</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;{</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;spherePos.at(shell) );</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;    </div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;}</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160; </div>
<div class="line"><a name="l03827"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94a73f81ba80621f5f52173e91bb47f7"> 3827</a></span>&#160;proshade_complex** <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94a73f81ba80621f5f52173e91bb47f7">ProSHADE_internal_data::ProSHADE_data::getEMatrixByBand</a> ( proshade_unsign band )</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;{</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;eMatrices[band] );</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;    </div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;}</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160; </div>
<div class="line"><a name="l03842"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab053362f9dc5422244ccfbafd9f00ff8"> 3842</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab053362f9dc5422244ccfbafd9f00ff8">ProSHADE_internal_data::ProSHADE_data::getEMatrixValue</a> ( proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double* valueReal, proshade_double* valueImag )</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;{</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;    <span class="comment">//================================================ Set pointer</span></div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;   *valueReal                                         = this-&gt;eMatrices[band][order1][order2][0];</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;   *valueImag                                         = this-&gt;eMatrices[band][order1][order2][1];</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;    </div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;    return ;</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;    </div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;}</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160; </div>
<div class="line"><a name="l03857"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be"> 3857</a></span>&#160;proshade_complex* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">ProSHADE_internal_data::ProSHADE_data::getInvSO3Coeffs</a> ( )</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;{</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;so3CoeffsInverse );</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;    </div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;}</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160; </div>
<div class="line"><a name="l03868"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae5c9c45b0db1e6a9eeef2ba292fbbcc3"> 3868</a></span>&#160;proshade_complex* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae5c9c45b0db1e6a9eeef2ba292fbbcc3">ProSHADE_internal_data::ProSHADE_data::getSO3Coeffs</a> ( )</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;{</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;so3Coeffs );</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;    </div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;}</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160; </div>
<div class="line"><a name="l03879"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6cc2b8e179a137adda234e0ba0f9d27b"> 3879</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6cc2b8e179a137adda234e0ba0f9d27b">ProSHADE_internal_data::ProSHADE_data::getComparisonBand</a> ( )</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;{</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;maxCompBand );</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;    </div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;}</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160; </div>
<div class="line"><a name="l03894"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5999f7181bd3509454966f8271ac39d6"> 3894</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5999f7181bd3509454966f8271ac39d6">ProSHADE_internal_data::ProSHADE_data::getWignerMatrixValue</a> ( proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double* valueReal, proshade_double* valueImag )</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;{</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;    <span class="comment">//================================================ Set pointer</span></div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;    *valueReal                                        = this-&gt;wignerMatrices[band][order1][order2][0];</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;    *valueImag                                        = this-&gt;wignerMatrices[band][order1][order2][1];</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;    </div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;    return ;</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;    </div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;}</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160; </div>
<div class="line"><a name="l03909"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185"> 3909</a></span>&#160;proshade_single <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">ProSHADE_internal_data::ProSHADE_data::getXDimSize</a> ( )</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;{</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;xDimSize );</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;}</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160; </div>
<div class="line"><a name="l03919"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51"> 3919</a></span>&#160;proshade_single <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">ProSHADE_internal_data::ProSHADE_data::getYDimSize</a> ( )</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;{</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;yDimSize );</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;}</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160; </div>
<div class="line"><a name="l03929"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970"> 3929</a></span>&#160;proshade_single <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">ProSHADE_internal_data::ProSHADE_data::getZDimSize</a> ( )</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;{</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;zDimSize );</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;}</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160; </div>
<div class="line"><a name="l03939"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1"> 3939</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">ProSHADE_internal_data::ProSHADE_data::getXDim</a> ( )</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;{</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;xDimIndices );</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;}</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160; </div>
<div class="line"><a name="l03949"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19"> 3949</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">ProSHADE_internal_data::ProSHADE_data::getYDim</a> ( )</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;{</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;yDimIndices );</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;}</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160; </div>
<div class="line"><a name="l03959"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d"> 3959</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">ProSHADE_internal_data::ProSHADE_data::getZDim</a> ( )</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;{</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;zDimIndices );</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;}</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160; </div>
<div class="line"><a name="l03969"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4c89c860da1836b30a9b2889d3e873ed"> 3969</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4c89c860da1836b30a9b2889d3e873ed">ProSHADE_internal_data::ProSHADE_data::getXFromPtr</a> ( )</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;{</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;xFrom );</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;}</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160; </div>
<div class="line"><a name="l03979"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f0d929d1e013cdd23e956d94b7a40da"> 3979</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f0d929d1e013cdd23e956d94b7a40da">ProSHADE_internal_data::ProSHADE_data::getYFromPtr</a> ( )</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;{</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;yFrom );</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;}</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160; </div>
<div class="line"><a name="l03989"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afbbcec01a6ee7701e3b1d0e61730fadf"> 3989</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afbbcec01a6ee7701e3b1d0e61730fadf">ProSHADE_internal_data::ProSHADE_data::getZFromPtr</a> ( )</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;{</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;zFrom );</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;}</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160; </div>
<div class="line"><a name="l03999"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#adf61c328db45fcd7692d13a8cde5e092"> 3999</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#adf61c328db45fcd7692d13a8cde5e092">ProSHADE_internal_data::ProSHADE_data::getXToPtr</a> ( )</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;{</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;xTo );</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;}</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160; </div>
<div class="line"><a name="l04009"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac859cbd21b93b9d2ed5f119f4ee57f3f"> 4009</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac859cbd21b93b9d2ed5f119f4ee57f3f">ProSHADE_internal_data::ProSHADE_data::getYToPtr</a> ( )</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;{</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;yTo );</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;}</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160; </div>
<div class="line"><a name="l04019"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a68eb739dd4846a1dd48032eb2cc3f49c"> 4019</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a68eb739dd4846a1dd48032eb2cc3f49c">ProSHADE_internal_data::ProSHADE_data::getZToPtr</a> ( )</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;{</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;zTo );</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;}</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160; </div>
<div class="line"><a name="l04029"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a1405b3974697f41c4a73da0cb52a32"> 4029</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a1405b3974697f41c4a73da0cb52a32">ProSHADE_internal_data::ProSHADE_data::getXAxisOrigin</a> ( )</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;{</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;xAxisOrigin );</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;}</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160; </div>
<div class="line"><a name="l04039"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a298bc9a6aae624a091cd97b842a6b618"> 4039</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a298bc9a6aae624a091cd97b842a6b618">ProSHADE_internal_data::ProSHADE_data::getYAxisOrigin</a> ( )</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;{</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;yAxisOrigin );</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;}</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160; </div>
<div class="line"><a name="l04049"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aeb0242051835b508e9af193dc40a697c"> 4049</a></span>&#160;proshade_signed* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aeb0242051835b508e9af193dc40a697c">ProSHADE_internal_data::ProSHADE_data::getZAxisOrigin</a> ( )</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;{</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;    <span class="keywordflow">return</span>                                            ( &amp;this-&gt;zAxisOrigin );</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;}</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160; </div>
<div class="line"><a name="l04059"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1bb8bf1e357cc25f68fe93554e44715d"> 4059</a></span>&#160;proshade_double*&amp; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1bb8bf1e357cc25f68fe93554e44715d">ProSHADE_internal_data::ProSHADE_data::getInternalMap</a> ( )</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;{</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;internalMap );</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;}</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160; </div>
<div class="line"><a name="l04069"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae27a3e92905ca9d5f9a32c4eaacc64ae"> 4069</a></span>&#160;proshade_complex* <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae27a3e92905ca9d5f9a32c4eaacc64ae">ProSHADE_internal_data::ProSHADE_data::getTranslationFnPointer</a> ( <span class="keywordtype">void</span> )</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;{</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;translationMap );</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;}</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160; </div>
<div class="line"><a name="l04079"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4bd7a9a5ea6cac4302ec1cd80922c617"> 4079</a></span>&#160;std::vector&lt; proshade_double &gt; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4bd7a9a5ea6cac4302ec1cd80922c617">ProSHADE_internal_data::ProSHADE_data::getMapCOMProcessChange</a> ( <span class="keywordtype">void</span> )</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;{</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;    std::vector&lt; proshade_double &gt; ret;</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;    </div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;    <span class="comment">//================================================ Save the values</span></div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;ret, this-&gt;mapCOMProcessChangeX );</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;ret, this-&gt;mapCOMProcessChangeY );</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;ret, this-&gt;mapCOMProcessChangeZ );</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;    </div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;    <span class="comment">//================================================ Return the requested value</span></div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;}</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160; </div>
<div class="line"><a name="l04097"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e7b1d5d4164ea7a6fda53c57ac979f4"> 4097</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e7b1d5d4164ea7a6fda53c57ac979f4">ProSHADE_internal_data::ProSHADE_data::setIntegrationWeight</a> ( proshade_double intW )</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;{</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;    this-&gt;integrationWeight                           = intW;</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;    </div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;    return ;</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;    </div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;}</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160; </div>
<div class="line"><a name="l04111"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a737ee01d968fef7ae1094847a0271033"> 4111</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a737ee01d968fef7ae1094847a0271033">ProSHADE_internal_data::ProSHADE_data::setIntegrationWeightCumul</a> ( proshade_double intW )</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;{</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;    this-&gt;integrationWeight                          += intW;</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;    </div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;    return ;</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;    </div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;}</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160; </div>
<div class="line"><a name="l04128"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5af5c8c3b18275e65ae4ebacd9877c"> 4128</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5af5c8c3b18275e65ae4ebacd9877c">ProSHADE_internal_data::ProSHADE_data::setEMatrixValue</a> ( proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_complex val )</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;{</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;    this-&gt;eMatrices[band][order1][order2][0]          = val[0];</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;    this-&gt;eMatrices[band][order1][order2][1]          = val[1];</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;    </div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;    return ;</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;    </div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;}</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160; </div>
<div class="line"><a name="l04146"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb19c915cebcef22c085cc6619cc472"> 4146</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb19c915cebcef22c085cc6619cc472">ProSHADE_internal_data::ProSHADE_data::normaliseEMatrixValue</a> ( proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double normF )</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;{</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;    this-&gt;eMatrices[band][order1][order2][0]         /= normF;</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;    this-&gt;eMatrices[band][order1][order2][1]         /= normF;</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;    </div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;    return ;</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;    </div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;}</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160; </div>
<div class="line"><a name="l04162"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5e27540622190be41ce78157c0807e"> 4162</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5e27540622190be41ce78157c0807e">ProSHADE_internal_data::ProSHADE_data::setSO3CoeffValue</a> ( proshade_unsign position, proshade_complex val )</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;{</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;    this-&gt;so3Coeffs[position][0]                      = val[0];</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;    this-&gt;so3Coeffs[position][1]                      = val[1];</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;    </div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;    return ;</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;    </div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;}</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160; </div>
<div class="line"><a name="l04180"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab3aa4cdcd7cc9b458d7618077dfaab02"> 4180</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab3aa4cdcd7cc9b458d7618077dfaab02">ProSHADE_internal_data::ProSHADE_data::setWignerMatrixValue</a> ( proshade_complex val, proshade_unsign band, proshade_unsign order1, proshade_unsign order2 )</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;{</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;    <span class="comment">//================================================ Mutate</span></div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;    this-&gt;wignerMatrices[band][order1][order2][0]     = val[0];</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;    this-&gt;wignerMatrices[band][order1][order2][1]     = val[1];</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;    </div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;    return ;</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;    </div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;}</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160; </div>
<div class="line"><a name="l04198"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa757f9d32ebe20435661599652fd30fa"> 4198</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa757f9d32ebe20435661599652fd30fa">ProSHADE_internal_data::ProSHADE_data::getRealEMatrixValuesForLM</a> ( proshade_signed band, proshade_signed order1, <span class="keywordtype">double</span> *eMatsLMReal, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;{</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;    {</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;        eMatsLMReal[iter]                             = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;eMatrices[band][order1][iter][0] );</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;    }</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;    </div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;    return ;</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;    </div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;}</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160; </div>
<div class="line"><a name="l04218"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b08a8b6f9569c06cd183c924e6e80de"> 4218</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b08a8b6f9569c06cd183c924e6e80de">ProSHADE_internal_data::ProSHADE_data::getImagEMatrixValuesForLM</a> ( proshade_signed band, proshade_signed order1, <span class="keywordtype">double</span> *eMatsLMImag, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;{</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;    {</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;        eMatsLMImag[iter]                             = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;eMatrices[band][order1][iter][1] );</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;    }</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;    </div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;    return ;</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;    </div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;}</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160; </div>
<div class="line"><a name="l04236"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30eac0ab5b69c1b7190d6e56571ba8b8"> 4236</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30eac0ab5b69c1b7190d6e56571ba8b8">ProSHADE_internal_data::ProSHADE_data::getRealSO3Coeffs</a> ( <span class="keywordtype">double</span> *so3CoefsReal, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;{</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;    {</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;        so3CoefsReal[iter]                            = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;so3Coeffs[iter][0] );</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;    }</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;    </div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;    return ;</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;    </div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;}</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160; </div>
<div class="line"><a name="l04254"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4b76352faa0915b1fef943fe139de5a6"> 4254</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4b76352faa0915b1fef943fe139de5a6">ProSHADE_internal_data::ProSHADE_data::getImagSO3Coeffs</a> ( <span class="keywordtype">double</span> *so3CoefsImag, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;{</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;    {</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;        so3CoefsImag[iter]                            = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;so3Coeffs[iter][1] );</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;    }</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;    </div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;    return ;</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;    </div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;}</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160; </div>
<div class="line"><a name="l04276"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9f6ba75b25e201466929bfd4df75688d"> 4276</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9f6ba75b25e201466929bfd4df75688d">ProSHADE_internal_data::ProSHADE_data::so3CoeffsArrayIndex</a> ( proshade_signed order1, proshade_signed order2, proshade_signed band )</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;{</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> ( so3CoefLoc ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( order1 ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( order2 ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( band ), <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;getMaxBand() ) ) ) );</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;}</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160; </div>
<div class="line"><a name="l04287"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8bc5fbad1079d42bfa73913a9e2df619"> 4287</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8bc5fbad1079d42bfa73913a9e2df619">ProSHADE_internal_data::ProSHADE_data::getRealRotFunction</a> ( <span class="keywordtype">double</span> *rotFunReal, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;{</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;    {</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;        rotFunReal[iter]                              = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;so3CoeffsInverse[iter][0] );</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;    }</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;    </div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;    return ;</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;    </div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;}</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160; </div>
<div class="line"><a name="l04305"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b063d1ca2ebed239029bad6250cf376"> 4305</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b063d1ca2ebed239029bad6250cf376">ProSHADE_internal_data::ProSHADE_data::getImagRotFunction</a> ( <span class="keywordtype">double</span> *rotFunImag, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;{</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;    {</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;        rotFunImag[iter]                              = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;so3CoeffsInverse[iter][1] );</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;    }</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;    </div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;    return ;</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;    </div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;}</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160; </div>
<div class="line"><a name="l04323"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94cce09895dc9f41d4b9a429ccf638e8"> 4323</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94cce09895dc9f41d4b9a429ccf638e8">ProSHADE_internal_data::ProSHADE_data::getRealTranslationFunction</a> ( <span class="keywordtype">double</span> *trsFunReal, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;{</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;    {</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;        trsFunReal[iter]                              = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;translationMap[iter][0] );</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;    }</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;    </div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;    return ;</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;    </div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;}</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160; </div>
<div class="line"><a name="l04341"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a97766b6a74aee4c364c1fd8efd6478ff"> 4341</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a97766b6a74aee4c364c1fd8efd6478ff">ProSHADE_internal_data::ProSHADE_data::getImagTranslationFunction</a> ( <span class="keywordtype">double</span> *trsFunImag, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;{</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;    <span class="comment">//================================================ Save the data into the output array</span></div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;    {</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;        trsFunImag[iter]                              = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( this-&gt;translationMap[iter][1] );</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;    }</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;    </div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;    return ;</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;    </div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;}</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160; </div>
<div class="line"><a name="l04362"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a688bac56d3c483bd99c0ff7d63cf7602"> 4362</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a688bac56d3c483bd99c0ff7d63cf7602">ProSHADE_internal_data::ProSHADE_data::getRotMatrixFromRotFunInds</a> ( proshade_signed aI, proshade_signed bI, proshade_signed gI, <span class="keywordtype">double</span> *rotMat, <span class="keywordtype">int</span> len )</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;{</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;    <span class="comment">//================================================ Get Euler angles</span></div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;    proshade_double eA, eB, eG;</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#acf6c5376edac98e54ef0e418cd05d706">ProSHADE_internal_maths::getEulerZXZFromSOFTPosition</a> ( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span> ( this-&gt;getMaxBand() ), aI, bI, gI, &amp;eA, &amp;eB, &amp;eG );</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;    </div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;    <span class="comment">//================================================ Prepare internal rotation matrix memory</span></div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;    proshade_double* rMat                             = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;    rMat                                              = <span class="keyword">new</span> proshade_double[9];</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rMat, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;    </div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;    <span class="comment">//================================================ Convert to rotation matrix</span></div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a> ( eA, eB, eG, rMat );</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;    </div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;    <span class="comment">//================================================ Copy to output</span></div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( len ); iter++ )</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;    {</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;        rotMat[iter]                                  = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( rMat[iter] );</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;    }</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;    </div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;    <span class="comment">//================================================ Release internal memory</span></div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;    <span class="keyword">delete</span>[] rMat;</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;    </div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;    return ;</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;    </div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;}</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160; </div>
<div class="line"><a name="l04394"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5add825ce8d5e5d9f598f6912f07aff"> 4394</a></span>&#160;std::string <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5add825ce8d5e5d9f598f6912f07aff">ProSHADE_internal_data::ProSHADE_data::getRecommendedSymmetryType</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;{</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;    <span class="keywordflow">return</span>                                            ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac39560ba9aca9053753c158fb2adb9de">recommendedSymmetryType</a> );</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;    </div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;}</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160; </div>
<div class="line"><a name="l04405"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e1bd5bd5a3fd12691a1d83735c13250"> 4405</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e1bd5bd5a3fd12691a1d83735c13250">ProSHADE_internal_data::ProSHADE_data::getRecommendedSymmetryFold</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;{</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;    <span class="keywordflow">return</span>                                            ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac8e62cc8dbd40265e51143c8207b6638">recommendedSymmetryFold</a> );</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;    </div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;}</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160; </div>
<div class="line"><a name="l04417"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1fdcd9bdebc2900748821c5b3cb53cc"> 4417</a></span>&#160;proshade_unsign <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1fdcd9bdebc2900748821c5b3cb53cc">ProSHADE_internal_data::ProSHADE_data::getNoRecommendedSymmetryAxes</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;{</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;    <span class="comment">//================================================ Return the value</span></div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() ) );</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;}</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160; </div>
<div class="line"><a name="l04429"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0662f17e733fb6c1a16f04b273f8b7a5"> 4429</a></span>&#160;std::vector&lt; std::string &gt; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0662f17e733fb6c1a16f04b273f8b7a5">ProSHADE_internal_data::ProSHADE_data::getSymmetryAxis</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, proshade_unsign axisNo )</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;{</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;    <span class="comment">//================================================ Sanity checks</span></div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;    <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.size() ) &lt;= axisNo )</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;    {</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Requested symmetry index does not exist. Returning empty vector.&quot;</span>, <span class="stringliteral">&quot;WS00039&quot;</span> );</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;        <span class="keywordflow">return</span>                                        ( std::vector&lt; std::string &gt; ( ) );</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;    }</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;    </div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;    std::vector&lt; std::string &gt; ret;</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;    </div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;    <span class="comment">//================================================ Input the axis data as strings</span></div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;    std::stringstream ssHlp;</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[0];</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;    </div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[1];</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;    </div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[2];</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;    </div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[3];</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;    </div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[4];</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;    </div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[5];</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;    </div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;    ssHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">detectedSymmetry</a>.at(axisNo)[6];</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a>         ( &amp;ret, ssHlp.str() );</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;    ssHlp.str                                         ( <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;    </div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;    </div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;}</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160; </div>
<div class="line"><a name="l04488"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6160812636f73e33c1c46a754b68a610"> 4488</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6160812636f73e33c1c46a754b68a610">ProSHADE_internal_data::ProSHADE_data::writeOutOverlayFiles</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, proshade_double eulA, proshade_double eulB, proshade_double eulG, std::vector&lt; proshade_double &gt;* rotCentre, std::vector&lt; proshade_double &gt;* ultimateTranslation )</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;{</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;    <span class="comment">//================================================ Write out rotated map</span></div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;    std::stringstream fNameHlp;</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;    fNameHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a833f51d5da64ed09004daa4bf66c013c">overlayStructureName</a> &lt;&lt; <span class="stringliteral">&quot;.map&quot;</span>;</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;    this-&gt;writeMap                                    ( fNameHlp.str() );</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;     </div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;    <span class="comment">//================================================ Write out rotated co-ordinates if possible</span></div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#abc5e6a82b6b44e3666abfc190dc0bc64">ProSHADE_internal_io::isFilePDB</a> ( this-&gt;fileName ) )</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;    {</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;        fNameHlp.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;        fNameHlp &lt;&lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a833f51d5da64ed09004daa4bf66c013c">overlayStructureName</a> &lt;&lt; <span class="stringliteral">&quot;.pdb&quot;</span>;</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;        this-&gt;writePdb                                ( fNameHlp.str(), eulA, eulB, eulG, ultimateTranslation-&gt;at(0), ultimateTranslation-&gt;at(1), ultimateTranslation-&gt;at(2), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">firstModelOnly</a> );</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;    }</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;    </div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;    <span class="comment">//================================================ Write out the json file with the results</span></div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__io.html#a9f714e15a7bc56dbe846fda6bb1d9c9e">ProSHADE_internal_io::writeRotationTranslationJSON</a> ( rotCentre-&gt;at(0), rotCentre-&gt;at(1), rotCentre-&gt;at(2),</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;                                                         eulA, eulB, eulG,</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;                                                         ultimateTranslation-&gt;at(0), ultimateTranslation-&gt;at(1), ultimateTranslation-&gt;at(2),</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;                                                         settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a30a0c63c3ab63d603776c9a16e1e4044">rotTrsJSONFile</a> );</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;    </div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;    return ;</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;    </div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;}</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160; </div>
<div class="line"><a name="l04522"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a43e3cad6f93a32f92194f76f0ec76a32"> 4522</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a43e3cad6f93a32f92194f76f0ec76a32">ProSHADE_internal_data::ProSHADE_data::reportOverlayResults</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector &lt; proshade_double &gt;* rotationCentre, std::vector &lt; proshade_double &gt;* eulerAngles, std::vector &lt; proshade_double &gt;* finalTranslation )</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;{</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;    <span class="comment">//================================================ Empty line</span></div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;    </div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;    <span class="comment">//================================================ Write out rotation centre translation results</span></div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;    std::stringstream rotCen; rotCen &lt;&lt; std::setprecision (3) &lt;&lt; std::showpos &lt;&lt; <span class="stringliteral">&quot;The rotation centre to origin translation vector is:  &quot;</span> &lt;&lt; -rotationCentre-&gt;at(0) &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; -rotationCentre-&gt;at(1) &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; -rotationCentre-&gt;at(2);</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, rotCen.str() );</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;    </div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;    <span class="comment">//================================================ Write out rotation matrix about origin</span></div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;    proshade_double* rotMat                           = <span class="keyword">new</span> proshade_double[9];</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rotMat, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a> ( eulerAngles-&gt;at(0), eulerAngles-&gt;at(1), eulerAngles-&gt;at(2), rotMat );</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;    </div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;    std::stringstream rotMatSS;  </div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;    rotMatSS &lt;&lt; std::setprecision (3) &lt;&lt; std::showpos &lt;&lt; <span class="stringliteral">&quot;The rotation matrix about origin is                 : &quot;</span> &lt;&lt; rotMat[0] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; rotMat[1] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; rotMat[2] &lt;&lt; std::endl;</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;    rotMatSS &lt;&lt; std::setprecision (3) &lt;&lt; std::showpos &lt;&lt; <span class="stringliteral">&quot;                                                    : &quot;</span> &lt;&lt; rotMat[3] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; rotMat[4] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; rotMat[5] &lt;&lt; std::endl;</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;    rotMatSS &lt;&lt; std::setprecision (3) &lt;&lt; std::showpos &lt;&lt; <span class="stringliteral">&quot;                                                    : &quot;</span> &lt;&lt; rotMat[6] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; rotMat[7] &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; rotMat[8];</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, rotMatSS.str() );</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;    </div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;    <span class="keyword">delete</span>[] rotMat;</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;    </div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;    <span class="comment">//================================================ Write out origin to overlay translation results</span></div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;    std::stringstream finTrs; finTrs &lt;&lt; std::setprecision (3) &lt;&lt; std::showpos &lt;&lt; <span class="stringliteral">&quot;The rotation centre to overlay translation vector is: &quot;</span> &lt;&lt; finalTranslation-&gt;at(0) &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; finalTranslation-&gt;at(1) &lt;&lt; <span class="stringliteral">&quot;     &quot;</span> &lt;&lt; finalTranslation-&gt;at(2);</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 0, finTrs.str() );</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;    </div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;    return ;</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;    </div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a671ebb0985408bff451ec359b4df79b9"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a671ebb0985408bff451ec359b4df79b9">ProSHADE_internal_data::ProSHADE_data::findTopGroupSmooth</a></div><div class="ttdeci">proshade_double findTopGroupSmooth(std::vector&lt; proshade_double * &gt; *CSym, size_t peakPos, proshade_double step, proshade_double sigma, proshade_signed windowSize)</div><div class="ttdoc">This function finds the distinct group of axes with highest peak heights.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02332">ProSHADE_data.cpp:2332</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a64323b4117a11f0971cb0d24ec95c64c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a64323b4117a11f0971cb0d24ec95c64c">ProSHADE_internal_data::ProSHADE_data::originalMapYCom</a></div><div class="ttdeci">proshade_double originalMapYCom</div><div class="ttdoc">The COM of the first map to be loaded/computed without any furhter changes being reflacted along the ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00092">ProSHADE_data.hpp:92</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a8324ed7ec9c19df21511f117df80ab11"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a8324ed7ec9c19df21511f117df80ab11">ProSHADE_settings::maxBandwidth</a></div><div class="ttdeci">proshade_unsign maxBandwidth</div><div class="ttdoc">The bandwidth of spherical harmonics decomposition for the largest sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00058">ProSHADE_settings.hpp:58</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a7c88b1152378beca4ccee251f2fb5e06"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a7c88b1152378beca4ccee251f2fb5e06">ProSHADE_internal_mapManip::addExtraBoundSpace</a></div><div class="ttdeci">void addExtraBoundSpace(proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed *&amp;bounds, proshade_single extraSpace)</div><div class="ttdoc">This function takes a set of bounds and adds a given number of Angstroms to them.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01139">ProSHADE_mapManip.cpp:1139</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a23f9a5f8f6fb7cf0f0324bc1d83d6090"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23f9a5f8f6fb7cf0f0324bc1d83d6090">ProSHADE_internal_data::ProSHADE_data::computeSphericalHarmonics</a></div><div class="ttdeci">void computeSphericalHarmonics(ProSHADE_settings *settings)</div><div class="ttdoc">This function computes the spherical harmonics decomposition for the whole structure.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01756">ProSHADE_data.cpp:1756</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a7861a96d94b8f7a8eb2946729c330863"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7861a96d94b8f7a8eb2946729c330863">ProSHADE_internal_data::ProSHADE_data::mapMovFromsChangeX</a></div><div class="ttdeci">proshade_double mapMovFromsChangeX</div><div class="ttdoc">When the map is translated, the xFrom and xTo values are changed. This variable holds how much they h...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00094">ProSHADE_data.hpp:94</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ac39560ba9aca9053753c158fb2adb9de"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ac39560ba9aca9053753c158fb2adb9de">ProSHADE_settings::recommendedSymmetryType</a></div><div class="ttdeci">std::string recommendedSymmetryType</div><div class="ttdoc">The symmetry type that ProSHADE finds the best fitting for the structure. Possible values are &quot;&quot; for ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00125">ProSHADE_settings.hpp:125</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a94a73f81ba80621f5f52173e91bb47f7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94a73f81ba80621f5f52173e91bb47f7">ProSHADE_internal_data::ProSHADE_data::getEMatrixByBand</a></div><div class="ttdeci">proshade_complex ** getEMatrixByBand(proshade_unsign band)</div><div class="ttdoc">This function allows access to E matrix for a particular band.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03827">ProSHADE_data.cpp:3827</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_ad4feb37444a93df167935cf42d1209f6"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ad4feb37444a93df167935cf42d1209f6">ProSHADE_internal_mapManip::determinePDBRanges</a></div><div class="ttdeci">void determinePDBRanges(gemmi::Structure pdbFile, proshade_single *xFrom, proshade_single *xTo, proshade_single *yFrom, proshade_single *yTo, proshade_single *zFrom, proshade_single *zTo, bool firstModel)</div><div class="ttdoc">Function for finding the PDB file ranges.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00072">ProSHADE_mapManip.cpp:72</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae9b0d5959b0f461b3b89ffeb059400fa"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae9b0d5959b0f461b3b89ffeb059400fa">ProSHADE_internal_data::ProSHADE_data::fileName</a></div><div class="ttdeci">std::string fileName</div><div class="ttdoc">This is the original file from which the data were obtained.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00052">ProSHADE_data.hpp:52</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a14980cdf619bcda026b9aad282c2064b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">ProSHADE_internal_data::ProSHADE_data::zFrom</a></div><div class="ttdeci">proshade_signed zFrom</div><div class="ttdoc">This is the starting index along the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00112">ProSHADE_data.hpp:112</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a30a0c63c3ab63d603776c9a16e1e4044"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a30a0c63c3ab63d603776c9a16e1e4044">ProSHADE_settings::rotTrsJSONFile</a></div><div class="ttdeci">std::string rotTrsJSONFile</div><div class="ttdoc">The filename to which the rotation and translation operations are to be saved into.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00137">ProSHADE_settings.hpp:137</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aceb7facd99379a000035ce35263577d5"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb7facd99379a000035ce35263577d5">ProSHADE_internal_data::ProSHADE_data::xDimIndices</a></div><div class="ttdeci">proshade_unsign xDimIndices</div><div class="ttdoc">This is the size of the map cell x dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00065">ProSHADE_data.hpp:65</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_af4d641d62864e4adf67c1365b0960970"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">ProSHADE_internal_data::ProSHADE_data::getZDimSize</a></div><div class="ttdeci">proshade_single getZDimSize(void)</div><div class="ttdoc">This function allows access to the map size in angstroms along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03929">ProSHADE_data.cpp:3929</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_afe3659ed2939880f96701cb162d8a12d"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#afe3659ed2939880f96701cb162d8a12d">ProSHADE_internal_mapManip::changePDBBFactors</a></div><div class="ttdeci">void changePDBBFactors(gemmi::Structure *pdbFile, proshade_double newBFactorValue, bool firstModel)</div><div class="ttdoc">Function for changing the PDB B-factor values to a specific single value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00444">ProSHADE_mapManip.cpp:444</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a530ad7e3396cbcbc1814051031070a8b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a530ad7e3396cbcbc1814051031070a8b">ProSHADE_internal_data::ProSHADE_data::zDimSizeOriginal</a></div><div class="ttdeci">proshade_single zDimSizeOriginal</div><div class="ttdoc">This is the size of the map cell z dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00084">ProSHADE_data.hpp:84</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a8a7c6330e101fb6d729aaf6f545db9c8"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a8a7c6330e101fb6d729aaf6f545db9c8">ProSHADE_internal_maths::vectorMeanAndSD</a></div><div class="ttdeci">void vectorMeanAndSD(std::vector&lt; proshade_double &gt; *vec, proshade_double *&amp;ret)</div><div class="ttdoc">Function to get vector mean and standard deviation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00121">ProSHADE_maths.cpp:121</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3349a7f6ffecc3ffd4e09192eb919248"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3349a7f6ffecc3ffd4e09192eb919248">ProSHADE_internal_data::ProSHADE_data::createNewMapFromBounds</a></div><div class="ttdeci">void createNewMapFromBounds(ProSHADE_settings *settings, ProSHADE_data *&amp;newStr, proshade_signed *newBounds)</div><div class="ttdoc">This function creates a new structure from the calling structure and new bounds values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01300">ProSHADE_data.cpp:1300</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_abc5e6a82b6b44e3666abfc190dc0bc64"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#abc5e6a82b6b44e3666abfc190dc0bc64">ProSHADE_internal_io::isFilePDB</a></div><div class="ttdeci">bool isFilePDB(std::string fName)</div><div class="ttdoc">Function determining if the input data type is PDB.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00032">ProSHADE_io.cpp:32</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aedb2ba02e77d5795077df91b2578ab29"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aedb2ba02e77d5795077df91b2578ab29">ProSHADE_internal_data::ProSHADE_data::xGridIndices</a></div><div class="ttdeci">proshade_unsign xGridIndices</div><div class="ttdoc">As far as I know, this is identical to the xDimIndices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00068">ProSHADE_data.hpp:68</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a37f26ac4bc76e4f4c5da77dd0eace56e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37f26ac4bc76e4f4c5da77dd0eace56e">ProSHADE_internal_data::ProSHADE_data::translationMap</a></div><div class="ttdeci">proshade_complex * translationMap</div><div class="ttdoc">This is where the translation map will be held, if at all used.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00133">ProSHADE_data.hpp:133</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__data_html_ac2cdde3bc58869b04f1aa39aee9b01bc"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__data.html#ac2cdde3bc58869b04f1aa39aee9b01bc">ProSHADE_internal_data::joinElementsFromDifferentGroups</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; joinElementsFromDifferentGroups(std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *first, std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *second, proshade_double matrixTolerance, bool combine)</div><div class="ttdoc">This function joins two group element lists using only unique elements.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03133">ProSHADE_data.cpp:3133</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a603841095e16abd0492dfc6db052fda7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a603841095e16abd0492dfc6db052fda7">ProSHADE_internal_data::ProSHADE_data::xAxisOrder</a></div><div class="ttdeci">proshade_unsign xAxisOrder</div><div class="ttdoc">This is the order of the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00071">ProSHADE_data.hpp:71</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a94b04108aa1a9406eb3c5eb61749140b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94b04108aa1a9406eb3c5eb61749140b">ProSHADE_internal_data::ProSHADE_data::rotSphericalHarmonics</a></div><div class="ttdeci">proshade_complex ** rotSphericalHarmonics</div><div class="ttdoc">A set of rotated spherical harmonics values arrays for each sphere, used only if map rotation is requ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00122">ProSHADE_data.hpp:122</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac0dc9f3ed79cc98719e6b727bb8bb982"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac0dc9f3ed79cc98719e6b727bb8bb982">ProSHADE_internal_data::ProSHADE_data::getReBoxBoundaries</a></div><div class="ttdeci">void getReBoxBoundaries(ProSHADE_settings *settings, proshade_signed *&amp;ret)</div><div class="ttdoc">This function finds the boundaries enclosing positive map values and adds some extra space.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01242">ProSHADE_data.cpp:1242</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a450e03005d24cc3e58d2d05fb3bc5027"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a450e03005d24cc3e58d2d05fb3bc5027">ProSHADE_settings::determineAllSHValues</a></div><div class="ttdeci">void determineAllSHValues(proshade_unsign xDim, proshade_unsign yDim, proshade_single xDimAngs, proshade_single yDimAngs, proshade_single zDimAngs)</div><div class="ttdoc">This function determines all the required values for spherical harmonics computation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l01612">ProSHADE.cpp:1612</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a6cc2b8e179a137adda234e0ba0f9d27b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6cc2b8e179a137adda234e0ba0f9d27b">ProSHADE_internal_data::ProSHADE_data::getComparisonBand</a></div><div class="ttdeci">proshade_unsign getComparisonBand(void)</div><div class="ttdoc">This function allows access to the maximum band for the comparison.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03879">ProSHADE_data.cpp:3879</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8e1bd5bd5a3fd12691a1d83735c13250"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e1bd5bd5a3fd12691a1d83735c13250">ProSHADE_internal_data::ProSHADE_data::getRecommendedSymmetryFold</a></div><div class="ttdeci">proshade_unsign getRecommendedSymmetryFold(ProSHADE_settings *settings)</div><div class="ttdoc">This function simply returns the detected recommended symmetry fold.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04405">ProSHADE_data.cpp:4405</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5f934f331c4d3bc7c0a6f63486b2f90e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f934f331c4d3bc7c0a6f63486b2f90e">ProSHADE_internal_data::ProSHADE_data::sphericalHarmonics</a></div><div class="ttdeci">proshade_complex ** sphericalHarmonics</div><div class="ttdoc">A set of spherical harmonics values arrays for each sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00121">ProSHADE_data.hpp:121</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3e7b1d5d4164ea7a6fda53c57ac979f4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e7b1d5d4164ea7a6fda53c57ac979f4">ProSHADE_internal_data::ProSHADE_data::setIntegrationWeight</a></div><div class="ttdeci">void setIntegrationWeight(proshade_double intW)</div><div class="ttdoc">This function allows setting the integration weight for the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04097">ProSHADE_data.cpp:4097</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a262b3b0e1129d4d3a5830a8982395f01"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a262b3b0e1129d4d3a5830a8982395f01">ProSHADE_internal_data::ProSHADE_data::saveRecommendedSymmetry</a></div><div class="ttdeci">void saveRecommendedSymmetry(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSym, std::vector&lt; proshade_double * &gt; *DSym, std::vector&lt; proshade_double * &gt; *TSym, std::vector&lt; proshade_double * &gt; *OSym, std::vector&lt; proshade_double * &gt; *ISym, std::vector&lt; proshade_double * &gt; *axes, fftw_complex *mapData, fftw_complex *origCoeffs, fftw_complex *fCoeffs, fftw_plan *planForwardFourier, proshade_signed noBins, proshade_signed *binIndexing, proshade_double **bindata, proshade_signed *binCounts)</div><div class="ttdoc">This function takes all the detected symmetry results and decides on which are to be recommended for ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02627">ProSHADE_data.cpp:2627</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8e2f99f00dd05198b508633cf7f6f080"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8e2f99f00dd05198b508633cf7f6f080">ProSHADE_internal_data::ProSHADE_data::cAngle</a></div><div class="ttdeci">proshade_single cAngle</div><div class="ttdoc">This is the angle c of the map cell in degrees.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00064">ProSHADE_data.hpp:64</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a33312dd4333617b460628e4db4bf41fc"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a33312dd4333617b460628e4db4bf41fc">ProSHADE_internal_data::ProSHADE_data::so3CoeffsInverse</a></div><div class="ttdeci">proshade_complex * so3CoeffsInverse</div><div class="ttdoc">The inverse coefficients obtained by inverse SO(3) Fourier Transform (SOFT) - i.e....</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00130">ProSHADE_data.hpp:130</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a51b1eb3cb274c1c68e85cf3cca0c25b7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51b1eb3cb274c1c68e85cf3cca0c25b7">ProSHADE_internal_data::ProSHADE_data::prepareFSCFourierMemory</a></div><div class="ttdeci">void prepareFSCFourierMemory(fftw_complex *&amp;mapData, fftw_complex *&amp;origCoeffs, fftw_complex *&amp;fCoeffs, proshade_signed *&amp;binIndexing, proshade_signed *noBins, proshade_double **&amp;bindata, proshade_signed *&amp;binCounts, fftw_plan *planForwardFourier)</div><div class="ttdoc">This function allocates the memory and makes all preparations required for FSC computation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02388">ProSHADE_data.cpp:2388</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8a1405b3974697f41c4a73da0cb52a32"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a1405b3974697f41c4a73da0cb52a32">ProSHADE_internal_data::ProSHADE_data::getXAxisOrigin</a></div><div class="ttdeci">proshade_signed * getXAxisOrigin(void)</div><div class="ttdoc">This function allows access to the map X axis origin value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04029">ProSHADE_data.cpp:4029</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a262d9e21cd6b81b8bda35ec22eb363dd"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a></div><div class="ttdeci">proshade_signed addAxisUnlessSame(proshade_unsign fold, proshade_double axX, proshade_double axY, proshade_double axZ, proshade_double axHeight, proshade_double averageFSC, std::vector&lt; proshade_double * &gt; *prosp, proshade_double axErr)</div><div class="ttdoc">This function simply creates a new axis from information in aruments and tests if no such axis alread...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02648">ProSHADE_symmetry.cpp:2648</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aceb19c915cebcef22c085cc6619cc472"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aceb19c915cebcef22c085cc6619cc472">ProSHADE_internal_data::ProSHADE_data::normaliseEMatrixValue</a></div><div class="ttdeci">void normaliseEMatrixValue(proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double normF)</div><div class="ttdoc">This function allows normalising the E matrix value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04146">ProSHADE_data.cpp:4146</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a668381d94a927275b3d839549475c7da"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668381d94a927275b3d839549475c7da">ProSHADE_internal_data::ProSHADE_data::yCom</a></div><div class="ttdeci">proshade_double yCom</div><div class="ttdoc">The COM of the map after processing along the Y-axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00078">ProSHADE_data.hpp:78</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a633435d4c8a7fd6533016c00ad9ba791"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a633435d4c8a7fd6533016c00ad9ba791">ProSHADE_settings::boundsExtraSpace</a></div><div class="ttdeci">proshade_single boundsExtraSpace</div><div class="ttdoc">The number of extra angstroms to be added to all re-boxing bounds just for safety.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00090">ProSHADE_settings.hpp:90</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__exception_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a></div><div class="ttdoc">This class is the representation of ProSHADE exception.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__exceptions_8hpp_source.html#l00036">ProSHADE_exceptions.hpp:37</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a97766b6a74aee4c364c1fd8efd6478ff"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a97766b6a74aee4c364c1fd8efd6478ff">ProSHADE_internal_data::ProSHADE_data::getImagTranslationFunction</a></div><div class="ttdeci">void getImagTranslationFunction(double *trsFunImag, int len)</div><div class="ttdoc">This function fills the input array with the imaginary translation function values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04341">ProSHADE_data.cpp:4341</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ab3aa4cdcd7cc9b458d7618077dfaab02"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab3aa4cdcd7cc9b458d7618077dfaab02">ProSHADE_internal_data::ProSHADE_data::setWignerMatrixValue</a></div><div class="ttdeci">void setWignerMatrixValue(proshade_complex val, proshade_unsign band, proshade_unsign order1, proshade_unsign order2)</div><div class="ttdoc">This function allows setting the Wigner D matrix value by its band, order1 and order2 co-ordinate.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04180">ProSHADE_data.cpp:4180</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a618c04a2c1d7f0a506d0bb3d7a0da444"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">ProSHADE_settings::allDetectedDAxes</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; allDetectedDAxes</div><div class="ttdoc">The vector of all detected dihedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00146">ProSHADE_settings.hpp:146</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a51c87d0b415c8eaa517dbb9b5496e7e9"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a51c87d0b415c8eaa517dbb9b5496e7e9">ProSHADE_settings::blurFactor</a></div><div class="ttdeci">proshade_single blurFactor</div><div class="ttdoc">This is the amount by which B-factors should be increased to create the blurred map for masking.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00078">ProSHADE_settings.hpp:78</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a0b0608e80f20087b24cc9498767f0894"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0b0608e80f20087b24cc9498767f0894">ProSHADE_internal_data::ProSHADE_data::saveDetectedSymmetries</a></div><div class="ttdeci">void saveDetectedSymmetries(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSyms, std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *allCs)</div><div class="ttdoc">This function takes the results of point group searches and saves then into the output variables.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02286">ProSHADE_data.cpp:2286</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a7c941c912cd17ad86057b8d7a15b9a21"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a7c941c912cd17ad86057b8d7a15b9a21">ProSHADE_settings::maskMap</a></div><div class="ttdeci">bool maskMap</div><div class="ttdoc">Should the map be masked from noise?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00080">ProSHADE_settings.hpp:80</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a6dc170d9826bad9ce4a2c31a033f7f6a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a6dc170d9826bad9ce4a2c31a033f7f6a">ProSHADE_settings::requestedSymmetryFold</a></div><div class="ttdeci">proshade_unsign requestedSymmetryFold</div><div class="ttdoc">The fold of the requested symmetry (only applicable to C and D symmetry types).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00128">ProSHADE_settings.hpp:128</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ab59297b3604ced939e30eaacd2eaaccb"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ab59297b3604ced939e30eaacd2eaaccb">ProSHADE_settings::requestedSymmetryType</a></div><div class="ttdeci">std::string requestedSymmetryType</div><div class="ttdoc">The symmetry type requested by the user. Allowed values are C, D, T, O and I.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00127">ProSHADE_settings.hpp:127</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ab053362f9dc5422244ccfbafd9f00ff8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab053362f9dc5422244ccfbafd9f00ff8">ProSHADE_internal_data::ProSHADE_data::getEMatrixValue</a></div><div class="ttdeci">void getEMatrixValue(proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double *valueReal, proshade_double *valueImag)</div><div class="ttdoc">This function allows access to E matrix by knowing the band, order1 and order2 indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03842">ProSHADE_data.cpp:3842</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a51d7b9d87d536ef0c48d820872bc9185"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">ProSHADE_internal_data::ProSHADE_data::getXDimSize</a></div><div class="ttdeci">proshade_single getXDimSize(void)</div><div class="ttdoc">This function allows access to the map size in angstroms along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03909">ProSHADE_data.cpp:3909</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1bb8bf1e357cc25f68fe93554e44715d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1bb8bf1e357cc25f68fe93554e44715d">ProSHADE_internal_data::ProSHADE_data::getInternalMap</a></div><div class="ttdeci">proshade_double *&amp; getInternalMap(void)</div><div class="ttdoc">This function allows access to the first map array value address.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04059">ProSHADE_data.cpp:4059</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a></div><div class="ttdoc">This class contains all inputed and derived data for a single structure.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00048">ProSHADE_data.hpp:49</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a411b398b06557387320b56c6b8233fc4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a411b398b06557387320b56c6b8233fc4">ProSHADE_internal_data::ProSHADE_data::noSpheres</a></div><div class="ttdeci">proshade_unsign noSpheres</div><div class="ttdoc">The number of spheres with map projected onto them.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00119">ProSHADE_data.hpp:119</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ad42474a333f9b605ccad7ecfb72afb2e"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ad42474a333f9b605ccad7ecfb72afb2e">ProSHADE_settings::removeNegativeDensity</a></div><div class="ttdeci">bool removeNegativeDensity</div><div class="ttdoc">Should the negative density be removed from input files?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00047">ProSHADE_settings.hpp:47</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae477e3c0d7b866e6069d8603950afe51"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">ProSHADE_internal_data::ProSHADE_data::getYDimSize</a></div><div class="ttdeci">proshade_single getYDimSize(void)</div><div class="ttdoc">This function allows access to the map size in angstroms along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03919">ProSHADE_data.cpp:3919</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a42699d52d1be0d24e58deea4e25439bf"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a42699d52d1be0d24e58deea4e25439bf">ProSHADE_internal_mapManip::getMaskFromBlurr</a></div><div class="ttdeci">void getMaskFromBlurr(proshade_double *&amp;blurMap, proshade_double *&amp;outMap, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_single noIQRs)</div><div class="ttdoc">Function for computing mask from blurred map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01032">ProSHADE_mapManip.cpp:1032</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a60643383ab239888adeee6e757876c80"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a60643383ab239888adeee6e757876c80">ProSHADE_internal_data::ProSHADE_data::computeFSC</a></div><div class="ttdeci">proshade_double computeFSC(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSym, size_t symIndex, fftw_complex *mapData, fftw_complex *fCoeffs, fftw_complex *origCoeffs, fftw_plan *planForwardFourier, proshade_signed noBins, proshade_signed *binIndexing, proshade_double **&amp;bindata, proshade_signed *&amp;binCounts)</div><div class="ttdoc">This function computes FSC for any given axis in the supplied CSym symmetry axes vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02456">ProSHADE_data.cpp:2456</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a20fd31138680dd622058732eba31dca5"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a20fd31138680dd622058732eba31dca5">ProSHADE_internal_data::ProSHADE_data::zDimSize</a></div><div class="ttdeci">proshade_single zDimSize</div><div class="ttdoc">This is the size of the map cell z dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00061">ProSHADE_data.hpp:61</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad5416490eb3eba7539d08a5b324fbadb"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5416490eb3eba7539d08a5b324fbadb">ProSHADE_internal_data::ProSHADE_data::so3Coeffs</a></div><div class="ttdeci">proshade_complex * so3Coeffs</div><div class="ttdoc">The coefficients obtained by SO(3) Fourier Transform (SOFT), in this case derived from the E matrices...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00129">ProSHADE_data.hpp:129</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2245b15f279de574406204156089e5ef"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2245b15f279de574406204156089e5ef">ProSHADE_internal_data::ProSHADE_data::getMaxSpheres</a></div><div class="ttdeci">proshade_unsign getMaxSpheres(void)</div><div class="ttdoc">This function returns the number of spheres which contain the whole object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03609">ProSHADE_data.cpp:3609</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aca5e27540622190be41ce78157c0807e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5e27540622190be41ce78157c0807e">ProSHADE_internal_data::ProSHADE_data::setSO3CoeffValue</a></div><div class="ttdeci">void setSO3CoeffValue(proshade_unsign position, proshade_complex val)</div><div class="ttdoc">This function allows setting the SOFT coefficient values using array position and value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04162">ProSHADE_data.cpp:4162</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a29445fb6221eed35a32147814a3f58d5"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a29445fb6221eed35a32147814a3f58d5">ProSHADE_settings::saveMask</a></div><div class="ttdeci">bool saveMask</div><div class="ttdoc">Should the mask be saved?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00084">ProSHADE_settings.hpp:84</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a7d0a63b2ac89e4f0df85ce5053c6bd87"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a7d0a63b2ac89e4f0df85ce5053c6bd87">ProSHADE_settings::requestedResolution</a></div><div class="ttdeci">proshade_single requestedResolution</div><div class="ttdoc">The resolution to which the calculations are to be done.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00050">ProSHADE_settings.hpp:50</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a471ec29b27c3a402d18b20fee8035f1a"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a471ec29b27c3a402d18b20fee8035f1a">ProSHADE_internal_data::ProSHADE_data::mapCOMProcessChangeX</a></div><div class="ttdeci">proshade_double mapCOMProcessChangeX</div><div class="ttdoc">The change in X axis between the creation of the structure (originalMapXCom) and just before rotation...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00097">ProSHADE_data.hpp:97</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_aaad67127777eab70acca5952a7838d26"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aaad67127777eab70acca5952a7838d26">ProSHADE_internal_mapManip::findMAPCOMValues</a></div><div class="ttdeci">void findMAPCOMValues(proshade_double *map, proshade_double *xCom, proshade_double *yCom, proshade_double *zCom, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed xFrom, proshade_signed xTo, proshade_signed yFrom, proshade_signed yTo, proshade_signed zFrom, proshade_signed zTo)</div><div class="ttdoc">This function finds the Centre of Mass for a map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00240">ProSHADE_mapManip.cpp:240</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_afdac8ed8f140bdcd289ee666b61789d4"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#afdac8ed8f140bdcd289ee666b61789d4">ProSHADE_internal_mapManip::blurSharpenMap</a></div><div class="ttdeci">void blurSharpenMap(proshade_double *&amp;map, proshade_double *&amp;maskedMap, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_single blurringFactor)</div><div class="ttdoc">Function for blurring/sharpening maps.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00932">ProSHADE_mapManip.cpp:932</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2a3fdf194eca61b1ccfa5bdd2f586e0b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2a3fdf194eca61b1ccfa5bdd2f586e0b">ProSHADE_internal_data::ProSHADE_data::originalMapXCom</a></div><div class="ttdeci">proshade_double originalMapXCom</div><div class="ttdoc">The COM of the first map to be loaded/computed without any furhter changes being reflacted along the ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00091">ProSHADE_data.hpp:91</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a688bac56d3c483bd99c0ff7d63cf7602"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a688bac56d3c483bd99c0ff7d63cf7602">ProSHADE_internal_data::ProSHADE_data::getRotMatrixFromRotFunInds</a></div><div class="ttdeci">void getRotMatrixFromRotFunInds(proshade_signed aI, proshade_signed bI, proshade_signed gI, double *rotMat, int len)</div><div class="ttdoc">This function takes rotation function indices, converts them to Euler angles and these to rotation ma...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04362">ProSHADE_data.cpp:4362</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_aaacee048ce8a3489edc77afcb54f0ca0"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#aaacee048ce8a3489edc77afcb54f0ca0">ProSHADE_settings::setDetectedSymmetry</a></div><div class="ttdeci">void setDetectedSymmetry(proshade_double *sym)</div><div class="ttdoc">Sets the final detected symmetry axes information.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l01294">ProSHADE.cpp:1294</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9598e9a38546e3bf260bc09c0c9366a2"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9598e9a38546e3bf260bc09c0c9366a2">ProSHADE_internal_data::ProSHADE_data::xDimIndicesOriginal</a></div><div class="ttdeci">proshade_unsign xDimIndicesOriginal</div><div class="ttdoc">This is the size of the map cell x dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00085">ProSHADE_data.hpp:85</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a94dfbe2867f4e294dbb49284881fcb2a"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a></div><div class="ttdeci">void moveMapByFourier(proshade_double *&amp;map, proshade_single xMov, proshade_single yMov, proshade_single zMov, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed xDim, proshade_signed yDim, proshade_signed zDim)</div><div class="ttdoc">Function for moving map back to original PDB location by using Fourier transformation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00811">ProSHADE_mapManip.cpp:811</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a23620b34a604aca7db4d8b21f6d2d09a"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23620b34a604aca7db4d8b21f6d2d09a">ProSHADE_internal_data::ProSHADE_data::getAnySphereRadius</a></div><div class="ttdeci">proshade_double getAnySphereRadius(proshade_unsign shell)</div><div class="ttdoc">This function allows access to the radius of any particular sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03780">ProSHADE_data.cpp:3780</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a2f1e4debc49664de8842d1b42be74d2d"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a2f1e4debc49664de8842d1b42be74d2d">ProSHADE_settings::progressiveSphereMapping</a></div><div class="ttdeci">bool progressiveSphereMapping</div><div class="ttdoc">If true, each shell will have its own angular resolution dependent on the actual number of map points...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00102">ProSHADE_settings.hpp:102</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a1f9e6ab7a6db084069402d83ad152c01"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a1f9e6ab7a6db084069402d83ad152c01">ProSHADE_internal_mapManip::movePDBForMapCalc</a></div><div class="ttdeci">void movePDBForMapCalc(gemmi::Structure *pdbFile, proshade_single xMov, proshade_single yMov, proshade_single zMov, bool firstModel)</div><div class="ttdoc">Function for moving co-ordinate atoms to better suit theoretical map computation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00573">ProSHADE_mapManip.cpp:573</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae5c9c45b0db1e6a9eeef2ba292fbbcc3"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae5c9c45b0db1e6a9eeef2ba292fbbcc3">ProSHADE_internal_data::ProSHADE_data::getSO3Coeffs</a></div><div class="ttdeci">proshade_complex * getSO3Coeffs(void)</div><div class="ttdoc">This function allows access to the SO(3) coefficients array.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03868">ProSHADE_data.cpp:3868</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a42e4b11981a2d3a518cb3c70e5470fb2"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a42e4b11981a2d3a518cb3c70e5470fb2">ProSHADE_settings::maxSphereDists</a></div><div class="ttdeci">proshade_single maxSphereDists</div><div class="ttdoc">The distance between spheres in spherical mapping for the largest sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00065">ProSHADE_settings.hpp:65</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a367d0cd13e3d7a2648488980220ca69b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">ProSHADE_internal_data::ProSHADE_data::maxShellBand</a></div><div class="ttdeci">proshade_unsign maxShellBand</div><div class="ttdoc">The maximum band for any shell of the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00123">ProSHADE_data.hpp:123</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a77cabdd70039e82f8c0cbb07fefd3960"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a77cabdd70039e82f8c0cbb07fefd3960">ProSHADE_internal_data::ProSHADE_data::originalPdbRotCenY</a></div><div class="ttdeci">proshade_double originalPdbRotCenY</div><div class="ttdoc">The centre of rotation as it relates to the original PDB positions (and not the ProSHADE internal map...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00103">ProSHADE_data.hpp:103</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a188b648a0ad28b598d682ca14f288dc4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a188b648a0ad28b598d682ca14f288dc4">ProSHADE_internal_data::ProSHADE_data::getSpherePositions</a></div><div class="ttdeci">void getSpherePositions(ProSHADE_settings *settings)</div><div class="ttdoc">This function determines the sphere positions (radii) for sphere mapping.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01655">ProSHADE_data.cpp:1655</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa67115a6b234764c958899863fb60b54"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa67115a6b234764c958899863fb60b54">ProSHADE_internal_data::ProSHADE_data::invertMirrorMap</a></div><div class="ttdeci">void invertMirrorMap(ProSHADE_settings *settings)</div><div class="ttdoc">Function for inverting the map to its mirror image.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01101">ProSHADE_data.cpp:1101</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_abd9fe573a48f499dd7d1df4f779222f1"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a></div><div class="ttdeci">void getRotationMatrixFromEulerZXZAngles(proshade_double eulerAlpha, proshade_double eulerBeta, proshade_double eulerGamma, proshade_double *matrix)</div><div class="ttdoc">Function to find the rotation matrix from Euler angles (ZXZ convention).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01011">ProSHADE_maths.cpp:1011</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__data_8cpp_html_aa430bcd7dc43633680907360656b7799"><div class="ttname"><a href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a></div><div class="ttdeci">bool checkElementsFormGroup(std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *elements, proshade_double matrixTolerance)</div><div class="ttdoc">This function checks if all group element products produce another group element.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03092">ProSHADE_data.cpp:3092</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a4bd7a9a5ea6cac4302ec1cd80922c617"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4bd7a9a5ea6cac4302ec1cd80922c617">ProSHADE_internal_data::ProSHADE_data::getMapCOMProcessChange</a></div><div class="ttdeci">std::vector&lt; proshade_double &gt; getMapCOMProcessChange(void)</div><div class="ttdoc">This function allows access to the translation caused by structure processing.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04079">ProSHADE_data.cpp:4079</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a51fec3f0a115640181f6e7ce102e4b37"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51fec3f0a115640181f6e7ce102e4b37">ProSHADE_internal_data::ProSHADE_data::saveRequestedSymmetryD</a></div><div class="ttdeci">void saveRequestedSymmetryD(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *DSym, std::vector&lt; proshade_double * &gt; *axes, fftw_complex *mapData, fftw_complex *origCoeffs, fftw_complex *fCoeffs, fftw_plan *planForwardFourier, proshade_signed noBins, proshade_signed *binIndexing, proshade_double **bindata, proshade_signed *binCounts)</div><div class="ttdoc">This function takes the D symmetries and searched for the requested symmetry.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02917">ProSHADE_data.cpp:2917</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a487131ae5dc44f8667908bf64725b4ab"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a487131ae5dc44f8667908bf64725b4ab">ProSHADE_internal_data::ProSHADE_data::mapCOMProcessChangeZ</a></div><div class="ttdeci">proshade_double mapCOMProcessChangeZ</div><div class="ttdoc">The change in Z axis between the creation of the structure (originalMapZCom) and just before rotation...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00099">ProSHADE_data.hpp:99</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a7c96697585083a53f83556e70e4faca8"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a7c96697585083a53f83556e70e4faca8">ProSHADE_settings::maskingThresholdIQRs</a></div><div class="ttdeci">proshade_single maskingThresholdIQRs</div><div class="ttdoc">Number of inter-quartile ranges from the median to be used for thresholding the blurred map for maski...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00079">ProSHADE_settings.hpp:79</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a2019a6bae1b3e6f7d8805ae2734b769e"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a2019a6bae1b3e6f7d8805ae2734b769e">ProSHADE_settings::usePhase</a></div><div class="ttdeci">bool usePhase</div><div class="ttdoc">If true, the full data will be used, if false, Patterson maps will be used instead and phased data wi...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00062">ProSHADE_settings.hpp:62</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1ae6821c27e7facf63839c9fc678c9c7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ae6821c27e7facf63839c9fc678c9c7">ProSHADE_internal_data::ProSHADE_data::xDimSizeOriginal</a></div><div class="ttdeci">proshade_single xDimSizeOriginal</div><div class="ttdoc">This is the size of the map cell x dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00082">ProSHADE_data.hpp:82</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ae42ba1e294d1887c71b763f9bb5519cc"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">ProSHADE_settings::allDetectedTAxes</a></div><div class="ttdeci">std::vector&lt; proshade_unsign &gt; allDetectedTAxes</div><div class="ttdoc">The vector of all detected tetrahedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00147">ProSHADE_settings.hpp:147</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__messages_html_addbb90f2b4199441f60e241ac850daa2"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a></div><div class="ttdeci">void printWarningMessage(proshade_signed verbose, std::string message, std::string warnCode)</div><div class="ttdoc">General stderr message printing (used for warnings).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__messages_8cpp_source.html#l00101">ProSHADE_messages.cpp:101</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa150cfc5715420cf3d2e28c8af3631c4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa150cfc5715420cf3d2e28c8af3631c4">ProSHADE_internal_data::ProSHADE_data::getIntegrationWeight</a></div><div class="ttdeci">proshade_double getIntegrationWeight(void)</div><div class="ttdoc">This function allows access to the integration weight for the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03791">ProSHADE_data.cpp:3791</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a63ae2cc7f413d224e5d651ed579e9afb"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a63ae2cc7f413d224e5d651ed579e9afb">ProSHADE_internal_io::figureDataType</a></div><div class="ttdeci">InputType figureDataType(std::string fName)</div><div class="ttdoc">Function determining input data type.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00356">ProSHADE_io.cpp:356</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a737ee01d968fef7ae1094847a0271033"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a737ee01d968fef7ae1094847a0271033">ProSHADE_internal_data::ProSHADE_data::setIntegrationWeightCumul</a></div><div class="ttdeci">void setIntegrationWeightCumul(proshade_double intW)</div><div class="ttdoc">This function allows setting the cumulative integration weight for the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04111">ProSHADE_data.cpp:4111</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a5db74cc13dd4b64cf0a8377ed078b47c"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a5db74cc13dd4b64cf0a8377ed078b47c">ProSHADE_internal_mapManip::reSampleMapToResolutionTrilinear</a></div><div class="ttdeci">void reSampleMapToResolutionTrilinear(proshade_double *&amp;map, proshade_single resolution, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_single *&amp;corrs)</div><div class="ttdoc">This function re-samples a map to conform to given resolution using tri-linear interpolation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01175">ProSHADE_mapManip.cpp:1175</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aed1c8e0ffb847b093a736c5156f86e9b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aed1c8e0ffb847b093a736c5156f86e9b">ProSHADE_internal_data::ProSHADE_data::zAxisOriginOriginal</a></div><div class="ttdeci">proshade_signed zAxisOriginOriginal</div><div class="ttdoc">This is the origin position along the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00090">ProSHADE_data.hpp:90</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__sphere.html">ProSHADE_internal_spheres::ProSHADE_sphere</a></div><div class="ttdoc">This class contains all inputed and derived data for a single sphere.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spheres_8hpp_source.html#l00048">ProSHADE_spheres.hpp:49</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a0662f17e733fb6c1a16f04b273f8b7a5"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0662f17e733fb6c1a16f04b273f8b7a5">ProSHADE_internal_data::ProSHADE_data::getSymmetryAxis</a></div><div class="ttdeci">std::vector&lt; std::string &gt; getSymmetryAxis(ProSHADE_settings *settings, proshade_unsign axisNo)</div><div class="ttdoc">This function returns a single symmetry axis as a vector of strings from the recommended symmetry axe...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04429">ProSHADE_data.cpp:4429</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_affb17d9099f0b85b3af04a78d5c670f4"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#affb17d9099f0b85b3af04a78d5c670f4">ProSHADE_settings::maskFileName</a></div><div class="ttdeci">std::string maskFileName</div><div class="ttdoc">The filename to which mask should be saved.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00085">ProSHADE_settings.hpp:85</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a4d869a528d0af64bc3688a9a48514061"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">ProSHADE_settings::allDetectedOAxes</a></div><div class="ttdeci">std::vector&lt; proshade_unsign &gt; allDetectedOAxes</div><div class="ttdoc">The vector of all detected octahedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00148">ProSHADE_settings.hpp:148</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a82b2d8f8c05da2eccb5561e6455b4d44"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a82b2d8f8c05da2eccb5561e6455b4d44">ProSHADE_internal_data::ProSHADE_data::eMatrices</a></div><div class="ttdeci">proshade_complex *** eMatrices</div><div class="ttdoc">The trace sigma and full rotation function c*conj(c) integral tables.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00127">ProSHADE_data.hpp:127</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a80ff45ef40549fb6a1d80b70865fc807"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a80ff45ef40549fb6a1d80b70865fc807">ProSHADE_internal_data::ProSHADE_data::centreMapOnCOM</a></div><div class="ttdeci">void centreMapOnCOM(ProSHADE_settings *settings)</div><div class="ttdoc">This function shits the map so that its COM is in the centre of the map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01438">ProSHADE_data.cpp:1438</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a4c89c860da1836b30a9b2889d3e873ed"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4c89c860da1836b30a9b2889d3e873ed">ProSHADE_internal_data::ProSHADE_data::getXFromPtr</a></div><div class="ttdeci">proshade_signed * getXFromPtr(void)</div><div class="ttdoc">This function allows access to the map start along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03969">ProSHADE_data.cpp:3969</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a89094c73ae033812d4df0bd846e03442"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">ProSHADE_settings::verbose</a></div><div class="ttdeci">proshade_signed verbose</div><div class="ttdoc">Should the software report on the progress, or just be quiet? Value between -1 (nothing) and 4 (loud)</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00140">ProSHADE_settings.hpp:140</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ab4da4e87f23a07702dcf32470ec740df"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab4da4e87f23a07702dcf32470ec740df">ProSHADE_internal_data::ProSHADE_data::yDimIndices</a></div><div class="ttdeci">proshade_unsign yDimIndices</div><div class="ttdoc">This is the size of the map cell y dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00066">ProSHADE_data.hpp:66</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a43f1c4682016759ea2e24c5903dbe444"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a43f1c4682016759ea2e24c5903dbe444">ProSHADE_internal_data::ProSHADE_data::xAxisOriginOriginal</a></div><div class="ttdeci">proshade_signed xAxisOriginOriginal</div><div class="ttdoc">This is the origin position along the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00088">ProSHADE_data.hpp:88</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac3fbad5b8628112ace798950e6068bd4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac3fbad5b8628112ace798950e6068bd4">ProSHADE_internal_data::ProSHADE_data::deepCopyMap</a></div><div class="ttdeci">void deepCopyMap(proshade_double *&amp;saveTo, proshade_signed verbose)</div><div class="ttdoc">This function copies the internal map into the supplied pointer, which it also allocates.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03466">ProSHADE_data.cpp:3466</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5999f7181bd3509454966f8271ac39d6"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5999f7181bd3509454966f8271ac39d6">ProSHADE_internal_data::ProSHADE_data::getWignerMatrixValue</a></div><div class="ttdeci">void getWignerMatrixValue(proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_double *valueReal, proshade_double *valueImag)</div><div class="ttdoc">This function allows access to the Wigner D matrix by knowing the band, order1 and order2 indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03894">ProSHADE_data.cpp:3894</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a898b48c1135e7a37f64f55e2367f0391"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a898b48c1135e7a37f64f55e2367f0391">ProSHADE_internal_data::ProSHADE_data::getShellBandwidth</a></div><div class="ttdeci">proshade_unsign getShellBandwidth(proshade_unsign shell)</div><div class="ttdoc">This function allows access to the bandwidth of a particular shell.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03803">ProSHADE_data.cpp:3803</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3d56e4edf14f91833ddfe8908887b506"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3d56e4edf14f91833ddfe8908887b506">ProSHADE_internal_data::ProSHADE_data::yGridIndices</a></div><div class="ttdeci">proshade_unsign yGridIndices</div><div class="ttdoc">As far as I know, this is identical to the yDimIndices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00069">ProSHADE_data.hpp:69</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a4f49a4f2263aa12ccb1737f8dc32c9ac"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a4f49a4f2263aa12ccb1737f8dc32c9ac">ProSHADE_settings::changeMapResolutionTriLinear</a></div><div class="ttdeci">bool changeMapResolutionTriLinear</div><div class="ttdoc">Should maps be re-sampled to obtain the required resolution?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00052">ProSHADE_settings.hpp:52</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a57a45df67d87117582f0810ca9f48695"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a57a45df67d87117582f0810ca9f48695">ProSHADE_internal_data::ProSHADE_data::zAxisOrigin</a></div><div class="ttdeci">proshade_signed zAxisOrigin</div><div class="ttdoc">This is the origin position along the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00076">ProSHADE_data.hpp:76</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a68c3eafaeea1c1873c33525f337f9d0b"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a></div><div class="ttdeci">void addToDoubleVector(std::vector&lt; proshade_double &gt; *vecToAddTo, proshade_double elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00077">ProSHADE_misc.cpp:77</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad1fdcd9bdebc2900748821c5b3cb53cc"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1fdcd9bdebc2900748821c5b3cb53cc">ProSHADE_internal_data::ProSHADE_data::getNoRecommendedSymmetryAxes</a></div><div class="ttdeci">proshade_unsign getNoRecommendedSymmetryAxes(ProSHADE_settings *settings)</div><div class="ttdoc">This function returns the number of detected recommended symmetry axes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04417">ProSHADE_data.cpp:4417</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a30edd2928e423198704adb955989960b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30edd2928e423198704adb955989960b">ProSHADE_internal_data::ProSHADE_data::setPDBMapValues</a></div><div class="ttdeci">void setPDBMapValues(void)</div><div class="ttdoc">Function for determining iterator start and stop positions.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00880">ProSHADE_data.cpp:880</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac07955296611dd411cf5ed87ced90571"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac07955296611dd411cf5ed87ced90571">ProSHADE_internal_data::ProSHADE_data::findMapCOM</a></div><div class="ttdeci">void findMapCOM(void)</div><div class="ttdoc">This function finds the centre of mass of the internal map representation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03554">ProSHADE_data.cpp:3554</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8bc5fbad1079d42bfa73913a9e2df619"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8bc5fbad1079d42bfa73913a9e2df619">ProSHADE_internal_data::ProSHADE_data::getRealRotFunction</a></div><div class="ttdeci">void getRealRotFunction(double *rotFunReal, int len)</div><div class="ttdoc">This function fills the input array with the real rotation function values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04287">ProSHADE_data.cpp:4287</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1ef18126c2c24edc9b6be06e0591127f"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ef18126c2c24edc9b6be06e0591127f">ProSHADE_internal_data::ProSHADE_data::yDimIndicesOriginal</a></div><div class="ttdeci">proshade_unsign yDimIndicesOriginal</div><div class="ttdoc">This is the size of the map cell y dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00086">ProSHADE_data.hpp:86</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3bc44913222e67ab861dd1e5838c1ae1"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">ProSHADE_internal_data::ProSHADE_data::getXDim</a></div><div class="ttdeci">proshade_unsign getXDim(void)</div><div class="ttdoc">This function allows access to the map size in indices along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03939">ProSHADE_data.cpp:3939</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a8993520350e1eab8f3eb041c8115cac5"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a8993520350e1eab8f3eb041c8115cac5">ProSHADE_internal_mapManip::removeWaters</a></div><div class="ttdeci">void removeWaters(gemmi::Structure *pdbFile, bool firstModel)</div><div class="ttdoc">This function removed all waters from PDB input file.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00504">ProSHADE_mapManip.cpp:504</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9548e8ff07c6a74bbe2353f647fb6a79"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9548e8ff07c6a74bbe2353f647fb6a79">ProSHADE_internal_data::ProSHADE_data::originalPdbTransX</a></div><div class="ttdeci">proshade_double originalPdbTransX</div><div class="ttdoc">The optimal translation vector as it relates to the original PDB positions (and not the ProSHADE inte...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00105">ProSHADE_data.hpp:105</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__data_8hpp_html"><div class="ttname"><a href="_pro_s_h_a_d_e__data_8hpp.html">ProSHADE_data.hpp</a></div><div class="ttdoc">This is the header file containing internal data representation and manipulation structures and funct...</div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a930e25e9377cf418f6eab71fa2837255"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a930e25e9377cf418f6eab71fa2837255">ProSHADE_internal_data::ProSHADE_data::zTo</a></div><div class="ttdeci">proshade_signed zTo</div><div class="ttdoc">This is the final index along the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00115">ProSHADE_data.hpp:115</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac40e8210bd69b598a67c6a3e0a9ecf16"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac40e8210bd69b598a67c6a3e0a9ecf16">ProSHADE_internal_data::ProSHADE_data::xTo</a></div><div class="ttdeci">proshade_signed xTo</div><div class="ttdoc">This is the final index along the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00113">ProSHADE_data.hpp:113</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aac87b1a87f32a742ea2b41014dac5f7b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aac87b1a87f32a742ea2b41014dac5f7b">ProSHADE_internal_data::ProSHADE_data::writeMask</a></div><div class="ttdeci">void writeMask(std::string fName, proshade_double *mask)</div><div class="ttdoc">Function for writing out a mask in MRC MAP format.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01064">ProSHADE_data.cpp:1064</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5d266289b137b48132f1456fd8fc43ea"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d266289b137b48132f1456fd8fc43ea">ProSHADE_internal_data::ProSHADE_data::integrationWeight</a></div><div class="ttdeci">proshade_double integrationWeight</div><div class="ttdoc">The Pearson's c.c. type weighting for the integration.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00128">ProSHADE_data.hpp:128</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a599a8fa1d6d780a45a2d772413bc778e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a599a8fa1d6d780a45a2d772413bc778e">ProSHADE_internal_data::ProSHADE_data::saveRequestedSymmetryC</a></div><div class="ttdeci">void saveRequestedSymmetryC(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSym, std::vector&lt; proshade_double * &gt; *axes)</div><div class="ttdoc">This function takes the C symmetries and searched for the requested symmetry.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02865">ProSHADE_data.cpp:2865</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a4af89abc1c94e4a6df28c7b31f576551"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a4af89abc1c94e4a6df28c7b31f576551">ProSHADE_settings::peakThresholdMin</a></div><div class="ttdeci">proshade_double peakThresholdMin</div><div class="ttdoc">The threshold for peak height above which axes are considered possible.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00133">ProSHADE_settings.hpp:133</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a56bfcfacedabd84ec54aa2843d59e014"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a56bfcfacedabd84ec54aa2843d59e014">ProSHADE_internal_data::ProSHADE_data::mapToSpheres</a></div><div class="ttdeci">void mapToSpheres(ProSHADE_settings *settings)</div><div class="ttdoc">This function converts the internal map onto a set of concentric spheres.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01712">ProSHADE_data.cpp:1712</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__peak_search_html_a3728cebdcc0cad1dff8c83dabaeed31c"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__peak_search.html#a3728cebdcc0cad1dff8c83dabaeed31c">ProSHADE_internal_peakSearch::findPeaks1D</a></div><div class="ttdeci">std::vector&lt; proshade_signed &gt; findPeaks1D(std::vector&lt; proshade_double &gt; data)</div><div class="ttdoc">This function simply finds all the peaks in a 1D data array.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__peak_search_8cpp_source.html#l01014">ProSHADE_peakSearch.cpp:1014</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2860d3acb4d9e5ec6fca0b58ae33845f"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2860d3acb4d9e5ec6fca0b58ae33845f">ProSHADE_internal_data::ProSHADE_data::xAxisOrigin</a></div><div class="ttdeci">proshade_signed xAxisOrigin</div><div class="ttdoc">This is the origin position along the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00074">ProSHADE_data.hpp:74</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5241ee8b8b9d9915e1ef92e3edab202d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5241ee8b8b9d9915e1ef92e3edab202d">ProSHADE_internal_data::ProSHADE_data::originalPdbTransY</a></div><div class="ttdeci">proshade_double originalPdbTransY</div><div class="ttdoc">The optimal translation vector as it relates to the original PDB positions (and not the ProSHADE inte...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00106">ProSHADE_data.hpp:106</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_ad3c391ac63c921d19d8d4956d58e0ea8"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#ad3c391ac63c921d19d8d4956d58e0ea8">ProSHADE_internal_maths::computeFSC</a></div><div class="ttdeci">proshade_double computeFSC(fftw_complex *fCoeffs1, fftw_complex *fCoeffs2, proshade_unsign xInds, proshade_unsign yInds, proshade_unsign zInds, proshade_signed noBins, proshade_signed *binIndexing, proshade_double **&amp;binData, proshade_signed *&amp;binCounts)</div><div class="ttdoc">This function computes the FSC.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l03090">ProSHADE_maths.cpp:3090</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_af8b72cbc56a4f72d0557e01a8101d435"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af8b72cbc56a4f72d0557e01a8101d435">ProSHADE_internal_data::ProSHADE_data::rrpMatrices</a></div><div class="ttdeci">proshade_double *** rrpMatrices</div><div class="ttdoc">The energy levels descriptor shell correlation tables.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00126">ProSHADE_data.hpp:126</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a47b4953dae84a5ab54dadd33d7805887"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47b4953dae84a5ab54dadd33d7805887">ProSHADE_internal_data::ProSHADE_data::yTo</a></div><div class="ttdeci">proshade_signed yTo</div><div class="ttdoc">This is the final index along the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00114">ProSHADE_data.hpp:114</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_acffa14a2c2121b5b425fcabdb7b3ba6a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#acffa14a2c2121b5b425fcabdb7b3ba6a">ProSHADE_settings::forceP1</a></div><div class="ttdeci">bool forceP1</div><div class="ttdoc">Should the P1 spacegroup be forced on the input PDB files?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00044">ProSHADE_settings.hpp:44</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aff65990df92e49b7636134feb56be8f9"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aff65990df92e49b7636134feb56be8f9">ProSHADE_internal_data::ProSHADE_data::xDimSize</a></div><div class="ttdeci">proshade_single xDimSize</div><div class="ttdoc">This is the size of the map cell x dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00059">ProSHADE_data.hpp:59</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a3d107e20dfeb5b5442fc3d0ba70bf2ef"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a3d107e20dfeb5b5442fc3d0ba70bf2ef">ProSHADE_internal_mapManip::findPDBCOMValues</a></div><div class="ttdeci">void findPDBCOMValues(gemmi::Structure pdbFile, proshade_double *xCom, proshade_double *yCom, proshade_double *zCom, bool firstModel)</div><div class="ttdoc">This function finds the Centre of Mass for the co-ordinate file.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00157">ProSHADE_mapManip.cpp:157</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1658311301e365cf17721e864b829c28"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1658311301e365cf17721e864b829c28">ProSHADE_internal_data::ProSHADE_data::mapMovFromsChangeY</a></div><div class="ttdeci">proshade_double mapMovFromsChangeY</div><div class="ttdoc">When the map is translated, the yFrom and yTo values are changed. This variable holds how much they h...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00095">ProSHADE_data.hpp:95</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3e2a50d383cdba4b6f6f3d1293c4174b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3e2a50d383cdba4b6f6f3d1293c4174b">ProSHADE_internal_data::ProSHADE_data::yAxisOrigin</a></div><div class="ttdeci">proshade_signed yAxisOrigin</div><div class="ttdoc">This is the origin position along the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00075">ProSHADE_data.hpp:75</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_aff0d8344fdd83482e5531eadedaac550"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a></div><div class="ttdeci">void deepCopyAxisToDblPtrVector(std::vector&lt; proshade_double * &gt; *dblPtrVec, proshade_double *axis)</div><div class="ttdoc">Does a deep copy of a double array to a vector of double arrays.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00310">ProSHADE_misc.cpp:310</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_afb39c3bb75f1b925175f9f6b09ada148"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#afb39c3bb75f1b925175f9f6b09ada148">ProSHADE_settings::task</a></div><div class="ttdeci">ProSHADE_Task task</div><div class="ttdoc">This custom type variable determines which task to perfom (i.e. symmetry detection,...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00040">ProSHADE_settings.hpp:40</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9302095b8642b8d5088cf8f1793d1990"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9302095b8642b8d5088cf8f1793d1990">ProSHADE_internal_data::ProSHADE_data::yAxisOrder</a></div><div class="ttdeci">proshade_unsign yAxisOrder</div><div class="ttdoc">This is the order of the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00072">ProSHADE_data.hpp:72</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5c0df68cd21b4f56abd1008065ca3573"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5c0df68cd21b4f56abd1008065ca3573">ProSHADE_internal_data::ProSHADE_data::getRealSphHarmValue</a></div><div class="ttdeci">proshade_double * getRealSphHarmValue(proshade_unsign band, proshade_unsign order, proshade_unsign shell)</div><div class="ttdoc">This function allows access to the private internal real spherical harmonics values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03754">ProSHADE_data.cpp:3754</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8aa6fbd67df9911e886f9001a0ef8bc2"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8aa6fbd67df9911e886f9001a0ef8bc2">ProSHADE_internal_data::ProSHADE_data::internalMap</a></div><div class="ttdeci">proshade_double * internalMap</div><div class="ttdoc">The internal map data representation, which may be amended as the run progresses.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00056">ProSHADE_data.hpp:56</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1ea6522b99cf1ac72199c9eeccd30742"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1ea6522b99cf1ac72199c9eeccd30742">ProSHADE_internal_data::ProSHADE_data::zDimIndicesOriginal</a></div><div class="ttdeci">proshade_unsign zDimIndicesOriginal</div><div class="ttdoc">This is the size of the map cell z dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00087">ProSHADE_data.hpp:87</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a43e3cad6f93a32f92194f76f0ec76a32"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a43e3cad6f93a32f92194f76f0ec76a32">ProSHADE_internal_data::ProSHADE_data::reportOverlayResults</a></div><div class="ttdeci">void reportOverlayResults(ProSHADE_settings *settings, std::vector&lt; proshade_double &gt; *rotationCentre, std::vector&lt; proshade_double &gt; *eulerAngles, std::vector&lt; proshade_double &gt; *finalTranslation)</div><div class="ttdoc">This function reports the results of the overlay mode.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04522">ProSHADE_data.cpp:4522</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html">ProSHADE_internal_symmetry</a></div><div class="ttdoc">This namespace contains the symmetry detection related code.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00074">ProSHADE_data.cpp:75</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afef6a064a54eb016776cb0879efb0b31"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">ProSHADE_internal_data::ProSHADE_data::xFrom</a></div><div class="ttdeci">proshade_signed xFrom</div><div class="ttdoc">This is the starting index along the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00110">ProSHADE_data.hpp:110</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a39eafef902a49cc0816a2ed675c14a49"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a39eafef902a49cc0816a2ed675c14a49">ProSHADE_internal_maths::getRotationMatrixFromAngleAxis</a></div><div class="ttdeci">void getRotationMatrixFromAngleAxis(proshade_double *rotMat, proshade_double x, proshade_double y, proshade_double z, proshade_double ang)</div><div class="ttdoc">This function converts the axis-angle representation to the rotation matrix representation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01448">ProSHADE_maths.cpp:1448</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a81e6aab30488052e6bdd9b339e8124d8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a81e6aab30488052e6bdd9b339e8124d8">ProSHADE_internal_data::ProSHADE_data::writeMap</a></div><div class="ttdeci">void writeMap(std::string fName, std::string title=&quot;Created by ProSHADE and written by GEMMI&quot;, int mode=2)</div><div class="ttdoc">Function for writing out the internal structure representation in MRC MAP format.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00948">ProSHADE_data.cpp:948</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ada8e6f27f49afc3a0ee17758ce9e7594"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ada8e6f27f49afc3a0ee17758ce9e7594">ProSHADE_internal_data::ProSHADE_data::shellBandExists</a></div><div class="ttdeci">bool shellBandExists(proshade_unsign shell, proshade_unsign bandVal)</div><div class="ttdoc">This function checks if particular shell has a particular band.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03656">ProSHADE_data.cpp:3656</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a152b43815a3d3debd4b60751d9c8afdd"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">ProSHADE_internal_data::ProSHADE_data::getMaxBand</a></div><div class="ttdeci">proshade_unsign getMaxBand(void)</div><div class="ttdoc">This function returns the maximum band value for the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03630">ProSHADE_data.cpp:3630</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a670cffe28bbdac027bffd8f5491d4266"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a670cffe28bbdac027bffd8f5491d4266">ProSHADE_settings::appliedMaskFileName</a></div><div class="ttdeci">std::string appliedMaskFileName</div><div class="ttdoc">The filename from which mask data will be read from.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00086">ProSHADE_settings.hpp:86</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a0d796061e73e8635f75fc6921b98ad66"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a0d796061e73e8635f75fc6921b98ad66">ProSHADE_settings::normaliseMap</a></div><div class="ttdeci">bool normaliseMap</div><div class="ttdoc">Should the map be normalised to mean 0 sd 1?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00072">ProSHADE_settings.hpp:72</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_afb42ec0cd0f8abb54327c0e2c3025ed1"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#afb42ec0cd0f8abb54327c0e2c3025ed1">ProSHADE_settings::addExtraSpace</a></div><div class="ttdeci">proshade_single addExtraSpace</div><div class="ttdoc">If this value is non-zero, this many angstroms of empty space will be added to the internal map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00099">ProSHADE_settings.hpp:99</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a50c884973add562558803a45991bbf19"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">ProSHADE_internal_data::ProSHADE_data::getYDim</a></div><div class="ttdeci">proshade_unsign getYDim(void)</div><div class="ttdoc">This function allows access to the map size in indices along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03949">ProSHADE_data.cpp:3949</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a99ed9b0a765739d89104eca2c1875dd4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a99ed9b0a765739d89104eca2c1875dd4">ProSHADE_internal_data::ProSHADE_data::maxCompBand</a></div><div class="ttdeci">proshade_unsign maxCompBand</div><div class="ttdoc">The largest comparison band - this variable tells how large arrays will be allocated for the comparis...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00132">ProSHADE_data.hpp:132</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9b08a8b6f9569c06cd183c924e6e80de"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b08a8b6f9569c06cd183c924e6e80de">ProSHADE_internal_data::ProSHADE_data::getImagEMatrixValuesForLM</a></div><div class="ttdeci">void getImagEMatrixValuesForLM(proshade_signed band, proshade_signed order1, double *eMatsLMImag, int len)</div><div class="ttdoc">This function fills the input array with the imaginary E matrix values for particular band and order1...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04218">ProSHADE_data.cpp:4218</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a0122be830893f5d82bab742be54d1ee7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0122be830893f5d82bab742be54d1ee7">ProSHADE_internal_data::ProSHADE_data::maskMap</a></div><div class="ttdeci">void maskMap(ProSHADE_settings *settings)</div><div class="ttdoc">Function for computing the map mask using blurring and X IQRs from median.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01202">ProSHADE_data.cpp:1202</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a485495727d37abd66295bab95d368438"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a485495727d37abd66295bab95d368438">ProSHADE_internal_data::ProSHADE_data::~ProSHADE_data</a></div><div class="ttdeci">~ProSHADE_data(void)</div><div class="ttdoc">Destructor for the ProSHADE_data class.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00349">ProSHADE_data.cpp:349</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_ac2650a79c20be34894c23d73ffaae750"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ac2650a79c20be34894c23d73ffaae750">ProSHADE_internal_mapManip::getNonZeroBounds</a></div><div class="ttdeci">void getNonZeroBounds(proshade_double *map, proshade_signed xDim, proshade_signed yDim, proshade_signed zDim, proshade_signed *&amp;ret)</div><div class="ttdoc">Function for finding the map boundaries enclosing positive only values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01082">ProSHADE_mapManip.cpp:1082</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a></div><div class="ttdoc">This class stores all the settings and is passed to the executive classes instead of a multitude of p...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00036">ProSHADE_settings.hpp:37</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a59fbe922fd7fd7aa5c72ca459e4242d0"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59fbe922fd7fd7aa5c72ca459e4242d0">ProSHADE_internal_data::ProSHADE_data::xCom</a></div><div class="ttdeci">proshade_double xCom</div><div class="ttdoc">The COM of the map after processing along the X-axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00077">ProSHADE_data.hpp:77</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a94cce09895dc9f41d4b9a429ccf638e8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a94cce09895dc9f41d4b9a429ccf638e8">ProSHADE_internal_data::ProSHADE_data::getRealTranslationFunction</a></div><div class="ttdeci">void getRealTranslationFunction(double *trsFunReal, int len)</div><div class="ttdoc">This function fills the input array with the real translation function values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04323">ProSHADE_data.cpp:4323</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a53120c9e4f3f1f69f80d7c966dff2cb7"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a53120c9e4f3f1f69f80d7c966dff2cb7">ProSHADE_settings::fscThreshold</a></div><div class="ttdeci">proshade_double fscThreshold</div><div class="ttdoc">The threshold for FSC value under which the axis is considered to be likely noise.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00132">ProSHADE_settings.hpp:132</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_aa2702798938d50ec2a55e46cbc31333e"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#aa2702798938d50ec2a55e46cbc31333e">ProSHADE_internal_maths::binReciprocalSpaceReflections</a></div><div class="ttdeci">void binReciprocalSpaceReflections(proshade_unsign xInds, proshade_unsign yInds, proshade_unsign zInds, proshade_signed *noBin, proshade_signed *&amp;binIndexing)</div><div class="ttdoc">This function does binning of the reciprocal space reflections.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l02943">ProSHADE_maths.cpp:2943</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aae8444b6c9ca3207d32bbf2a68c7b610"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aae8444b6c9ca3207d32bbf2a68c7b610">ProSHADE_internal_data::ProSHADE_data::getImagSphHarmValue</a></div><div class="ttdeci">proshade_double * getImagSphHarmValue(proshade_unsign band, proshade_unsign order, proshade_unsign shell)</div><div class="ttdoc">This function allows access to the private internal imaginary spherical harmonics values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03767">ProSHADE_data.cpp:3767</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aee571cb10ce61ab11680b1ebd5e23eb7"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aee571cb10ce61ab11680b1ebd5e23eb7">ProSHADE_internal_data::ProSHADE_data::originalPdbTransZ</a></div><div class="ttdeci">proshade_double originalPdbTransZ</div><div class="ttdoc">The optimal translation vector as it relates to the original PDB positions (and not the ProSHADE inte...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00107">ProSHADE_data.hpp:107</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a6160812636f73e33c1c46a754b68a610"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a6160812636f73e33c1c46a754b68a610">ProSHADE_internal_data::ProSHADE_data::writeOutOverlayFiles</a></div><div class="ttdeci">void writeOutOverlayFiles(ProSHADE_settings *settings, proshade_double eulA, proshade_double eulB, proshade_double eulG, std::vector&lt; proshade_double &gt; *rotCentre, std::vector&lt; proshade_double &gt; *ultimateTranslation)</div><div class="ttdoc">This function writes out the rotated map, co-ordinates and transformation JSON file.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04488">ProSHADE_data.cpp:4488</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9b063d1ca2ebed239029bad6250cf376"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9b063d1ca2ebed239029bad6250cf376">ProSHADE_internal_data::ProSHADE_data::getImagRotFunction</a></div><div class="ttdeci">void getImagRotFunction(double *rotFunImag, int len)</div><div class="ttdoc">This function fills the input array with the imaginary rotation function values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04305">ProSHADE_data.cpp:4305</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afcb4202e9ffea1b99c59f73faf06d899"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afcb4202e9ffea1b99c59f73faf06d899">ProSHADE_internal_data::ProSHADE_data::processInternalMap</a></div><div class="ttdeci">void processInternalMap(ProSHADE_settings *settings)</div><div class="ttdoc">This function simply clusters several other functions which should be called together.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01612">ProSHADE_data.cpp:1612</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_ad93f9644c5b132193b4ddd282f50abce"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#ad93f9644c5b132193b4ddd282f50abce">ProSHADE_internal_io::readInMapData</a></div><div class="ttdeci">void readInMapData(gemmi::Ccp4&lt; float &gt; *gemmiMap, proshade_double *&amp;map, proshade_unsign xDimInds, proshade_unsign yDimInds, proshade_unsign zDimInds, proshade_unsign xAxOrder, proshade_unsign yAxOrder, proshade_unsign zAxOrder)</div><div class="ttdoc">This function converts the gemmi Ccp4 object data to ProSHADE internal map representation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00178">ProSHADE_io.cpp:178</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae27a3e92905ca9d5f9a32c4eaacc64ae"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae27a3e92905ca9d5f9a32c4eaacc64ae">ProSHADE_internal_data::ProSHADE_data::getTranslationFnPointer</a></div><div class="ttdeci">proshade_complex * getTranslationFnPointer(void)</div><div class="ttdoc">This function allows access to the translation function through a pointer.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04069">ProSHADE_data.cpp:4069</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a974bbe07f5435f052df4592825ed7aba"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a974bbe07f5435f052df4592825ed7aba">ProSHADE_settings::setRecommendedSymmetry</a></div><div class="ttdeci">void setRecommendedSymmetry(std::string val)</div><div class="ttdoc">Sets the ProSHADE detected symmetry type.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l01210">ProSHADE.cpp:1210</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a668c168ea0037312025b860b9b5be415"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a668c168ea0037312025b860b9b5be415">ProSHADE_internal_data::ProSHADE_data::zCom</a></div><div class="ttdeci">proshade_double zCom</div><div class="ttdoc">The COM of the map after processing along the Z-axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00079">ProSHADE_data.hpp:79</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a31b57e51f48e58828883b04b612dcf55"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a31b57e51f48e58828883b04b612dcf55">ProSHADE_internal_data::ProSHADE_data::spherePos</a></div><div class="ttdeci">std::vector&lt; proshade_single &gt; spherePos</div><div class="ttdoc">Vector of sphere radii from the centre of the map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00118">ProSHADE_data.hpp:118</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a0d205c102e722997ab1f0953f76a288a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a0d205c102e722997ab1f0953f76a288a">ProSHADE_settings::invertMap</a></div><div class="ttdeci">bool invertMap</div><div class="ttdoc">Should the map be inverted? Only use this if you think you have the wrong hand in your map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00075">ProSHADE_settings.hpp:75</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_aa2da3e6dc4d41b8f09b47982fe74b3ea"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#aa2da3e6dc4d41b8f09b47982fe74b3ea">ProSHADE_internal_maths::smoothen1D</a></div><div class="ttdeci">std::vector&lt; proshade_double &gt; smoothen1D(proshade_double step, proshade_signed windowSize, proshade_double sigma, std::vector&lt; proshade_double &gt; data)</div><div class="ttdoc">This function takes a 1D vector and computes smoothened version based on the parameters.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l02873">ProSHADE_maths.cpp:2873</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a034af93b9152fb2db675d5632a4ebc6d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">ProSHADE_internal_data::ProSHADE_data::getZDim</a></div><div class="ttdeci">proshade_unsign getZDim(void)</div><div class="ttdoc">This function allows access to the map size in indices along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03959">ProSHADE_data.cpp:3959</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a167f7a9dbd061752d2a099181090a3b8"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a167f7a9dbd061752d2a099181090a3b8">ProSHADE_internal_mapManip::removeMapPhase</a></div><div class="ttdeci">void removeMapPhase(fftw_complex *&amp;mapCoeffs, proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim)</div><div class="ttdoc">This function removes the phase from reciprocal (frequency) map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01631">ProSHADE_mapManip.cpp:1631</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a827e3241fa6401027e0526fffb8b281d"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a827e3241fa6401027e0526fffb8b281d">ProSHADE_settings::boundsSimilarityThreshold</a></div><div class="ttdeci">proshade_signed boundsSimilarityThreshold</div><div class="ttdoc">Number of indices which can be added just to make sure same size in indices is achieved.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00091">ProSHADE_settings.hpp:91</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a38d47eb11eafa106c65867ceec62a3fc"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a38d47eb11eafa106c65867ceec62a3fc">ProSHADE_internal_data::ProSHADE_data::getSpherePosValue</a></div><div class="ttdeci">proshade_single getSpherePosValue(proshade_unsign shell)</div><div class="ttdoc">This function allows access to sphere positions.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03815">ProSHADE_data.cpp:3815</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a0322fb97dcd3c0495f98963210f36c27"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0322fb97dcd3c0495f98963210f36c27">ProSHADE_internal_data::ProSHADE_data::writePdb</a></div><div class="ttdeci">void writePdb(std::string fName, proshade_double euA=0.0, proshade_double euB=0.0, proshade_double euG=0.0, proshade_double trsX=0.0, proshade_double trsY=0.0, proshade_double trsZ=0.0, bool firstModel=true)</div><div class="ttdoc">This function writes out the PDB formatted file coresponding to the structure so that its COM is at s...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01013">ProSHADE_data.cpp:1013</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ab61d2183930ea26b3d49e7662052e83b"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ab61d2183930ea26b3d49e7662052e83b">ProSHADE_settings::changeMapResolution</a></div><div class="ttdeci">bool changeMapResolution</div><div class="ttdoc">Should maps be re-sampled to obtain the required resolution?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00051">ProSHADE_settings.hpp:51</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afa35ae5ccd9d4b22bcc028f609cd1c3e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa35ae5ccd9d4b22bcc028f609cd1c3e">ProSHADE_internal_data::ProSHADE_data::getRRPValue</a></div><div class="ttdeci">proshade_double getRRPValue(proshade_unsign band, proshade_unsign sh1, proshade_unsign sh2)</div><div class="ttdoc">This function allows access to the priva internal RRP matrices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03640">ProSHADE_data.cpp:3640</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a9f714e15a7bc56dbe846fda6bb1d9c9e"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a9f714e15a7bc56dbe846fda6bb1d9c9e">ProSHADE_internal_io::writeRotationTranslationJSON</a></div><div class="ttdeci">void writeRotationTranslationJSON(proshade_double trsX1, proshade_double trsY1, proshade_double trsZ1, proshade_double eulA, proshade_double eulB, proshade_double eulG, proshade_double trsX2, proshade_double trsY2, proshade_double trsZ2, std::string fileName)</div><div class="ttdoc">Function for writing out the optimal rotation and translation into a JSON file.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00398">ProSHADE_io.cpp:398</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a682749f30d2fd19842d96e9b870d76ab"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a682749f30d2fd19842d96e9b870d76ab">ProSHADE_internal_data::ProSHADE_data::mapMovFromsChangeZ</a></div><div class="ttdeci">proshade_double mapMovFromsChangeZ</div><div class="ttdoc">When the map is translated, the zFrom and zTo values are changed. This variable holds how much they h...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00096">ProSHADE_data.hpp:96</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__data_8cpp_html_a188746757d4fe33cc7bca307aa367bc7"><div class="ttname"><a href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">axesToGroupTypeSanityCheck</a></div><div class="ttdeci">void axesToGroupTypeSanityCheck(proshade_unsign requiredAxes, proshade_unsign obtainedAxes, std::string groupType)</div><div class="ttdoc">This function checks that the required and obtained numbers of axes are correct, printing error if th...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03044">ProSHADE_data.cpp:3044</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a833f51d5da64ed09004daa4bf66c013c"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a833f51d5da64ed09004daa4bf66c013c">ProSHADE_settings::overlayStructureName</a></div><div class="ttdeci">std::string overlayStructureName</div><div class="ttdoc">The filename to which the rotated and translated moving structure is to be saved.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00136">ProSHADE_settings.hpp:136</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a2380a3710f7dbe672519c3adda30f7cd"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a2380a3710f7dbe672519c3adda30f7cd">ProSHADE_internal_maths::isAxisUnique</a></div><div class="ttdeci">bool isAxisUnique(std::vector&lt; proshade_double * &gt; *CSymList, proshade_double *axis, proshade_double tolerance=0.1, bool improve=false)</div><div class="ttdoc">This function checks if new axis is unique, or already detected.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l02721">ProSHADE_maths.cpp:2721</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afe04510c67e9dc9c19efaef8463b6e6e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afe04510c67e9dc9c19efaef8463b6e6e">ProSHADE_internal_data::ProSHADE_data::getMapValue</a></div><div class="ttdeci">proshade_double getMapValue(proshade_unsign pos)</div><div class="ttdoc">This function returns the internal map representation value of a particular array position.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03620">ProSHADE_data.cpp:3620</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a4b76352faa0915b1fef943fe139de5a6"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4b76352faa0915b1fef943fe139de5a6">ProSHADE_internal_data::ProSHADE_data::getImagSO3Coeffs</a></div><div class="ttdeci">void getImagSO3Coeffs(double *so3CoefsImag, int len)</div><div class="ttdoc">This function fills the input array with the imaginary SO(3) coefficient values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04254">ProSHADE_data.cpp:4254</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac859cbd21b93b9d2ed5f119f4ee57f3f"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac859cbd21b93b9d2ed5f119f4ee57f3f">ProSHADE_internal_data::ProSHADE_data::getYToPtr</a></div><div class="ttdeci">proshade_signed * getYToPtr(void)</div><div class="ttdoc">This function allows access to the map last position along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04009">ProSHADE_data.cpp:4009</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a37c9037721c1ad28ad6421a31dbcd8d8"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a37c9037721c1ad28ad6421a31dbcd8d8">ProSHADE_settings::moveToCOM</a></div><div class="ttdeci">bool moveToCOM</div><div class="ttdoc">Logical value stating whether the structure should be moved to have its Centre Of Mass (COM) in the m...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00096">ProSHADE_settings.hpp:96</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a07fb6e354dcd90dc70f8b4fa8bba0c33"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a07fb6e354dcd90dc70f8b4fa8bba0c33">ProSHADE_internal_data::ProSHADE_data::readInMAP</a></div><div class="ttdeci">void readInMAP(ProSHADE_settings *settings)</div><div class="ttdoc">Function for reading map data using gemmi library.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00554">ProSHADE_data.cpp:554</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a618fc0fc9ca71ec70500c99c7e6231f4"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a618fc0fc9ca71ec70500c99c7e6231f4">ProSHADE_internal_data::ProSHADE_data::wignerMatrices</a></div><div class="ttdeci">proshade_complex *** wignerMatrices</div><div class="ttdoc">These matrices are computed for a particular rotation to be done in spherical harmonics.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00131">ProSHADE_data.hpp:131</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afac05cfadc141435c4fc4a568ecffe29"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afac05cfadc141435c4fc4a568ecffe29">ProSHADE_internal_data::ProSHADE_data::detectSymmetryInStructure</a></div><div class="ttdeci">void detectSymmetryInStructure(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *axes, std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *allCs)</div><div class="ttdoc">This function runs the symmetry detection algorithms on this structure and saves the results in the s...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01801">ProSHADE_data.cpp:1801</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a4052e498b4650f62bfe5ff37ed959292"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4052e498b4650f62bfe5ff37ed959292">ProSHADE_internal_data::ProSHADE_data::fileType</a></div><div class="ttdeci">ProSHADE_internal_io::InputType fileType</div><div class="ttdoc">This is the type of the input file.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00053">ProSHADE_data.hpp:53</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aeb0242051835b508e9af193dc40a697c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aeb0242051835b508e9af193dc40a697c">ProSHADE_internal_data::ProSHADE_data::getZAxisOrigin</a></div><div class="ttdeci">proshade_signed * getZAxisOrigin(void)</div><div class="ttdoc">This function allows access to the map Z axis origin value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04049">ProSHADE_data.cpp:4049</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a2e438f3d348e3e065f798031d5a33d09"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a2e438f3d348e3e065f798031d5a33d09">ProSHADE_internal_io::writeOutMapHeader</a></div><div class="ttdeci">void writeOutMapHeader(gemmi::Ccp4&lt; float &gt; *map, proshade_unsign xDimInds, proshade_unsign yDimInds, proshade_unsign zDimInds, proshade_single xDim, proshade_single yDim, proshade_single zDim, proshade_single aAng, proshade_single bAng, proshade_single cAng, proshade_signed xFrom, proshade_signed yFrom, proshade_signed zFrom, proshade_signed xAxOrigin, proshade_signed yAxOrigin, proshade_signed zAxOrigin, proshade_unsign xAxOrder, proshade_unsign yAxOrder, proshade_unsign zAxOrder, proshade_unsign xGridInds, proshade_unsign yGridInds, proshade_unsign zGridInds, std::string title, int mode)</div><div class="ttdoc">This function parses the CCP4 MAP file header as read in by gemmi.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00306">ProSHADE_io.cpp:306</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a50df80b02427f9f55a2c7af033a9fb93"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a></div><div class="ttdeci">proshade_signed myRound(proshade_double x)</div><div class="ttdoc">Calls the appropriate version of round function depending on compiler version.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00031">ProSHADE_mapManip.cpp:31</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a7855424ca5d51853c7fc665ecb9b935b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7855424ca5d51853c7fc665ecb9b935b">ProSHADE_internal_data::ProSHADE_data::yDimSizeOriginal</a></div><div class="ttdeci">proshade_single yDimSizeOriginal</div><div class="ttdoc">This is the size of the map cell y dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00083">ProSHADE_data.hpp:83</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a550c839b5ce7b53ccee5e6da1cf001af"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a550c839b5ce7b53ccee5e6da1cf001af">ProSHADE_internal_data::ProSHADE_data::zAxisOrder</a></div><div class="ttdeci">proshade_unsign zAxisOrder</div><div class="ttdoc">This is the order of the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00073">ProSHADE_data.hpp:73</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_aeb9acf2a6f2f23b72424f01417c9ead3"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aeb9acf2a6f2f23b72424f01417c9ead3">ProSHADE_internal_mapManip::beautifyBoundaries</a></div><div class="ttdeci">void beautifyBoundaries(proshade_signed *&amp;bounds, proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_signed boundsDiffThres)</div><div class="ttdoc">Function for modifying boundaries to a mathematically more pleasant values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01916">ProSHADE_mapManip.cpp:1916</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ab573ea90a16991a06a77c5343328b060"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ab573ea90a16991a06a77c5343328b060">ProSHADE_internal_data::ProSHADE_data::reSampleMap</a></div><div class="ttdeci">void reSampleMap(ProSHADE_settings *settings)</div><div class="ttdoc">This function changes the internal map sampling to conform to particular resolution value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01366">ProSHADE_data.cpp:1366</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a4c1ee71ada97967f49ae1b338d6f43f9"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a4c1ee71ada97967f49ae1b338d6f43f9">ProSHADE_internal_mapManip::rotatePDBCoordinates</a></div><div class="ttdeci">void rotatePDBCoordinates(gemmi::Structure *pdbFile, proshade_double euA, proshade_double euB, proshade_double euG, proshade_double xCom, proshade_double yCom, proshade_double zCom, bool firstModel)</div><div class="ttdoc">Function for rotating the PDB file co-ordinates by Euler angles.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00296">ProSHADE_mapManip.cpp:296</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a3bd5d0937bf5a545008b06593c5722a7"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a3bd5d0937bf5a545008b06593c5722a7">ProSHADE_internal_mapManip::generateMapFromPDB</a></div><div class="ttdeci">void generateMapFromPDB(gemmi::Structure pdbFile, proshade_double *&amp;map, proshade_single requestedResolution, proshade_single xCell, proshade_single yCell, proshade_single zCell, proshade_signed *xTo, proshade_signed *yTo, proshade_signed *zTo, bool forceP1, bool firstModel)</div><div class="ttdoc">This function generates a theoretical map from co-ordinate input files.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00644">ProSHADE_mapManip.cpp:644</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a4348a7a36275c9cea20b5c27093c9b7e"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a4348a7a36275c9cea20b5c27093c9b7e">ProSHADE_internal_maths::rotationMatrixSimilarity</a></div><div class="ttdeci">bool rotationMatrixSimilarity(std::vector&lt; proshade_double &gt; *mat1, std::vector&lt; proshade_double &gt; *mat2, proshade_double tolerance=0.1)</div><div class="ttdoc">This function compares the distance between two rotation matrices and decides if they are similar usi...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l02299">ProSHADE_maths.cpp:2299</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_af556836aa9286c1571196de442a6b493"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a></div><div class="ttdeci">void checkMemoryAllocation(chVar checkVar, std::string fileP, unsigned int lineP, std::string funcP, std::string infoP=&quot;This error may occurs when ProSHADE requests memory to be\n                    : allocated to it and this operation fails. This could\n                    : happen when not enough memory is available, either due to\n                    : other processes using a lot of memory, or when the machine\n                    : does not have sufficient memory available. Re-run to see\n                    : if this problem persists.&quot;)</div><div class="ttdoc">Checks if memory was allocated properly.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8hpp_source.html#l00067">ProSHADE_misc.hpp:67</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_adf61c328db45fcd7692d13a8cde5e092"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#adf61c328db45fcd7692d13a8cde5e092">ProSHADE_internal_data::ProSHADE_data::getXToPtr</a></div><div class="ttdeci">proshade_signed * getXToPtr(void)</div><div class="ttdoc">This function allows access to the map last position along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03999">ProSHADE_data.cpp:3999</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5f0d929d1e013cdd23e956d94b7a40da"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f0d929d1e013cdd23e956d94b7a40da">ProSHADE_internal_data::ProSHADE_data::getYFromPtr</a></div><div class="ttdeci">proshade_signed * getYFromPtr(void)</div><div class="ttdoc">This function allows access to the map start along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03979">ProSHADE_data.cpp:3979</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a2f09d5bdfb5450f2da8395f8770ef137"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a2f09d5bdfb5450f2da8395f8770ef137">ProSHADE_internal_mapManip::translatePDBCoordinates</a></div><div class="ttdeci">void translatePDBCoordinates(gemmi::Structure *pdbFile, proshade_double transX, proshade_double transY, proshade_double transZ, bool firstModel)</div><div class="ttdoc">Function for translating the PDB file co-ordinates by given distances in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00381">ProSHADE_mapManip.cpp:381</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a47bf2343b0b50267e8e3732c964b63ea"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47bf2343b0b50267e8e3732c964b63ea">ProSHADE_internal_data::ProSHADE_data::mapCOMProcessChangeY</a></div><div class="ttdeci">proshade_double mapCOMProcessChangeY</div><div class="ttdoc">The change in Y axis between the creation of the structure (originalMapYCom) and just before rotation...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00098">ProSHADE_data.hpp:98</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9dbcec9f32eb76625d7aa59d8c2701d9"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9dbcec9f32eb76625d7aa59d8c2701d9">ProSHADE_internal_data::ProSHADE_data::bAngle</a></div><div class="ttdeci">proshade_single bAngle</div><div class="ttdoc">This is the angle b of the map cell in degrees.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00063">ProSHADE_data.hpp:63</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_acf6c5376edac98e54ef0e418cd05d706"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#acf6c5376edac98e54ef0e418cd05d706">ProSHADE_internal_maths::getEulerZXZFromSOFTPosition</a></div><div class="ttdeci">void getEulerZXZFromSOFTPosition(proshade_signed band, proshade_signed x, proshade_signed y, proshade_signed z, proshade_double *eulerAlpha, proshade_double *eulerBeta, proshade_double *eulerGamma)</div><div class="ttdoc">Function to find Euler angles (ZXZ convention) from index position in the inverse SOFT map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00963">ProSHADE_maths.cpp:963</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a53cffdab0d66cb88884ec4f46c19a5ff"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a53cffdab0d66cb88884ec4f46c19a5ff">ProSHADE_internal_data::ProSHADE_data::yAxisOriginOriginal</a></div><div class="ttdeci">proshade_signed yAxisOriginOriginal</div><div class="ttdoc">This is the origin position along the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00089">ProSHADE_data.hpp:89</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa75beee618649d6fd9dc850a5a66a551"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa75beee618649d6fd9dc850a5a66a551">ProSHADE_internal_data::ProSHADE_data::aAngle</a></div><div class="ttdeci">proshade_single aAngle</div><div class="ttdoc">This is the angle a of the map cell in degrees.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00062">ProSHADE_data.hpp:62</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_ad9fbf28fda3873fc511fa2000ccba86c"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#ad9fbf28fda3873fc511fa2000ccba86c">ProSHADE_internal_misc::addToDoubleVectorVector</a></div><div class="ttdeci">void addToDoubleVectorVector(std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *vecToAddTo, std::vector&lt; proshade_double &gt; elementToAdd)</div><div class="ttdoc">Adds the element to the vector of vectors.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00233">ProSHADE_misc.cpp:233</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_abea2d62360b17cddca155816d3e485e8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abea2d62360b17cddca155816d3e485e8">ProSHADE_internal_data::ProSHADE_data::reportSymmetryResults</a></div><div class="ttdeci">void reportSymmetryResults(ProSHADE_settings *settings)</div><div class="ttdoc">This function takes prints the report for symmetry detection.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03498">ProSHADE_data.cpp:3498</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a476092aa08dff20d64a895e7b2227b2e"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a476092aa08dff20d64a895e7b2227b2e">ProSHADE_internal_data::ProSHADE_data::figureIndexStartStop</a></div><div class="ttdeci">void figureIndexStartStop(void)</div><div class="ttdoc">Function for determining iterator start and stop positions.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00926">ProSHADE_data.cpp:926</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac57d606fdb59d54bd3f9249941402b12"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac57d606fdb59d54bd3f9249941402b12">ProSHADE_internal_data::ProSHADE_data::isEmpty</a></div><div class="ttdeci">bool isEmpty</div><div class="ttdoc">This variable stated whether the class contains any information.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00139">ProSHADE_data.hpp:139</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2eb10989a2f8d46b849cdaf8410b68be"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">ProSHADE_internal_data::ProSHADE_data::getInvSO3Coeffs</a></div><div class="ttdeci">proshade_complex * getInvSO3Coeffs(void)</div><div class="ttdoc">This function allows access to the inverse SO(3) coefficients array.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03857">ProSHADE_data.cpp:3857</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_aa4957b0a47193ef1042028dc22b350f6"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">ProSHADE_settings::allDetectedIAxes</a></div><div class="ttdeci">std::vector&lt; proshade_unsign &gt; allDetectedIAxes</div><div class="ttdoc">The vector of all detected icosahedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00149">ProSHADE_settings.hpp:149</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_aa3e24ef5a66fa7204a2ba9c27f2f12b9"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#aa3e24ef5a66fa7204a2ba9c27f2f12b9">ProSHADE_settings::forceBounds</a></div><div class="ttdeci">proshade_signed * forceBounds</div><div class="ttdoc">These will be the boundaries to be forced upon the map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00093">ProSHADE_settings.hpp:93</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a42b012ec753ebd1d87a0b6f557e97d1a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a42b012ec753ebd1d87a0b6f557e97d1a">ProSHADE_settings::detectedSymmetry</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; detectedSymmetry</div><div class="ttdoc">The vector of detected symmetry axes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00144">ProSHADE_settings.hpp:144</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5d47aafdd2ec9912225c3c44e2bbc4d8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">ProSHADE_internal_data::ProSHADE_data::yFrom</a></div><div class="ttdeci">proshade_signed yFrom</div><div class="ttdoc">This is the starting index along the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00111">ProSHADE_data.hpp:111</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ac8e62cc8dbd40265e51143c8207b6638"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ac8e62cc8dbd40265e51143c8207b6638">ProSHADE_settings::recommendedSymmetryFold</a></div><div class="ttdeci">proshade_unsign recommendedSymmetryFold</div><div class="ttdoc">The fold of the recommended symmetry C or D type, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00126">ProSHADE_settings.hpp:126</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a16336bdf0b391c953a549d3df115d691"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a></div><div class="ttdeci">void addToUnsignVector(std::vector&lt; proshade_unsign &gt; *vecToAddTo, proshade_unsign elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00099">ProSHADE_misc.cpp:99</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_ac311071faa65db4dfc1886d2a6de78ef"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#ac311071faa65db4dfc1886d2a6de78ef">ProSHADE_internal_mapManip::reSampleMapToResolutionFourier</a></div><div class="ttdeci">void reSampleMapToResolutionFourier(proshade_double *&amp;map, proshade_single resolution, proshade_unsign xDimS, proshade_unsign yDimS, proshade_unsign zDimS, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_single *&amp;corrs)</div><div class="ttdoc">This function re-samples a map to conform to given resolution using Fourier.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l01376">ProSHADE_mapManip.cpp:1376</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_aa373379d6fa4ebebb0f62e66384186e1"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#aa373379d6fa4ebebb0f62e66384186e1">ProSHADE_internal_mapManip::copyMapByBounds</a></div><div class="ttdeci">void copyMapByBounds(proshade_signed xFrom, proshade_signed xTo, proshade_signed yFrom, proshade_signed yTo, proshade_signed zFrom, proshade_signed zTo, proshade_signed origXFrom, proshade_signed origYFrom, proshade_signed origZFrom, proshade_unsign yDimIndices, proshade_unsign zDimIndices, proshade_unsign origXDimIndices, proshade_unsign origYDimIndices, proshade_unsign origZDimIndices, proshade_double *&amp;newMap, proshade_double *origMap)</div><div class="ttdoc">This function copies an old map to a new map with different boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l02082">ProSHADE_mapManip.cpp:2082</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a298bc9a6aae624a091cd97b842a6b618"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a298bc9a6aae624a091cd97b842a6b618">ProSHADE_internal_data::ProSHADE_data::getYAxisOrigin</a></div><div class="ttdeci">proshade_signed * getYAxisOrigin(void)</div><div class="ttdoc">This function allows access to the map Y axis origin value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04039">ProSHADE_data.cpp:4039</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a924d0767561842716b2ac260426cdc19"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a924d0767561842716b2ac260426cdc19">ProSHADE_internal_data::ProSHADE_data::originalPdbRotCenZ</a></div><div class="ttdeci">proshade_double originalPdbRotCenZ</div><div class="ttdoc">The centre of rotation as it relates to the original PDB positions (and not the ProSHADE internal map...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00104">ProSHADE_data.hpp:104</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a2d19df22d740c51de6edafbf679ae3fd"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a2d19df22d740c51de6edafbf679ae3fd">ProSHADE_internal_misc::addToSingleVector</a></div><div class="ttdeci">void addToSingleVector(std::vector&lt; proshade_single &gt; *vecToAddTo, proshade_single elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00055">ProSHADE_misc.cpp:55</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a549bd90e8cdb71762a48aec59a313dd3"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a549bd90e8cdb71762a48aec59a313dd3">ProSHADE_internal_data::ProSHADE_data::ProSHADE_data</a></div><div class="ttdeci">ProSHADE_data()</div><div class="ttdoc">Constructor for getting empty ProSHADE_data class.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00093">ProSHADE_data.cpp:93</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a0ee28b12499554d8dff8752cd5ef072a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a0ee28b12499554d8dff8752cd5ef072a">ProSHADE_settings::firstModelOnly</a></div><div class="ttdeci">bool firstModelOnly</div><div class="ttdoc">Shoud only the first PDB model be used, or should all models be used?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00046">ProSHADE_settings.hpp:46</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__data_8cpp_html_ae2a2bd26e2e081130593c7783c54f293"><div class="ttname"><a href="_pro_s_h_a_d_e__data_8cpp.html#ae2a2bd26e2e081130593c7783c54f293">sortProSHADESymmetryByFSC</a></div><div class="ttdeci">bool sortProSHADESymmetryByFSC(proshade_double *a, proshade_double *b)</div><div class="ttdoc">This function allows using std::sort to sort vectors of ProSHADE symmetry format.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01914">ProSHADE_data.cpp:1914</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a4627b03c4064d3de15efb3ebbf57ed78"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">ProSHADE_settings::axisErrTolerance</a></div><div class="ttdeci">proshade_double axisErrTolerance</div><div class="ttdoc">Allowed error on vector axis in in dot product ( acos ( 1 - axErr ) is the allowed difference in radi...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00122">ProSHADE_settings.hpp:122</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a1f0d2cb45fee521ddb2d0bc30beff3ec"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a1f0d2cb45fee521ddb2d0bc30beff3ec">ProSHADE_settings::useSameBounds</a></div><div class="ttdeci">bool useSameBounds</div><div class="ttdoc">Switch to say that the same boundaries as used for the first should be used for all input maps.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00092">ProSHADE_settings.hpp:92</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad1f180d58f829e2c0fc50569b2425d56"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad1f180d58f829e2c0fc50569b2425d56">ProSHADE_internal_data::ProSHADE_data::zDimIndices</a></div><div class="ttdeci">proshade_unsign zDimIndices</div><div class="ttdoc">This is the size of the map cell z dimension in indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00067">ProSHADE_data.hpp:67</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__data_html_a0b4a8747c321a46b5acf4206feba6c86"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__data.html#a0b4a8747c321a46b5acf4206feba6c86">ProSHADE_internal_data::computeGroupElementsForGroup</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; computeGroupElementsForGroup(proshade_double xAx, proshade_double yAx, proshade_double zAx, proshade_signed fold)</div><div class="ttdoc">This function computes the group elements as rotation matrices (except for the identity element) for ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02980">ProSHADE_data.cpp:2980</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a3cac1bd635aabf3a3370fc26dfa0f49a"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a3cac1bd635aabf3a3370fc26dfa0f49a">ProSHADE_settings::pdbBFactorNewVal</a></div><div class="ttdeci">proshade_double pdbBFactorNewVal</div><div class="ttdoc">Change all PDB B-factors to this value (for smooth maps).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00055">ProSHADE_settings.hpp:55</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad5add825ce8d5e5d9f598f6912f07aff"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad5add825ce8d5e5d9f598f6912f07aff">ProSHADE_internal_data::ProSHADE_data::getRecommendedSymmetryType</a></div><div class="ttdeci">std::string getRecommendedSymmetryType(ProSHADE_settings *settings)</div><div class="ttdoc">This function simply returns the detected recommended symmetry type.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04394">ProSHADE_data.cpp:4394</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a67d6eadd10e10c0b46f1f2e43df7db99"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a67d6eadd10e10c0b46f1f2e43df7db99">ProSHADE_internal_data::ProSHADE_data::zGridIndices</a></div><div class="ttdeci">proshade_unsign zGridIndices</div><div class="ttdoc">As far as I know, this is identical to the zDimIndices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00070">ProSHADE_data.hpp:70</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a96a407a325278aec10d10a15c480c077"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a96a407a325278aec10d10a15c480c077">ProSHADE_settings::setRecommendedFold</a></div><div class="ttdeci">void setRecommendedFold(proshade_unsign val)</div><div class="ttdoc">Sets the ProSHADE detected symmetry fold.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l01233">ProSHADE.cpp:1233</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a192954646aa4b895b5fc522e79ea38cf"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a192954646aa4b895b5fc522e79ea38cf">ProSHADE_settings::setVariablesLeftOnAuto</a></div><div class="ttdeci">void setVariablesLeftOnAuto(void)</div><div class="ttdoc">Function to determine general values that the user left on auto-determination.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l00333">ProSHADE.cpp:333</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aca5af5c8c3b18275e65ae4ebacd9877c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aca5af5c8c3b18275e65ae4ebacd9877c">ProSHADE_internal_data::ProSHADE_data::setEMatrixValue</a></div><div class="ttdeci">void setEMatrixValue(proshade_unsign band, proshade_unsign order1, proshade_unsign order2, proshade_complex val)</div><div class="ttdoc">This function allows setting the E matrix value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04128">ProSHADE_data.cpp:4128</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_acea4abeec3e2b45524e23809a69dce9d"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#acea4abeec3e2b45524e23809a69dce9d">ProSHADE_settings::removeWaters</a></div><div class="ttdeci">bool removeWaters</div><div class="ttdoc">Should all waters be removed from input PDB files?</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00045">ProSHADE_settings.hpp:45</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa414664dde18320cc52075640590d51d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa414664dde18320cc52075640590d51d">ProSHADE_internal_data::ProSHADE_data::spheres</a></div><div class="ttdeci">ProSHADE_internal_spheres::ProSHADE_sphere ** spheres</div><div class="ttdoc">The set of concentric spheres to which the intermal density map has been projected.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00120">ProSHADE_data.hpp:120</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a255bdb77824ce0fddc2454d5823219e1"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a255bdb77824ce0fddc2454d5823219e1">ProSHADE_internal_data::ProSHADE_data::normaliseMap</a></div><div class="ttdeci">void normaliseMap(ProSHADE_settings *settings)</div><div class="ttdoc">Function for normalising the map values to mean 0 and sd 1..</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01155">ProSHADE_data.cpp:1155</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_abcf770f9177a4d2f1a94a3adb20bf790"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abcf770f9177a4d2f1a94a3adb20bf790">ProSHADE_internal_data::ProSHADE_data::detectSymmetryFromAngleAxisSpace</a></div><div class="ttdeci">void detectSymmetryFromAngleAxisSpace(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *axes, std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *allCs)</div><div class="ttdoc">This function runs the symmetry detection algorithms on this structure using the angle-axis space and...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01934">ProSHADE_data.cpp:1934</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a923cdc6e27455ba99ce5f536932f3721"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a923cdc6e27455ba99ce5f536932f3721">ProSHADE_internal_data::ProSHADE_data::originalPdbRotCenX</a></div><div class="ttdeci">proshade_double originalPdbRotCenX</div><div class="ttdoc">The centre of rotation as it relates to the original PDB positions (and not the ProSHADE internal map...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00102">ProSHADE_data.hpp:102</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac00197ab71e3353cb2884be0e51d6cd3"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac00197ab71e3353cb2884be0e51d6cd3">ProSHADE_internal_data::ProSHADE_data::originalMapZCom</a></div><div class="ttdeci">proshade_double originalMapZCom</div><div class="ttdoc">The COM of the first map to be loaded/computed without any furhter changes being reflacted along the ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00093">ProSHADE_data.hpp:93</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__messages_html_a6aa8cdb600cad623409802cfaed494fa"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a></div><div class="ttdeci">void printProgressMessage(proshade_signed verbose, proshade_signed messageLevel, std::string message)</div><div class="ttdoc">General stdout message printing.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__messages_8cpp_source.html#l00070">ProSHADE_messages.cpp:70</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a30eac0ab5b69c1b7190d6e56571ba8b8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a30eac0ab5b69c1b7190d6e56571ba8b8">ProSHADE_internal_data::ProSHADE_data::getRealSO3Coeffs</a></div><div class="ttdeci">void getRealSO3Coeffs(double *so3CoefsReal, int len)</div><div class="ttdoc">This function fills the input array with the real SO(3) coefficient values.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04236">ProSHADE_data.cpp:4236</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a37b2746ce3f6560446b4eb45ba552084"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a37b2746ce3f6560446b4eb45ba552084">ProSHADE_internal_data::ProSHADE_data::yDimSize</a></div><div class="ttdeci">proshade_single yDimSize</div><div class="ttdoc">This is the size of the map cell y dimension in Angstroms.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00060">ProSHADE_data.hpp:60</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a3e7f4174b62aa402a1f6d3becd8e9dd5"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a3e7f4174b62aa402a1f6d3becd8e9dd5">ProSHADE_settings::setResolution</a></div><div class="ttdeci">void setResolution(proshade_single resolution)</div><div class="ttdoc">Sets the requested resolution in the appropriate variable.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e_8cpp_source.html#l00382">ProSHADE.cpp:382</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a2ac59de43dacdd96c7f89811f80d2e7e"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a2ac59de43dacdd96c7f89811f80d2e7e">ProSHADE_settings::allDetectedCAxes</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; allDetectedCAxes</div><div class="ttdoc">The vector of all detected cyclic symmetry axes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00145">ProSHADE_settings.hpp:145</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5919acc2f26efcf373db47ed96eadc38"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5919acc2f26efcf373db47ed96eadc38">ProSHADE_internal_data::ProSHADE_data::removePhaseInormation</a></div><div class="ttdeci">void removePhaseInormation(ProSHADE_settings *settings)</div><div class="ttdoc">This function removes phase from the map, effectively converting it to Patterson map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03676">ProSHADE_data.cpp:3676</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a037825616c60bef58075284449872642"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">ProSHADE_internal_mapManip::moveMapByIndices</a></div><div class="ttdeci">void moveMapByIndices(proshade_single *xMov, proshade_single *yMov, proshade_single *zMov, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed *xFrom, proshade_signed *xTo, proshade_signed *yFrom, proshade_signed *yTo, proshade_signed *zFrom, proshade_signed *zTo, proshade_signed *xOrigin, proshade_signed *yOrigin, proshade_signed *zOrigin)</div><div class="ttdoc">Function for moving map back to original PDB location by changing the indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00763">ProSHADE_mapManip.cpp:763</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__io_html_a9677e06f0781855b9046aab1b3638831"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__io.html#a9677e06f0781855b9046aab1b3638831">ProSHADE_internal_io::readInMapHeader</a></div><div class="ttdeci">void readInMapHeader(gemmi::Ccp4&lt; float &gt; *map, proshade_unsign *xDimInds, proshade_unsign *yDimInds, proshade_unsign *zDimInds, proshade_single *xDim, proshade_single *yDim, proshade_single *zDim, proshade_single *aAng, proshade_single *bAng, proshade_single *cAng, proshade_signed *xFrom, proshade_signed *yFrom, proshade_signed *zFrom, proshade_signed *xAxOrigin, proshade_signed *yAxOrigin, proshade_signed *zAxOrigin, proshade_unsign *xAxOrder, proshade_unsign *yAxOrder, proshade_unsign *zAxOrder, proshade_unsign *xGridInds, proshade_unsign *yGridInds, proshade_unsign *zGridInds)</div><div class="ttdoc">This function parses the CCP4 MAP file header as read in by gemmi.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__io_8cpp_source.html#l00109">ProSHADE_io.cpp:109</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a18222a942e5fff8eecd15f1235c609e1"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a18222a942e5fff8eecd15f1235c609e1">ProSHADE_internal_maths::multiplyGroupElementMatrices</a></div><div class="ttdeci">std::vector&lt; proshade_double &gt; multiplyGroupElementMatrices(std::vector&lt; proshade_double &gt; *el1, std::vector&lt; proshade_double &gt; *el2)</div><div class="ttdoc">This function computes matrix multiplication using the ProSHADE group element matrix format as input ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l02245">ProSHADE_maths.cpp:2245</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a59f2f2ce1bfdb90432c5a29600fdd9e6"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59f2f2ce1bfdb90432c5a29600fdd9e6">ProSHADE_internal_data::ProSHADE_data::readInStructure</a></div><div class="ttdeci">void readInStructure(std::string fName, proshade_unsign inputO, ProSHADE_settings *settings)</div><div class="ttdoc">This function initialises the basic ProSHADE_data variables and reads in a single structure.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00501">ProSHADE_data.cpp:501</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae2f2469c7d252c5e87d7bf9976b9b796"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae2f2469c7d252c5e87d7bf9976b9b796">ProSHADE_internal_data::ProSHADE_data::getAllGroupElements</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; getAllGroupElements(ProSHADE_settings *settings, std::vector&lt; proshade_unsign &gt; axesList, std::string groupType=&quot;&quot;, proshade_double matrixTolerance=0.05)</div><div class="ttdoc">This function returns the group elements as rotation matrices of any defined point group.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03199">ProSHADE_data.cpp:3199</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a7a402c710af1af5fabf7505848dad047"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7a402c710af1af5fabf7505848dad047">ProSHADE_internal_data::ProSHADE_data::addExtraSpace</a></div><div class="ttdeci">void addExtraSpace(ProSHADE_settings *settings)</div><div class="ttdoc">This function increases the size of the map so that it can add empty space around it.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01503">ProSHADE_data.cpp:1503</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa757f9d32ebe20435661599652fd30fa"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa757f9d32ebe20435661599652fd30fa">ProSHADE_internal_data::ProSHADE_data::getRealEMatrixValuesForLM</a></div><div class="ttdeci">void getRealEMatrixValuesForLM(proshade_signed band, proshade_signed order1, double *eMatsLMReal, int len)</div><div class="ttdoc">This function fills the input array with the real E matrix values for particular band and order1 (l a...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04198">ProSHADE_data.cpp:4198</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a60e14917f99e745c35cc400475ad6ca5"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a60e14917f99e745c35cc400475ad6ca5">ProSHADE_internal_misc::addToStringVector</a></div><div class="ttdeci">void addToStringVector(std::vector&lt; std::string &gt; *vecToAddTo, std::string elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00033">ProSHADE_misc.cpp:33</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__spherical_harmonics_html_a3fa7caeb0d21183a39d7cca2d889c437"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__spherical_harmonics.html#a3fa7caeb0d21183a39d7cca2d889c437">ProSHADE_internal_sphericalHarmonics::computeSphericalHarmonics</a></div><div class="ttdeci">void computeSphericalHarmonics(proshade_unsign band, proshade_double *sphereMappedData, proshade_complex *&amp;shArray)</div><div class="ttdoc">This function computes the spherical harmonics of a aingle shell, saving them in supplied pointer.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spherical_harmonics_8cpp_source.html#l00394">ProSHADE_sphericalHarmonics.cpp:394</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__data_8cpp_html_ae56351defa0ee4f5777b61e58150aba4"><div class="ttname"><a href="_pro_s_h_a_d_e__data_8cpp.html#ae56351defa0ee4f5777b61e58150aba4">checkElementAlreadyExists</a></div><div class="ttdeci">bool checkElementAlreadyExists(std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *elements, std::vector&lt; proshade_double &gt; *elem, proshade_double matrixTolerance)</div><div class="ttdoc">This function checks if the element list already contains a given matrix.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03066">ProSHADE_data.cpp:3066</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_abd1c1b3588308f775da5c8aeba3f3e78"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#abd1c1b3588308f775da5c8aeba3f3e78">ProSHADE_internal_data::ProSHADE_data::readInPDB</a></div><div class="ttdeci">void readInPDB(ProSHADE_settings *settings)</div><div class="ttdoc">Function for reading pdb data.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00725">ProSHADE_data.cpp:725</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afbbcec01a6ee7701e3b1d0e61730fadf"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afbbcec01a6ee7701e3b1d0e61730fadf">ProSHADE_internal_data::ProSHADE_data::getZFromPtr</a></div><div class="ttdeci">proshade_signed * getZFromPtr(void)</div><div class="ttdoc">This function allows access to the map start along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03989">ProSHADE_data.cpp:3989</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a68eb739dd4846a1dd48032eb2cc3f49c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a68eb739dd4846a1dd48032eb2cc3f49c">ProSHADE_internal_data::ProSHADE_data::getZToPtr</a></div><div class="ttdeci">proshade_signed * getZToPtr(void)</div><div class="ttdoc">This function allows access to the map last position along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04019">ProSHADE_data.cpp:4019</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a9f6ba75b25e201466929bfd4df75688d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a9f6ba75b25e201466929bfd4df75688d">ProSHADE_internal_data::ProSHADE_data::so3CoeffsArrayIndex</a></div><div class="ttdeci">int so3CoeffsArrayIndex(proshade_signed order1, proshade_signed order2, proshade_signed band)</div><div class="ttdoc">This function gets the SO(3) coefficients array index for a particular so(3) band,...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l04276">ProSHADE_data.cpp:4276</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_fa9be34cc2c3eb9c0decdfb277595ca7.html">proshade</a></li><li class="navelem"><a class="el" href="_pro_s_h_a_d_e__data_8cpp.html">ProSHADE_data.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
