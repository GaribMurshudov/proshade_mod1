<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ProSHADE: src/proshade/ProSHADE_symmetry.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ProSHADE
   &#160;<span id="projectnumber">0.7.6.1 (AUG 2021)</span>
   </div>
   <div id="projectbrief">Protein Shape Detection</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_pro_s_h_a_d_e__symmetry_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ProSHADE_symmetry.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_pro_s_h_a_d_e__symmetry_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//==================================================== ProSHADE</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_pro_s_h_a_d_e__symmetry_8hpp.html">ProSHADE_symmetry.hpp</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//==================================================== Local functions prototypes</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;proshade_double                               <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#af62700fc94d2901ec61928d01773ea57">determinePeakThreshold</a>      ( std::vector &lt; proshade_double &gt; inArr, proshade_double noIQRsFromMedian );</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keywordtype">bool</span>                                          <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#afe2404666a504704a67e634c2abe186c">sortProSHADESymmetryByPeak</a>  ( proshade_double* a, proshade_double* b );</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;std::vector &lt; std::pair&lt; proshade_unsign, proshade_unsign &gt; &gt; <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#a16b3a0c170d01be9b4fad682f90025a5">findBestIcosDihedralPair</a>    ( std::vector&lt; proshade_double* &gt;* CSymList, proshade_double minPeakHeight, proshade_double axErr );</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;std::pair&lt; proshade_unsign, proshade_unsign &gt; <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#a458a09071115478efb8b666b839c18f2">findBestOctaDihedralPair</a>    ( std::vector&lt; proshade_double* &gt;* CSymList, proshade_double minPeakHeight, proshade_double axErr );</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;std::pair&lt; proshade_unsign, proshade_unsign &gt; <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#a02e0d7dfd2961c534fa1d5ab4c3002e3">findBestTetraDihedralPair</a>   ( std::vector&lt; proshade_double* &gt;* CSymList, proshade_double minPeakHeight, proshade_double axErr );</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac7cb89ed871668c57a3b5dc953c20482">   41</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac7cb89ed871668c57a3b5dc953c20482">ProSHADE_internal_data::ProSHADE_data::computeRotationFunction</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting self-rotation function computation.&quot;</span> );</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">//================================================ Compute un-weighted E matrices and their weights</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#add48230d67bd69305df058d29a588507">ProSHADE_internal_distances::computeEMatrices</a>     ( <span class="keyword">this</span>, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">//================================================ Normalise E matrices by the magnitudes</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#ac96ff1a23997199af76e58885a1ee1e2">ProSHADE_internal_distances::normaliseEMatrices</a>   ( <span class="keyword">this</span>, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">//================================================ Generate SO(3) coefficients</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#afacb5240b508ea28b64cacf395b47dba">ProSHADE_internal_distances::generateSO3CoeffsFromEMatrices</a> ( <span class="keyword">this</span>, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">//================================================ Compute the inverse SO(3) Fourier Transform (SOFT) on the newly computed coefficients</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__distances.html#a3cdde76bf20d9cd5d756ffde2d3dc854">ProSHADE_internal_distances::computeInverseSOFTTransform</a> ( <span class="keyword">this</span>, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Self-rotation function obtained.&quot;</span> );</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    return ;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;}</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="_pro_s_h_a_d_e__symmetry_8cpp.html#af62700fc94d2901ec61928d01773ea57">   71</a></span>&#160;proshade_double <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#af62700fc94d2901ec61928d01773ea57">determinePeakThreshold</a> ( std::vector &lt; proshade_double &gt; inArr, proshade_double noIQRsFromMedian )</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    proshade_double ret                               = 0.0;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    proshade_unsign vecSize                           = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( inArr.size() );</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    proshade_double* meadianAndIQR                    = <span class="keyword">new</span> proshade_double[2];</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">//================================================ Deal with low number of input cases</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">if</span> ( vecSize == 0 ) { <span class="keyword">delete</span>[] meadianAndIQR; <span class="keywordflow">return</span> ( ret ); }                                                                   <span class="comment">// Return 0</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> ( vecSize &lt;= 4 ) { ret = std::accumulate ( inArr.begin(), inArr.end(), 0.0 ) / <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( vecSize ); }   <span class="comment">// Return mean</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">//================================================ Deal with reasonable number in input cases</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="comment">//============================================ Allocate memory for median and IQR computation</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( meadianAndIQR, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="comment">//============================================ Find median and IQR</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#af185ca14eb5d82fb126092767746e00a">ProSHADE_internal_maths::vectorMedianAndIQR</a>   ( &amp;inArr, meadianAndIQR );</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="comment">//============================================ Get the threshold</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        ret                                           = meadianAndIQR[0] + ( meadianAndIQR[1] * noIQRsFromMedian );</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">//================================================ Sanity checks</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> ( ret &gt; *( std::max_element ( inArr.begin(), inArr.end() ) ) )</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        ret                                           = *( std::max_element ( inArr.begin(), inArr.end() ) );</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keyword">delete</span>[] meadianAndIQR;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad96cd7a72fc56e7d97cfeff1086faad9">  120</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad96cd7a72fc56e7d97cfeff1086faad9">ProSHADE_internal_data::ProSHADE_data::convertRotationFunction</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;{</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting self-rotation function conversion to angle-axis representation.&quot;</span> );</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    proshade_double shellSpacing                      = ( 2.0 * M_PI ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;maxShellBand ) * 2.0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    std::vector&lt; proshade_double &gt; allPeakHeights;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">//================================================ Initialise the spheres</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign spIt = 1; spIt &lt; ( this-&gt;maxShellBand * 2 ); spIt++ )</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        this-&gt;sphereMappedRotFun.emplace_back         ( <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a>( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( spIt ) * shellSpacing,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                                                                                               shellSpacing,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                                                                                                               this-&gt;maxShellBand * 2,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                                                                                               <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( spIt ) * shellSpacing,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                                                                                               spIt - 1 ) );</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">//================================================ Interpolate the rotation function onto the spheres</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign shIt = 0; shIt &lt; static_cast&lt;proshade_unsign&gt; ( sphereMappedRotFun.size() ); shIt++ )</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        std::stringstream hlpSS;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;Interpolating sphere &quot;</span> &lt;&lt; shIt &lt;&lt; <span class="stringliteral">&quot; ( radius: &quot;</span> &lt;&lt; this-&gt;sphereMappedRotFun.at(shIt)-&gt;getRadius() &lt;&lt; <span class="stringliteral">&quot; ).&quot;</span>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, hlpSS.str() );</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">//============================================ Interpolate onto spheres</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        this-&gt;sphereMappedRotFun.at(shIt)-&gt;interpolateSphereValues ( this-&gt;getInvSO3Coeffs ( ) );</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Self-rotation function converted to spherical angle-axis space.&quot;</span> );</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Started peak detection on the angle-axis spheres.&quot;</span> );</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">//================================================ Find all peaks in the sphere grids</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign shIt = 0; shIt &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;sphereMappedRotFun.size() ); shIt++ )</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        this-&gt;sphereMappedRotFun.at(shIt)-&gt;findAllPeaks  ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a26b57d39529ca69a117aceead6b12680">peakNeighbours</a> ), &amp;allPeakHeights );</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot;Detected &quot;</span> &lt;&lt; allPeakHeights.size() &lt;&lt; <span class="stringliteral">&quot; peaks with any height.&quot;</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, hlpSS.str() );</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">//================================================ Compute threshold for small peaks</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    proshade_double peakThres                         = std::max ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a>, <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#af62700fc94d2901ec61928d01773ea57">determinePeakThreshold</a> ( allPeakHeights, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3e7948fd9177bd39ed3dd2320ea2b0bc">noIQRsFromMedianNaivePeak</a> ) );</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    std::stringstream hlpSS2;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    hlpSS2 &lt;&lt; <span class="stringliteral">&quot;From these peaks, decided the threshold will be &quot;</span> &lt;&lt; peakThres &lt;&lt; <span class="stringliteral">&quot; peak height.&quot;</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, hlpSS2.str() );</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">//================================================ Remove too small peaks</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign shIt = 0; shIt &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;sphereMappedRotFun.size() ); shIt++ )</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        this-&gt;sphereMappedRotFun.at(shIt)-&gt;removeSmallPeaks  ( peakThres );</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, <span class="stringliteral">&quot;Peaks detected for all spheres.&quot;</span> );</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    return ;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a421d8cf46b6671857d0054cf0defe17f">  198</a></span>&#160;std::vector&lt; proshade_double* &gt; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a421d8cf46b6671857d0054cf0defe17f">ProSHADE_internal_data::ProSHADE_data::getCyclicSymmetriesList</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting C symmetry detection.&quot;</span> );</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">//================================================ Get list of peaks in the self-rotation map</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    std::vector&lt; proshade_double* &gt; allPeaks          = <a class="code" href="namespace_pro_s_h_a_d_e__internal__peak_search.html#a9874fdfe82bd0d75958f9b250750fd56">ProSHADE_internal_peakSearch::getAllPeaksNaive</a> ( this-&gt;getInvSO3Coeffs (), this-&gt;getMaxBand() * 2,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                                                                                         <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a26b57d39529ca69a117aceead6b12680">peakNeighbours</a> ),</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                                                                                         settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3e7948fd9177bd39ed3dd2320ea2b0bc">noIQRsFromMedianNaivePeak</a> );</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">//================================================ Convert peaks to angle-axis</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    std::vector&lt; proshade_double* &gt; peaksAA           = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#acc08b5c3e227d4671a208cdd68d5c80c">ProSHADE_internal_symmetry::getPeaksAngleAxisPositions</a> ( allPeaks, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a> );</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">//================================================ Sort peaks by height groups</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    std::vector&lt; proshade_double &gt; peakGroupsBoundaries = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a2137fa16a69fc7a8365439e322b67dc8">ProSHADE_internal_symmetry::findPeaksByHeightBoundaries</a> ( peaksAA, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a84e490954883961abf92b9ed5b3cae65">smoothingFactor</a> );</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">//================================================ Get symmetry per group</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; detectedCSymmetries;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed iter = <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( peakGroupsBoundaries.size() - 1 ); iter &gt;= 0; iter-- )</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment">//============================================ Get peaks group peaks only</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        std::vector&lt; proshade_double* &gt; symPeaks;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( peaksAA.size() ); it++ )</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordflow">if</span> ( peaksAA.at(it)[4] &gt; peakGroupsBoundaries.at( <span class="keyword">static_cast&lt;</span> <span class="keywordtype">size_t</span> <span class="keyword">&gt;</span> ( iter ) ) ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a> ( &amp;symPeaks, peaksAA.at(it) ); }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="comment">//============================================ Search for symmetry in these peaks</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        detectedCSymmetries                           = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a648ddad98891a4d8a6af5187d994c5ec">ProSHADE_internal_symmetry::findPeaksCSymmetry</a> ( &amp;symPeaks, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                                                                                          this-&gt;getMaxBand(),</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                                                                                          settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a43e4918d4e7d08787d47788a6dae16ba">symMissPeakThres</a>,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                                                                                          settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>,</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                                                                                          settings-&gt;axisErrToleranceDefault,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                                                                                          <span class="keyword">this</span> );</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="comment">//============================================ Print detected symmetries</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign detIt = 0; detIt &lt; static_cast&lt;proshade_unsign&gt; ( detectedCSymmetries.size() ); detIt++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af4b044752fe0a780a3f09743e9d8d58e">ProSHADE_internal_symmetry::printSymmetryGroup</a> ( detectedCSymmetries.at(detIt), symPeaks, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a> ); }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="comment">//============================================ Save detected</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a870711ceabba16c8fc79bd93d26b11a8">ProSHADE_internal_symmetry::saveAllCSymmetries</a> ( detectedCSymmetries, symPeaks, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a> );</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( peaksAA.size() ); iter++ ) { <span class="keyword">delete</span>[] allPeaks.at(iter); <span class="keyword">delete</span>[] peaksAA.at(iter); }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">//================================================ Report completion</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aac0456f55cb3bf83707cc3b493e32fb3">ProSHADE_internal_symmetry::printSymmetryCompletion</a> ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span>( ret.size() ), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a> );</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;}</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#acc08b5c3e227d4671a208cdd68d5c80c">  263</a></span>&#160;std::vector&lt; proshade_double* &gt; <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#acc08b5c3e227d4671a208cdd68d5c80c">ProSHADE_internal_symmetry::getPeaksAngleAxisPositions</a> ( std::vector&lt; proshade_double* &gt; allPeaks, proshade_signed verbose )</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;{</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    proshade_double* hlpP                             = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    proshade_double* rotMat                           = <span class="keyword">new</span> proshade_double [9];</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rotMat, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">//================================================ For each peak</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign peakIter = 0; peakIter &lt; static_cast&lt;proshade_unsign&gt; ( allPeaks.size() ); peakIter++ )</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="comment">//============================================ Convert Euler ZXZ angles to rotation matrix</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a> ( allPeaks.at(peakIter)[0], allPeaks.at(peakIter)[1], allPeaks.at(peakIter)[2], rotMat );</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">//============================================ Allocate pointer to results</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        hlpP                                          = <span class="keyword">new</span> proshade_double [5];</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( hlpP, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="comment">//============================================ Convert rotation matrix to Angle-axis reporesentation</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#aafc6f1626c7463de53c9f4f6fa11db22">ProSHADE_internal_maths::getAxisAngleFromRotationMatrix</a> ( rotMat, &amp;hlpP[0], &amp;hlpP[1], &amp;hlpP[2], &amp;hlpP[3] );</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        hlpP[4]                                       = allPeaks.at(peakIter)[3];</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="comment">//============================================ Save results</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a>     ( &amp;ret, hlpP );</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keyword">delete</span>[] rotMat;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    std::stringstream hlpSSP;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    hlpSSP &lt;&lt; <span class="stringliteral">&quot;Found &quot;</span> &lt;&lt; ret.size() &lt;&lt; <span class="stringliteral">&quot; possible peaks.&quot;</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 3, hlpSSP.str() );</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">//================================================ Warning if no peaks!</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span> ( ret.size() &lt; 1 )</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( verbose, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect any symmetries. There are no reasonable peaks in the self-rotation map. If you believe there should be some symmetry, you can try decreasing the resolution or changing the peak IQR threshold.&quot;</span>, <span class="stringliteral">&quot;WS00029&quot;</span> );</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a2137fa16a69fc7a8365439e322b67dc8">  317</a></span>&#160;std::vector&lt; proshade_double &gt; <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a2137fa16a69fc7a8365439e322b67dc8">ProSHADE_internal_symmetry::findPeaksByHeightBoundaries</a> ( std::vector&lt; proshade_double* &gt; allPeaks, proshade_double smoothing )</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;{</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    std::vector&lt; proshade_double &gt; boundaries;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>         ( &amp;boundaries, 0.0 );</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    proshade_double peakContribution                  = 0.0;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">//================================================ Generate Probability Density function (PDF)</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    std::vector&lt; proshade_double &gt; pdf;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">for</span> ( proshade_double iter = 0.0; iter &lt;= 1.0; iter += 0.01 )</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="comment">//============================================ Initialise point</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        peakContribution                              = 0.0;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="comment">//============================================ Sum peak contributions</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( allPeaks.size() ); it++ )</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            peakContribution                         += <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a01087ea3e0db56758d1771618e2e4a45">ProSHADE_internal_maths::normalDistributionValue</a> ( allPeaks.at(it)[4], smoothing, iter );</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment">//============================================ Save result</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;pdf, peakContribution );</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">//================================================ Find boundaries</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    proshade_double prev                              = pdf.at(0);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 1; iter &lt; static_cast&lt;proshade_unsign&gt; ( pdf.size() - 1 ); iter ++ )</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="comment">//============================================ Check for local minima</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">if</span> ( ( prev &gt; pdf.at(iter) ) &amp;&amp; ( pdf.at(iter+1) &gt; pdf.at(iter) ) )</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a> ( &amp;boundaries, <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( iter ) * 0.01 );</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="comment">//============================================ Prepare next iteration</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        prev                                          = pdf.at(iter);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">return</span>                                            ( boundaries );</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a648ddad98891a4d8a6af5187d994c5ec">  375</a></span>&#160;std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a648ddad98891a4d8a6af5187d994c5ec">ProSHADE_internal_symmetry::findPeaksCSymmetry</a> ( std::vector&lt; proshade_double* &gt;* peaks, proshade_signed verbose, proshade_unsign band, proshade_double missPeakThres, proshade_double axisErrTolerance, <span class="keywordtype">bool</span> axisErrToleranceDef, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj )</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;{</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">//======================================== Initialise variables</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; ret;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    std::vector&lt; proshade_double &gt; triedAlready;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    std::vector&lt; proshade_unsign &gt; angsToTry, testedAlready;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    proshade_double angDist, angDivisionRemainder, angDivisionBasis, nextSymmetryError, nextPeakError = ( M_PI * 2.0 ) / ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( band ) * 2.0 );</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">if</span> ( peaks-&gt;size() &lt; 1 ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">//================================================ Group peaks by axes</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; sameAxesGroups = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a98538547e5bcc6192bbbea1d7b51c537">ProSHADE_internal_symmetry::groupSameAxes</a> ( *peaks, axisErrTolerance );</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">//================================================ For each axis group</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign grpIt = 0; grpIt &lt; static_cast&lt;proshade_unsign&gt; ( sameAxesGroups.size() ); grpIt++ )</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="comment">//============================================ Print axis group if need be</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af9835b91e354e4615beb79b5c2a674e9">ProSHADE_internal_symmetry::printSymmetryPeaks</a> ( sameAxesGroups.at(grpIt), *peaks, verbose, grpIt );</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">//============================================ While there are distances between rotation angles in the group</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        triedAlready.clear                            ( );</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        testedAlready.clear                           ( );</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">while</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a2b3fcf4dd97e677da27192cf63dbb678">ProSHADE_internal_symmetry::smallestDistanceBetweenAngles</a> ( sameAxesGroups.at(grpIt), *peaks, &amp;triedAlready, &amp;angDist ) )</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="comment">//======================================== Check if testable fold value exists, otherwise test other distances</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            angsToTry.clear                           ( );</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="keywordflow">if</span> ( !<a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ac0a8dc71c37de02256521ebc9178c8d4">ProSHADE_internal_symmetry::determineFoldToTry</a> ( angDist, &amp;angDivisionBasis, &amp;angDivisionRemainder, nextPeakError, &amp;nextSymmetryError, &amp;angsToTry ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="comment">//======================================== If reasonable folds are found, test these for being complete symmetries</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a580f68aa45b9b4f66dff3a4d5daaa316">ProSHADE_internal_symmetry::findSymmetryUsingFold</a> ( dataObj, &amp;angsToTry, &amp;sameAxesGroups.at(grpIt), peaks, &amp;ret, &amp;testedAlready, axisErrTolerance, axisErrToleranceDef, missPeakThres, verbose );</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;}</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a98538547e5bcc6192bbbea1d7b51c537">  426</a></span>&#160;std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a98538547e5bcc6192bbbea1d7b51c537">ProSHADE_internal_symmetry::groupSameAxes</a> ( std::vector&lt; proshade_double* &gt;&amp; peaks, proshade_double errTolerance )</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;{</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; ret;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordtype">bool</span> sameAxisFound                                = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    proshade_double angTolerance                      = std::acos ( 1.0 - errTolerance );</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">//================================================ Set all largest axis value to positive (this will make the 0,0,1 and 0,0,-1 axes the same)</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a41150b2f8995b2ac1f144143fc83b6ee">ProSHADE_internal_symmetry::giveOppositeAxesSameDirection</a> ( peaks );</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">//================================================ For each axis</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign peakIter = 0; peakIter &lt; static_cast&lt;proshade_unsign&gt; ( peaks.size() ); peakIter++ )</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">//============================================ Initialise variables for next peak</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        sameAxisFound                                 = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="comment">//============================================ Ignore zero angle peaks</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordflow">if</span> ( ( peaks.at(peakIter)[3] - angTolerance &lt;= 0.0 ) &amp;&amp; ( peaks.at(peakIter)[3] + angTolerance &gt; 0.0 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="comment">//============================================ Ignore very small axis peaks - the axis may be wrong here.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">// !! The value of 0.1 is hardcoded, but arbitrary</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">if</span> ( ( ( peaks.at(peakIter)[0] - 0.1 &lt;= 0.0 ) &amp;&amp; ( peaks.at(peakIter)[0] + 0.1 &gt; 0.0 ) ) &amp;&amp;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;             ( ( peaks.at(peakIter)[1] - 0.1 &lt;= 0.0 ) &amp;&amp; ( peaks.at(peakIter)[1] + 0.1 &gt; 0.0 ) ) &amp;&amp;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;             ( ( peaks.at(peakIter)[2] - 0.1 &lt;= 0.0 ) &amp;&amp; ( peaks.at(peakIter)[2] + 0.1 &gt; 0.0 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="comment">//============================================ Compare to all already detected axes groups</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign sameAxisGrp = 0; sameAxisGrp &lt; static_cast&lt;proshade_unsign&gt; ( ret.size() ); sameAxisGrp++ )</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <span class="comment">//======================================== and all their members</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign sameAxis = 0; sameAxis &lt; static_cast&lt;proshade_unsign&gt; ( ret.at(sameAxisGrp).size() ); sameAxis++ )</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <span class="comment">//==================================== Is this identical axis to the tested one?</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2b2f67cba1eea57f19fdaf062db74fde">ProSHADE_internal_maths::vectorOrientationSimilarity</a> ( peaks.at(ret.at(sameAxisGrp).at(sameAxis))[0],</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                                                            peaks.at(ret.at(sameAxisGrp).at(sameAxis))[1],</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                                                            peaks.at(ret.at(sameAxisGrp).at(sameAxis))[2],</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                                                            peaks.at(peakIter)[0],</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                                                            peaks.at(peakIter)[1],</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                                                            peaks.at(peakIter)[2],</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                                                                            errTolerance ) )</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    sameAxisFound                     = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;ret.at(sameAxisGrp), peakIter );</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="comment">//============================================ If same axis was found, do nothing</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="keywordflow">if</span> ( sameAxisFound ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="comment">//============================================ No similar axis was found</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        std::vector&lt;proshade_unsign&gt; hlpVec;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a>     ( &amp;hlpVec, peakIter );</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a86e2bb172f766ab4a620df482d2fe481">ProSHADE_internal_misc::addToUnsignVectorVector</a> ( &amp;ret, hlpVec );</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">//================================================ Add zero peak to all axes</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ade9b717260e86c8f24bcbe6d17fe4e06">ProSHADE_internal_symmetry::addZeroPeakToGroups</a>   ( ret, peaks );</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a41150b2f8995b2ac1f144143fc83b6ee">  498</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a41150b2f8995b2ac1f144143fc83b6ee">ProSHADE_internal_symmetry::giveOppositeAxesSameDirection</a> ( std::vector&lt; proshade_double* &gt; peaks )</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;{</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">//================================================ Apply to all peaks</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign i = 0; i &lt; static_cast&lt;proshade_unsign&gt; ( peaks.size() ); i++ )</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( std::max ( std::abs ( peaks.at(i)[0] ), std::max( std::abs ( peaks.at(i)[1] ), std::abs ( peaks.at(i)[2] ) ) ) );</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs1 ( std::abs ( peaks.at(i)[0] ) );</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs2 ( std::abs ( peaks.at(i)[1] ) );</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs3 ( std::abs ( peaks.at(i)[2] ) );</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordflow">if</span> ( ( ( lhs1.AlmostEquals ( rhs1 ) ) &amp;&amp; ( peaks.at(i)[0] &lt; 0.0 ) ) ||</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;             ( ( lhs1.AlmostEquals ( rhs2 ) ) &amp;&amp; ( peaks.at(i)[1] &lt; 0.0 ) ) ||</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;             ( ( lhs1.AlmostEquals ( rhs3 ) ) &amp;&amp; ( peaks.at(i)[2] &lt; 0.0 ) ) )</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            peaks.at(i)[0]                           *= -1.0;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            peaks.at(i)[1]                           *= -1.0;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            peaks.at(i)[2]                           *= -1.0;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            peaks.at(i)[3]                           *= -1.0;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    return ;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;}</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af9835b91e354e4615beb79b5c2a674e9">  529</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af9835b91e354e4615beb79b5c2a674e9">ProSHADE_internal_symmetry::printSymmetryPeaks</a> ( std::vector&lt; proshade_unsign &gt; grp, std::vector&lt; proshade_double* &gt; peaks, proshade_signed verbose, proshade_unsign groupNo )</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;{</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">//================================================ Symmetry group output header</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot;Symmetry axis group &quot;</span> &lt;&lt; groupNo;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 6, hlpSS.str() );</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 6, <span class="stringliteral">&quot;Peak index\t\tx\t y\t z\tAngle\tPeak heiht&quot;</span> );</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">//================================================ Print the symmetry group</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign axIt = 0; axIt &lt; static_cast&lt;proshade_unsign&gt; ( grp.size() ); axIt++ )</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        std::stringstream SS;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        SS &lt;&lt; <span class="stringliteral">&quot;    &quot;</span> &lt;&lt; axIt &lt;&lt; <span class="stringliteral">&quot;\t      &quot;</span> &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( peaks.at(grp.at(axIt))[0] * 100.0 ) / 100.0 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( peaks.at(grp.at(axIt))[1] * 100.0 ) / 100.0 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( peaks.at(grp.at(axIt))[2] * 100.0 ) / 100.0 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( peaks.at(grp.at(axIt))[3] * 100.0 ) / 100.0 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( peaks.at(grp.at(axIt))[4] * 100.0 ) / 100.0;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( verbose, 6, SS.str() );</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    return ;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;}</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a2b3fcf4dd97e677da27192cf63dbb678">  562</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a2b3fcf4dd97e677da27192cf63dbb678">ProSHADE_internal_symmetry::smallestDistanceBetweenAngles</a> ( std::vector&lt; proshade_unsign &gt; grp, std::vector&lt; proshade_double* &gt; peaks, std::vector&lt; proshade_double &gt;* tried, proshade_double* dist )</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;{</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordtype">bool</span> ret                                          = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordtype">bool</span> skip                                         = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    proshade_unsign g1 = 0, g2 = 0;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   *dist                                              = 999.9;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">//================================================ For each group pair</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign gr1It = 0; gr1It &lt; static_cast&lt;proshade_unsign&gt; ( grp.size() ); gr1It++ )</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign gr2It = 1; gr2It &lt; static_cast&lt;proshade_unsign&gt; ( grp.size() ); gr2It++ )</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="comment">//======================================== Unique pairs only</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="keywordflow">if</span> ( gr1It &gt;= gr2It ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <span class="comment">//======================================== Have we tried this already?</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            skip                                      = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( tried-&gt;size() ); iter += 3 )</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                <span class="comment">//==================================== Avoid already tested combinations</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( gr2It ) ), rhs1 ( tried-&gt;at( iter + 1 ) );</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs2 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( gr1It ) ), rhs2 ( tried-&gt;at( iter ) );</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                <span class="keywordflow">if</span> ( ( lhs1.AlmostEquals ( rhs1 ) ) &amp;&amp; ( lhs2.AlmostEquals ( rhs2 ) ) ) { skip = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                <span class="comment">//==================================== Also avoid distances very close to already tested  distances (no problem until approx C700)</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                <span class="keywordflow">if</span> ( !skip &amp;&amp;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                     ( ( std::abs( std::abs ( peaks.at(grp.at(gr1It))[3] ) - std::abs ( peaks.at(grp.at(gr2It))[3] ) ) - 0.01 ) &lt; tried-&gt;at( iter + 2 ) ) &amp;&amp;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                     ( ( std::abs( std::abs ( peaks.at(grp.at(gr1It))[3] ) - std::abs ( peaks.at(grp.at(gr2It))[3] ) ) + 0.01 ) &gt; tried-&gt;at( iter + 2 ) ) )</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                    skip                              = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <span class="keywordflow">if</span> ( skip ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="comment">//======================================== Is this the smallest distance?</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="keywordflow">if</span> ( std::abs( std::abs ( peaks.at(grp.at(gr1It))[3] ) - std::abs ( peaks.at(grp.at(gr2It))[3] ) ) &lt; (*dist) )</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                <span class="comment">//==================================== Avoid very small angle distances as they would just take time (the hardcoded value would only be a problem for C700 and larger symmetries...</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                <span class="keywordflow">if</span> ( std::abs( std::abs ( peaks.at(grp.at(gr1It))[3] ) - std::abs ( peaks.at(grp.at(gr2It))[3] ) ) &gt; 0.01 )</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                    g1                                = gr1It;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                    g2                                = gr2It;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                   *dist                              = std::abs( std::abs ( peaks.at(grp.at(gr1It))[3] ) - std::abs ( peaks.at(grp.at(gr2It))[3] ) );</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    }</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="comment">//================================================ If new dist found, save to tried and return success</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( *dist ), rhs1 ( 999.9 );</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">if</span> ( !lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        ret                                           = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( tried, <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( g1 ) );</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( tried, <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( g2 ) );</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( tried, *dist );</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;}</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ade9b717260e86c8f24bcbe6d17fe4e06">  635</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ade9b717260e86c8f24bcbe6d17fe4e06">ProSHADE_internal_symmetry::addZeroPeakToGroups</a> ( std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt;&amp; grpsVec, std::vector&lt; proshade_double* &gt;&amp; peaks )</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;{</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="comment">//================================================ Do your job</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( grpsVec.size() ); iter++ )</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    {</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        proshade_double* hlpP                         = <span class="keyword">new</span> proshade_double [5];</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( hlpP, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        hlpP[0]                                       = peaks.at(grpsVec.at(iter).at(0))[0];</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        hlpP[1]                                       = peaks.at(grpsVec.at(iter).at(0))[1];</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        hlpP[2]                                       = peaks.at(grpsVec.at(iter).at(0))[2];</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        hlpP[3]                                       = 0.0;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        hlpP[4]                                       = peaks.at(grpsVec.at(iter).at(0))[4];</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a>     ( &amp;grpsVec.at(iter), <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( peaks.size() ) );</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a>     ( &amp;peaks, hlpP );</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    return ;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;}</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ac0a8dc71c37de02256521ebc9178c8d4">  672</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ac0a8dc71c37de02256521ebc9178c8d4">ProSHADE_internal_symmetry::determineFoldToTry</a> ( proshade_double dist, proshade_double* divBasis, proshade_double* divRem, proshade_double peakErr, proshade_double* symmErr, std::vector&lt; proshade_unsign &gt;* angsToTry )</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;{</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordtype">bool</span> ret                                          = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">//================================================ Find the basis and remainder of the 2pi/dist equation</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   *divRem                                            = std::modf ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( ( 2.0 * M_PI ) / std::abs ( dist ) ), divBasis );</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">//================================================ If the remainder would be smaller for larger basis, so this basis</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">if</span> ( *divRem &gt; 0.5 )</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;       *divRem                                       -= 1.0;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;       *divBasis                                     += 1.0;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">//================================================ Determine errors on peaks and on folds</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   *symmErr                                           = ( M_PI * 2.0 / *divBasis ) - ( M_PI * 2.0 / ( *divBasis + 1.0 ) );</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    proshade_double angTolerance                      = ( peakErr / *symmErr  );</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">//================================================ Is remainder small enough?</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordflow">if</span> ( ( *divRem &lt; ( 0.0 + angTolerance ) ) &amp;&amp; ( *divRem &gt; ( 0.0 - angTolerance ) ) )</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="comment">//============================================ Are we sure about the fold determination accuracy</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        proshade_signed angTolRound                   = std::min ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a> ( angTolerance ), <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( 10 ) );</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed iter = -angTolRound; iter &lt;= angTolRound; iter++ )</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( angsToTry, <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( std::max ( *divBasis + <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( iter ), 2.0 ) ) );</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">//================================================ Return indication of whether testable fold value(s) was found.</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">if</span> ( angsToTry-&gt;size() == 0 ) { ret = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">else</span> { ret = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordflow">return</span>                                    ( ret );</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;}</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af4f982fc282e8fca11b6a85f2d2069a5">  719</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af4f982fc282e8fca11b6a85f2d2069a5">ProSHADE_internal_symmetry::findExpectedPeakRotations</a> ( proshade_unsign fold, std::vector&lt; proshade_double &gt;* expAngs )</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;{</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    proshade_double groupAngle                        = ( 2.0 * M_PI ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( fold );</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">//================================================ Generate expected angles</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed iter = <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( -( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( fold ) / 2.0 + 1.0) ); iter &lt;= static_cast&lt;proshade_signed&gt; ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( fold )/2.0 + 1.0 ); iter++ )</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( expAngs, <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( iter ) * groupAngle );</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    return ;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;}</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a074d9c1d40d7491ea9f9f9639744e18d">  748</a></span>&#160;proshade_unsign <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a074d9c1d40d7491ea9f9f9639744e18d">ProSHADE_internal_symmetry::checkExpectedAgainstFound</a> ( std::vector&lt; proshade_unsign &gt; grp, std::vector&lt; proshade_double* &gt; peaks, std::vector&lt; proshade_double &gt;* expAngs, std::vector&lt; proshade_unsign &gt;* matchedAngs, std::vector&lt; proshade_unsign &gt;* missingAngs, proshade_double angTol )</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;{</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    proshade_unsign ret                               = 0;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    proshade_unsign retHlp                            = 0;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    proshade_double groupAngle                        = expAngs-&gt;at(1) - expAngs-&gt;at(0);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordtype">bool</span> matchedThisPeak                              = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keywordtype">bool</span> noDoubleMatches                              = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    std::vector &lt; proshade_unsign &gt; matchedAlready;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">//================================================ For each expected peak rotation angle value</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign expAngIt = 0; expAngIt &lt; static_cast&lt;proshade_unsign&gt; ( expAngs-&gt;size() ); expAngIt++ )</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="comment">//============================================ For each peak in the group</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        matchedThisPeak                               = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign peakIt = 0; peakIt &lt; static_cast&lt;proshade_unsign&gt; ( grp.size() ); peakIt++ )</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <span class="keywordflow">if</span> ( ( expAngs-&gt;at(expAngIt) &lt; ( peaks.at(grp.at(peakIt))[3] + angTol ) ) &amp;&amp;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                 ( expAngs-&gt;at(expAngIt) &gt; ( peaks.at(grp.at(peakIt))[3] - angTol ) ) )</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                noDoubleMatches                       = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign ndm = 0; ndm &lt; static_cast&lt;proshade_unsign&gt; ( matchedAlready.size() ); ndm++ )</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                    <span class="keywordflow">if</span> ( matchedAlready.at(ndm) == grp.at(peakIt) ) { noDoubleMatches = <span class="keyword">true</span>; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                <span class="keywordflow">if</span> ( !noDoubleMatches )</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( matchedAngs, grp.at(peakIt) );</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;matchedAlready, grp.at(peakIt) );</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    matchedThisPeak                   = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                }</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="comment">//============================================ If not matched, add to missing</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordflow">if</span> ( !matchedThisPeak )</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( missingAngs, expAngIt );</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">//================================================ Find the number of consecutive matches</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keywordflow">if</span> ( matchedAngs-&gt;size () &gt; 1 )</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 1; iter &lt; static_cast&lt;unsigned int&gt; ( matchedAngs-&gt;size () ); iter++ )</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <span class="keywordflow">if</span> ( ( ( peaks.at(matchedAngs-&gt;at(iter-1))[3] + groupAngle ) &lt; ( peaks.at(matchedAngs-&gt;at(iter))[3] + angTol ) ) &amp;&amp;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                 ( ( peaks.at(matchedAngs-&gt;at(iter-1))[3] + groupAngle ) &gt; ( peaks.at(matchedAngs-&gt;at(iter))[3] - angTol ) ) )</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                retHlp                       += 1;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                retHlp                        = 0;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            <span class="keywordflow">if</span> ( retHlp &gt; ret ) { ret = retHlp; }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">return</span>                                            ( ret + 1 ); <span class="comment">// This is because the count of matches is the count of intervals between numbers, so +1 to get the count of matched numbers.</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;}</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aacced7feb8ce5251dce199505912d997">  830</a></span>&#160;proshade_double <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aacced7feb8ce5251dce199505912d997">ProSHADE_internal_symmetry::checkForMissingPeak</a> ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, proshade_double x, proshade_double y, proshade_double z, proshade_double angle, proshade_double heightThres, proshade_double axTol )</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;{</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    proshade_double ret                               = 0.0;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    proshade_unsign arrIndex                          = 0;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    proshade_double* rotMat                           = <span class="keyword">new</span> proshade_double [9];</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rotMat, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    proshade_double pointHeight, euA, euB, euG, xPk, yPk, zPk, anglPk;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    proshade_double angTol                            = std::acos ( 1.0 - axTol );</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="comment">//================================================ Search the self-rotation map</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign xIt = 0; xIt &lt; ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() * 2 ); xIt++ )</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign yIt = 0; yIt &lt; ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() * 2 ); yIt++ )</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign zIt = 0; zIt &lt; ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() * 2 ); zIt++ )</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                <span class="comment">//==================================== Get height and check against threshold</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                arrIndex                              = zIt  + ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() * 2 ) * ( yIt  + ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() * 2 ) * xIt );</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                pointHeight                           = pow( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">getInvSO3Coeffs</a>()[arrIndex][0], 2.0 ) + pow( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">getInvSO3Coeffs</a>()[arrIndex][1], 2.0 );</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                <span class="keywordflow">if</span> ( pointHeight &lt; heightThres ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                <span class="comment">//==================================== Get angle-axis values</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#acf6c5376edac98e54ef0e418cd05d706">ProSHADE_internal_maths::getEulerZXZFromSOFTPosition</a> ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ), <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( xIt ),</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                                                                       <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( yIt ), <span class="keyword">static_cast&lt;</span>proshade_signed<span class="keyword">&gt;</span> ( zIt ),</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                                                                       &amp;euA, &amp;euB, &amp;euG );</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a> ( euA, euB, euG, rotMat );</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#aafc6f1626c7463de53c9f4f6fa11db22">ProSHADE_internal_maths::getAxisAngleFromRotationMatrix</a> ( rotMat, &amp;xPk, &amp;yPk, &amp;zPk, &amp;anglPk );</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                <span class="comment">//==================================== Check for matching angle</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                <span class="keywordflow">if</span> ( ( ( std::abs( anglPk ) - angTol ) &lt; std::abs ( angle ) ) &amp;&amp; ( ( std::abs( anglPk ) + angTol ) &gt; std::abs ( angle ) ) )</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                    <span class="comment">//================================ Make sure vector direction is the same</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( std::max( std::abs( xPk ), std::max( std::abs( yPk ), std::abs( zPk ) ) ) );</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs1 ( std::abs( xPk ) );</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs2 ( std::abs( yPk ) );</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs3 ( std::abs( zPk ) );</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                    <span class="keywordflow">if</span> ( ( lhs1.AlmostEquals ( rhs1 ) &amp;&amp; ( xPk &lt; 0.0 ) ) ||</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                         ( lhs1.AlmostEquals ( rhs2 ) &amp;&amp; ( yPk &lt; 0.0 ) ) ||</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                         ( lhs1.AlmostEquals ( rhs3 ) &amp;&amp; ( zPk &lt; 0.0 ) ) )</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                    {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                        xPk                          *= -1.0;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                        yPk                          *= -1.0;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                        zPk                          *= -1.0;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                        anglPk                       *= -1.0;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                    }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                    </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                    <span class="comment">//================================ Compare axis elements</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2b2f67cba1eea57f19fdaf062db74fde">ProSHADE_internal_maths::vectorOrientationSimilarity</a> ( xPk, yPk, zPk, x, y, z, axTol ) )</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                    {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                        <span class="keywordflow">if</span> ( ret &lt; pointHeight ) { ret = pointHeight; }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                    }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                }</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            }</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;}</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5dda335a87d6c26edfd3cf2a29ff7f1f">  902</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5dda335a87d6c26edfd3cf2a29ff7f1f">ProSHADE_internal_symmetry::saveDetectedCSymmetry</a> ( proshade_unsign fold, std::vector&lt; proshade_unsign &gt;* matchedPeaks, std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt;* ret, proshade_signed verbose )</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;{</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="comment">//================================================ Save fold as first vector value</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    std::vector&lt; proshade_unsign &gt; hlpVec;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a>         ( &amp;hlpVec, fold );</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="comment">//================================================ and follow it with indices of all symmetry forming peaks</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign pIt = 0; pIt &lt; static_cast&lt;proshade_unsign&gt; ( matchedPeaks-&gt;size() ); pIt++ )</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a>     ( &amp;hlpVec, matchedPeaks-&gt;at(pIt) );</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a86e2bb172f766ab4a620df482d2fe481">ProSHADE_internal_misc::addToUnsignVectorVector</a>   ( ret, hlpVec );</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="comment">//================================================ Report finding symmetry</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    std::stringstream hlpS;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    hlpS &lt;&lt; <span class="stringliteral">&quot;Found symmetry C&quot;</span> &lt;&lt; fold;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 5, hlpS.str() );</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    return ;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;}</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a9304bbd5138aaa9e4f4aed4676af6256">  942</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a9304bbd5138aaa9e4f4aed4676af6256">ProSHADE_internal_symmetry::completeMissingCSymmetry</a> ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, proshade_unsign fold, std::vector&lt; proshade_unsign &gt;* grp, std::vector&lt; proshade_double* &gt;* peaks, std::vector&lt; proshade_unsign &gt;* missingPeaks, std::vector&lt; proshade_double &gt;* expectedAngles, std::vector&lt; proshade_unsign &gt;* matchedPeaks, proshade_double axErrTolerance, proshade_signed verbose )</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;{</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordtype">bool</span> ret                                          = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="comment">//================================================ Report searching for missing peaks</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    std::stringstream hlpSSP;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    hlpSSP &lt;&lt; <span class="stringliteral">&quot;Searching for missing peaks for symmetry C&quot;</span> &lt;&lt; fold;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( verbose, 4, hlpSSP.str() );</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="comment">//================================================ Height threshold for missing peak</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    proshade_double heightThreshold                   = 0.0;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( grp-&gt;size() ); grIt++ ) { heightThreshold += peaks-&gt;at(grp-&gt;at(grIt))[4]; }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    heightThreshold                                  /= <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( grp-&gt;size() );</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    heightThreshold                                  *= 0.5;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="comment">//================================================ For each missing value</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign misPkIt = 0; misPkIt &lt; static_cast&lt;proshade_unsign&gt; ( missingPeaks-&gt;size() ); misPkIt++ )</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <span class="comment">//============================================ Ignore the extra values in the expected values</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="keywordflow">if</span> ( expectedAngles-&gt;at(missingPeaks-&gt;at(misPkIt)) &gt;   M_PI ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <span class="keywordflow">if</span> ( expectedAngles-&gt;at(missingPeaks-&gt;at(misPkIt)) &lt;  -M_PI ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <span class="comment">//============================================ Search for the missing peak</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        proshade_double misHeight = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aacced7feb8ce5251dce199505912d997">ProSHADE_internal_symmetry::checkForMissingPeak</a> ( dataObj, peaks-&gt;at(grp-&gt;at(0))[0], peaks-&gt;at(grp-&gt;at(0))[1], peaks-&gt;at(grp-&gt;at(0))[2], expectedAngles-&gt;at(missingPeaks-&gt;at(misPkIt)), heightThreshold, axErrTolerance );</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="keywordflow">if</span> ( misHeight != 0.0 )</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            <span class="comment">//======================================== Missing peak detected - save it to the group</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            proshade_double* hlpP                     = <span class="keyword">new</span> proshade_double [5];</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( hlpP, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            hlpP[0]                                   = peaks-&gt;at(grp-&gt;at(0))[0];</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            hlpP[1]                                   = peaks-&gt;at(grp-&gt;at(0))[1];</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            hlpP[2]                                   = peaks-&gt;at(grp-&gt;at(0))[2];</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            hlpP[3]                                   = expectedAngles-&gt;at(missingPeaks-&gt;at(misPkIt));</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            hlpP[4]                                   = misHeight;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( matchedPeaks, <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( peaks-&gt;size() ) );</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a> ( peaks, hlpP );</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            ret                                       = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    }</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;}</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a580f68aa45b9b4f66dff3a4d5daaa316"> 1007</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a580f68aa45b9b4f66dff3a4d5daaa316">ProSHADE_internal_symmetry::findSymmetryUsingFold</a> ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, std::vector&lt; proshade_unsign &gt;* angsToTry, std::vector&lt; proshade_unsign &gt;* grp, std::vector&lt; proshade_double* &gt;* peaks, std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt;* ret, std::vector&lt; proshade_unsign &gt;* testedAlready, proshade_double axErrTolerance, <span class="keywordtype">bool</span> axErrToleranceDefault, proshade_double missPeakThres, proshade_signed verbose )</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;{</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordtype">bool</span> skipFold                                     = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    std::vector&lt; proshade_unsign &gt; matchedPeaks, missingPeaks;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    std::vector&lt; proshade_double &gt; expectedAngles;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    proshade_double angTolerance                      = std::acos ( 1.0 - axErrTolerance );</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="comment">//================================================ Testing folds for being supported by peaks</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign fIt = 0; fIt &lt; static_cast&lt;proshade_unsign&gt; ( angsToTry-&gt;size() ); fIt++ )</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="comment">//============================================ Was this fold already found?</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        skipFold                                      = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign ftIt = 0; ftIt &lt; static_cast&lt;proshade_unsign&gt; ( testedAlready-&gt;size() ); ftIt++ ) { <span class="keywordflow">if</span> ( testedAlready-&gt;at(ftIt) == angsToTry-&gt;at(fIt) ) { skipFold = <span class="keyword">true</span>; } }</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <span class="keywordflow">if</span> ( skipFold ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <span class="keywordflow">else</span> { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a>( testedAlready, angsToTry-&gt;at(fIt) ); }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        <span class="comment">//============================================ Set axis tolerance based on fold (if required)</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <span class="keywordflow">if</span> ( axErrToleranceDefault )</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            angTolerance                              = std::max ( std::min ( angTolerance, ( ( (M_PI * 2.0) / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( angsToTry-&gt;at(fIt) ) ) -</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                                                                                              ( (M_PI * 2.0) / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( angsToTry-&gt;at(fIt) + 1 ) ) ) * 2.0 ), 0.02 );</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            axErrTolerance                            = std::max ( 1.0 - std::cos ( angTolerance ), 0.0008 );</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        <span class="comment">//============================================ Find expected peak rotation angles</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        expectedAngles.clear                          ( );</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af4f982fc282e8fca11b6a85f2d2069a5">ProSHADE_internal_symmetry::findExpectedPeakRotations</a> ( angsToTry-&gt;at(fIt), &amp;expectedAngles );</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <span class="comment">//============================================ Compare group to expected angles</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        matchedPeaks.clear                            ( );</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        missingPeaks.clear                            ( );</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        proshade_unsign consecMatches                 = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a074d9c1d40d7491ea9f9f9639744e18d">ProSHADE_internal_symmetry::checkExpectedAgainstFound</a> ( *grp, *peaks, &amp;expectedAngles,</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                                                                                                                &amp;matchedPeaks, &amp;missingPeaks, angTolerance );</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="comment">//============================================ If enough consecutive matches, symmetry was found. Save it</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keywordflow">if</span> ( consecMatches &gt;= angsToTry-&gt;at(fIt) )</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5dda335a87d6c26edfd3cf2a29ff7f1f">ProSHADE_internal_symmetry::saveDetectedCSymmetry</a> ( angsToTry-&gt;at(fIt), &amp;matchedPeaks, ret, verbose );</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        }</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        {</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            <span class="keywordflow">if</span> ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( matchedPeaks.size() ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( angsToTry-&gt;at(fIt) ) ) &gt;= ( 1.0 - missPeakThres ) )</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            {</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                <span class="comment">//==================================== Attempt completing the symmetry  using missing peaks</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a9304bbd5138aaa9e4f4aed4676af6256">ProSHADE_internal_symmetry::completeMissingCSymmetry</a> ( dataObj, angsToTry-&gt;at(fIt), grp, peaks, &amp;missingPeaks,</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                                                                           &amp;expectedAngles, &amp;matchedPeaks, axErrTolerance, verbose ) )</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5dda335a87d6c26edfd3cf2a29ff7f1f">ProSHADE_internal_symmetry::saveDetectedCSymmetry</a> ( angsToTry-&gt;at(fIt), &amp;matchedPeaks, ret, verbose );</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                }</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            {</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                <span class="comment">//=================================== Symmetry not detected</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            }</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        }</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    }</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">//=============================================== Done</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    return ;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;}</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af4b044752fe0a780a3f09743e9d8d58e"> 1077</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af4b044752fe0a780a3f09743e9d8d58e">ProSHADE_internal_symmetry::printSymmetryGroup</a> ( std::vector&lt; proshade_unsign &gt; grp, std::vector&lt; proshade_double* &gt; peaks, proshade_signed verbose )</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;{</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="comment">//================================================ Detected symmetry table header</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;Detected C&quot;</span> &lt;&lt; grp.at(0) &lt;&lt; <span class="stringliteral">&quot; symmetry with following peaks:&quot;</span>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( verbose, 5, ss.str() );</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( verbose, 5, <span class="stringliteral">&quot;\tx\t y\t z\tAngle\tPeak height&quot;</span> );</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="comment">//================================================ Now print all supporting peaks</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign pkIt = 1; pkIt &lt; static_cast&lt;proshade_unsign&gt; ( grp.size() ); pkIt++ )</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    {</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        std::stringstream SS;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        SS &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( peaks.at(grp.at(pkIt))[0] * 100.0 ) / 100.0 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( peaks.at(grp.at(pkIt))[1] * 100.0 ) / 100.0 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( peaks.at(grp.at(pkIt))[2] * 100.0 ) / 100.0 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( peaks.at(grp.at(pkIt))[3] * 100.0 ) / 100.0 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( peaks.at(grp.at(pkIt))[4] * 100.0 ) / 100.0;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( verbose, 5, SS.str() );</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    return ;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;}</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aac0456f55cb3bf83707cc3b493e32fb3"> 1103</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aac0456f55cb3bf83707cc3b493e32fb3">ProSHADE_internal_symmetry::printSymmetryCompletion</a> ( proshade_unsign noSyms, proshade_signed verbose )</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;{</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="comment">//================================================ Report completion of symmetry detection</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;Detected &quot;</span> &lt;&lt; noSyms &lt;&lt; <span class="stringliteral">&quot; Cyclic symmetries.&quot;</span>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 2, ss.str() );</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="comment">//================================================ If no symmetries were found, print warning</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordflow">if</span> ( noSyms &lt; 1 )</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( verbose, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect any symmetries. If you believe there should be one, you can try decreasing the resolution or checking that the map is centred on the centry of symmetry (or use map centering option in ProSHADE).&quot;</span>, <span class="stringliteral">&quot;WS00030&quot;</span> );</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    return ;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;}</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a870711ceabba16c8fc79bd93d26b11a8"> 1133</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a870711ceabba16c8fc79bd93d26b11a8">ProSHADE_internal_symmetry::saveAllCSymmetries</a> ( std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; detected, std::vector&lt; proshade_double* &gt; peaks, std::vector&lt; proshade_double* &gt;* ret, proshade_double axErr )</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;{</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    proshade_double sumX, sumY, sumZ, sumH;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    proshade_signed matchedPos                        = -1;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="comment">//================================================ Start saving</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign symIt = 0; symIt &lt; static_cast&lt;proshade_unsign&gt; ( detected.size() ); symIt++ )</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <span class="comment">//============================================ Allocate the memory</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        proshade_double* hlpP                         = <span class="keyword">new</span> proshade_double [6];</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( hlpP, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="comment">//============================================ Set obvious values</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        hlpP[0]                                       = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( detected.at(symIt).at(0) );</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        hlpP[4]                                       = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( ( 2.0 * M_PI ) / hlpP[0] );</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        </div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        <span class="comment">//============================================ Compute peak averages for rest</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        sumX = 0.0; sumY = 0.0; sumZ = 0.0; sumH = 0.0;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign pkIt = 1; pkIt &lt; static_cast&lt;proshade_unsign&gt; ( detected.at(symIt).size() ); pkIt++ )</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        {</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            sumX                                     += peaks.at(detected.at(symIt).at(pkIt))[0];</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            sumY                                     += peaks.at(detected.at(symIt).at(pkIt))[1];</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            sumZ                                     += peaks.at(detected.at(symIt).at(pkIt))[2];</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            sumH                                     += peaks.at(detected.at(symIt).at(pkIt))[4];</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        }</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        sumX                                         /= <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( detected.at(symIt).size() - 1 );</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        sumY                                         /= <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( detected.at(symIt).size() - 1 );</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        sumZ                                         /= <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( detected.at(symIt).size() - 1 );</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        sumH                                         /= <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( detected.at(symIt).size() - 1 );</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        </div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        <span class="comment">//============================================ And add these as well</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        hlpP[1]                                       = sumX;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        hlpP[2]                                       = sumY;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        hlpP[3]                                       = sumZ;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;        hlpP[5]                                       = sumH;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        <span class="comment">//============================================ Save the complete symmetry description to the vector, unless already there</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        <span class="keywordflow">if</span> ( !<a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad977c265833d6466598cceb406a085db">ProSHADE_internal_symmetry::isSymmetrySame</a> ( ret, hlpP, axErr, &amp;matchedPos ) )</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        {</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a> ( ret, hlpP );</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        }</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;            <span class="keyword">delete</span>[] hlpP;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        }</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    return ;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;}</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160; </div>
<div class="line"><a name="l01197"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad977c265833d6466598cceb406a085db"> 1197</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad977c265833d6466598cceb406a085db">ProSHADE_internal_symmetry::isSymmetrySame</a> ( std::vector&lt; proshade_double* &gt;* ret, proshade_double* sym, proshade_double simThres, proshade_signed* matchedPos )</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;{</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    proshade_double dotProduct                        = 0.0;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;   *matchedPos                                        = -1;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="comment">//================================================ Check</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign symIt = 0; symIt &lt; static_cast&lt;proshade_unsign&gt; ( ret-&gt;size() ); symIt++ )</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    {</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <span class="comment">//============================================ Minor speed-up =&gt; only test for same folds</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs ( ret-&gt;at(symIt)[0] ), rhs ( sym[0] );</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="keywordflow">if</span> ( lhs.AlmostEquals ( rhs ) )</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;            <span class="comment">//======================================== Is axis the same?</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;            dotProduct                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;ret-&gt;at(symIt)[1], &amp;ret-&gt;at(symIt)[2],</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                                                                                                     &amp;ret-&gt;at(symIt)[3], &amp;sym[1], &amp;sym[2], &amp;sym[3] );</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;            <span class="keywordflow">if</span> ( ( ( 1.0 &gt; ( dotProduct - simThres ) ) &amp;&amp; ( 1.0 &lt; ( dotProduct + simThres ) ) ) || ( ( -1.0 &gt; ( dotProduct - simThres ) ) &amp;&amp; ( -1.0 &lt; ( dotProduct + simThres ) ) ) )</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;            {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                <span class="comment">//==================================== Matched. Save the index</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;               *matchedPos                            = <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( symIt );</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                <span class="comment">//==================================== Does the already saved have higher height?</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                <span class="keywordflow">if</span> ( ret-&gt;at(symIt)[5] &gt;= sym[5] ) { <span class="keywordflow">return</span> ( <span class="keyword">true</span> ); }</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                </div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                <span class="comment">//==================================== In this case, new is better than old - sort it out</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                ret-&gt;at(symIt)[1]                     = sym[1];</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                ret-&gt;at(symIt)[2]                     = sym[2];</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                ret-&gt;at(symIt)[3]                     = sym[3];</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                ret-&gt;at(symIt)[5]                     = sym[5];</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                <span class="keywordflow">return</span>                                ( <span class="keyword">true</span> );</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;            }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    </div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="comment">//================================================ Done - no matches found</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">false</span> );</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;}</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01248"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a10af3702dc9022c3afcaf72b049779f3"> 1248</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad977c265833d6466598cceb406a085db">ProSHADE_internal_symmetry::isSymmetrySame</a> ( std::vector&lt; proshade_double* &gt;* ret, proshade_double* sym, proshade_double simThres, proshade_signed* matchedPos, proshade_double fscVal )</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;{</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    proshade_double dotProduct                        = 0.0;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;   *matchedPos                                        = -1;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="comment">//================================================ Check</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign symIt = 0; symIt &lt; static_cast&lt;proshade_unsign&gt; ( ret-&gt;size() ); symIt++ )</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <span class="comment">//============================================ Minor speed-up =&gt; only test for same folds</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs ( ret-&gt;at(symIt)[0] ), rhs ( sym[0] );</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="keywordflow">if</span> ( lhs.AlmostEquals ( rhs ) )</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        {</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            <span class="comment">//======================================== Is axis the same?</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            dotProduct                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;ret-&gt;at(symIt)[1], &amp;ret-&gt;at(symIt)[2],</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                                                                                                     &amp;ret-&gt;at(symIt)[3], &amp;sym[1], &amp;sym[2], &amp;sym[3] );</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            <span class="keywordflow">if</span> ( ( ( 1.0 &gt; ( dotProduct - simThres ) ) &amp;&amp; ( 1.0 &lt; ( dotProduct + simThres ) ) ) || ( ( -1.0 &gt; ( dotProduct - simThres ) ) &amp;&amp; ( -1.0 &lt; ( dotProduct + simThres ) ) ) )</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                <span class="comment">//==================================== Matched. Save the index</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;               *matchedPos                            = <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( symIt );</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                <span class="comment">//==================================== Does the already saved have higher height?</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                <span class="keywordflow">if</span> ( ret-&gt;at(symIt)[5] &gt;= sym[5] ) { <span class="keywordflow">return</span> ( <span class="keyword">true</span> ); }</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                </div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                <span class="comment">//==================================== In this case, new is better than old - sort it out</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                ret-&gt;at(symIt)[1]                     = sym[1];</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                ret-&gt;at(symIt)[2]                     = sym[2];</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                ret-&gt;at(symIt)[3]                     = sym[3];</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                ret-&gt;at(symIt)[5]                     = sym[5];</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                ret-&gt;at(symIt)[6]                     = fscVal;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                <span class="keywordflow">return</span>                                ( <span class="keyword">true</span> );</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            }</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        }</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    }</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    </div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="comment">//================================================ Done - no matches found</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">false</span> );</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;}</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; </div>
<div class="line"><a name="l01299"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1fdc5b9df47ff8de3a5f2f6e6ce233a5"> 1299</a></span>&#160;std::vector&lt; proshade_double* &gt; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1fdc5b9df47ff8de3a5f2f6e6ce233a5">ProSHADE_internal_data::ProSHADE_data::getDihedralSymmetriesList</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* CSymList )</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;{</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    proshade_double dotProduct;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting D symmetry detection.&quot;</span> );</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="comment">//================================================If not enough axes, just end here</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordflow">if</span> ( CSymList-&gt;size() &lt; 2 ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    </div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="comment">//================================================ For each unique pair of axes</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign ax1 = 0; ax1 &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); ax1++ )</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <span class="comment">//============================================ Ignore small axes</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(ax1)[5] ), rhs1 ( -999.9 );</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        <span class="keywordflow">if</span> ( ( CSymList-&gt;at(ax1)[5] &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) &amp;&amp; !( lhs1.AlmostEquals ( rhs1 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign ax2 = 1; ax2 &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); ax2++ )</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            <span class="comment">//======================================= Use unique pairs only</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            <span class="keywordflow">if</span> ( ax1 &gt;= ax2 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            <span class="comment">//======================================== Ignore small axes</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs2 ( CSymList-&gt;at(ax2)[5] ), rhs2 ( -999.9 );</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            <span class="keywordflow">if</span> ( ( CSymList-&gt;at(ax2)[5] &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) &amp;&amp; !( lhs2.AlmostEquals ( rhs2 ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            <span class="comment">//======================================= Compute the dot product</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            dotProduct                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;CSymList-&gt;at(ax1)[1], &amp;CSymList-&gt;at(ax1)[2],</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                                                                                                     &amp;CSymList-&gt;at(ax1)[3], &amp;CSymList-&gt;at(ax2)[1],</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                                                                                                     &amp;CSymList-&gt;at(ax2)[2], &amp;CSymList-&gt;at(ax2)[3] );</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            <span class="comment">//======================================== If close to zero, these two axes are perpendicular</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            <span class="keywordflow">if</span> ( std::abs( dotProduct ) &lt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a> )</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;            {</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                <span class="comment">//==================================== Save</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                <span class="keywordflow">if</span> ( CSymList-&gt;at(ax1)[0] &gt;= CSymList-&gt;at(ax2)[0] )</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                {</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ab0ac919dd609bc6bded806c0f78201fd">ProSHADE_internal_symmetry::saveDSymmetry</a> ( &amp;ret, CSymList, ax1, ax2 );</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                    </div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                    std::vector&lt; proshade_unsign &gt; DSymInd;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;DSymInd, ax1 );</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;DSymInd, ax2 );</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a86e2bb172f766ab4a620df482d2fe481">ProSHADE_internal_misc::addToUnsignVectorVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>, DSymInd );</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                    </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ab0ac919dd609bc6bded806c0f78201fd">ProSHADE_internal_symmetry::saveDSymmetry</a> ( &amp;ret, CSymList, ax2, ax1 );</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                    </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                    std::vector&lt; proshade_unsign &gt; DSymInd;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;DSymInd, ax2 );</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;DSymInd, ax1 );</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a86e2bb172f766ab4a620df482d2fe481">ProSHADE_internal_misc::addToUnsignVectorVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">allDetectedDAxes</a>, DSymInd );</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                }</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            }</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        }</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    }</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    </div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot;Detected &quot;</span> &lt;&lt; ret.size() &lt;&lt; <span class="stringliteral">&quot; D symmetries.&quot;</span>;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, hlpSS.str() );</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;}</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ab0ac919dd609bc6bded806c0f78201fd"> 1380</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ab0ac919dd609bc6bded806c0f78201fd">ProSHADE_internal_symmetry::saveDSymmetry</a> ( std::vector&lt; proshade_double* &gt;* ret, std::vector&lt; proshade_double* &gt;* CSymList, proshade_unsign axisOne, proshade_unsign axisTwo )</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;{</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="comment">//================================================ Allocate the memory</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    proshade_double* hlpP                             = <span class="keyword">new</span> proshade_double [14];</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( hlpP, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    </div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="comment">//================================================ Set the axis and heights</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    hlpP[0]                                           = CSymList-&gt;at(axisOne)[0];</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    hlpP[1]                                           = CSymList-&gt;at(axisOne)[1];</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    hlpP[2]                                           = CSymList-&gt;at(axisOne)[2];</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    hlpP[3]                                           = CSymList-&gt;at(axisOne)[3];</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    hlpP[4]                                           = CSymList-&gt;at(axisOne)[4];</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    hlpP[5]                                           = CSymList-&gt;at(axisOne)[5];</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    hlpP[6]                                           = CSymList-&gt;at(axisOne)[6];</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    hlpP[7]                                           = CSymList-&gt;at(axisTwo)[0];</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    hlpP[8]                                           = CSymList-&gt;at(axisTwo)[1];</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    hlpP[9]                                           = CSymList-&gt;at(axisTwo)[2];</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    hlpP[10]                                          = CSymList-&gt;at(axisTwo)[3];</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    hlpP[11]                                          = CSymList-&gt;at(axisTwo)[4];</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    hlpP[12]                                          = CSymList-&gt;at(axisTwo)[5];</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    hlpP[13]                                          = CSymList-&gt;at(axisTwo)[6];</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="comment">//================================================ Save to ret</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a>         ( ret, hlpP );</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    </div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    return ;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;}</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; </div>
<div class="line"><a name="l01419"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a85bfab9b1babe0b35e6d81f525ead29b"> 1419</a></span>&#160;std::vector&lt; proshade_double* &gt; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a85bfab9b1babe0b35e6d81f525ead29b">ProSHADE_internal_data::ProSHADE_data::getTetrahedralSymmetriesList</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* CSymList )</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;{</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting T symmetry detection.&quot;</span> );</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="comment">//================================================ Are the basic requirements for tetrahedral symmetry met?</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a37925ac477480c718451debb01a9c74a">ProSHADE_internal_symmetry::detectTetrahedralSymmetry</a> ( CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) )</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        <span class="comment">//============================================ Search for all the symmetry axes</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a754f8c240a6a0bfc2dac842e4cfafb58">ProSHADE_internal_symmetry::findTetra4C3s</a>     ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 4 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#adac314dce30ead61ca122c991e4a9671">ProSHADE_internal_symmetry::findTetra3C2s</a>     ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 7 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        {</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign csIt = 0; csIt &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); csIt++ )</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            {</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign retIt = 0; retIt &lt; static_cast&lt;proshade_unsign&gt; ( ret.size() ); retIt++ )</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                {</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                    <span class="comment">//======================================== Sort ret by fold</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                    std::sort                                 ( ret.begin(), ret.end(), <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad14d6427df4269728627fcd880abaf31">ProSHADE_internal_misc::sortSymInvFoldHlp</a> );</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                    </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                    <span class="comment">//======================================== Save indices</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(csIt)[0] ), rhs1 ( ret.at(retIt)[0] );</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs2 ( CSymList-&gt;at(csIt)[1] ), rhs2 ( ret.at(retIt)[1] );</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs3 ( CSymList-&gt;at(csIt)[2] ), rhs3 ( ret.at(retIt)[2] );</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs4 ( CSymList-&gt;at(csIt)[3] ), rhs4 ( ret.at(retIt)[3] );</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs5 ( CSymList-&gt;at(csIt)[4] ), rhs5 ( ret.at(retIt)[4] );</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs6 ( CSymList-&gt;at(csIt)[5] ), rhs6 ( ret.at(retIt)[5] );</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                    <span class="keywordflow">if</span> ( ( lhs1.AlmostEquals ( rhs1 ) ) &amp;&amp;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                         ( lhs2.AlmostEquals ( rhs2 ) ) &amp;&amp;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                         ( lhs3.AlmostEquals ( rhs3 ) ) &amp;&amp;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                         ( lhs4.AlmostEquals ( rhs4 ) ) &amp;&amp;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                         ( lhs5.AlmostEquals ( rhs5 ) ) &amp;&amp;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                         ( lhs6.AlmostEquals ( rhs6 ) ) )</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                    {</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>, csIt );</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                    }</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                }</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        }</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;T symmetry detection complete.&quot;</span> );</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;}</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160; </div>
<div class="line"><a name="l01485"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a37925ac477480c718451debb01a9c74a"> 1485</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a37925ac477480c718451debb01a9c74a">ProSHADE_internal_symmetry::detectTetrahedralSymmetry</a> ( std::vector&lt; proshade_double* &gt;* CSymList, proshade_double axErr, proshade_double minPeakHeight )</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;{</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    std::vector&lt; proshade_unsign &gt; C3List;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    proshade_double dotProduct;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="comment">//================================================ Find all C3 symmetries</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cSym = 0; cSym &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cSym++ )</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs ( CSymList-&gt;at(cSym)[0] ), rhs ( 3.0 );</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        <span class="keywordflow">if</span> ( lhs.AlmostEquals ( rhs ) &amp;&amp; CSymList-&gt;at(cSym)[5] &gt;= minPeakHeight ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C3List, cSym ); }</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    }</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="comment">//================================================ For each unique pair of C3s</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign c31 = 0; c31 &lt; static_cast&lt;proshade_unsign&gt; ( C3List.size() ); c31++ )</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    {</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign c32 = 1; c32 &lt; static_cast&lt;proshade_unsign&gt; ( C3List.size() ); c32++ )</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        {</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;            <span class="comment">//================================ Unique pairs only</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;            <span class="keywordflow">if</span> ( c31 &gt;= c32 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;            </div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;            <span class="comment">//========================================  Check the angle between the C3 axes</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;            dotProduct                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;CSymList-&gt;at(C3List.at(c31))[1], &amp;CSymList-&gt;at(C3List.at(c31))[2], &amp;CSymList-&gt;at(C3List.at(c31))[3], &amp;CSymList-&gt;at(C3List.at(c32))[1], &amp;CSymList-&gt;at(C3List.at(c32))[2], &amp;CSymList-&gt;at(C3List.at(c32))[3] );</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;            </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;            <span class="comment">//================================ Is the angle approximately the dihedral angle</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;            <span class="keywordflow">if</span> ( ( ( 1.0 / 3.0 ) &gt; ( dotProduct - axErr ) ) &amp;&amp; ( ( 1.0 / 3.0 ) &lt; ( dotProduct + axErr ) ) )</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;            {</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                <span class="keywordflow">return</span>                                ( <span class="keyword">true</span> );</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;            }</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        }</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    </div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">false</span> );</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;}</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160; </div>
<div class="line"><a name="l01535"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a754f8c240a6a0bfc2dac842e4cfafb58"> 1535</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a754f8c240a6a0bfc2dac842e4cfafb58">ProSHADE_internal_symmetry::findTetra4C3s</a> ( std::vector&lt; proshade_double* &gt;* CSymList, std::vector&lt; proshade_double* &gt;* ret, proshade_double axErr, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, proshade_signed verbose, proshade_double minPeakHeight )</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;{</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    std::vector&lt; proshade_unsign &gt; C3PossibilitiesHlp;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; C3Possibilities;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="keywordtype">bool</span> groupMatched;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( verbose, 2, <span class="stringliteral">&quot;Starting detection of four C3 axes.&quot;</span> );</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    </div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <span class="comment">//================================================ For all symmetries in the C symmetries list</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cIt++ )</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    {</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        <span class="comment">//============================================ Search only using C3s</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        <span class="keywordflow">if</span> ( CSymList-&gt;at(cIt)[0] != 3.0 || CSymList-&gt;at(cIt)[0] &lt; minPeakHeight ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        </div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        <span class="comment">//============================================ If this is the first C3, then just save it to the first group of the temporary holder</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        <span class="keywordflow">if</span> ( C3Possibilities.size() == 0 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C3PossibilitiesHlp, cIt ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a86e2bb172f766ab4a620df482d2fe481">ProSHADE_internal_misc::addToUnsignVectorVector</a> ( &amp;C3Possibilities, C3PossibilitiesHlp ); <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;        </div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        <span class="comment">//============================================ If second or more C3, check if it has the correct angle to all other already found C3s for each group</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        groupMatched                                  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign gIt = 0; gIt &lt; static_cast&lt;proshade_unsign&gt; ( C3Possibilities.size() ); gIt++ )</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        {</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad8c193e95c7069fafa78dccc1de1aaa4">ProSHADE_internal_symmetry::testGroupAgainstSymmetry</a> ( CSymList, &amp;C3Possibilities.at(gIt), CSymList-&gt;at(cIt), axErr, 1.0/3.0, <span class="keyword">true</span>, cIt ) ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C3Possibilities.at(gIt), cIt ); groupMatched = <span class="keyword">true</span>; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        }</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        </div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        <span class="comment">//============================================ If no group matched, create a new group</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <span class="keywordflow">if</span> ( !groupMatched ) { C3PossibilitiesHlp.clear(); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C3PossibilitiesHlp, cIt ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a86e2bb172f766ab4a620df482d2fe481">ProSHADE_internal_misc::addToUnsignVectorVector</a> ( &amp;C3Possibilities, C3PossibilitiesHlp ); <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    }</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    </div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="comment">//================================================ Test for missing symmetry axes, if need be</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af6093da290ce7b73a33e8b55f2c83491">ProSHADE_internal_symmetry::findMissingAxes</a>       ( &amp;C3Possibilities, CSymList, 4, axErr, 1.0/3.0, 3, dataObj, minPeakHeight );</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    </div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="comment">//================================================ Any group has 4 entries? If more such groups, take the one with highest average height.</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    proshade_double maxHeight = 0.0; proshade_unsign maxGrp = 0;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( C3Possibilities.size() ); iter++ ) { <span class="keywordflow">if</span> ( C3Possibilities.at(iter).size() == 4 ) { <span class="keywordflow">if</span> ( ( ( CSymList-&gt;at(C3Possibilities.at(iter).at(0))[5] + CSymList-&gt;at(C3Possibilities.at(iter).at(1))[5] + CSymList-&gt;at(C3Possibilities.at(iter).at(2))[5] + CSymList-&gt;at(C3Possibilities.at(iter).at(3))[5] ) / 4.0 ) &gt; maxHeight ) { maxHeight = ( ( CSymList-&gt;at(C3Possibilities.at(iter).at(0))[5] + CSymList-&gt;at(C3Possibilities.at(iter).at(1))[5] + CSymList-&gt;at(C3Possibilities.at(iter).at(2))[5] + CSymList-&gt;at(C3Possibilities.at(iter).at(3))[5] ) / 4.0 ); maxGrp = iter; } } }</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    </div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="keywordflow">if</span> ( C3Possibilities.at(maxGrp).size() == 4 )</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    {</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        <span class="comment">//============================================ Success! Save and exit</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( C3Possibilities.at(maxGrp).size() ); it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a> ( ret, CSymList-&gt;at(C3Possibilities.at(maxGrp).at(it)) ); }</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        </div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( verbose, 3, <span class="stringliteral">&quot;Detection of four C3 axes successfull.&quot;</span> );</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        </div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        <span class="comment">//============================================ Done</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        return ;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    }</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    return ;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;}</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; </div>
<div class="line"><a name="l01605"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad8c193e95c7069fafa78dccc1de1aaa4"> 1605</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad8c193e95c7069fafa78dccc1de1aaa4">ProSHADE_internal_symmetry::testGroupAgainstSymmetry</a> ( std::vector&lt; proshade_double* &gt;* CSymList, std::vector&lt; proshade_unsign &gt;* grp, proshade_double* sym, proshade_double axErr, proshade_double angle, <span class="keywordtype">bool</span> improve, proshade_unsign pos )</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;{</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="keywordtype">bool</span> allAnglesMet                                 = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    proshade_double dotProduct;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    </div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="comment">//================================================ Improve if required</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">if</span> ( improve )</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    {</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign mIt = 0; mIt &lt; static_cast&lt;proshade_unsign&gt; ( grp-&gt;size() ); mIt++ )</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        {</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            dotProduct                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;CSymList-&gt;at(grp-&gt;at(mIt))[1], &amp;CSymList-&gt;at(grp-&gt;at(mIt))[2], &amp;CSymList-&gt;at(grp-&gt;at(mIt))[3], &amp;sym[1], &amp;sym[2], &amp;sym[3] );</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            </div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;            <span class="keywordflow">if</span> ( ( ( 1.0 &gt; ( dotProduct - axErr ) ) &amp;&amp; ( 1.0 &lt; ( dotProduct + axErr ) ) ) || ( ( -1.0 &gt; ( dotProduct - axErr ) ) &amp;&amp; ( -1.0 &lt; ( dotProduct + axErr ) ) ) )</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            {</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                <span class="keywordflow">if</span> ( sym[5] &gt; CSymList-&gt;at(grp-&gt;at(mIt))[5] )</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                    grp-&gt;at(mIt)                      = pos;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                {</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                    allAnglesMet                      = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                    <span class="keywordflow">return</span>                            ( allAnglesMet );</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                }</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;            }</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        }</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    }</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    </div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="comment">//================================================ For all group members</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign mIt = 0; mIt &lt; static_cast&lt;proshade_unsign&gt; ( grp-&gt;size() ); mIt++ )</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    {</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        dotProduct                                    = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;CSymList-&gt;at(grp-&gt;at(mIt))[1], &amp;CSymList-&gt;at(grp-&gt;at(mIt))[2], &amp;CSymList-&gt;at(grp-&gt;at(mIt))[3], &amp;sym[1], &amp;sym[2], &amp;sym[3] );</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        <span class="keywordflow">if</span> ( ( angle &gt; ( std::abs ( dotProduct ) - axErr ) ) &amp;&amp;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;             ( angle &lt; ( std::abs ( dotProduct ) + axErr ) ) )</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        {</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;            <span class="comment">//======================================== Matching group memner - try next one</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        }</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        {</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;            <span class="comment">//======================================== Group member not matched - try next group</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;            allAnglesMet                              = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        }</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    }</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    </div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="keywordflow">return</span>                                           ( allAnglesMet );</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    </div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;}</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160; </div>
<div class="line"><a name="l01672"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af6093da290ce7b73a33e8b55f2c83491"> 1672</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af6093da290ce7b73a33e8b55f2c83491">ProSHADE_internal_symmetry::findMissingAxes</a> ( std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt;* possibilities, std::vector&lt; proshade_double* &gt;* CSymList, proshade_unsign requiredNoAxes, proshade_double axErr, proshade_double angle, proshade_unsign fold, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, proshade_double minPeakHeight )</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;{</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    std::vector&lt; proshade_double* &gt; hlpVec;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="keywordtype">bool</span> atLeastOne                                   = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    </div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="comment">//================================================ Proceed only if need be</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign gIt = 0; gIt &lt; static_cast&lt;proshade_unsign&gt; ( possibilities-&gt;size() ); gIt++ )</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    {</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( possibilities-&gt;at(gIt).size() ) == requiredNoAxes ) { atLeastOne = <span class="keyword">true</span>; <span class="keywordflow">return</span> ( atLeastOne ); }</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    }</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    </div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="comment">//================================================ For each possible group</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign gIt = 0; gIt &lt; static_cast&lt;proshade_unsign&gt; ( possibilities-&gt;size() ); gIt++ )</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    {</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        <span class="comment">//============================================ This will not work for less than two axes in group</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        <span class="keywordflow">if</span> ( possibilities-&gt;at(gIt).size() &lt; 2 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        </div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        <span class="comment">//============================================ Prepare iteration</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        hlpVec.clear                                  ( );</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        </div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        <span class="comment">//============================================ Search for missing axes</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a1ada2416687dbb0bec93603770cb4c83">ProSHADE_internal_symmetry::searchMissingSymmetrySpace</a> ( dataObj, CSymList, &amp;possibilities-&gt;at(gIt), &amp;hlpVec, axErr, angle, fold, minPeakHeight );</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        </div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        <span class="comment">//============================================ Add missing axes</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        <span class="keywordflow">if</span> ( hlpVec.size() &gt; 0 )</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        {</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;            <span class="comment">//======================================== Start adding by highest first</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;            std::sort                                 ( hlpVec.begin(), hlpVec.end(), <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a2e915d310892aea124046acd14db4a84">ProSHADE_internal_misc::sortSymHlpInv</a> );</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;            </div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;            <span class="comment">//======================================== For each missing axis</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign axIt = 0; axIt &lt; static_cast&lt;proshade_unsign&gt; ( hlpVec.size() ); axIt++ )</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;            {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad8c193e95c7069fafa78dccc1de1aaa4">ProSHADE_internal_symmetry::testGroupAgainstSymmetry</a> ( CSymList, &amp;possibilities-&gt;at(gIt), hlpVec.at(axIt), axErr, angle, <span class="keyword">false</span> ) )</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                {</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                    <span class="comment">//================================ Check for uniqueness</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2380a3710f7dbe672519c3adda30f7cd">ProSHADE_internal_maths::isAxisUnique</a> ( CSymList, hlpVec.at(axIt), axErr ) )</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                    {</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                        <span class="comment">//============================ Add</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a> ( CSymList, hlpVec.at(axIt) );</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;possibilities-&gt;at(gIt), <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( CSymList-&gt;size()-1 ) );</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                    }</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                }</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;            }</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        }</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        <span class="keywordflow">if</span> ( possibilities-&gt;at(gIt).size() == requiredNoAxes ) { atLeastOne = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    }</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <span class="keywordflow">return</span>                                            ( atLeastOne );</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;}</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160; </div>
<div class="line"><a name="l01732"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a68d576f90449b7d3fcf5ae4d3114c268"> 1732</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a68d576f90449b7d3fcf5ae4d3114c268">ProSHADE_internal_symmetry::sortArrVecHlp</a> ( <span class="keyword">const</span> proshade_double* a, <span class="keyword">const</span> proshade_double* b )</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;{</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="comment">//================================================ Compare</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="keywordflow">return</span>                                            ( a[0] &lt; b[0] );</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    </div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;}</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01753"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad44ed609e8a3d59674b2b2256aec41f8"> 1753</a></span>&#160;proshade_double <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad44ed609e8a3d59674b2b2256aec41f8">ProSHADE_internal_symmetry::missingAxisHeight</a> ( proshade_double xVal, proshade_double yVal, proshade_double zVal, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, proshade_unsign fold, proshade_double axErr )</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;{</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    proshade_double ret                               = 0.0;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    proshade_double curSum                            = 0.0;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    proshade_double maxVal                            = 0.0;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    proshade_double angStep                           = std::acos ( 1.0 - axErr ) / 2;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    std::vector&lt; proshade_double* &gt; angVec;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="comment">//================================================ Find map points conforming to the axis</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    angVec                                            = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a465606e58df7d6a2238d40c6919b2e58">ProSHADE_internal_symmetry::findMissingAxisPoints</a> ( xVal, yVal, zVal, dataObj, axErr );</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    </div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <span class="comment">//================================================ Sort points by angle</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    std::sort                                         ( angVec.begin(), angVec.end(), <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a68d576f90449b7d3fcf5ae4d3114c268">ProSHADE_internal_symmetry::sortArrVecHlp</a> );</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="comment">//================================================ Find the best X peaks with correct distances</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( std::floor ( ( 2.0 * M_PI / angStep ) / <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( fold ) ) ); iter++ )</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    {</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        <span class="comment">//============================================ Initialise new ang group iteration</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        curSum                                        = 0.0;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        </div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        <span class="comment">//============================================ For each of the fold times</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign angCmb = 0; angCmb &lt; static_cast&lt;proshade_unsign&gt; ( fold ); angCmb++ )</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        {</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;            <span class="comment">//======================================== Initialise</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;            maxVal                                    = 0.0;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;            </div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;            <span class="comment">//======================================== Search</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign angIt = 0; angIt &lt; static_cast&lt;proshade_unsign&gt; ( angVec.size() ); angIt++ )</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            {</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                <span class="keywordflow">if</span> ( angVec.at(angIt)[0] &lt; ( ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( iter ) * angStep ) +</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                                             ( ( 2.0 * M_PI / <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( fold ) ) * <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( angCmb ) ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                <span class="keywordflow">if</span> ( angVec.at(angIt)[0] &gt; ( ( ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( iter ) + 1.0 ) * angStep ) +</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                                             ( ( 2.0 * M_PI / <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( fold ) ) * <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( angCmb ) ) ) ) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160; </div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                <span class="keywordflow">if</span> ( angVec.at(angIt)[1] &gt; maxVal ) { maxVal = angVec.at(angIt)[1]; }</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            }</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            curSum                                   += maxVal;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        }</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        curSum                                      /= <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( fold );</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        <span class="keywordflow">if</span> ( ret &lt; curSum ) { ret = curSum; }</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    }</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( angVec.size() ); iter++ ) { <span class="keyword">delete</span>[] angVec.at(iter); }</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    </div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    </div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;}</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160; </div>
<div class="line"><a name="l01817"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a465606e58df7d6a2238d40c6919b2e58"> 1817</a></span>&#160;std::vector &lt; proshade_double* &gt; <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a465606e58df7d6a2238d40c6919b2e58">ProSHADE_internal_symmetry::findMissingAxisPoints</a> ( proshade_double xVal, proshade_double yVal, proshade_double zVal, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, proshade_double axErr )</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;{</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    proshade_double euA, euB, euG, xPk, yPk, zPk, anglPk;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    proshade_double* rotMat                           = <span class="keyword">new</span> proshade_double [9];</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rotMat, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    proshade_unsign arrIndex;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    std::vector&lt; proshade_double* &gt; angVec;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    </div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="comment">//================================================ Search the self-rotation map</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign xIt = 0; xIt &lt; ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() * 2 ); xIt++ )</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    {</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign yIt = 0; yIt &lt; ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() * 2 ); yIt++ )</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        {</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign zIt = 0; zIt &lt; ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() * 2 ); zIt++ )</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            {</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                <span class="comment">//==================================== Get height and check against threshold</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                arrIndex                              = zIt  + ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() * 2 ) * ( yIt  + ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() * 2 ) * xIt );</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                </div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                <span class="comment">//==================================== Get angle-axis values</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#acf6c5376edac98e54ef0e418cd05d706">ProSHADE_internal_maths::getEulerZXZFromSOFTPosition</a> ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( xIt ),</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                                                                       <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( yIt ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( zIt ),</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                                                                       &amp;euA, &amp;euB, &amp;euG );</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a> ( euA, euB, euG, rotMat );</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#aafc6f1626c7463de53c9f4f6fa11db22">ProSHADE_internal_maths::getAxisAngleFromRotationMatrix</a> ( rotMat, &amp;xPk, &amp;yPk, &amp;zPk, &amp;anglPk );</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                </div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                <span class="comment">//==================================== Set largest axis element to positive</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( std::max ( std::abs ( xPk ), std::max( std::abs ( yPk ), std::abs ( zPk ) ) ) );</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs1 ( std::abs ( xPk ));</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs2 ( std::abs ( yPk ) );</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs3 ( std::abs ( zPk ) );</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                <span class="keywordflow">if</span> ( ( lhs1.AlmostEquals ( rhs1 ) &amp;&amp; ( xPk &lt; 0.0 ) ) ||</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                     ( lhs1.AlmostEquals ( rhs2 ) &amp;&amp; ( yPk &lt; 0.0 ) ) ||</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                     ( lhs1.AlmostEquals ( rhs3 ) &amp;&amp; ( zPk &lt; 0.0 ) ) )</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                {</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                    xPk                              *= -1.0;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                    yPk                              *= -1.0;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                    zPk                              *= -1.0;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                    anglPk                           *= -1.0;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                </div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                <span class="comment">//==================================== Does the peak match the required axis?</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2b2f67cba1eea57f19fdaf062db74fde">ProSHADE_internal_maths::vectorOrientationSimilarity</a> ( xPk, yPk, zPk, xVal, yVal, zVal, axErr ) )</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                {</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                    <span class="comment">//================================ Matching map point - save it</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                    proshade_double* hlpArr           = <span class="keyword">new</span> proshade_double [2];</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( hlpArr, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                    hlpArr[0]                         = anglPk + M_PI;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                    hlpArr[1]                         = pow( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">getInvSO3Coeffs</a>()[arrIndex][0], 2.0 ) +</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                                                        pow( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">getInvSO3Coeffs</a>()[arrIndex][1], 2.0 );</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a> ( &amp;angVec, hlpArr );</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;            }</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        }</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    }</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    </div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    <span class="keyword">delete</span>[] rotMat;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    </div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <span class="keywordflow">return</span>                                            ( angVec );</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;}</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01895"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5dc4353223fc752e0007b2adec193079"> 1895</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5dc4353223fc752e0007b2adec193079">ProSHADE_internal_symmetry::saveMissingAxisNewOnly</a> ( std::vector&lt; proshade_double* &gt;* axVec, proshade_double axX, proshade_double axY, proshade_double axZ, proshade_double height, proshade_unsign fold, proshade_double axErr )</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;{</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="comment">//================================================  Create symmetry array from the inputs</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    proshade_double* hlpSym                           = <span class="keyword">new</span> proshade_double [6];</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( hlpSym, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    </div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="comment">//================================================ Fill it in</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    hlpSym[0]                                         = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( fold );</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    hlpSym[1]                                         = axX;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    hlpSym[2]                                         = axY;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    hlpSym[3]                                         = axZ;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    hlpSym[4]                                         = ( 2.0 * M_PI ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( fold );</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    hlpSym[5]                                         = height;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="comment">//================================================ Check if similar symmetry does not exist already</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign symIt = 0; symIt &lt; static_cast&lt;proshade_unsign&gt; ( axVec-&gt;size() ); symIt++ )</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    {</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        <span class="comment">//============================================ Minor speed-up =&gt; only test for same folds</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( axVec-&gt;at(symIt)[0] ), rhs1 ( hlpSym[0] );</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;        <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) )</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        {</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2b2f67cba1eea57f19fdaf062db74fde">ProSHADE_internal_maths::vectorOrientationSimilarity</a> ( axVec-&gt;at(symIt)[1],</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                                                                        axVec-&gt;at(symIt)[2],</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                                                                        axVec-&gt;at(symIt)[3],</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                                                                        hlpSym[1],</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                                                                        hlpSym[2],</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                                                                        hlpSym[3],</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                                                                        axErr ) )</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;            {</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;                <span class="comment">//==================================== Almost identical entry</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                <span class="keywordflow">if</span> ( axVec-&gt;at(symIt)[5] &lt; hlpSym[5] )</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                {</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                    <span class="comment">//================================ If higher, save</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                    <span class="keyword">delete</span>[] axVec-&gt;at(symIt);</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                    axVec-&gt;at(symIt)                  = hlpSym;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                    return ;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                }</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                {</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                    <span class="comment">//================================ or just terminate if better is already saved</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                    <span class="keyword">delete</span>[] hlpSym;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                    return ;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                }</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;            }</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        }</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    }</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    </div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <span class="comment">//================================================ Not matched to anything</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a>         ( axVec, hlpSym );</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    </div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    return ;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    </div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;}</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160; </div>
<div class="line"><a name="l01964"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a1ada2416687dbb0bec93603770cb4c83"> 1964</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a1ada2416687dbb0bec93603770cb4c83">ProSHADE_internal_symmetry::searchMissingSymmetrySpace</a> ( <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, std::vector&lt; proshade_double* &gt;* CSymList, std::vector&lt; proshade_unsign &gt;* grp, std::vector&lt; proshade_double* &gt;* hlpVec, proshade_double axErr, proshade_double angle, proshade_unsign fold, proshade_double minPeakHeight )</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;{</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="keywordflow">if</span> ( grp-&gt;size() &lt; 2 ) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    </div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    proshade_double axHeight                          = 0.0;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    proshade_double* symHlp                           = <span class="keyword">new</span> proshade_double[7];</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( symHlp, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="comment">//================================================ For each axis pair in the group, find the possible solutions</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign fAx = 0; fAx &lt; static_cast&lt;proshade_unsign&gt; ( grp-&gt;size() ); fAx++ )</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    {</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign sAx = 1; sAx &lt; static_cast&lt;proshade_unsign&gt; ( grp-&gt;size() ); sAx++ )</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        {</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;            <span class="comment">//======================================== Only unique pairs</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;            <span class="keywordflow">if</span> ( fAx &gt;= sAx ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;            </div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;            <span class="comment">//======================================== Find possible axis having the required angle to this pair ( solution 1 )</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;            std::vector&lt; proshade_double &gt; solVec     = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a45fbcfaeaabf9bae2fbd7d46a5fb4bc7">ProSHADE_internal_maths::findVectorFromTwoVAndTwoD</a> ( CSymList-&gt;at(grp-&gt;at(fAx))[1],</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                                                                                                             CSymList-&gt;at(grp-&gt;at(fAx))[2],</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                                                                                                             CSymList-&gt;at(grp-&gt;at(fAx))[3],</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                                                                                                             CSymList-&gt;at(grp-&gt;at(sAx))[1],</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                                                                                                             CSymList-&gt;at(grp-&gt;at(sAx))[2],</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                                                                                                             CSymList-&gt;at(grp-&gt;at(sAx))[3], angle, angle );</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;            </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;            <span class="comment">//======================================== Set largest axis element to positive</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( std::max ( std::abs ( solVec.at(0) ), std::max( std::abs ( solVec.at(1) ), std::abs ( solVec.at(2) ) ) ) );</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs1 ( std::abs ( solVec.at(0) ) );</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs2 ( std::abs ( solVec.at(1) ) );</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs3 ( std::abs ( solVec.at(2) ) );</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;            <span class="keywordflow">if</span> ( ( lhs1.AlmostEquals ( rhs1 ) &amp;&amp; ( solVec.at(0) &lt; 0.0 ) ) ||</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                 ( lhs1.AlmostEquals ( rhs2 ) &amp;&amp; ( solVec.at(1) &lt; 0.0 ) ) ||</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                 ( lhs1.AlmostEquals ( rhs3 ) &amp;&amp; ( solVec.at(2) &lt; 0.0 ) ) )</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;            {</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;                solVec.at(0)                         *= -1.0;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                solVec.at(1)                         *= -1.0;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                solVec.at(2)                         *= -1.0;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;            }</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;            </div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;            <span class="comment">//======================================== Does the solution fit the whole group?</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            symHlp[1] = solVec.at(0); symHlp[2] = solVec.at(1); symHlp[3] = solVec.at(2); symHlp[6] = -1.0;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad8c193e95c7069fafa78dccc1de1aaa4">ProSHADE_internal_symmetry::testGroupAgainstSymmetry</a> ( CSymList, grp, symHlp, axErr, angle, <span class="keyword">true</span> ) )</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;            {</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                <span class="comment">//==================================== Find the height for the axis</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                axHeight                              = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad44ed609e8a3d59674b2b2256aec41f8">ProSHADE_internal_symmetry::missingAxisHeight</a> ( solVec.at(0), solVec.at(1), solVec.at(2), dataObj, fold, axErr );</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                </div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                <span class="comment">//================================ Save max height result</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                <span class="keywordflow">if</span> ( axHeight &gt;= minPeakHeight ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5dc4353223fc752e0007b2adec193079">ProSHADE_internal_symmetry::saveMissingAxisNewOnly</a> ( hlpVec, solVec.at(0), solVec.at(1), solVec.at(2), axHeight, fold, axErr ); }</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;            }</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;            </div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;            <span class="comment">//======================================== Find possible axis having the required angle to this pair ( solution 2 )</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;            solVec                                    = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a45fbcfaeaabf9bae2fbd7d46a5fb4bc7">ProSHADE_internal_maths::findVectorFromTwoVAndTwoD</a> ( CSymList-&gt;at(grp-&gt;at(fAx))[1],</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                                                                                                             CSymList-&gt;at(grp-&gt;at(fAx))[2],</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                                                                                                             CSymList-&gt;at(grp-&gt;at(fAx))[3],</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                                                                                                             CSymList-&gt;at(grp-&gt;at(sAx))[1],</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                                                                                                             CSymList-&gt;at(grp-&gt;at(sAx))[2],</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                                                                                                             CSymList-&gt;at(grp-&gt;at(sAx))[3], -angle, -angle );</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;            </div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;            <span class="comment">//======================================== Set largest axis element to positive</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs2 ( std::max ( std::abs ( solVec.at(0) ), std::max( std::abs ( solVec.at(1) ), std::abs ( solVec.at(2) ) ) ) );</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs4 ( std::abs ( solVec.at(0) ) );</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs5 ( std::abs ( solVec.at(1) ) );</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs6 ( std::abs ( solVec.at(2) ) );</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;            <span class="keywordflow">if</span> ( ( lhs2.AlmostEquals ( rhs4 ) &amp;&amp; ( solVec.at(0) &lt; 0.0 ) ) ||</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                 ( lhs2.AlmostEquals ( rhs5 ) &amp;&amp; ( solVec.at(1) &lt; 0.0 ) ) ||</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                 ( lhs2.AlmostEquals ( rhs6 ) &amp;&amp; ( solVec.at(2) &lt; 0.0 ) ) )</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;            {</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                solVec.at(0)                         *= -1.0;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                solVec.at(1)                         *= -1.0;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                solVec.at(2)                         *= -1.0;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;            }</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;            </div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;            <span class="comment">//======================================== Does the solution fit the whole group?</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;            symHlp[1] = solVec.at(0); symHlp[2] = solVec.at(1); symHlp[3] = solVec.at(2); symHlp[6] = -1.0;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad8c193e95c7069fafa78dccc1de1aaa4">ProSHADE_internal_symmetry::testGroupAgainstSymmetry</a> ( CSymList, grp, symHlp, axErr, angle, <span class="keyword">true</span> ) )</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;            {</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;                <span class="comment">//==================================== Find the height for the axis</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                axHeight                              = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad44ed609e8a3d59674b2b2256aec41f8">ProSHADE_internal_symmetry::missingAxisHeight</a> ( solVec.at(0), solVec.at(1), solVec.at(2), dataObj, fold, axErr );</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                </div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                <span class="comment">//================================ Save max height result</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                <span class="keywordflow">if</span> ( axHeight &gt;= minPeakHeight ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5dc4353223fc752e0007b2adec193079">ProSHADE_internal_symmetry::saveMissingAxisNewOnly</a> ( hlpVec, solVec.at(0), solVec.at(1), solVec.at(2), axHeight, fold, axErr ); }</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;            }</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        }</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    }</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    </div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    <span class="keyword">delete</span>[] symHlp;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    </div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    return ;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    </div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;}</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160; </div>
<div class="line"><a name="l02071"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#adac314dce30ead61ca122c991e4a9671"> 2071</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#adac314dce30ead61ca122c991e4a9671">ProSHADE_internal_symmetry::findTetra3C2s</a> ( std::vector&lt; proshade_double* &gt;* CSymList, std::vector&lt; proshade_double* &gt;* ret, proshade_double axErr, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, proshade_signed verbose, proshade_double minPeakHeight )</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;{</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    std::vector&lt; proshade_unsign &gt; C3s, prospectiveC2s, C2PossibilitiesHlp;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; C2Possibilities;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    proshade_double dotProd;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <span class="keywordtype">bool</span> groupMatched;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 4; iter++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C3s, iter ); }</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    </div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 2, <span class="stringliteral">&quot;Starting detection of three C2 axes.&quot;</span> );</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    </div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    <span class="comment">//================================================ For each C3</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign rIt = 0; rIt &lt; static_cast&lt;proshade_unsign&gt; ( ret-&gt;size() ); rIt++ )</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        <span class="comment">//============================================ For each C2, check it has angle ( acos(0.5) ) to the tested C3</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cIt++ )</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;            <span class="comment">//======================================== Search only using C2s</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs999 ( CSymList-&gt;at(cIt)[5] ), rhs999 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( -999.9 ) );</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;            <span class="keywordflow">if</span> ( CSymList-&gt;at(cIt)[0] != 2.0 || ( ( CSymList-&gt;at(cIt)[5] &lt; minPeakHeight ) &amp;&amp; !( lhs999.AlmostEquals( rhs999 ) ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;            </div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;            <span class="comment">//======================================== Check the C2 axis to the C3 ( acos ( 0.5 ) )</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;            dotProd = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;ret-&gt;at(rIt)[1], &amp;ret-&gt;at(rIt)[2], &amp;ret-&gt;at(rIt)[3],</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                                                                   &amp;CSymList-&gt;at(cIt)[1], &amp;CSymList-&gt;at(cIt)[2], &amp;CSymList-&gt;at(cIt)[3] );</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;            </div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;            <span class="keywordflow">if</span> ( ( std::abs ( dotProd ) &gt; ( 0.5 - axErr ) ) &amp;&amp; ( std::abs ( dotProd ) &lt; ( 0.5 + axErr ) ) ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;prospectiveC2s, cIt ); }</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;        }</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    }</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;        </div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="comment">//================================================ Group the prospective C2s</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    C2Possibilities.clear(); C2PossibilitiesHlp.clear();</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( prospectiveC2s.size() ); cIt++ )</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    {</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;        <span class="comment">//============================================ If second or more C2, check if it can be placed in any group with being perpendicular to all its members</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;        groupMatched                                  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign gIt = 0; gIt &lt; static_cast&lt;proshade_unsign&gt; ( C2Possibilities.size() ); gIt++ )</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;        {</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad8c193e95c7069fafa78dccc1de1aaa4">ProSHADE_internal_symmetry::testGroupAgainstSymmetry</a> ( CSymList, &amp;C2Possibilities.at(gIt), CSymList-&gt;at(prospectiveC2s.at(cIt)), axErr, 0.0, <span class="keyword">true</span>, prospectiveC2s.at(cIt) ) ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C2Possibilities.at(gIt), prospectiveC2s.at(cIt) ); groupMatched = <span class="keyword">true</span>; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        }</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        </div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;        <span class="comment">//============================================ If no group matched, create a new group</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        <span class="keywordflow">if</span> ( !groupMatched ) { C2PossibilitiesHlp.clear(); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C2PossibilitiesHlp, prospectiveC2s.at(cIt) ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a86e2bb172f766ab4a620df482d2fe481">ProSHADE_internal_misc::addToUnsignVectorVector</a> ( &amp;C2Possibilities, C2PossibilitiesHlp ); <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    }</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    </div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <span class="comment">//================================================ Find the best group or return empty</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <span class="keywordflow">while</span> ( C2Possibilities.size() != 0 )</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    {</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        <span class="comment">//============================================ Test for missing symmetry axes, if need be</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af6093da290ce7b73a33e8b55f2c83491">ProSHADE_internal_symmetry::findMissingAxes</a>   ( &amp;C2Possibilities, CSymList, 3, axErr, 0.0, 2, dataObj, minPeakHeight );</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        </div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;        <span class="comment">//============================================ Found 3 C2s?</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;        <span class="keywordflow">if</span> ( C2Possibilities.at(0).size() == 3 )</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;        {</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            <span class="comment">//======================================== Success! Save and exit</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; 3; it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a> ( ret, CSymList-&gt;at(C2Possibilities.at(0).at(it)) ); }</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;            </div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            <span class="comment">//======================================== Report progress</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( verbose, 3, <span class="stringliteral">&quot;Detection of three C2 axes successfull.&quot;</span> );</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;            </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;            <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;            return ;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;        }</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;        <span class="keywordflow">else</span> { C2Possibilities.erase ( C2Possibilities.begin() ); }</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    }</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  </div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    return ;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    </div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;}</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160; </div>
<div class="line"><a name="l02156"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5360c152697780177eb2676888cd5108"> 2156</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5360c152697780177eb2676888cd5108">ProSHADE_internal_symmetry::testGroupAgainstGroup</a> ( std::vector&lt; proshade_double* &gt;* GrList1, std::vector&lt; proshade_unsign &gt;* grp1, std::vector&lt; proshade_double* &gt;* GrList2, std::vector&lt; proshade_unsign &gt;* grp2, proshade_double angle, proshade_double axErr )</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;{</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="keywordtype">bool</span> ret                                          = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    proshade_double dotProduct;</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    </div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="comment">//================================================ For all pairs of axes</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign g1It = 0; g1It &lt; static_cast&lt;proshade_unsign&gt; ( grp1-&gt;size() ); g1It++ )</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    {</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign g2It = 0; g2It &lt; static_cast&lt;proshade_unsign&gt; ( grp2-&gt;size() ); g2It++ )</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;        {</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;            <span class="comment">//======================================== Find the angle</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;            dotProduct                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;GrList1-&gt;at(grp1-&gt;at(g1It))[1],</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                                                                                                     &amp;GrList1-&gt;at(grp1-&gt;at(g1It))[2],</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                                                                                                     &amp;GrList1-&gt;at(grp1-&gt;at(g1It))[3],</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                                                                                                     &amp;GrList2-&gt;at(grp2-&gt;at(g2It))[1],</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                                                                                                     &amp;GrList2-&gt;at(grp2-&gt;at(g2It))[2],</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                                                                                                     &amp;GrList2-&gt;at(grp2-&gt;at(g2It))[3] );</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;            </div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;            <span class="comment">//======================================== Check the angle</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;            <span class="keywordflow">if</span> ( ( angle &gt; ( dotProduct - axErr ) ) &amp;&amp; ( angle &lt; ( dotProduct + axErr ) ) )</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;            {</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                ret                                   = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                <span class="keywordflow">return</span>                                ( ret );</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;            }</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        }</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    }</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    </div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    </div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;}</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160; </div>
<div class="line"><a name="l02199"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14c4d6044c5174afa8a0984025c45436"> 2199</a></span>&#160;std::vector&lt; proshade_double* &gt; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14c4d6044c5174afa8a0984025c45436">ProSHADE_internal_data::ProSHADE_data::getOctahedralSymmetriesList</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* CSymList )</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;{</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    </div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting O symmetry detection.&quot;</span> );</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    </div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="comment">//================================================ Are the basic requirements for tetrahedral symmetry met?</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a18d456057604616a7cf6b68f59b4f2d0">ProSHADE_internal_symmetry::detectOctahedralSymmetry</a> ( CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) )</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    {</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;        <span class="comment">//============================================ Search for all the symmetry axes</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a870671b74f645f535f327c397826d6c9">ProSHADE_internal_symmetry::findOcta3C4s</a> ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 3 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        </div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a0a35a745745fa3db227455241bb083ae">ProSHADE_internal_symmetry::findOcta4C3s</a> ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 7 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;        </div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a62c8dc8fe0c14305d2d715a22c7042aa">ProSHADE_internal_symmetry::findOcta6C2s</a> ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 13 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        {</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign csIt = 0; csIt &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); csIt++ )</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;            {</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign retIt = 0; retIt &lt; static_cast&lt;proshade_unsign&gt; ( ret.size() ); retIt++ )</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                {</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                    <span class="comment">//======================================== Sort ret by fold</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                    std::sort                                 ( ret.begin(), ret.end(), <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad14d6427df4269728627fcd880abaf31">ProSHADE_internal_misc::sortSymInvFoldHlp</a> );</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                    </div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                    <span class="comment">//======================================== Save indices</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(csIt)[0] ), rhs1 ( ret.at(retIt)[0] );</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs2 ( CSymList-&gt;at(csIt)[1] ), rhs2 ( ret.at(retIt)[1] );</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs3 ( CSymList-&gt;at(csIt)[2] ), rhs3 ( ret.at(retIt)[2] );</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs4 ( CSymList-&gt;at(csIt)[3] ), rhs4 ( ret.at(retIt)[3] );</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs5 ( CSymList-&gt;at(csIt)[4] ), rhs5 ( ret.at(retIt)[4] );</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs6 ( CSymList-&gt;at(csIt)[5] ), rhs6 ( ret.at(retIt)[5] );</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                    <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) &amp;&amp;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                         lhs2.AlmostEquals ( rhs2 ) &amp;&amp;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                         lhs3.AlmostEquals ( rhs3 ) &amp;&amp;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                         lhs4.AlmostEquals ( rhs4 ) &amp;&amp;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                         lhs5.AlmostEquals ( rhs5 ) &amp;&amp;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                         lhs6.AlmostEquals ( rhs6 ) )</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                    {</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>, csIt );</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                    }</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                }</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;            }</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        }</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    }</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    </div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;O symmetry detection complete.&quot;</span> );</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    </div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    </div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;}</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160; </div>
<div class="line"><a name="l02268"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a18d456057604616a7cf6b68f59b4f2d0"> 2268</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a18d456057604616a7cf6b68f59b4f2d0">ProSHADE_internal_symmetry::detectOctahedralSymmetry</a> ( std::vector&lt; proshade_double* &gt;* CSymList, proshade_double axErr, proshade_double minPeakHeight )</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;{</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    std::vector&lt; proshade_unsign &gt; C4List;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    proshade_double dotProduct;</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    </div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <span class="comment">//================================================ Find all C4 symmetries</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cSym = 0; cSym &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cSym++ )</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    {</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(cSym)[0] ), rhs1 ( 4.0 );</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) &amp;&amp; CSymList-&gt;at(cSym)[5] &gt;= minPeakHeight ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C4List, cSym ); }</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    }</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    </div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    <span class="comment">//================================================ For each unique pair of C3s</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign c4 = 0; c4 &lt; static_cast&lt;proshade_unsign&gt; ( C4List.size() ); c4++ )</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    {</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign cSym = 0; cSym &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cSym++ )</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        {</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;            <span class="comment">//======================================== Compare only C3s to the C3List</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(cSym)[0] ), rhs1 ( 3.0 );</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;            <span class="keywordflow">if</span> ( !lhs1.AlmostEquals ( rhs1 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;            </div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;            <span class="comment">//========================================  Check the angle between the C4 and C3 axes</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;            dotProduct                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;CSymList-&gt;at(C4List.at(c4))[1],</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                                                                                                     &amp;CSymList-&gt;at(C4List.at(c4))[2],</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                                                                                                     &amp;CSymList-&gt;at(C4List.at(c4))[3],</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[1],</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[2],</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[3] );</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            </div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;            <span class="comment">//======================================== Is the angle approximately the dihedral angle</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;            <span class="keywordflow">if</span> ( ( ( 1.0 / sqrt ( 3.0 ) ) &gt; ( dotProduct - axErr ) ) &amp;&amp; ( ( 1.0 / sqrt ( 3.0 ) ) &lt; ( dotProduct + axErr ) ) )</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;            {</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;                <span class="keywordflow">return</span>                                ( <span class="keyword">true</span> );</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;            }</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;        }</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    }</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    </div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">false</span> );</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    </div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;}</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160; </div>
<div class="line"><a name="l02324"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a870671b74f645f535f327c397826d6c9"> 2324</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a870671b74f645f535f327c397826d6c9">ProSHADE_internal_symmetry::findOcta3C4s</a> ( std::vector&lt; proshade_double* &gt;* CSymList, std::vector&lt; proshade_double* &gt;* ret, proshade_double axErr, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, proshade_signed verbose, proshade_double minPeakHeight )</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;{</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    std::vector&lt; proshade_unsign &gt; C4PossibilitiesHlp;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; C4Possibilities;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    <span class="keywordtype">bool</span> groupMatched;</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    </div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 2, <span class="stringliteral">&quot;Starting detection of three C4 axes.&quot;</span> );</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    </div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    <span class="comment">//================================================ For all symmetries in the C symmetries list</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cIt++ )</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    {</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;        <span class="comment">//============================================ Search only using C4s</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        <span class="keywordflow">if</span> ( CSymList-&gt;at(cIt)[0] != 4.0 || CSymList-&gt;at(cIt)[5] &lt; minPeakHeight ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160; </div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        <span class="comment">//============================================ If second or more C4, check if it has the correct angle to all other already found C4s for each group</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;        groupMatched                                  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign gIt = 0; gIt &lt; static_cast&lt;proshade_unsign&gt; ( C4Possibilities.size() ); gIt++ )</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;        {</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad8c193e95c7069fafa78dccc1de1aaa4">ProSHADE_internal_symmetry::testGroupAgainstSymmetry</a> ( CSymList, &amp;C4Possibilities.at(gIt), CSymList-&gt;at(cIt), axErr, 0.0, <span class="keyword">true</span>, cIt ) ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C4Possibilities.at(gIt), cIt ); groupMatched = <span class="keyword">true</span>; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        }</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160; </div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        <span class="comment">//=========================================== If no group matched, create a new group</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        <span class="keywordflow">if</span> ( !groupMatched ) { C4PossibilitiesHlp.clear(); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C4PossibilitiesHlp, cIt ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a86e2bb172f766ab4a620df482d2fe481">ProSHADE_internal_misc::addToUnsignVectorVector</a> ( &amp;C4Possibilities, C4PossibilitiesHlp ); <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    }</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160; </div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    <span class="comment">//================================================ Test for missing symmetry axes, if need be</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af6093da290ce7b73a33e8b55f2c83491">ProSHADE_internal_symmetry::findMissingAxes</a>       ( &amp;C4Possibilities, CSymList, 3, axErr, 0.0, 4, dataObj, minPeakHeight );</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160; </div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    <span class="comment">//================================================ Any group has 3 entries? If more such groups, take the one with highest average height.</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    proshade_double maxHeight = 0.0; proshade_unsign maxGrp = 0;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( C4Possibilities.size() ); iter++ ) { <span class="keywordflow">if</span> ( C4Possibilities.at(iter).size() == 3 ) { <span class="keywordflow">if</span> ( ( ( CSymList-&gt;at(C4Possibilities.at(iter).at(0))[5] + CSymList-&gt;at(C4Possibilities.at(iter).at(1))[5] + CSymList-&gt;at(C4Possibilities.at(iter).at(2))[5] ) / 3.0 ) &gt; maxHeight ) { maxHeight = ( ( CSymList-&gt;at(C4Possibilities.at(iter).at(0))[5] + CSymList-&gt;at(C4Possibilities.at(iter).at(1))[5] + CSymList-&gt;at(C4Possibilities.at(iter).at(2))[5] ) / 3.0 ); maxGrp = iter; } } }</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    </div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    <span class="keywordflow">if</span> ( C4Possibilities.at(maxGrp).size() == 3 )</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    {</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        <span class="comment">//============================================ Success! Save and exit</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( C4Possibilities.at(maxGrp).size() ); it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a> ( ret, CSymList-&gt;at(C4Possibilities.at(maxGrp).at(it)) ); }</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;        </div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( verbose, 3, <span class="stringliteral">&quot;Detection of three C4 axes successfull.&quot;</span> );</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        </div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        <span class="comment">//============================================ Done</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        return ;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    }</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    </div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;    return ;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    </div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;}</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160; </div>
<div class="line"><a name="l02390"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a0a35a745745fa3db227455241bb083ae"> 2390</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a0a35a745745fa3db227455241bb083ae">ProSHADE_internal_symmetry::findOcta4C3s</a> ( std::vector&lt; proshade_double* &gt;* CSymList, std::vector&lt; proshade_double* &gt;* ret, proshade_double axErr, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, proshade_signed verbose, proshade_double minPeakHeight )</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;{</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    std::vector&lt; proshade_unsign &gt; C4s, prospectiveC3s, C3PossibilitiesHlp;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; C3Possibilities;</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    proshade_double dotProd;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <span class="keywordtype">bool</span> groupMatched;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 3; iter++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C4s, iter ); }</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    </div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 2, <span class="stringliteral">&quot;Starting detection of four C3 axes.&quot;</span> );</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    </div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    <span class="comment">//================================================ For each C4</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign rIt = 0; rIt &lt; static_cast&lt;proshade_unsign&gt; ( ret-&gt;size() ); rIt++ )</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    {</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        <span class="comment">//============================================ For each C3, check it has angle ( acos( 1/sqrt(3) ) ) to the tested C4</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cIt++ )</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;        {</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;            <span class="comment">//======================================== Search only using C3s</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;            <span class="keywordflow">if</span> ( CSymList-&gt;at(cIt)[0] != 3.0 || CSymList-&gt;at(cIt)[5] &lt; minPeakHeight ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;            </div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;            <span class="comment">//======================================== Check the C3 axis to the C4 ( acos ( 1/sqrt(3) ) )</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;            dotProd = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;ret-&gt;at(rIt)[1], &amp;ret-&gt;at(rIt)[2], &amp;ret-&gt;at(rIt)[3], &amp;CSymList-&gt;at(cIt)[1], &amp;CSymList-&gt;at(cIt)[2], &amp;CSymList-&gt;at(cIt)[3] );</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;            </div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;            <span class="keywordflow">if</span> ( ( std::abs ( dotProd ) &gt; ( ( 1.0 / sqrt(3.0) ) - axErr ) ) &amp;&amp; ( std::abs ( dotProd ) &lt; ( ( 1.0 / sqrt(3.0) ) + axErr ) ) ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;prospectiveC3s, cIt ); }</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        }</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    }</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    </div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    <span class="comment">//================================================ Group the prospective C3s</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    C3Possibilities.clear(); C3PossibilitiesHlp.clear();</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( prospectiveC3s.size() ); cIt++ )</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    {</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        <span class="comment">//============================================ If second or more C3, check if it can be placed in any group with having acos (1/3) to all its members</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;        groupMatched                                  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign gIt = 0; gIt &lt; static_cast&lt;proshade_unsign&gt; ( C3Possibilities.size() ); gIt++ )</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;        {</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad8c193e95c7069fafa78dccc1de1aaa4">ProSHADE_internal_symmetry::testGroupAgainstSymmetry</a> ( CSymList, &amp;C3Possibilities.at(gIt), CSymList-&gt;at(prospectiveC3s.at(cIt)), axErr, 1.0/3.0, <span class="keyword">true</span>, prospectiveC3s.at(cIt) ) ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C3Possibilities.at(gIt), prospectiveC3s.at(cIt) ); groupMatched = <span class="keyword">true</span>; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        }</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160; </div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;        <span class="comment">//============================================ If no group matched, create a new group</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;        <span class="keywordflow">if</span> ( !groupMatched ) { C3PossibilitiesHlp.clear(); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C3PossibilitiesHlp, prospectiveC3s.at(cIt) ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a86e2bb172f766ab4a620df482d2fe481">ProSHADE_internal_misc::addToUnsignVectorVector</a> ( &amp;C3Possibilities, C3PossibilitiesHlp ); <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    }</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160; </div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    <span class="comment">//================================================ Find the best group or return empty</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    <span class="keywordflow">while</span> ( C3Possibilities.size() != 0 )</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    {</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;        <span class="comment">//============================================ Test for missing symmetry axes, if need be</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af6093da290ce7b73a33e8b55f2c83491">ProSHADE_internal_symmetry::findMissingAxes</a> ( &amp;C3Possibilities, CSymList, 4, axErr, 1.0/3.0, 3, dataObj, minPeakHeight );</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160; </div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;        <span class="comment">//============================================ Found four C3s?</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;        <span class="keywordflow">if</span> ( C3Possibilities.at(0).size() == 4 )</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;        {</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;            <span class="comment">//======================================== Success! Save and exit</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; 4; it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a> ( ret, CSymList-&gt;at(C3Possibilities.at(0).at(it)) ); }</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160; </div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;            <span class="comment">//======================================== Report progress</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( verbose, 3, <span class="stringliteral">&quot;Detection of four C3 axes successfull.&quot;</span> );</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160; </div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;            <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;            return ;</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;        }</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        <span class="keywordflow">else</span> { C3Possibilities.erase                  ( C3Possibilities.begin() ); }</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    }</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160; </div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    return ;</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    </div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;}</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160; </div>
<div class="line"><a name="l02472"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a62c8dc8fe0c14305d2d715a22c7042aa"> 2472</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a62c8dc8fe0c14305d2d715a22c7042aa">ProSHADE_internal_symmetry::findOcta6C2s</a> ( std::vector&lt; proshade_double* &gt;* CSymList, std::vector&lt; proshade_double* &gt;* ret, proshade_double axErr, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, proshade_signed verbose, proshade_double minPeakHeight )</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;{</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    std::vector&lt; proshade_unsign &gt; prospectiveC2s, retGrp;</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    proshade_double dotProd;</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    proshade_unsign noPerpendicular, noSqrtTwo;</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    </div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 2, <span class="stringliteral">&quot;Starting detection of six C2 axes.&quot;</span> );</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    </div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <span class="comment">//================================================ For each C2</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cIt++ )</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    {</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;        <span class="comment">//============================================ Use only C2s</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs999 ( CSymList-&gt;at(cIt)[5] ), rhs999 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( -999.9 ) );</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;        <span class="keywordflow">if</span> ( CSymList-&gt;at(cIt)[0] != 2.0 || ( ( CSymList-&gt;at(cIt)[5] &lt; minPeakHeight ) &amp;&amp; ! ( lhs999.AlmostEquals( rhs999 ) ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;        </div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;        <span class="comment">//============================================ Check the C2 has acos ( 1/sqrt(2) ) to 2 C4s and acos ( 0.0 ) to the third C4</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        noPerpendicular = 0; noSqrtTwo = 0;</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign rIt = 0; rIt &lt; 3; rIt++ )</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        {</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;            dotProd                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;ret-&gt;at(rIt)[1],</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                                                                                                     &amp;ret-&gt;at(rIt)[2],</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;                                                                                                     &amp;ret-&gt;at(rIt)[3],</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cIt)[1],</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cIt)[2],</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cIt)[3] );</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;            </div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;            <span class="keywordflow">if</span> ( ( std::abs ( dotProd ) &gt; ( ( 1.0 / sqrt(2.0) ) - axErr ) ) &amp;&amp; ( std::abs ( dotProd ) &lt; ( ( 1.0 / sqrt(2.0) ) + axErr ) ) ) { noSqrtTwo       += 1; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;            <span class="keywordflow">if</span> ( ( std::abs ( dotProd ) &gt; (   0.0               - axErr ) ) &amp;&amp; ( std::abs ( dotProd ) &lt; (   0.0               + axErr ) ) ) { noPerpendicular += 1; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;        }</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;        </div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        <span class="comment">//============================================ If correct angles distribution is found, save the axis</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;        <span class="keywordflow">if</span> ( ( noSqrtTwo == 2 ) &amp;&amp; ( noPerpendicular == 1 ) )</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        {</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;prospectiveC2s, cIt );</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;        }</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    }</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    </div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    <span class="comment">//================================================ Search for missing axes</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 3; iter++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;retGrp, iter ); }</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    <span class="keywordflow">if</span> ( !<a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a6d9f533a789bd5c6031fa77b9649ed3d">ProSHADE_internal_symmetry::findMissingAxesDual</a> ( &amp;prospectiveC2s, CSymList, ret, &amp;retGrp, 6, axErr, 1, 0.0, 2, 1/sqrt(2.0), 2, dataObj ) )</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    {</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;        return ;</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    }</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    </div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    <span class="comment">//================================================ Found correct number of axes! Now save the</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( prospectiveC2s.size() ); iter++ )</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    {</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a>     ( ret, CSymList-&gt;at(prospectiveC2s.at(iter)) );</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;    }</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    </div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 3, <span class="stringliteral">&quot;Detection of six C2 axes successfull.&quot;</span> );</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    </div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    return ;</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    </div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;}</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160; </div>
<div class="line"><a name="l02553"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a6d9f533a789bd5c6031fa77b9649ed3d"> 2553</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a6d9f533a789bd5c6031fa77b9649ed3d">ProSHADE_internal_symmetry::findMissingAxesDual</a> ( std::vector&lt; proshade_unsign &gt;* possibilities, std::vector&lt; proshade_double* &gt;* CSymList, std::vector&lt; proshade_double* &gt;* ret, std::vector&lt; proshade_unsign &gt;* retGroup, proshade_unsign requiredNoAxes, proshade_double axErr, proshade_unsign noMatchesG1, proshade_double angle1, proshade_unsign noMatchesG2, proshade_double angle2, proshade_unsign fold, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj )</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;{</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <span class="keywordtype">bool</span> atLeastOne                                   = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    std::vector&lt; proshade_double* &gt; prosp;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    std::vector&lt; proshade_double &gt; sol;</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    </div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    <span class="comment">//================================================ Proceed only if need be</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( possibilities-&gt;size() ) == requiredNoAxes ) { atLeastOne = <span class="keyword">true</span>; <span class="keywordflow">return</span> ( atLeastOne ); }</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    </div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    <span class="comment">//================================================ Copy already found to prospective</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign prIt = 0; prIt &lt; static_cast&lt;proshade_unsign&gt; ( possibilities-&gt;size() ); prIt++ )</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    {</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( CSymList-&gt;at(possibilities-&gt;at(prIt))[0] ),</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;                                                        CSymList-&gt;at(possibilities-&gt;at(prIt))[1],</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;                                                        CSymList-&gt;at(possibilities-&gt;at(prIt))[2],</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                                                        CSymList-&gt;at(possibilities-&gt;at(prIt))[3],</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                                                        CSymList-&gt;at(possibilities-&gt;at(prIt))[5], &amp;prosp, axErr );</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    }</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    </div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    <span class="comment">//================================================ Start generating possible solutions</span></div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign rgIt1 = 0; rgIt1 &lt; static_cast&lt;proshade_unsign&gt; ( retGroup-&gt;size() ); rgIt1++ )</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    {</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign rgIt2 = 0; rgIt2 &lt; static_cast&lt;proshade_unsign&gt; ( retGroup-&gt;size() ); rgIt2++ )</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;        {</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;            <span class="comment">//======================================== Use unique combinations (order matters here!)</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;            <span class="keywordflow">if</span> ( rgIt1 == rgIt2 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;            </div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;            <span class="comment">//======================================== Generate possible solution (1)</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;            sol                                       = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a45fbcfaeaabf9bae2fbd7d46a5fb4bc7">ProSHADE_internal_maths::findVectorFromTwoVAndTwoD</a> ( ret-&gt;at(rgIt1)[1], ret-&gt;at(rgIt1)[2], ret-&gt;at(rgIt1)[3],</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;                                                                                                             ret-&gt;at(rgIt2)[1], ret-&gt;at(rgIt2)[2], ret-&gt;at(rgIt2)[3], angle1, angle2 );</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;            </div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;            <span class="comment">//======================================== Check if solution fits the group completely</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a210ee0af651d440b68168882ead71c66">ProSHADE_internal_symmetry::checkFittingAxisDualAndSave</a> ( retGroup, ret, fold, sol.at(0), sol.at(1), sol.at(2), &amp;prosp, axErr, noMatchesG1, angle1, noMatchesG2, angle2, dataObj );</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;            <span class="keywordflow">if</span> ( prosp.size() == requiredNoAxes ) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;            </div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;            <span class="comment">//======================================== Generate possible solution (2)</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;            sol                                       = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a45fbcfaeaabf9bae2fbd7d46a5fb4bc7">ProSHADE_internal_maths::findVectorFromTwoVAndTwoD</a> ( ret-&gt;at(rgIt1)[1], ret-&gt;at(rgIt1)[2], ret-&gt;at(rgIt1)[3],</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                                                                                                             ret-&gt;at(rgIt2)[1], ret-&gt;at(rgIt2)[2], ret-&gt;at(rgIt2)[3], -angle1, -angle2 );</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;            </div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;            <span class="comment">//======================================== Check if solution fits the group completely</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a210ee0af651d440b68168882ead71c66">ProSHADE_internal_symmetry::checkFittingAxisDualAndSave</a> ( retGroup, ret, fold, sol.at(0), sol.at(1), sol.at(2), &amp;prosp, axErr, noMatchesG1, angle1, noMatchesG2, angle2, dataObj );</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;            <span class="keywordflow">if</span> ( prosp.size() == requiredNoAxes ) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        }</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;        </div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;        <span class="keywordflow">if</span> ( prosp.size() == requiredNoAxes ) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    }</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160; </div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    <span class="comment">//================================================ Found all required axes!</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( prosp.size() ) == requiredNoAxes )</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    {</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;        <span class="comment">//============================================ Copy the detected axes</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( possibilities-&gt;size() ); iter &lt; <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( prosp.size() ); iter++ )</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;        {</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2380a3710f7dbe672519c3adda30f7cd">ProSHADE_internal_maths::isAxisUnique</a> ( CSymList, prosp.at(iter), axErr ) )</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;            {</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;                <span class="comment">//==================================== Add</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( possibilities, <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( CSymList-&gt;size() ) );</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a> ( CSymList, prosp.at(iter) );</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;            }</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;        }</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;        </div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;        <span class="comment">//============================================ Done</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;        atLeastOne                                    = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;        <span class="keywordflow">return</span>                                        ( atLeastOne );</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    }</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;    {</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;        <span class="comment">//============================================ Delete the created, but not used axes</span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( possibilities-&gt;size() ); iter &lt; <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( prosp.size() ); iter++ )</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        {</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;            <span class="keyword">delete</span>[] prosp.at(iter);</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;        }</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    }</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    </div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    <span class="keywordflow">return</span>                                            ( atLeastOne );</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    </div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;}</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160; </div>
<div class="line"><a name="l02648"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd"> 2648</a></span>&#160;proshade_signed <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( proshade_unsign fold, proshade_double axX, proshade_double axY, proshade_double axZ, proshade_double axHeight, proshade_double averageFSC, std::vector&lt; proshade_double* &gt;* prosp, proshade_double axErr )</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;{</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;    proshade_double* symHlp                           = <span class="keyword">new</span> proshade_double[7];</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( symHlp, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    proshade_signed ret                               = -1;</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    </div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    <span class="comment">//================================================ Fill in the prospective axis</span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    symHlp[0]                                         = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( fold );</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    symHlp[1]                                         = axX;</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    symHlp[2]                                         = axY;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    symHlp[3]                                         = axZ;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    symHlp[4]                                         = 2.0 * M_PI / symHlp[0];</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;    symHlp[5]                                         = axHeight;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    symHlp[6]                                         = averageFSC;</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    </div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    <span class="comment">//================================================ If it is not the same as already saved axes</span></div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    <span class="keywordflow">if</span> ( !<a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad977c265833d6466598cceb406a085db">ProSHADE_internal_symmetry::isSymmetrySame</a> ( prosp, symHlp, axErr, &amp;ret, averageFSC ) )</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    {</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a>     ( prosp, symHlp );</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;        <span class="keywordflow">return</span>                                        ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( prosp-&gt;size() - 1 ) );</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    }</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    {</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;        <span class="keyword">delete</span>[] symHlp;</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;        <span class="keywordflow">return</span>                                        ( ret );</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    }</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    </div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    </div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;}</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160; </div>
<div class="line"><a name="l02694"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a00a784fd675e871b3b032d8f62013262"> 2694</a></span>&#160;proshade_signed <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( proshade_unsign fold, proshade_double axX, proshade_double axY, proshade_double axZ, proshade_double axHeight, std::vector&lt; proshade_double* &gt;* prosp, proshade_double axErr )</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;{</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    proshade_double* symHlp                           = <span class="keyword">new</span> proshade_double[7];</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( symHlp, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    proshade_signed ret                               = -1;</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    </div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    <span class="comment">//================================================ Fill in the prospective axis</span></div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    symHlp[0]                                         = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( fold );</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    symHlp[1]                                         = axX;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    symHlp[2]                                         = axY;</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    symHlp[3]                                         = axZ;</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    symHlp[4]                                         = 2.0 * M_PI / symHlp[0];</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    symHlp[5]                                         = axHeight;</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    symHlp[6]                                         = -1.0;</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    </div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    <span class="comment">//================================================ If it is not the same as already saved axes</span></div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    <span class="keywordflow">if</span> ( !<a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad977c265833d6466598cceb406a085db">ProSHADE_internal_symmetry::isSymmetrySame</a> ( prosp, symHlp, axErr, &amp;ret ) )</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    {</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a>     ( prosp, symHlp );</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        <span class="keywordflow">return</span>                                        ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( prosp-&gt;size() - 1 ) );</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    }</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;    {</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;        <span class="keyword">delete</span>[] symHlp;</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;        <span class="keywordflow">return</span>                                        ( ret );</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    }</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    </div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    </div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;}</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160; </div>
<div class="line"><a name="l02747"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a210ee0af651d440b68168882ead71c66"> 2747</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a210ee0af651d440b68168882ead71c66">ProSHADE_internal_symmetry::checkFittingAxisDualAndSave</a> ( std::vector&lt; proshade_unsign &gt;* retGroup, std::vector&lt; proshade_double* &gt;* ret, proshade_unsign fold, proshade_double axX, proshade_double axY, proshade_double axZ, std::vector&lt; proshade_double* &gt;* prosp, proshade_double axErr, proshade_unsign noMatchesG1, proshade_double angle1, proshade_unsign noMatchesG2, proshade_double angle2, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj )</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;{</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;    proshade_unsign noG1                              = 0;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    proshade_unsign noG2                              = 0;</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    proshade_double dotProd                           = 0.0;</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    proshade_double axHeight                          = 0.0;</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    </div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    <span class="comment">//================================================ Find the angle and count dual matching frequencies</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign rIt = 0; rIt &lt; static_cast&lt;proshade_unsign&gt; ( retGroup-&gt;size() ); rIt++ )</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    {</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;        dotProd                                       = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;ret-&gt;at(retGroup-&gt;at(rIt))[1],</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                                                                                                     &amp;ret-&gt;at(retGroup-&gt;at(rIt))[2],</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;                                                                                                     &amp;ret-&gt;at(retGroup-&gt;at(rIt))[3],</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;                                                                                                     &amp;axX, &amp;axY, &amp;axZ );</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;        </div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;        <span class="keywordflow">if</span> ( ( std::abs ( dotProd ) &gt; ( angle1 - axErr ) ) &amp;&amp; ( std::abs ( dotProd ) &lt; ( angle1 + axErr ) ) ) { noG1 += 1; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;        <span class="keywordflow">if</span> ( ( std::abs ( dotProd ) &gt; ( angle2 - axErr ) ) &amp;&amp; ( std::abs ( dotProd ) &lt; ( angle2 + axErr ) ) ) { noG2 += 1; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    }</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;    </div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    <span class="comment">//================================================ If correct frequencies are matched, check height.</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    <span class="keywordflow">if</span> ( ( noG1 == noMatchesG1 ) &amp;&amp; ( noG2 == noMatchesG2 ) )</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    {</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;        <span class="comment">//============================================ Is the height good enough?</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        axHeight                                      = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad44ed609e8a3d59674b2b2256aec41f8">ProSHADE_internal_symmetry::missingAxisHeight</a> ( axX, axY, axZ, dataObj, fold, axErr );</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;        </div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;        <span class="comment">//============================================ If so, save</span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;        <span class="keywordflow">if</span> ( axHeight &gt; 0.1 )</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;        {</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;            proshade_unsign prevProsp                 = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( prosp-&gt;size() );</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( fold, axX, axY, axZ, axHeight, prosp, axErr );</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;            </div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;            <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( prosp-&gt;size() ) &gt; prevProsp ) { <span class="keywordflow">return</span> ( <span class="keyword">true</span> ); }</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;            <span class="keywordflow">else</span>                                                              { <span class="keywordflow">return</span> ( <span class="keyword">false</span> ); }</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;        }</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    }</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    </div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">false</span> );</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    </div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;}</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160; </div>
<div class="line"><a name="l02799"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad46b5c9a39df4faa45cc53d31aab43db"> 2799</a></span>&#160;std::vector&lt; proshade_double* &gt; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad46b5c9a39df4faa45cc53d31aab43db">ProSHADE_internal_data::ProSHADE_data::getIcosahedralSymmetriesList</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* CSymList )</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;{</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;    </div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting I symmetry detection.&quot;</span> );</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    </div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    <span class="comment">//================================================ Are the basic requirements for icosahedral symmetry met?</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a4f09b90de1f15b345ee7998ff31327f3">ProSHADE_internal_symmetry::detectIcosahedralSymmetry</a> ( CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) )</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    {</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;        <span class="comment">//============================================ Search for all the symmetry axes</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a8e5edd0504efb95ecf9caf51661d5aa4">ProSHADE_internal_symmetry::findIcos6C5s</a>      ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 6 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160; </div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aa0df823fdb0d1f187f160f884f220327">ProSHADE_internal_symmetry::findIcos10C3s</a>     ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 16 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160; </div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a81b6825a5467ac570ebe9a3167cda9e2">ProSHADE_internal_symmetry::findIcos15C2s</a>     ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">this</span>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        <span class="keywordflow">if</span> ( ret.size() != 31 ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, <span class="stringliteral">&quot;!!! ProSHADE WARNING !!! Failed to detect some of the polyhedral symmetries, while detecting the correct dihedral angles.&quot;</span>, <span class="stringliteral">&quot;WS00031&quot;</span> ); <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        {</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;            <span class="comment">//======================================== Sort ret by fold</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;            std::sort                                 ( ret.begin(), ret.end(), <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad14d6427df4269728627fcd880abaf31">ProSHADE_internal_misc::sortSymInvFoldHlp</a> );</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;            </div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;            <span class="comment">//======================================== Save indices</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign csIt = 0; csIt &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); csIt++ )</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;            {</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign retIt = 0; retIt &lt; static_cast&lt;proshade_unsign&gt; ( ret.size() ); retIt++ )</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;                {</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(csIt)[0] ), rhs1 ( ret.at(retIt)[0] );</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs2 ( CSymList-&gt;at(csIt)[1] ), rhs2 ( ret.at(retIt)[1] );</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs3 ( CSymList-&gt;at(csIt)[2] ), rhs3 ( ret.at(retIt)[2] );</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs4 ( CSymList-&gt;at(csIt)[3] ), rhs4 ( ret.at(retIt)[3] );</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs5 ( CSymList-&gt;at(csIt)[4] ), rhs5 ( ret.at(retIt)[4] );</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;                    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs6 ( CSymList-&gt;at(csIt)[5] ), rhs6 ( ret.at(retIt)[5] );</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;                    <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) &amp;&amp;</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;                         lhs2.AlmostEquals ( rhs2 ) &amp;&amp;</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;                         lhs3.AlmostEquals ( rhs3 ) &amp;&amp;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;                         lhs4.AlmostEquals ( rhs4 ) &amp;&amp;</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;                         lhs5.AlmostEquals ( rhs5 ) &amp;&amp;</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;                         lhs6.AlmostEquals ( rhs6 ) )</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;                    {</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;                        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">allDetectedIAxes</a>, csIt );</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;                    }</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;                }</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;            }</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;        }</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    }</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160; </div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;I symmetry detection complete.&quot;</span> );</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160; </div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    </div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;}</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160; </div>
<div class="line"><a name="l02871"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad9a02d8d68aac021572b764651aad0f1"> 2871</a></span>&#160;std::vector &lt; std::vector&lt; proshade_double* &gt; &gt; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad9a02d8d68aac021572b764651aad0f1">ProSHADE_internal_data::ProSHADE_data::getPredictedIcosahedralSymmetriesList</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* CSymList )</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;{</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    std::vector&lt; std::vector&lt; proshade_double* &gt; &gt; ret;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    </div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting I symmetry prediction.&quot;</span> );</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    </div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    <span class="comment">//================================================ Are the basic requirements for icosahedral symmetry met?</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a4f09b90de1f15b345ee7998ff31327f3">ProSHADE_internal_symmetry::detectIcosahedralSymmetry</a> ( CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) )</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    {</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;        <span class="comment">//============================================ Generate the rest of the axes</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a16d3cf24f73eafc1d5b8ef9e204aaf8d">ProSHADE_internal_symmetry::predictIcosAxes</a>   ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160; </div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;        <span class="comment">//============================================ For each possible axes pair</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> pIt = 0; pIt &lt; ret.size(); pIt++ )</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;        {</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;            <span class="comment">//======================================== Get heights for the predicted axes</span></div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a33c650c19a6954800bba6b3a8f5842e6">ProSHADE_internal_symmetry::findPredictedAxesHeights</a> ( &amp;(ret.at(pIt)), <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;        }</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    }</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;    </div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160; </div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;I symmetry prediction complete.&quot;</span> );</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160; </div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    </div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;}</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160; </div>
<div class="line"><a name="l02916"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae97b54a34689c1dceae47a5e8e94bbb0"> 2916</a></span>&#160;std::vector&lt; proshade_double* &gt; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae97b54a34689c1dceae47a5e8e94bbb0">ProSHADE_internal_data::ProSHADE_data::getPredictedOctahedralSymmetriesList</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* CSymList )</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;{</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    </div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting O symmetry prediction.&quot;</span> );</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    </div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;    <span class="comment">//================================================ Are the basic requirements for icosahedral symmetry met?</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a18d456057604616a7cf6b68f59b4f2d0">ProSHADE_internal_symmetry::detectOctahedralSymmetry</a> ( CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) )</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    {</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;        <span class="comment">//============================================ Generate the rest of the axes</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a38ce8efbbe05220793b5f01f0fef07a6">ProSHADE_internal_symmetry::predictOctaAxes</a>   ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160; </div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;        <span class="comment">//============================================ Get heights for the predicted axes</span></div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a33c650c19a6954800bba6b3a8f5842e6">ProSHADE_internal_symmetry::findPredictedAxesHeights</a> ( &amp;ret, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160; </div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;        <span class="comment">//============================================ Add predicted axes to detected C axes list and also to the settings Icosahedral symmetry list</span></div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign retIt = 0; retIt &lt; static_cast &lt; proshade_unsign &gt; ( ret.size() ); retIt++ )</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;        {</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;            proshade_signed matchedPos                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( ret.at(retIt)[0] ), ret.at(retIt)[1], ret.at(retIt)[2], ret.at(retIt)[3], ret.at(retIt)[5], CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a> );</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">allDetectedOAxes</a>, <span class="keyword">static_cast &lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( matchedPos ) );</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;        }</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;    }</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;    </div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;O symmetry prediction complete.&quot;</span> );</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160; </div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    </div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;}</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160; </div>
<div class="line"><a name="l02960"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a4f09b90de1f15b345ee7998ff31327f3"> 2960</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a4f09b90de1f15b345ee7998ff31327f3">ProSHADE_internal_symmetry::detectIcosahedralSymmetry</a> ( std::vector&lt; proshade_double* &gt;* CSymList, proshade_double axErr, proshade_double minPeakHeight )</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;{</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;    std::vector&lt; proshade_unsign &gt; C5List;</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;    proshade_double dotProduct;</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    </div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    <span class="comment">//================================================ Find all C5 symmetries</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cSym = 0; cSym &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cSym++ )</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;    {</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(cSym)[0] ), rhs1 ( 5.0 );</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;        <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) &amp;&amp; CSymList-&gt;at(cSym)[5] &gt;= minPeakHeight ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C5List, cSym ); }</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;    }</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;    </div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;    <span class="comment">//================================================ For each unique pair of C5 and C3</span></div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign c5 = 0; c5 &lt; static_cast&lt;proshade_unsign&gt; ( C5List.size() ); c5++ )</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;    {</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign cSym = 0; cSym &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cSym++ )</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;        {</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;            <span class="comment">//======================================== Compare only C3s to the C5List</span></div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(cSym)[0] ), rhs1 ( 3.0 );</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;            <span class="keywordflow">if</span> ( !lhs1.AlmostEquals ( rhs1 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;            </div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;            <span class="comment">//========================================  Check the angle between the C5 and C3 axes</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;            dotProduct                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;CSymList-&gt;at(C5List.at(c5))[1],</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;                                                                                                     &amp;CSymList-&gt;at(C5List.at(c5))[2],</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;                                                                                                     &amp;CSymList-&gt;at(C5List.at(c5))[3],</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[1],</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[2],</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[3] );</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;            </div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;            <span class="comment">//======================================== Is the angle approximately the dihedral angle</span></div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;            <span class="keywordflow">if</span> ( std::abs ( std::abs( std::sqrt ( ( 1.0 + 2.0 / std::sqrt ( 5.0 ) ) / 3.0 ) ) - std::abs( dotProduct ) ) &lt; axErr )</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;            {</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;                <span class="keywordflow">return</span>                                ( <span class="keyword">true</span> );</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;            }</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;        }</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    }</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;    </div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;    <span class="keywordflow">return</span>                                            ( <span class="keyword">false</span> );</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    </div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;}</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160; </div>
<div class="line"><a name="l03020"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a8e5edd0504efb95ecf9caf51661d5aa4"> 3020</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a8e5edd0504efb95ecf9caf51661d5aa4">ProSHADE_internal_symmetry::findIcos6C5s</a> ( std::vector&lt; proshade_double* &gt;* CSymList, std::vector&lt; proshade_double* &gt;* ret, proshade_double axErr, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, proshade_signed verbose, proshade_double minPeakHeight )</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;{</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;    std::vector&lt; proshade_unsign &gt; C5PossibilitiesHlp;</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;    std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; C5Possibilities;</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    <span class="keywordtype">bool</span> groupMatched;</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    </div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 2, <span class="stringliteral">&quot;Starting detection of six C5 axes.&quot;</span> );</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160; </div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;    <span class="comment">//================================================ For all symmetries in the C symmetries list</span></div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cIt++ )</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    {</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;        <span class="comment">//============================================ Search only using C5s and check peak height</span></div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(cIt)[0] ), rhs1 ( 5.0 );</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;        <span class="keywordflow">if</span> ( !lhs1.AlmostEquals ( rhs1 ) || CSymList-&gt;at(cIt)[5] &lt; minPeakHeight ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160; </div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        <span class="comment">//============================================ If second or more C5, check if it has the correct angle to all other already found C5s for each group</span></div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;        groupMatched                                  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign gIt = 0; gIt &lt; static_cast&lt;proshade_unsign&gt; ( C5Possibilities.size() ); gIt++ )</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;        {</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad8c193e95c7069fafa78dccc1de1aaa4">ProSHADE_internal_symmetry::testGroupAgainstSymmetry</a> ( CSymList, &amp;C5Possibilities.at(gIt), CSymList-&gt;at(cIt), axErr, 1.0/2.0, <span class="keyword">true</span>, cIt ) ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C5Possibilities.at(gIt), cIt ); groupMatched = <span class="keyword">true</span>; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;        }</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160; </div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;        <span class="comment">//============================================ If no group matched, create a new group</span></div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;        <span class="keywordflow">if</span> ( !groupMatched ) { C5PossibilitiesHlp.clear(); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C5PossibilitiesHlp, cIt ); <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a86e2bb172f766ab4a620df482d2fe481">ProSHADE_internal_misc::addToUnsignVectorVector</a> ( &amp;C5Possibilities, C5PossibilitiesHlp ); <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;    }</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;    </div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    <span class="comment">//================================================ Test for missing symmetry axes, if need be</span></div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af6093da290ce7b73a33e8b55f2c83491">ProSHADE_internal_symmetry::findMissingAxes</a>       ( &amp;C5Possibilities, CSymList, 6, axErr, 1.0 / 2.0, 5, dataObj, minPeakHeight );</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160; </div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    <span class="comment">//=================================================Any group has 6 entries? If more such groups, take the one with highest average height.</span></div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;    proshade_double maxHeight = 0.0; proshade_unsign maxGrp = 0;</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( C5Possibilities.size() ); iter++ ) { <span class="keywordflow">if</span> ( C5Possibilities.at(iter).size() == 6 ) { <span class="keywordflow">if</span> ( ( ( CSymList-&gt;at(C5Possibilities.at(iter).at(0))[5] + CSymList-&gt;at(C5Possibilities.at(iter).at(1))[5] + CSymList-&gt;at(C5Possibilities.at(iter).at(2))[5] + CSymList-&gt;at(C5Possibilities.at(iter).at(3))[5] + CSymList-&gt;at(C5Possibilities.at(iter).at(4))[5] + CSymList-&gt;at(C5Possibilities.at(iter).at(5))[5] ) / 6.0 ) &gt; maxHeight ) { maxHeight = ( ( CSymList-&gt;at(C5Possibilities.at(iter).at(0))[5] + CSymList-&gt;at(C5Possibilities.at(iter).at(1))[5] + CSymList-&gt;at(C5Possibilities.at(iter).at(2))[5] + CSymList-&gt;at(C5Possibilities.at(iter).at(3))[5] + CSymList-&gt;at(C5Possibilities.at(iter).at(4))[5] + CSymList-&gt;at(C5Possibilities.at(iter).at(5))[5] ) / 6.0 ); maxGrp = iter; } } }</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160; </div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    <span class="keywordflow">if</span> ( C5Possibilities.at(maxGrp).size() == 6 )</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    {</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;        <span class="comment">//============================================ Success! Save and exit</span></div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast&lt;proshade_unsign&gt; ( C5Possibilities.at(maxGrp).size() ); it++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a> ( ret, CSymList-&gt;at(C5Possibilities.at(maxGrp).at(it)) ); }</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160; </div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( verbose, 3, <span class="stringliteral">&quot;Detection of six C5 axes successfull.&quot;</span> );</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160; </div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;        <span class="comment">//============================================ Done</span></div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;        return ;</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;    }</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;    </div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    return ;</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;    </div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;}</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160; </div>
<div class="line"><a name="l03079"></a><span class="lineno"><a class="line" href="_pro_s_h_a_d_e__symmetry_8cpp.html#a16b3a0c170d01be9b4fad682f90025a5"> 3079</a></span>&#160;std::vector &lt; std::pair&lt; proshade_unsign, proshade_unsign &gt; &gt; <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#a16b3a0c170d01be9b4fad682f90025a5">findBestIcosDihedralPair</a> ( std::vector&lt; proshade_double* &gt;* CSymList, proshade_double minPeakHeight, proshade_double axErr )</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;{</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;    std::vector &lt; std::pair&lt; proshade_unsign, proshade_unsign &gt; &gt; ret;</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    std::vector&lt; proshade_unsign  &gt; C5List;</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;    proshade_double dotProduct;</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;    </div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;    <span class="comment">//================================================ Find all C5 symmetries</span></div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cSym = 0; cSym &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cSym++ ) { <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(cSym)[0] ), rhs1 ( 5.0 ); <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) &amp;&amp; CSymList-&gt;at(cSym)[5] &gt;= minPeakHeight ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C5List, cSym ); } }</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;    </div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    <span class="comment">//================================================ For each unique pair of C5 and C3</span></div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign c5 = 0; c5 &lt; static_cast&lt;proshade_unsign&gt; ( C5List.size() ); c5++ )</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    {</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign cSym = 0; cSym &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cSym++ )</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;        {</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;            <span class="comment">//======================================== Compare only C3s to the C5List and only with decent average peak height</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(cSym)[0] ), rhs1 ( 3.0 );</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;            <span class="keywordflow">if</span> ( !lhs1.AlmostEquals ( rhs1 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;            <span class="keywordflow">if</span> ( CSymList-&gt;at(cSym)[5] &lt; minPeakHeight ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;            </div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;            <span class="comment">//========================================  Check the angle between the C5 and C3 axes</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;            dotProduct                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;CSymList-&gt;at(C5List.at(c5))[1],</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;                                                                                                     &amp;CSymList-&gt;at(C5List.at(c5))[2],</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;                                                                                                     &amp;CSymList-&gt;at(C5List.at(c5))[3],</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[1],</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[2],</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[3] );</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;            </div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;            <span class="comment">//======================================== Is the angle approximately the dihedral angle?</span></div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;            <span class="keywordflow">if</span> ( std::abs ( std::abs( std::sqrt ( ( 1.0 + 2.0 / std::sqrt ( 5.0 ) ) / 3.0 ) ) - std::abs( dotProduct ) ) &lt; axErr )</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;            {</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;                std::pair&lt; proshade_unsign, proshade_unsign &gt; hlp;</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;                hlp.first                             = C5List.at(c5);</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;                hlp.second                            = cSym;</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;                ret.emplace_back                      ( hlp );</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;            }</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;        }</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;    }</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;    </div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;}</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160; </div>
<div class="line"><a name="l03142"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a16d3cf24f73eafc1d5b8ef9e204aaf8d"> 3142</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a16d3cf24f73eafc1d5b8ef9e204aaf8d">ProSHADE_internal_symmetry::predictIcosAxes</a> ( std::vector&lt; proshade_double* &gt;* CSymList, std::vector&lt; std::vector&lt; proshade_double* &gt; &gt;* ret, proshade_double axErr, proshade_double minPeakHeight )</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;{</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;    <span class="comment">//================================================ Find the best axis combination with dihedral angle and correct folds</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    std::vector &lt; std::pair&lt; proshade_unsign, proshade_unsign &gt; &gt; initAxes = <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#a16b3a0c170d01be9b4fad682f90025a5">findBestIcosDihedralPair</a> ( CSymList, minPeakHeight, axErr );</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;    </div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;    <span class="comment">//================================================ For each pair of possible axis combinations</span></div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> pIt = 0; pIt &lt; initAxes.size(); pIt++ )</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;    {</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;        <span class="comment">//============================================ Create the tetrahedronAxes object</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;        <a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html">ProSHADE_internal_precomputedVals::icosahedronAxes</a> *icoAx = <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html">ProSHADE_internal_precomputedVals::icosahedronAxes</a> ( );</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;        </div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;        <span class="comment">//============================================ Find rotation between the detected C5 and the model C5 axes.</span></div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;        proshade_double* rotMat                       = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2b17617f8b3c42c5199948828cd1a57b">ProSHADE_internal_maths::findRotMatMatchingVectors</a> ( icoAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html#aeec201a53ee1f3aeaf69cc956b43bb30">getValue</a> ( 0, 1 ),</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;                                                                                                             icoAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html#aeec201a53ee1f3aeaf69cc956b43bb30">getValue</a> ( 0, 2 ),</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;                                                                                                             icoAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html#aeec201a53ee1f3aeaf69cc956b43bb30">getValue</a> ( 0, 3 ),</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;                                                                                                             CSymList-&gt;at(initAxes.at(pIt).first)[1],</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;                                                                                                             CSymList-&gt;at(initAxes.at(pIt).first)[2],</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;                                                                                                             CSymList-&gt;at(initAxes.at(pIt).first)[3] );</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;        </div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;        <span class="comment">//============================================ Rotate the model C3 to the correct orientation relative to the detected C5 axis.</span></div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;        proshade_double* rotModelC3                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2f9c7716f6ab682e8548ab77efcdc444">ProSHADE_internal_maths::compute3x3MatrixVectorMultiplication</a> ( rotMat,</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;                                                                                                                        icoAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html#aeec201a53ee1f3aeaf69cc956b43bb30">getValue</a> ( 6, 1 ),</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;                                                                                                                        icoAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html#aeec201a53ee1f3aeaf69cc956b43bb30">getValue</a> ( 6, 2 ),</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;                                                                                                                        icoAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html#aeec201a53ee1f3aeaf69cc956b43bb30">getValue</a> ( 6, 3 ) );</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;        </div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;        <span class="comment">//============================================ Find the angle betwen the rotated model C3 and the detected C3 axes along the detected C5 axis.</span></div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;        proshade_double bestAng = 0.0, curAngDist, bestAngDist = 999.9;</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;        proshade_double* rotMatHlp                    = <span class="keyword">new</span> proshade_double[9];</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( rotMatHlp, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;        <span class="keywordflow">for</span> ( proshade_double ang = 0.0; ang &lt; ( M_PI * 2.0 ); ang += 0.002 )</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;        {</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;            <span class="comment">//============================================ Compute rotation matrix for this angle value</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a39eafef902a49cc0816a2ed675c14a49">ProSHADE_internal_maths::getRotationMatrixFromAngleAxis</a> ( rotMatHlp, CSymList-&gt;at(initAxes.at(pIt).first)[1], CSymList-&gt;at(initAxes.at(pIt).first)[2], CSymList-&gt;at(initAxes.at(pIt).first)[3], ang );</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160; </div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;            <span class="comment">//======================================== Rotate the rotated C2 by the matrix</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;            proshade_double* rotRotModelC3            = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2f9c7716f6ab682e8548ab77efcdc444">ProSHADE_internal_maths::compute3x3MatrixVectorMultiplication</a> ( rotMatHlp,</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;                                                                                                                        rotModelC3[0],</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;                                                                                                                        rotModelC3[1],</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;                                                                                                                        rotModelC3[2] );</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160; </div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;            <span class="comment">//======================================== Find distance</span></div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;            curAngDist                                = std::sqrt ( std::pow ( rotRotModelC3[0] - CSymList-&gt;at(initAxes.at(pIt).second)[1], 2.0 ) +</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;                                                                    std::pow ( rotRotModelC3[1] - CSymList-&gt;at(initAxes.at(pIt).second)[2], 2.0 ) +</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;                                                                    std::pow ( rotRotModelC3[2] - CSymList-&gt;at(initAxes.at(pIt).second)[3], 2.0 ) );</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160; </div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;            <span class="comment">//======================================== Save best angle</span></div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;            <span class="keywordflow">if</span> ( curAngDist &lt; bestAngDist ) { bestAngDist = curAngDist; bestAng = ang; }</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160; </div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;            <span class="comment">//======================================== Release memory</span></div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;            <span class="keyword">delete</span>[] rotRotModelC3;</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;        }</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;        </div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;        <span class="comment">//============================================ Release memory</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;        <span class="keyword">delete</span>[] rotMatHlp;</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;        </div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;        <span class="comment">//============================================ For the rotation matrix along the detected C5 axis with the same anlge as is between the rotated model C3 and the detected C3 axes.</span></div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;        proshade_double* rotMat2                      = <span class="keyword">new</span> proshade_double[9];</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( rotMat2, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a39eafef902a49cc0816a2ed675c14a49">ProSHADE_internal_maths::getRotationMatrixFromAngleAxis</a> ( rotMat2, CSymList-&gt;at(initAxes.at(pIt).first)[1], CSymList-&gt;at(initAxes.at(pIt).first)[2], CSymList-&gt;at(initAxes.at(pIt).first)[3], bestAng );</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;        </div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;        <span class="comment">//============================================ Combine the two rotation matrices into a single rotation matrix</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;        proshade_double* rotMatFin                    = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a5f2b9b9da97b52b7e5cccc08493d0e0d">ProSHADE_internal_maths::compute3x3MatrixMultiplication</a> ( rotMat2, rotMat );</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160; </div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;        <span class="comment">//============================================ For each model axis</span></div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;        std::vector&lt; proshade_double* &gt; hlpAxes;</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; icoAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html#aeb51e819ae1cf2ca1a2faba0ee3782ae">getNoAxes</a> ( ); iter++ )</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;        {</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;            <span class="comment">//======================================== Rotate the model axis to fit the detected orientation</span></div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;            proshade_double* rotAxis                  = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2f9c7716f6ab682e8548ab77efcdc444">ProSHADE_internal_maths::compute3x3MatrixVectorMultiplication</a> ( rotMatFin,</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;                                                                                                                        icoAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html#aeec201a53ee1f3aeaf69cc956b43bb30">getValue</a> ( iter, 1 ),</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;                                                                                                                        icoAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html#aeec201a53ee1f3aeaf69cc956b43bb30">getValue</a> ( iter, 2 ),</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;                                                                                                                        icoAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html#aeec201a53ee1f3aeaf69cc956b43bb30">getValue</a> ( iter, 3 ) );</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160; </div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;            <span class="comment">//======================================== Create ProSHADE symmetry axis representation</span></div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;            proshade_double* axis                     = <span class="keyword">new</span> proshade_double[7];</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( axis, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160; </div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;            axis[0]                                   = icoAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html#aeec201a53ee1f3aeaf69cc956b43bb30">getValue</a> ( iter, 0 );</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;            axis[1]                                   = rotAxis[0];</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;            axis[2]                                   = rotAxis[1];</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;            axis[3]                                   = rotAxis[2];</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;            axis[4]                                   = ( 2.0 * M_PI ) / axis[0];</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;            axis[5]                                   = 0.0;</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;            axis[6]                                   = -1.0;</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160; </div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;            <span class="comment">//======================================== Save axis to ret</span></div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( &amp;hlpAxes, axis );</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160; </div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;            <span class="comment">//======================================== Release memory</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;            <span class="keyword">delete</span>[] rotAxis;</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;            <span class="keyword">delete</span>[] axis;</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;        }</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;        </div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;        <span class="comment">//============================================ Save to ret</span></div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;        ret-&gt;emplace_back                             ( hlpAxes );</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160; </div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;        <span class="comment">//============================================ Release memory</span></div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;        <span class="keyword">delete</span>[] rotMat;</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;        <span class="keyword">delete</span>[] rotMat2;</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;        <span class="keyword">delete</span>[] rotMatFin;</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;        <span class="keyword">delete</span>[] rotModelC3;</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;        <span class="keyword">delete</span>   icoAx;</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;    }</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160; </div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;    return ;</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;    </div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;}</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160; </div>
<div class="line"><a name="l03258"></a><span class="lineno"><a class="line" href="_pro_s_h_a_d_e__symmetry_8cpp.html#a458a09071115478efb8b666b839c18f2"> 3258</a></span>&#160;std::pair&lt; proshade_unsign, proshade_unsign &gt; <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#a458a09071115478efb8b666b839c18f2">findBestOctaDihedralPair</a> ( std::vector&lt; proshade_double* &gt;* CSymList, proshade_double minPeakHeight, proshade_double axErr )</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;{</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;    std::pair&lt; proshade_unsign, proshade_unsign &gt; ret;</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;    std::vector&lt; proshade_unsign  &gt; C4List;</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;    proshade_double bestHeightSum                     = 0.0;</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;    proshade_double dotProduct;</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;    </div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;    <span class="comment">//================================================ Find all C5 symmetries</span></div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cSym = 0; cSym &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cSym++ ) { <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(cSym)[0] ), rhs1 ( 4.0 ); <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) &amp;&amp; CSymList-&gt;at(cSym)[5] &gt;= minPeakHeight ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C4List, cSym ); } }</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;    </div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    <span class="comment">//================================================ For each unique pair of C5 and C3</span></div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign c4 = 0; c4 &lt; static_cast&lt;proshade_unsign&gt; ( C4List.size() ); c4++ )</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;    {</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign cSym = 0; cSym &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cSym++ )</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;        {</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;            <span class="comment">//======================================== Compare only C3s to the C5List and only with decent average peak height</span></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(cSym)[0] ), rhs1 ( 3.0 );</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;            <span class="keywordflow">if</span> ( !lhs1.AlmostEquals ( rhs1 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;            <span class="keywordflow">if</span> ( CSymList-&gt;at(cSym)[5] &lt; minPeakHeight ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;            </div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;            <span class="comment">//========================================  Check the angle between the C5 and C3 axes</span></div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;            dotProduct                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;CSymList-&gt;at(C4List.at(c4))[1],</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;                                                                                                     &amp;CSymList-&gt;at(C4List.at(c4))[2],</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;                                                                                                     &amp;CSymList-&gt;at(C4List.at(c4))[3],</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[1],</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[2],</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[3] );</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;            </div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;            <span class="comment">//======================================== Is the angle approximately the dihedral angle?</span></div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;            <span class="keywordflow">if</span> ( ( ( 1.0 / sqrt ( 3.0 ) ) &gt; ( std::abs( dotProduct ) - axErr ) ) &amp;&amp; ( ( 1.0 / sqrt ( 3.0 ) ) &lt; ( std::abs( dotProduct ) + axErr ) ) )</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;            {</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;                <span class="keywordflow">if</span> ( bestHeightSum &lt; ( CSymList-&gt;at(C4List.at(c4))[5] + CSymList-&gt;at(cSym)[5] ) )</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;                {</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;                    bestHeightSum                     = ( CSymList-&gt;at(C4List.at(c4))[5] + CSymList-&gt;at(cSym)[5] );</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;                    ret.first                         = C4List.at(c4);</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;                    ret.second                        = cSym;</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;                }</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;            }</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;        }</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;    }</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;    </div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;    </div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;}</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160; </div>
<div class="line"><a name="l03325"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a38ce8efbbe05220793b5f01f0fef07a6"> 3325</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a38ce8efbbe05220793b5f01f0fef07a6">ProSHADE_internal_symmetry::predictOctaAxes</a> ( std::vector&lt; proshade_double* &gt;* CSymList, std::vector&lt; proshade_double* &gt;* ret, proshade_double axErr, proshade_double minPeakHeight )</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;{</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;    <span class="comment">//================================================ Create the tetrahedronAxes object</span></div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    <a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html">ProSHADE_internal_precomputedVals::octahedronAxes</a> *octAx = <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html">ProSHADE_internal_precomputedVals::octahedronAxes</a> ( );</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;    </div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    <span class="comment">//================================================ Find the best axis combination with dihedral angle and correct folds</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    std::pair&lt; proshade_unsign, proshade_unsign &gt; initAxes = <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#a458a09071115478efb8b666b839c18f2">findBestOctaDihedralPair</a> ( CSymList, minPeakHeight, axErr );</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;    </div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;    <span class="comment">//================================================ Find rotation between the detected C4 and the model C4 axes.</span></div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;    proshade_double* rotMat                           = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2b17617f8b3c42c5199948828cd1a57b">ProSHADE_internal_maths::findRotMatMatchingVectors</a> ( octAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html#ab357cd5b90f9f841ae7f53254f54e6d0">getValue</a> ( 0, 1 ),</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;                                                                                                             octAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html#ab357cd5b90f9f841ae7f53254f54e6d0">getValue</a> ( 0, 2 ),</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;                                                                                                             octAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html#ab357cd5b90f9f841ae7f53254f54e6d0">getValue</a> ( 0, 3 ),</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;                                                                                                             CSymList-&gt;at(initAxes.first)[1],</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;                                                                                                             CSymList-&gt;at(initAxes.first)[2],</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;                                                                                                             CSymList-&gt;at(initAxes.first)[3] );</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160; </div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;    <span class="comment">//================================================ Rotate the model C3 to the correct orientation relative to the detected C4 axis.</span></div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;    proshade_double* rotModelC3                       = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2f9c7716f6ab682e8548ab77efcdc444">ProSHADE_internal_maths::compute3x3MatrixVectorMultiplication</a> ( rotMat,</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;                                                                                                                        octAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html#ab357cd5b90f9f841ae7f53254f54e6d0">getValue</a> ( 3, 1 ),</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;                                                                                                                        octAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html#ab357cd5b90f9f841ae7f53254f54e6d0">getValue</a> ( 3, 2 ),</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;                                                                                                                        octAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html#ab357cd5b90f9f841ae7f53254f54e6d0">getValue</a> ( 3, 3 ) );</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    </div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;    <span class="comment">//================================================ Find the angle betwen the rotated model C3 and the detected C3 axes along the detected C4 axis.</span></div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;    proshade_double bestAng = 0.0, curAngDist, bestAngDist = 999.9;</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;    proshade_double* rotMatHlp                    = <span class="keyword">new</span> proshade_double[9];</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( rotMatHlp, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;    <span class="keywordflow">for</span> ( proshade_double ang = 0.0; ang &lt; ( M_PI * 2.0 ); ang += 0.002 )</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;    {</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;        <span class="comment">//============================================ Compute rotation matrix for this angle value</span></div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a39eafef902a49cc0816a2ed675c14a49">ProSHADE_internal_maths::getRotationMatrixFromAngleAxis</a> ( rotMatHlp, CSymList-&gt;at(initAxes.first)[1], CSymList-&gt;at(initAxes.first)[2], CSymList-&gt;at(initAxes.first)[3], ang );</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;        </div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;        <span class="comment">//============================================ Rotate the rotated C2 by the matrix</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;        proshade_double* rotRotModelC3                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2f9c7716f6ab682e8548ab77efcdc444">ProSHADE_internal_maths::compute3x3MatrixVectorMultiplication</a> ( rotMatHlp,</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;                                                                                                                        rotModelC3[0],</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;                                                                                                                        rotModelC3[1],</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;                                                                                                                        rotModelC3[2] );</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;        </div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;        <span class="comment">//============================================ Find distance</span></div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;        curAngDist                                    = std::sqrt ( std::pow ( rotRotModelC3[0] - CSymList-&gt;at(initAxes.second)[1], 2.0 ) +</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;                                                                    std::pow ( rotRotModelC3[1] - CSymList-&gt;at(initAxes.second)[2], 2.0 ) +</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;                                                                    std::pow ( rotRotModelC3[2] - CSymList-&gt;at(initAxes.second)[3], 2.0 ) );</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;        </div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;        <span class="comment">//============================================ Save best angle</span></div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;        <span class="keywordflow">if</span> ( curAngDist &lt; bestAngDist ) { bestAngDist = curAngDist; bestAng = ang; }</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;        </div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;        <span class="comment">//============================================ Release memory</span></div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;        <span class="keyword">delete</span>[] rotRotModelC3;</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;    }</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;    </div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;    <span class="comment">//============================================ Release memory</span></div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;    <span class="keyword">delete</span>[] rotMatHlp;</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;    </div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;    <span class="comment">//================================================ For the rotation matrix along the detected C5 axis with the same anlge as is between the rotated model C3 and the detected C3 axes.</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;    proshade_double* rotMat2                          = <span class="keyword">new</span> proshade_double[9];</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rotMat2, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a39eafef902a49cc0816a2ed675c14a49">ProSHADE_internal_maths::getRotationMatrixFromAngleAxis</a> ( rotMat2, CSymList-&gt;at(initAxes.first)[1], CSymList-&gt;at(initAxes.first)[2], CSymList-&gt;at(initAxes.first)[3], bestAng );</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;    </div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;    <span class="comment">//================================================ Combine the two rotation matrices into a single rotation matrix</span></div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;    proshade_double* rotMatFin                        = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a5f2b9b9da97b52b7e5cccc08493d0e0d">ProSHADE_internal_maths::compute3x3MatrixMultiplication</a> ( rotMat2, rotMat );</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;    </div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;    <span class="comment">//================================================ For each model axis</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; octAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html#a7e437518938a28a37f54c0f6fe3636ec">getNoAxes</a> ( ); iter++ )</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;    {</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;        <span class="comment">//============================================ Rotate the model axis to fit the detected orientation</span></div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;        proshade_double* rotAxis                      = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2f9c7716f6ab682e8548ab77efcdc444">ProSHADE_internal_maths::compute3x3MatrixVectorMultiplication</a> ( rotMatFin,</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;                                                                                                                        octAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html#ab357cd5b90f9f841ae7f53254f54e6d0">getValue</a> ( iter, 1 ),</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;                                                                                                                        octAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html#ab357cd5b90f9f841ae7f53254f54e6d0">getValue</a> ( iter, 2 ),</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;                                                                                                                        octAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html#ab357cd5b90f9f841ae7f53254f54e6d0">getValue</a> ( iter, 3 ) );</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;        </div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;        <span class="comment">//============================================ Create ProSHADE symmetry axis representation</span></div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;        proshade_double* axis                         = <span class="keyword">new</span> proshade_double[7];</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( axis, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;        </div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;        axis[0]                                       = octAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html#ab357cd5b90f9f841ae7f53254f54e6d0">getValue</a> ( iter, 0 );</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;        axis[1]                                       = rotAxis[0];</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;        axis[2]                                       = rotAxis[1];</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;        axis[3]                                       = rotAxis[2];</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;        axis[4]                                       = ( 2.0 * M_PI ) / axis[0];</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;        axis[5]                                       = 0.0;</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;        axis[6]                                       = -1.0;</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;        </div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;        <span class="comment">//============================================ Save axis to ret</span></div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a>     ( ret, axis );</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;        </div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;        <span class="comment">//============================================ Release memory</span></div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;        <span class="keyword">delete</span>[] rotAxis;</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;    }</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;    </div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;    <span class="keyword">delete</span>[] rotMat;</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;    <span class="keyword">delete</span>[] rotMat2;</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;    <span class="keyword">delete</span>[] rotMatFin;</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;    <span class="keyword">delete</span>[] rotModelC3;</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;    <span class="keyword">delete</span>   octAx;</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;    </div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;    return ;</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;    </div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;}</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160; </div>
<div class="line"><a name="l03438"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aa0df823fdb0d1f187f160f884f220327"> 3438</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aa0df823fdb0d1f187f160f884f220327">ProSHADE_internal_symmetry::findIcos10C3s</a> ( std::vector&lt; proshade_double* &gt;* CSymList, std::vector&lt; proshade_double* &gt;* ret, proshade_double axErr, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, proshade_signed verbose, proshade_double minPeakHeight )</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;{</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;    std::vector&lt; proshade_unsign &gt; prospectiveC3s, retGrp;</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;    proshade_double dotProd;</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;    proshade_unsign noClose, noAway;</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;    </div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 2, <span class="stringliteral">&quot;Starting detection of ten C3 axes.&quot;</span> );</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160; </div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;    <span class="comment">//================================================ For each C3</span></div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cIt++ )</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;    {</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;        <span class="comment">//============================================ Use only C3s with hight enough average</span></div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;        <span class="keywordflow">if</span> ( CSymList-&gt;at(cIt)[0] != 3.0 || CSymList-&gt;at(cIt)[0] &lt; minPeakHeight ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160; </div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;        <span class="comment">//============================================ Check the C3 has acos ( std::sqrt ( ( 1.0 + 2.0 / std::sqrt ( 5.0 ) ) / 3.0 ) ) to 3 C5s and acos ( 1.0 - ( std::sqrt ( ( 1.0 + 2.0 / std::sqrt ( 5.0 ) ) / 3.0 ) ) ) to the other three C5s</span></div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;        noClose = 0; noAway = 0;</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign rIt = 0; rIt &lt; 6; rIt++ )</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;        {</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;            dotProd                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;ret-&gt;at(rIt)[1],</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;                                                                                                     &amp;ret-&gt;at(rIt)[2],</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;                                                                                                     &amp;ret-&gt;at(rIt)[3],</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cIt)[1],</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cIt)[2],</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cIt)[3] );</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160; </div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;            <span class="keywordflow">if</span> ( ( std::abs ( dotProd ) &gt; (       ( std::sqrt ( ( 1.0 + 2.0 / std::sqrt ( 5.0 ) ) / 3.0 ) ) - axErr ) ) &amp;&amp; ( std::abs ( dotProd ) &lt; (       ( std::sqrt ( ( 1.0 + 2.0 / std::sqrt ( 5.0 ) ) / 3.0 ) ) + axErr ) ) ) { noClose += 1; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;            <span class="keywordflow">if</span> ( ( std::abs ( dotProd ) &gt; ( 1.0 - ( std::sqrt ( ( 1.0 + 2.0 / std::sqrt ( 5.0 ) ) / 3.0 ) ) - axErr ) ) &amp;&amp; ( std::abs ( dotProd ) &lt; ( 1.0 - ( std::sqrt ( ( 1.0 + 2.0 / std::sqrt ( 5.0 ) ) / 3.0 ) ) + axErr ) ) ) { noAway  += 1; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;        }</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160; </div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;        <span class="comment">//============================================ If correct angles distribution is found, save the axis</span></div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;        <span class="keywordflow">if</span> ( ( noClose == 3 ) &amp;&amp; ( noAway == 3 ) )</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;        {</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;prospectiveC3s, cIt );</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;        }</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;    }</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160; </div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;    <span class="comment">//================================================ Search for missing axes</span></div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 6; iter++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;retGrp, iter ); }</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;    <span class="keywordflow">if</span> ( !<a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a6d9f533a789bd5c6031fa77b9649ed3d">ProSHADE_internal_symmetry::findMissingAxesDual</a> ( &amp;prospectiveC3s, CSymList, ret, &amp;retGrp, 10, axErr, 3, std::sqrt ( ( 1.0 + 2.0 / std::sqrt ( 5.0 ) ) / 3.0 ), 3, 1.0 - ( std::sqrt ( ( 1.0 + 2.0 / std::sqrt ( 5.0 ) ) / 3.0 ) ), 3, dataObj ) )</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;    {</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;        return ;</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;    }</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160; </div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;    <span class="comment">//================================================ Found correct number of axes! Now save the</span></div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( prospectiveC3s.size() ); iter++ )</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;    {</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a>     ( ret, CSymList-&gt;at(prospectiveC3s.at(iter)) );</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;    }</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160; </div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 3, <span class="stringliteral">&quot;Detection of ten C3 axes successfull.&quot;</span> );</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;    </div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;    return ;</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;    </div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;}</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160; </div>
<div class="line"><a name="l03510"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a81b6825a5467ac570ebe9a3167cda9e2"> 3510</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a81b6825a5467ac570ebe9a3167cda9e2">ProSHADE_internal_symmetry::findIcos15C2s</a> ( std::vector&lt; proshade_double* &gt;* CSymList, std::vector&lt; proshade_double* &gt;* ret, proshade_double axErr, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, proshade_signed verbose, proshade_double minPeakHeight )</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;{</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;    std::vector&lt; proshade_unsign &gt; prospectiveC2s, retGrp;</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;    proshade_double dotProd;</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;    proshade_unsign noClose, noMidway, noAway;</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;    </div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 2, <span class="stringliteral">&quot;Starting detection of fifteen C2 axes.&quot;</span> );</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160; </div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;    <span class="comment">//================================================ For each C2</span></div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cIt = 0; cIt &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cIt++ )</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;    {</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;        <span class="comment">//============================================ Use only C2s</span></div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs999 ( CSymList-&gt;at(cIt)[5] ), rhs999 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( -999.9 ) );</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;        <span class="keywordflow">if</span> ( CSymList-&gt;at(cIt)[0] != 2.0 || ( ( CSymList-&gt;at(cIt)[5] &lt; minPeakHeight ) &amp;&amp; !( lhs999.AlmostEquals( rhs999 ) ) ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160; </div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;        <span class="comment">//============================================ Check the C2 has acos ( 0.0 ) to 2 C5s, acos ( 0.5 ) to another 2 C5s and acos ( sqrt ( 3.0 ) / 2.0 ) to the last two C5s</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;        noClose = 0; noMidway = 0; noAway = 0;</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign rIt = 0; rIt &lt; 6; rIt++ )</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;        {</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;            dotProd                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;ret-&gt;at(rIt)[1],</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;                                                                                                     &amp;ret-&gt;at(rIt)[2],</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;                                                                                                     &amp;ret-&gt;at(rIt)[3],</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cIt)[1],</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cIt)[2],</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cIt)[3] );</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160; </div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;            <span class="keywordflow">if</span> ( ( std::abs ( dotProd ) &gt; ( ( sqrt ( 3.0 ) / 2.0 ) - axErr ) ) &amp;&amp; ( std::abs ( dotProd ) &lt; ( ( sqrt ( 3.0 ) / 2.0 ) + axErr ) ) ) { noAway    += 1; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;            <span class="keywordflow">if</span> ( ( std::abs ( dotProd ) &gt; ( ( 1.0 / 2.0 )          - axErr ) ) &amp;&amp; ( std::abs ( dotProd ) &lt; ( ( 1.0 / 2.0 )          + axErr ) ) ) { noMidway  += 1; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;            <span class="keywordflow">if</span> ( ( std::abs ( dotProd ) &gt; ( ( 0.0 )                - axErr ) ) &amp;&amp; ( std::abs ( dotProd ) &lt; ( ( 0.0 )                + axErr ) ) ) { noClose   += 1; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;        }</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160; </div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;        <span class="comment">//============================================ If correct angles distribution is found, save the axis</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;        <span class="keywordflow">if</span> ( ( noClose == 2 ) &amp;&amp; ( noMidway == 2 ) &amp;&amp; ( noAway == 2 ) )</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;        {</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;prospectiveC2s, cIt );</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;        }</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;    }</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160; </div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;    <span class="comment">//================================================ Search for missing axes</span></div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; 6; iter++ ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;retGrp, iter ); }</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;    <span class="keywordflow">if</span> ( !<a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ae266053664eb7cf916aa5e2d282e35dd">ProSHADE_internal_symmetry::findMissingAxesTriple</a> ( &amp;prospectiveC2s, CSymList, ret, &amp;retGrp, 15, axErr, 2, 0.0, 2, 1.0/2.0, 2, sqrt ( 3.0 ) / 2.0, 2, dataObj ) )</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;    {</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;        return ;</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;    }</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;    </div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;    <span class="comment">//================================================ Found correct number of axes! Now save the</span></div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( prospectiveC2s.size() ); iter++ )</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;    {</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a>     ( ret, CSymList-&gt;at(prospectiveC2s.at(iter)) );</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;    }</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160; </div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 3, <span class="stringliteral">&quot;Detection of fifteen C2 axes successfull.&quot;</span> );</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;    </div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    return ;</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;    </div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;}</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160; </div>
<div class="line"><a name="l03593"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ae266053664eb7cf916aa5e2d282e35dd"> 3593</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ae266053664eb7cf916aa5e2d282e35dd">ProSHADE_internal_symmetry::findMissingAxesTriple</a> ( std::vector&lt; proshade_unsign &gt;* possibilities, std::vector&lt; proshade_double* &gt;* CSymList, std::vector&lt; proshade_double* &gt;* ret, std::vector&lt; proshade_unsign &gt;* retGroup, proshade_unsign requiredNoAxes, proshade_double axErr, proshade_unsign noMatchesG1, proshade_double angle1, proshade_unsign noMatchesG2, proshade_double angle2, proshade_unsign noMatchesG3, proshade_double angle3, proshade_unsign fold, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj )</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;{</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;    <span class="keywordtype">bool</span> atLeastOne                                   = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;    std::vector&lt; proshade_double* &gt; prosp;</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;    std::vector&lt; proshade_double &gt; sol;</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;    </div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;    <span class="comment">//================================================ Proceed only if need be</span></div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;    <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( possibilities-&gt;size() ) == requiredNoAxes ) { atLeastOne = <span class="keyword">true</span>; <span class="keywordflow">return</span> ( atLeastOne ); }</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;    </div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    <span class="comment">//================================================ Copy already found to prospective</span></div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign prIt = 0; prIt &lt; static_cast&lt;proshade_unsign&gt; ( possibilities-&gt;size() ); prIt++ )</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;    {</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( CSymList-&gt;at(possibilities-&gt;at(prIt))[0] ),</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;                                                        CSymList-&gt;at(possibilities-&gt;at(prIt))[1],</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;                                                        CSymList-&gt;at(possibilities-&gt;at(prIt))[2],</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;                                                        CSymList-&gt;at(possibilities-&gt;at(prIt))[3],</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;                                                        CSymList-&gt;at(possibilities-&gt;at(prIt))[5], &amp;prosp, axErr );</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;    }</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;    </div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;    <span class="comment">//================================================ Start generating possible solutions</span></div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign rgIt1 = 0; rgIt1 &lt; static_cast&lt;proshade_unsign&gt; ( retGroup-&gt;size() ); rgIt1++ )</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;    {</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign rgIt2 = 0; rgIt2 &lt; static_cast&lt;proshade_unsign&gt; ( retGroup-&gt;size() ); rgIt2++ )</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;        {</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;            <span class="comment">//======================================== Use unique combinations (order matters here!)</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;            <span class="keywordflow">if</span> ( rgIt1 == rgIt2 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;            </div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign rgIt3 = 0; rgIt3 &lt; static_cast&lt;proshade_unsign&gt; ( retGroup-&gt;size() ); rgIt3++ )</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;            {</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;                <span class="comment">//==================================== Use unique combinations (order matters here!)</span></div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;                <span class="keywordflow">if</span> ( ( rgIt1 == rgIt3 ) || ( rgIt2 == rgIt3 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;                </div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;                <span class="comment">//==================================== Generate possible solution (1)</span></div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;                sol                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ae9f376bb341b192fff008b9b4ef5c603">ProSHADE_internal_maths::findVectorFromThreeVAndThreeD</a> ( ret-&gt;at(rgIt1)[1], ret-&gt;at(rgIt1)[2], ret-&gt;at(rgIt1)[3],</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;                                                                                                                 ret-&gt;at(rgIt2)[1], ret-&gt;at(rgIt2)[2], ret-&gt;at(rgIt2)[3],</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;                                                                                                                 ret-&gt;at(rgIt3)[1], ret-&gt;at(rgIt3)[2], ret-&gt;at(rgIt3)[3], angle1, angle2, angle3 );</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;                </div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;                <span class="comment">//==================================== Check if solution fits the group completely</span></div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a194944b48a4b6b523ef251a2a03eab17">ProSHADE_internal_symmetry::checkFittingAxisTripleAndSave</a> ( retGroup, ret, fold, sol.at(0), sol.at(1), sol.at(2), &amp;prosp, axErr, noMatchesG1, angle1, noMatchesG2, angle2, noMatchesG3, angle3, dataObj );</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;                <span class="keywordflow">if</span> ( prosp.size() == requiredNoAxes ) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;                </div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;                <span class="comment">//==================================== Generate possible solution (2)</span></div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;                sol                                   = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#ae9f376bb341b192fff008b9b4ef5c603">ProSHADE_internal_maths::findVectorFromThreeVAndThreeD</a> ( ret-&gt;at(rgIt1)[1], ret-&gt;at(rgIt1)[2], ret-&gt;at(rgIt1)[3],</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;                                                                                                                 ret-&gt;at(rgIt2)[1], ret-&gt;at(rgIt2)[2], ret-&gt;at(rgIt2)[3],</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;                                                                                                                 ret-&gt;at(rgIt3)[1], ret-&gt;at(rgIt3)[2], ret-&gt;at(rgIt3)[3], -angle1, -angle2, -angle3 );</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;                </div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;                <span class="comment">//==================================== Check if solution fits the group completely</span></div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a194944b48a4b6b523ef251a2a03eab17">ProSHADE_internal_symmetry::checkFittingAxisTripleAndSave</a> ( retGroup, ret, fold, sol.at(0), sol.at(1), sol.at(2), &amp;prosp, axErr, noMatchesG1, angle1, noMatchesG2, angle2, noMatchesG3, angle3, dataObj );</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;                <span class="keywordflow">if</span> ( prosp.size() == requiredNoAxes ) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;            }</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;            </div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;            <span class="keywordflow">if</span> ( prosp.size() == requiredNoAxes ) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;        }</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;        </div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;        <span class="keywordflow">if</span> ( prosp.size() == requiredNoAxes ) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;    }</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;    </div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;    <span class="comment">//================================================ Found all required axes</span></div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;    <span class="keywordflow">if</span> ( prosp.size() == requiredNoAxes )</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;    {</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;        <span class="comment">//============================================ For each found missing axis</span></div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign axIt = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( possibilities-&gt;size() ); axIt &lt; <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( prosp.size() ); axIt++ )</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;        {</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2380a3710f7dbe672519c3adda30f7cd">ProSHADE_internal_maths::isAxisUnique</a> ( CSymList, prosp.at(axIt), axErr ) )</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;            {</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;                <span class="comment">//======================================== Add</span></div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a> ( CSymList, prosp.at(axIt) );</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( possibilities, <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( CSymList-&gt;size()-1 ) );</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;            }</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;        }</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;        </div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;        atLeastOne                                    = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;        <span class="keywordflow">return</span>                                        ( atLeastOne );</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;    }</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;    {</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;        <span class="comment">//============================================ Delete all found, but unnecessary axes</span></div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign axIt = <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( possibilities-&gt;size() ); axIt &lt; <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( prosp.size() ); axIt++ )</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;        {</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;            <span class="keyword">delete</span>[] prosp.at(axIt);</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;        }</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;    }</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;    </div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;    <span class="keywordflow">return</span>                                            ( atLeastOne );</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;    </div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;}</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160; </div>
<div class="line"><a name="l03704"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a194944b48a4b6b523ef251a2a03eab17"> 3704</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a194944b48a4b6b523ef251a2a03eab17">ProSHADE_internal_symmetry::checkFittingAxisTripleAndSave</a> ( std::vector&lt; proshade_unsign &gt;* retGroup, std::vector&lt; proshade_double* &gt;* ret, proshade_unsign fold, proshade_double axX, proshade_double axY, proshade_double axZ, std::vector&lt; proshade_double* &gt;* prosp, proshade_double axErr, proshade_unsign noMatchesG1, proshade_double angle1, proshade_unsign noMatchesG2, proshade_double angle2, proshade_unsign noMatchesG3, proshade_double angle3, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj )</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;{</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;    proshade_unsign noG1                              = 0;</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;    proshade_unsign noG2                              = 0;</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;    proshade_unsign noG3                              = 0;</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;    proshade_double dotProd                           = 0.0;</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;    proshade_double axHeight                          = 0.0;</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;    </div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;    <span class="comment">//================================================ Find the angle and count dual matching frequencies</span></div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign rIt = 0; rIt &lt; static_cast&lt;proshade_unsign&gt; ( retGroup-&gt;size() ); rIt++ )</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;    {</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;        dotProd                                       = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;ret-&gt;at(retGroup-&gt;at(rIt))[1],</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;                                                                                                     &amp;ret-&gt;at(retGroup-&gt;at(rIt))[2],</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;                                                                                                     &amp;ret-&gt;at(retGroup-&gt;at(rIt))[3],</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;                                                                                                     &amp;axX, &amp;axY, &amp;axZ );</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;        </div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;        <span class="keywordflow">if</span> ( ( std::abs ( dotProd ) &gt; ( angle1 - axErr ) ) &amp;&amp; ( std::abs ( dotProd ) &lt; ( angle1 + axErr ) ) ) { noG1 += 1; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;        <span class="keywordflow">if</span> ( ( std::abs ( dotProd ) &gt; ( angle2 - axErr ) ) &amp;&amp; ( std::abs ( dotProd ) &lt; ( angle2 + axErr ) ) ) { noG2 += 1; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;        <span class="keywordflow">if</span> ( ( std::abs ( dotProd ) &gt; ( angle3 - axErr ) ) &amp;&amp; ( std::abs ( dotProd ) &lt; ( angle3 + axErr ) ) ) { noG3 += 1; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;    }</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;    </div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;    <span class="comment">//================================================ If correct frequencies are matched, check height.</span></div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;    <span class="keywordflow">if</span> ( ( noG1 == noMatchesG1 ) &amp;&amp; ( noG2 == noMatchesG2 ) &amp;&amp; ( noG3 == noMatchesG3 ) )</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;    {</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;        <span class="comment">//============================================ Is the height good enough?</span></div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;        axHeight                                      = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad44ed609e8a3d59674b2b2256aec41f8">ProSHADE_internal_symmetry::missingAxisHeight</a> ( axX, axY, axZ, dataObj, fold, axErr );</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;        </div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;        <span class="comment">//============================================ If so, save</span></div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;        <span class="keywordflow">if</span> ( axHeight &gt; 0.1 )</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;        {</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( fold, axX, axY, axZ, axHeight, prosp, axErr );</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;        }</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;    }</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;    </div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;    return ;</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;    </div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;}</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160; </div>
<div class="line"><a name="l03756"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa3b1a8ef870a606035102b5dcf1ce44"> 3756</a></span>&#160;std::vector&lt; proshade_double* &gt; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa3b1a8ef870a606035102b5dcf1ce44">ProSHADE_internal_data::ProSHADE_data::getCyclicSymmetriesListFromAngleAxis</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;{</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;    std::vector&lt; proshade_unsign  &gt; primes            = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2454c19169bb38d616e52b99f1dc4495">ProSHADE_internal_maths::findAllPrimes</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afcece610f52c27cadefb217f1d0c278c">maxSymmetryFold</a> );</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;    std::vector&lt; proshade_double* &gt; ret, tmpHolder;</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;    std::vector&lt; proshade_unsign  &gt; testedFolds;</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;    proshade_double symThres;</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;    proshade_unsign foldToTest;</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;    <span class="keywordtype">bool</span> foldDone, anyNewSyms = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;    </div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;    <span class="comment">//================================================ For each found prime number in the limit</span></div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign prIt = 0; prIt &lt; static_cast&lt; proshade_unsign &gt; ( primes.size() ); prIt++ )</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;    {</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;        std::stringstream hlpSS;</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;Searching for prime fold symmetry C&quot;</span> &lt;&lt; primes.at(prIt) &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, hlpSS.str() );</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;        </div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;        <span class="comment">//============================================ Get all symmetries for this prime fold</span></div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;        std::vector&lt; proshade_double* &gt; prSyms        = this-&gt;findRequestedCSymmetryFromAngleAxis ( settings, primes.at(prIt), &amp;symThres );</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;        </div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;        <span class="comment">//============================================ Save the detected C symmetries</span></div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> axIt = 0; axIt &lt; prSyms.size(); axIt++ )</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;        {</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;            <span class="comment">//======================================== Is this symmetry passing the threshold?</span></div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;            <span class="keywordflow">if</span> ( prSyms.at(axIt)[5] &gt;= symThres )</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;            {</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;                <span class="comment">//==================================== Add this symmetry to final list</span></div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;                <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2380a3710f7dbe672519c3adda30f7cd">ProSHADE_internal_maths::isAxisUnique</a> ( &amp;ret, prSyms.at(axIt), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">true</span> ) )</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;                {</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;                    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( &amp;ret, prSyms.at(axIt) );</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;                }</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;            }</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;        </div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;            <span class="comment">//======================================== Release memory</span></div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;            <span class="keyword">delete</span>[] prSyms.at(axIt);</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;        }</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;    }</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;    </div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;    <span class="comment">//================================================ Was anything found?</span></div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;    <span class="keywordflow">if</span> ( ret.size() &lt; 1 ) { <span class="keywordflow">return</span> ( ret ); }</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;    </div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;    <span class="comment">//================================================ Check for prime symmetry fold multiples</span></div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;    <span class="keywordflow">while</span> ( anyNewSyms )</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;    {</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;        <span class="comment">//============================================ Initialise new iteration</span></div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;        anyNewSyms                                    = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;        </div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;        <span class="comment">//============================================ For each passing symmetry, look if there are any combinations of symmetries that would contain it</span></div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign axIt1 = 0; axIt1 &lt; static_cast&lt; proshade_unsign &gt; ( ret.size() ); axIt1++ )</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;        {</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign axIt2 = 0; axIt2 &lt; static_cast&lt; proshade_unsign &gt; ( ret.size() ); axIt2++ )</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;            {</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;                <span class="comment">//==================================== Initialise iteration</span></div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;                foldToTest                            = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( ret.at(axIt1)[0] * ret.at(axIt2)[0] );</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;                <span class="keywordflow">if</span> ( foldToTest &gt; settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afcece610f52c27cadefb217f1d0c278c">maxSymmetryFold</a> ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;                </div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;                <span class="comment">//==================================== Was this fold tested already?</span></div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;                foldDone                              = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;                <span class="keywordflow">for</span> ( proshade_unsign fIt = 0; fIt &lt; static_cast&lt; proshade_unsign &gt; ( testedFolds.size() ); fIt++ ) { <span class="keywordflow">if</span> ( testedFolds.at(fIt) == foldToTest ) { foldDone = <span class="keyword">true</span>; <span class="keywordflow">break</span>; } }</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;                <span class="keywordflow">if</span> ( foldDone ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;                <span class="keywordflow">else</span>            { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;testedFolds, foldToTest ); }</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;                </div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;                <span class="comment">//==================================== Report progress</span></div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;                std::stringstream hlpSS2;</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;                hlpSS2 &lt;&lt; <span class="stringliteral">&quot;Searching for fold combination of detected folds &quot;</span> &lt;&lt; ret.at(axIt1)[0] &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; ret.at(axIt2)[0] &lt;&lt; <span class="stringliteral">&quot;, i.e. C&quot;</span> &lt;&lt; foldToTest &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, hlpSS2.str() );</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;                </div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;                <span class="comment">//==================================== Get all symmetries for this fold</span></div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;                std::vector&lt; proshade_double* &gt; prSyms = this-&gt;findRequestedCSymmetryFromAngleAxis ( settings, foldToTest, &amp;symThres );</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;                </div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;                <span class="comment">//==================================== For each detected group with the required fold</span></div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;                <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> newAxIt = 0; newAxIt &lt; prSyms.size(); newAxIt++ )</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;                {</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;                    <span class="keywordflow">if</span> ( prSyms.at(newAxIt)[5] &gt;= symThres )</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;                    {</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;                        <span class="comment">//================================ Add to detected axes</span></div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;                        <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2380a3710f7dbe672519c3adda30f7cd">ProSHADE_internal_maths::isAxisUnique</a> ( &amp;ret, prSyms.at(newAxIt), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, <span class="keyword">true</span> ) )</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;                        {</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;                            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( &amp;tmpHolder, prSyms.at(newAxIt) );</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;                        }</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;                    }</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160; </div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;                    <span class="comment">//==================================== Release memory</span></div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;                    <span class="keyword">delete</span>[] prSyms.at(newAxIt);</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;                }</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;            }</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;        }</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;        </div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;        <span class="comment">//============================================ Add newly found groups and repeat if need be</span></div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;        <span class="keywordflow">if</span> ( tmpHolder.size() &gt; 0 )</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;        {</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign tmpIt = 0; tmpIt &lt; static_cast&lt; proshade_unsign &gt; ( tmpHolder.size() ); tmpIt++ )</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;            {</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a> ( &amp;ret, tmpHolder.at(tmpIt) );</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;                <span class="keyword">delete</span>[] tmpHolder.at(tmpIt);</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;            }</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;            </div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;            anyNewSyms                                = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;            tmpHolder.clear                           ( );</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;        }</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;    }</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;    </div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;    <span class="comment">//================================================ Sort the vector</span></div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;    std::sort                                         ( ret.begin(), ret.end(), <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a2e915d310892aea124046acd14db4a84">ProSHADE_internal_misc::sortSymHlpInv</a> );</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;    </div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;}</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160; </div>
<div class="line"><a name="l03872"></a><span class="lineno"><a class="line" href="_pro_s_h_a_d_e__symmetry_8cpp.html#afe2404666a504704a67e634c2abe186c"> 3872</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#afe2404666a504704a67e634c2abe186c">sortProSHADESymmetryByPeak</a> ( proshade_double* a, proshade_double* b)</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;{</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;    <span class="keywordflow">return</span> ( a[5] &gt; b[5] );</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160; </div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;}</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160; </div>
<div class="line"><a name="l03895"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2714fcb2c08b224ccf09d64322bd2ab2"> 3895</a></span>&#160;std::vector &lt; proshade_double* &gt; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2714fcb2c08b224ccf09d64322bd2ab2">ProSHADE_internal_data::ProSHADE_data::findRequestedCSymmetryFromAngleAxis</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, proshade_unsign fold, proshade_double* peakThres )</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;{    </div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;    proshade_double soughtAngle;</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;    std::vector&lt; proshade_double  &gt; allPeakHeights;</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;    std::vector&lt; ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup* &gt; peakGroups;</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;    <span class="keywordtype">bool</span> newPeak;</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;    </div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;    <span class="comment">//================================================ Make sure we have a clean start</span></div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;    this-&gt;sphereMappedRotFun.clear();</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;    </div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;    <span class="comment">//================================================ Convert rotation function to only the required angle-axis space spheres and find all peaks</span></div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;    <span class="keywordflow">for</span> ( proshade_double angIt = 1.0; angIt &lt; static_cast&lt;proshade_double&gt; ( fold ); angIt += 1.0 )</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;    {</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;        <span class="comment">//============================================ Figure the angles to form the symmetry</span></div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;        soughtAngle                                   = angIt * ( 2.0 * M_PI / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( fold ) );</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;        </div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;        <span class="comment">//============================================ Create the angle-axis sphere with correct radius (angle)</span></div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;        this-&gt;sphereMappedRotFun.emplace_back         ( <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a> ( soughtAngle,</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;                                                                                                                M_PI / <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;maxShellBand ),</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;                                                                                                                this-&gt;maxShellBand * 2,</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;                                                                                                                soughtAngle,</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;                                                                                                                <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( angIt - 1.0 ) ) );</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;        </div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;        <span class="comment">//=========================================== Interpolate rotation function onto the sphere</span></div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;        this-&gt;sphereMappedRotFun.at(<span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( angIt - 1.0 ))-&gt;interpolateSphereValues ( this-&gt;getInvSO3Coeffs ( ) );</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;        </div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;        <span class="comment">//============================================ Find all peaks for this sphere</span></div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;        this-&gt;sphereMappedRotFun.at(<span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( angIt - 1.0 ))-&gt;findAllPeaks ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a26b57d39529ca69a117aceead6b12680">peakNeighbours</a> ), &amp;allPeakHeights );</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;    }</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;    </div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;    <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot;Found a total of &quot;</span> &lt;&lt; std::pow ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;maxShellBand ) * 2.0 * ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( fold ) - 1.0 ), 2.0 ) - <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( allPeakHeights.size() ) &lt;&lt; <span class="stringliteral">&quot; non-peaks for thresholding.&quot;</span>;</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, hlpSS.str() );</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;    </div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;    <span class="comment">//================================================ Determine the threshold for significant peaks</span></div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;   *peakThres                                         = std::max ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a>, <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#af62700fc94d2901ec61928d01773ea57">determinePeakThreshold</a> ( allPeakHeights, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a3e7948fd9177bd39ed3dd2320ea2b0bc">noIQRsFromMedianNaivePeak</a> ) );</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;    </div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;    <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;    std::stringstream hlpSS2;</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;    hlpSS2 &lt;&lt; <span class="stringliteral">&quot;Determined peak threshold &quot;</span> &lt;&lt; *peakThres &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 4, hlpSS2.str() );</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;    </div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;    <span class="comment">//================================================ Remove small peaks</span></div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign shIt = 0; shIt &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;sphereMappedRotFun.size() ); shIt++ )</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;    {</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;        this-&gt;sphereMappedRotFun.at(shIt)-&gt;removeSmallPeaks ( *peakThres );</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;    }</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;    </div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;    <span class="comment">//================================================ Group peaks</span></div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign sphIt = 0; sphIt &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;sphereMappedRotFun.size() ); sphIt++ )</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;    {</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;        <span class="comment">//============================================ For each peak</span></div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign pkIt = 0; pkIt &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;sphereMappedRotFun.at(sphIt)-&gt;getPeaks().size() ); pkIt++ )</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;        {</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;            <span class="comment">//======================================== Check if peak belongs to an already detected peak group</span></div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;            newPeak                                   = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign pkGrpIt = 0; pkGrpIt &lt; static_cast&lt;proshade_unsign&gt; ( peakGroups.size() ); pkGrpIt++ )</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;            {</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;                <span class="keywordflow">if</span> ( peakGroups.at(pkGrpIt)-&gt;checkIfPeakBelongs ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;sphereMappedRotFun.at(sphIt)-&gt;getPeaks().at(pkIt).first  ),</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;                                                                  <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;sphereMappedRotFun.at(sphIt)-&gt;getPeaks().at(pkIt).second ),</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;                                                                  sphIt, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a> ) ) { newPeak = <span class="keyword">false</span>; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;            }</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;            </div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;            <span class="comment">//======================================== If already added, go to next one</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;            <span class="keywordflow">if</span> ( !newPeak ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;            </div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;            <span class="comment">//======================================== If not, create a new group with this peak</span></div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;            peakGroups.emplace_back                   ( <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup</a> ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;sphereMappedRotFun.at(sphIt)-&gt;getPeaks().at(pkIt).first ),</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;                                                                                                                         <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;sphereMappedRotFun.at(sphIt)-&gt;getPeaks().at(pkIt).second ),</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;                                                                                                                         sphIt,</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;                                                                                                                         this-&gt;sphereMappedRotFun.at(sphIt)-&gt;getAngularDim() ) );</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;        }</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;    }</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;    </div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;    <span class="comment">//================================================ For each peak group, look for the requested fold</span></div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign grIt = 0; grIt &lt; static_cast&lt;proshade_unsign&gt; ( peakGroups.size() ); grIt++ )</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;    {</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;        std::stringstream hlpSS3;</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;        hlpSS3 &lt;&lt; <span class="stringliteral">&quot;Now considering group with LAT &quot;</span> &lt;&lt; peakGroups.at(grIt)-&gt;getLatFromIndices() &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; peakGroups.at(grIt)-&gt;getLatToIndices() &lt;&lt; <span class="stringliteral">&quot; and LON &quot;</span> &lt;&lt; peakGroups.at(grIt)-&gt;getLonFromIndices() &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; peakGroups.at(grIt)-&gt;getLonToIndices() &lt;&lt; <span class="stringliteral">&quot; spanning spheres &quot;</span>;</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign sphIt = 0; sphIt &lt; static_cast&lt;proshade_unsign&gt; ( peakGroups.at(grIt)-&gt;getSpherePositions().size() ); sphIt++ ) { hlpSS3 &lt;&lt; peakGroups.at(grIt)-&gt;getSpherePositions().at(sphIt) &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span>; }</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a> ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 5, hlpSS3.str() );</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;        </div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;        <span class="comment">//============================================ Find point groups in the peak group</span></div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;        peakGroups.at(grIt)-&gt;findCyclicPointGroupsGivenFold ( this-&gt;sphereMappedRotFun, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb183823a47a73d459a5bae16042bf4e">useBiCubicInterpolationOnPeaks</a>, fold, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a> );</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160; </div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;        <span class="comment">//============================================ Release the memory</span></div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;        <span class="keyword">delete</span> peakGroups.at(grIt);</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;    }</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;    </div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;    <span class="comment">//================================================ Sort ret by peak height</span></div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;    std::sort                                         ( ret.begin(), ret.end(), <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#afe2404666a504704a67e634c2abe186c">sortProSHADESymmetryByPeak</a> );</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;    </div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;    </div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;}</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160; </div>
<div class="line"><a name="l04008"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a33c650c19a6954800bba6b3a8f5842e6"> 4008</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a33c650c19a6954800bba6b3a8f5842e6">ProSHADE_internal_symmetry::findPredictedAxesHeights</a> ( std::vector&lt; proshade_double* &gt;* ret, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;{</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;    std::vector &lt; proshade_unsign &gt; folds;</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;    <span class="keywordtype">bool</span> alreadyFound;</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;    proshade_double lat, lon;</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;    proshade_double latSamlUnit                       = ( 2.0 * M_PI ) / ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> ) * 2.0 );</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;    proshade_double lonSamlUnit                       = ( 1.0 * M_PI ) / ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> ) * 2.0 );</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;    </div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;    <span class="comment">//================================================ Determine all the folds for which rotation function mapping will be required</span></div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast &lt; proshade_unsign &gt; ( ret-&gt;size() ); iter++ )</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;    {</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;        alreadyFound                                  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign it = 0; it &lt; static_cast &lt; proshade_unsign &gt; ( folds.size() ); it++ ) { <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( folds.at(it) ) ), rhs1 ( ret-&gt;at(iter)[0] ); <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) ) { alreadyFound = <span class="keyword">true</span>; <span class="keywordflow">break</span>; } }</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;        </div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;        <span class="keywordflow">if</span> ( !alreadyFound ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;folds, <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( ret-&gt;at(iter)[0] ) ); }</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;    }</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;    </div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;    <span class="comment">//================================================ For each fold which needs rotation function mapping</span></div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign foldIt = 0; foldIt &lt; static_cast &lt; proshade_unsign &gt; ( folds.size() ); foldIt++ )</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;    {</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;        <span class="comment">//============================================ Make sure we have a clean start</span></div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;        dataObj-&gt;sphereMappedRotFun.clear();</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;        </div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;        <span class="comment">//============================================ Convert rotation function to only the required angle-axis space spheres and find all peaks</span></div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;        <span class="keywordflow">for</span> ( proshade_double angIt = 1.0; angIt &lt; static_cast&lt;proshade_double&gt; ( folds.at(foldIt) ); angIt += 1.0 )</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;        {</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;            <span class="comment">//======================================== Create the angle-axis sphere with correct radius (angle)</span></div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;            dataObj-&gt;sphereMappedRotFun.emplace_back  ( <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a> ( angIt * ( 2.0 * M_PI / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( folds.at(foldIt) ) ),</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;                                                                                                                M_PI / <span class="keyword">static_cast &lt;</span> proshade_double <span class="keyword">&gt;</span> ( folds.at(foldIt) ),</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;                                                                                                                dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> * 2,</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;                                                                                                                angIt * ( 2.0 * M_PI / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( folds.at(foldIt) ) ),</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;                                                                                                                <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( angIt - 1.0 ) ) );</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;            </div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;            <span class="comment">//=========================================== Interpolate rotation function onto the sphere</span></div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;            dataObj-&gt;sphereMappedRotFun.at( <span class="keyword">static_cast &lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( angIt - 1.0 ))-&gt;interpolateSphereValues ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">getInvSO3Coeffs</a> ( ) );</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;        }</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;        </div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;        <span class="comment">//============================================ For each ret axis with this fold</span></div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign axIt = 0; axIt &lt; static_cast&lt; proshade_unsign &gt; ( ret-&gt;size() ); axIt++ )</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;        {</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;            <span class="comment">//======================================== Ignore different folds</span></div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( ret-&gt;at(axIt)[0] ), rhs1 ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( folds.at(foldIt) ) );</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;            <span class="keywordflow">if</span> ( !lhs1.AlmostEquals ( rhs1 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;            </div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;            <span class="comment">//======================================== Convert XYZ to lat and lon INDICES</span></div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;            lat                                       = std::atan2( ret-&gt;at(axIt)[2], ret-&gt;at(axIt)[1] ) / latSamlUnit;</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;            lon                                       = std::acos ( ret-&gt;at(axIt)[3] ) / lonSamlUnit;</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;            </div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;            <span class="keywordflow">if</span> ( lat &lt; 0.0 ) { lat += ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> ) * 2.0 ); }</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;            <span class="keywordflow">if</span> ( lon &lt; 0.0 ) { lon += ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> ) * 2.0 ); }</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;            </div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;            lat                                       = std::round ( lat );</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;            lon                                       = std::round ( lon );</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;            </div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;            <span class="comment">//======================================== Initialise the peak group</span></div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;            <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup</a>* grp = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;            </div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;            <span class="comment">//======================================== Construct a peak group with entry from each sphere with the axis as the peak</span></div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign sphIt = 0; sphIt &lt; static_cast&lt;proshade_unsign&gt; ( dataObj-&gt;sphereMappedRotFun.size() ); sphIt++ )</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;            {</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;                <span class="keywordflow">if</span> ( sphIt == 0 )</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;                {</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;                    <span class="comment">//================================ If first sphere, create the peak group</span></div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;                    grp                               = <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup</a> ( lat, lon, sphIt, dataObj-&gt;sphereMappedRotFun.at(sphIt)-&gt;getAngularDim() );</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;                }</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;                {</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;                    <span class="comment">//================================ Add to the existing object</span></div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;                    grp-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a711e11c6df8491a0b4ed3f31a33b550d">checkIfPeakBelongs</a>           ( lat, lon, sphIt, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a> );</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;                }</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;            }</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;            </div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;            <span class="comment">//======================================== Find the peak height</span></div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;            std::vector &lt; proshade_double* &gt; detectedAxis;</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;            grp-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a45b094d574ae0aae114d074774314556">findCyclicPointGroupsGivenFold</a>       ( dataObj-&gt;sphereMappedRotFun, &amp;detectedAxis, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb183823a47a73d459a5bae16042bf4e">useBiCubicInterpolationOnPeaks</a>, folds.at(foldIt), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a> );</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;            </div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;            <span class="comment">//======================================== Save it!</span></div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;            <span class="keywordflow">if</span> ( detectedAxis.size() &gt; 0 )            { ret-&gt;at(axIt)[5] = detectedAxis.at(0)[5]; }</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;            <span class="keywordflow">else</span>                                      { ret-&gt;at(axIt)[5] = 0.0; }</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;            </div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;            <span class="comment">//======================================== Release memory</span></div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign i = 0; i &lt; static_cast &lt; proshade_unsign &gt; ( detectedAxis.size() ); i++ ) { <span class="keyword">delete</span> detectedAxis.at(i); }</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;            <span class="keyword">delete</span> grp;</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;        }</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;    }</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;    </div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;    <span class="comment">//================================================ Sort axes by fold</span></div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;    std::sort                                         ( ret-&gt;begin(), ret-&gt;end(), <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#ad14d6427df4269728627fcd880abaf31">ProSHADE_internal_misc::sortSymInvFoldHlp</a> );</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;    </div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;    return ;</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;    </div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;}</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160; </div>
<div class="line"><a name="l04115"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a58c00659b5f6abf315fb5a426c45810c"> 4115</a></span>&#160;proshade_double <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a58c00659b5f6abf315fb5a426c45810c">ProSHADE_internal_symmetry::findPredictedSingleAxisHeight</a> ( proshade_double* axis, proshade_double fold, <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a>* dataObj, <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings )</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;{</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;    proshade_double height                            = 0.0;</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;    proshade_double lat, lon;</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;    proshade_double latSamlUnit                       = ( 2.0 * M_PI ) / ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> ) * 2.0 );</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;    proshade_double lonSamlUnit                       = ( 1.0 * M_PI ) / ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> ) * 2.0 );</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;    </div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;    <span class="comment">//================================================ Make sure we have a clean start</span></div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;    dataObj-&gt;sphereMappedRotFun.clear                 ( );</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;    </div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;    <span class="comment">//================================================ Convert rotation function to only the required angle-axis space spheres and find all peaks</span></div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;    <span class="keywordflow">for</span> ( proshade_double angIt = 1.0; angIt &lt; fold; angIt += 1.0 )</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;    {</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;        <span class="comment">//============================================ Create the angle-axis sphere with correct radius (angle)</span></div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;        dataObj-&gt;sphereMappedRotFun.emplace_back      ( <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a> ( angIt * ( 2.0 * M_PI / fold ),</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;                                                                                                                M_PI / fold,</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;                                                                                                                dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> * 2,</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;                                                                                                                angIt * ( 2.0 * M_PI / fold ),</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;                                                                                                                <span class="keyword">static_cast&lt;</span>proshade_unsign<span class="keyword">&gt;</span> ( angIt - 1.0 ) ) );</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;        </div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;        <span class="comment">//============================================ Interpolate rotation function onto the sphere</span></div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;        dataObj-&gt;sphereMappedRotFun.at( <span class="keyword">static_cast &lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( angIt - 1.0 ))-&gt;interpolateSphereValues ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">getInvSO3Coeffs</a> ( ) );</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;    }</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;    </div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;    <span class="comment">//================================================ Convert XYZ to lat and lon INDICES</span></div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;    lat                                               = std::atan2( axis[1], axis[0] ) / latSamlUnit;</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;    lon                                               = std::acos ( axis[2] ) / lonSamlUnit;</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;    </div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;    <span class="keywordflow">if</span> ( lat &lt; 0.0 ) { lat += ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> ) * 2.0 ); }</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;    <span class="keywordflow">if</span> ( lon &lt; 0.0 ) { lon += ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( dataObj-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">maxShellBand</a> ) * 2.0 ); }</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;    </div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;    lat                                               = std::round ( lat );</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;    lon                                               = std::round ( lon );</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;    </div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;    <span class="comment">//================================================ Initialise the peak group</span></div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;    <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup</a>* grp = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;    </div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;    <span class="comment">//================================================ Construct a peak group with entry from each sphere with the axis as the peak</span></div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign sphIt = 0; sphIt &lt; static_cast&lt;proshade_unsign&gt; ( dataObj-&gt;sphereMappedRotFun.size() ); sphIt++ )</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;    {</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;        <span class="keywordflow">if</span> ( sphIt == 0 )</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;        {</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;            <span class="comment">//======================================== If first sphere, create the peak group</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;            grp                                       = <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup</a> ( lat, lon, sphIt, dataObj-&gt;sphereMappedRotFun.at(sphIt)-&gt;getAngularDim() );</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;        }</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;        {</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;            <span class="comment">//======================================== Add to the existing object</span></div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;            grp-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a711e11c6df8491a0b4ed3f31a33b550d">checkIfPeakBelongs</a>                   ( lat, lon, sphIt, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a> );</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;        }</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;    }</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;    </div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;    <span class="comment">//================================================ Find the peak height</span></div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;    std::vector &lt; proshade_double* &gt; detectedAxis;</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;    grp-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a45b094d574ae0aae114d074774314556">findCyclicPointGroupsGivenFold</a>               ( dataObj-&gt;sphereMappedRotFun, &amp;detectedAxis, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#afb183823a47a73d459a5bae16042bf4e">useBiCubicInterpolationOnPeaks</a>, <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( fold ), settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a> );</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;    </div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;    <span class="comment">//================================================ Save it!</span></div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;    <span class="keywordflow">if</span> ( detectedAxis.size() &gt; 0 )                    { height = detectedAxis.at(0)[5]; }</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;    <span class="keywordflow">else</span>                                              { height = 0.0; }</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;    </div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign i = 0; i &lt; static_cast &lt; proshade_unsign &gt; ( detectedAxis.size() ); i++ ) { <span class="keyword">delete</span> detectedAxis.at(i); }</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;    <span class="keyword">delete</span> grp;</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;    </div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;    <span class="keywordflow">return</span>                                            ( height );</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;    </div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;}</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160; </div>
<div class="line"><a name="l04192"></a><span class="lineno"><a class="line" href="_pro_s_h_a_d_e__symmetry_8cpp.html#a02e0d7dfd2961c534fa1d5ab4c3002e3"> 4192</a></span>&#160;std::pair&lt; proshade_unsign, proshade_unsign &gt; <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#a02e0d7dfd2961c534fa1d5ab4c3002e3">findBestTetraDihedralPair</a> ( std::vector&lt; proshade_double* &gt;* CSymList, proshade_double minPeakHeight, proshade_double axErr )</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;{</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;    std::pair&lt; proshade_unsign, proshade_unsign &gt; ret;</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;    std::vector&lt; proshade_unsign  &gt; C3List;</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;    proshade_double bestHeightSum                     = 0.0;</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;    proshade_double dotProduct;</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;    </div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;    <span class="comment">//================================================ Find all C3 symmetries</span></div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cSym = 0; cSym &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cSym++ ) { <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(cSym)[0] ), rhs1 ( 3.0 ); <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) &amp;&amp; CSymList-&gt;at(cSym)[5] &gt;= minPeakHeight ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C3List, cSym ); } }</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;    </div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;    <span class="comment">//================================================ For each unique pair of C3 and C2</span></div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign c3 = 0; c3 &lt; static_cast&lt;proshade_unsign&gt; ( C3List.size() ); c3++ )</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;    {</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign cSym = 0; cSym &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cSym++ )</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;        {</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;            <span class="comment">//======================================== Compare only C2s to the C3List and only with decent average peak height</span></div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;            <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( CSymList-&gt;at(cSym)[0] ), rhs1 ( 2.0 );</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;            <span class="keywordflow">if</span> ( !lhs1.AlmostEquals ( rhs1 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;            <span class="keywordflow">if</span> ( CSymList-&gt;at(cSym)[5] &lt; minPeakHeight ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;            </div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;            <span class="comment">//========================================  Check the angle between the C5 and C3 axes</span></div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;            dotProduct                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;CSymList-&gt;at(C3List.at(c3))[1],</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;                                                                                                     &amp;CSymList-&gt;at(C3List.at(c3))[2],</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;                                                                                                     &amp;CSymList-&gt;at(C3List.at(c3))[3],</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[1],</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[2],</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[3] );</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;            </div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;            <span class="comment">//======================================== Is the angle approximately the dihedral angle?</span></div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;            <span class="keywordflow">if</span> ( ( ( 1.0 / sqrt ( 3.0 ) ) &gt; ( std::abs( dotProduct ) - axErr ) ) &amp;&amp; ( ( 1.0 / sqrt ( 3.0 ) ) &lt; ( std::abs( dotProduct ) + axErr ) ) )</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;            {</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;                <span class="keywordflow">if</span> ( bestHeightSum &lt; ( CSymList-&gt;at(C3List.at(c3))[5] + CSymList-&gt;at(cSym)[5] ) )</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;                {</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;                    bestHeightSum                     = CSymList-&gt;at(C3List.at(c3))[5] + CSymList-&gt;at(cSym)[5];</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;                    ret.first                         = C3List.at(c3);</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;                    ret.second                        = cSym;</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;                }</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;            }</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;        }</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;    }</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;    </div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;    </div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;}</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160; </div>
<div class="line"><a name="l04253"></a><span class="lineno"><a class="line" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a931aa4c10c426c3b8041bd4e838b0678"> 4253</a></span>&#160;std::vector&lt; proshade_double* &gt; <a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a931aa4c10c426c3b8041bd4e838b0678">ProSHADE_internal_data::ProSHADE_data::getPredictedTetrahedralSymmetriesList</a> ( <a class="code" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a>* settings, std::vector&lt; proshade_double* &gt;* CSymList )</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;{</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;    std::vector&lt; proshade_double* &gt; ret;</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;    </div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting T symmetry prediction.&quot;</span> );</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;    </div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;    <span class="comment">//================================================ Are the basic requirements for icosahedral symmetry met?</span></div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a37925ac477480c718451debb01a9c74a">ProSHADE_internal_symmetry::detectTetrahedralSymmetry</a> ( CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> ) )</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;    {</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;        <span class="comment">//============================================ Generate the rest of the axes</span></div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aef7a2435e9d3616d860aeee2d94dba55">ProSHADE_internal_symmetry::predictTetraAxes</a>  ( CSymList, &amp;ret, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a>, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">minSymPeak</a> );</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160; </div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;        <span class="comment">//============================================ Get heights for the predicted axes</span></div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a33c650c19a6954800bba6b3a8f5842e6">ProSHADE_internal_symmetry::findPredictedAxesHeights</a> ( &amp;ret, <span class="keyword">this</span>, settings );</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160; </div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;        <span class="comment">//============================================ Add predicted axes to detected C axes list and also to the settings Icosahedral symmetry list</span></div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign retIt = 0; retIt &lt; static_cast &lt; proshade_unsign &gt; ( ret.size() ); retIt++ )</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;        {</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;            proshade_signed matchedPos                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> ( <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( ret.at(retIt)[0] ), ret.at(retIt)[1], ret.at(retIt)[2], ret.at(retIt)[3], ret.at(retIt)[5], CSymList, settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">axisErrTolerance</a> );</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">allDetectedTAxes</a>, <span class="keyword">static_cast &lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( matchedPos ) );</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;        }</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;    }</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;    </div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;T symmetry prediction complete.&quot;</span> );</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160; </div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;    </div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;}</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160; </div>
<div class="line"><a name="l04306"></a><span class="lineno"><a class="line" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aef7a2435e9d3616d860aeee2d94dba55"> 4306</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aef7a2435e9d3616d860aeee2d94dba55">ProSHADE_internal_symmetry::predictTetraAxes</a> ( std::vector&lt; proshade_double* &gt;* CSymList, std::vector&lt; proshade_double* &gt;* ret, proshade_double axErr, proshade_double minPeakHeight )</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;{</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;    <span class="comment">//================================================ Create the tetrahedronAxes object</span></div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;    <a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html">ProSHADE_internal_precomputedVals::tetrahedronAxes</a> *tetAx = <span class="keyword">new</span> <a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html">ProSHADE_internal_precomputedVals::tetrahedronAxes</a> ( );</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;    </div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;    <span class="comment">//================================================ Find the best axis combination with dihedral angle and correct folds</span></div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;    std::pair&lt; proshade_unsign, proshade_unsign &gt; initAxes = <a class="code" href="_pro_s_h_a_d_e__symmetry_8cpp.html#a02e0d7dfd2961c534fa1d5ab4c3002e3">findBestTetraDihedralPair</a> ( CSymList, minPeakHeight, axErr );</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160; </div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;    <span class="comment">//================================================ Find rotation between the detected C3 and the model C3 axes.</span></div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;    proshade_double* rotMat                           = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2b17617f8b3c42c5199948828cd1a57b">ProSHADE_internal_maths::findRotMatMatchingVectors</a> ( tetAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html#a67427f9d7294471f06126ff7768d8b74">getValue</a> ( 0, 1 ),</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;                                                                                                             tetAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html#a67427f9d7294471f06126ff7768d8b74">getValue</a> ( 0, 2 ),</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;                                                                                                             tetAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html#a67427f9d7294471f06126ff7768d8b74">getValue</a> ( 0, 3 ),</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;                                                                                                             CSymList-&gt;at(initAxes.first)[1],</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;                                                                                                             CSymList-&gt;at(initAxes.first)[2],</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;                                                                                                             CSymList-&gt;at(initAxes.first)[3] );</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160; </div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;    <span class="comment">//================================================ Rotate the model C2 to the correct orientation relative to the detected C3 axis.</span></div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;    proshade_double* rotModelC2                       = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2f9c7716f6ab682e8548ab77efcdc444">ProSHADE_internal_maths::compute3x3MatrixVectorMultiplication</a> ( rotMat,</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;                                                                                                                        tetAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html#a67427f9d7294471f06126ff7768d8b74">getValue</a> ( 4, 1 ),</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;                                                                                                                        tetAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html#a67427f9d7294471f06126ff7768d8b74">getValue</a> ( 4, 2 ),</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;                                                                                                                        tetAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html#a67427f9d7294471f06126ff7768d8b74">getValue</a> ( 4, 3 ) );</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160; </div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;    <span class="comment">//================================================ Find the angle betwen the rotated model C2 and the detected C2 axes along the detected C3 axis.</span></div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;    proshade_double bestAng = 0.0, curAngDist, bestAngDist = 999.9;</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;    proshade_double* rotMatHlp                        = <span class="keyword">new</span> proshade_double[9];</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rotMatHlp, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;    <span class="keywordflow">for</span> ( proshade_double ang = 0.0; ang &lt; ( M_PI * 2.0 ); ang += 0.002 )</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;    {</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;        <span class="comment">//============================================ Compute rotation matrix for this angle value</span></div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a39eafef902a49cc0816a2ed675c14a49">ProSHADE_internal_maths::getRotationMatrixFromAngleAxis</a> ( rotMatHlp, CSymList-&gt;at(initAxes.first)[1], CSymList-&gt;at(initAxes.first)[2], CSymList-&gt;at(initAxes.first)[3], ang );</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;        </div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;        <span class="comment">//============================================ Rotate the rotated C2 by the matrix</span></div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;        proshade_double* rotRotModelC2                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2f9c7716f6ab682e8548ab77efcdc444">ProSHADE_internal_maths::compute3x3MatrixVectorMultiplication</a> ( rotMatHlp,</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;                                                                                                                        rotModelC2[0],</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;                                                                                                                        rotModelC2[1],</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;                                                                                                                        rotModelC2[2] );</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;        </div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;        <span class="comment">//============================================ Find distance</span></div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;        curAngDist                                    = std::sqrt ( std::pow ( rotRotModelC2[0] - CSymList-&gt;at(initAxes.second)[1], 2.0 ) +</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;                                                                    std::pow ( rotRotModelC2[1] - CSymList-&gt;at(initAxes.second)[2], 2.0 ) +</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;                                                                    std::pow ( rotRotModelC2[2] - CSymList-&gt;at(initAxes.second)[3], 2.0 ) );</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;        </div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;        <span class="comment">//============================================ Save best angle</span></div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;        <span class="keywordflow">if</span> ( curAngDist &lt; bestAngDist ) { bestAngDist = curAngDist; bestAng = ang; }</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;        </div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;        <span class="comment">//============================================ Release memory</span></div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;        <span class="keyword">delete</span>[] rotRotModelC2;</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;    }</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;    </div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;    <span class="keyword">delete</span>[] rotMatHlp;</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;    </div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;    <span class="comment">//================================================ For the rotation matrix along the detected C5 axis with the same anlge as is between the rotated model C3 and the detected C3 axes.</span></div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;    proshade_double* rotMat2                          = <span class="keyword">new</span> proshade_double[9];</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rotMat2, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a39eafef902a49cc0816a2ed675c14a49">ProSHADE_internal_maths::getRotationMatrixFromAngleAxis</a> ( rotMat2, CSymList-&gt;at(initAxes.first)[1], CSymList-&gt;at(initAxes.first)[2], CSymList-&gt;at(initAxes.first)[3], bestAng );</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;    </div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;    <span class="comment">//================================================ Combine the two rotation matrices into a single rotation matrix</span></div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;    proshade_double* rotMatFin                        = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a5f2b9b9da97b52b7e5cccc08493d0e0d">ProSHADE_internal_maths::compute3x3MatrixMultiplication</a> ( rotMat2, rotMat );</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;    </div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;    <span class="comment">//================================================ For each model axis</span></div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; tetAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html#ac293476061c52c6f5c4b3125672e8eae">getNoAxes</a>( ); iter++ )</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;    {</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;        <span class="comment">//============================================ Rotate the model axis to fit the detected orientation</span></div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;        proshade_double* rotAxis                      = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2f9c7716f6ab682e8548ab77efcdc444">ProSHADE_internal_maths::compute3x3MatrixVectorMultiplication</a> ( rotMatFin,</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;                                                                                                                        tetAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html#a67427f9d7294471f06126ff7768d8b74">getValue</a> ( iter, 1 ),</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;                                                                                                                        tetAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html#a67427f9d7294471f06126ff7768d8b74">getValue</a> ( iter, 2 ),</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;                                                                                                                        tetAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html#a67427f9d7294471f06126ff7768d8b74">getValue</a> ( iter, 3 ) );</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160; </div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;        <span class="comment">//============================================ Create ProSHADE symmetry axis representation</span></div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;        proshade_double* axis                         = <span class="keyword">new</span> proshade_double[7];</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( axis, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160; </div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;        axis[0]                                       = tetAx-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html#a67427f9d7294471f06126ff7768d8b74">getValue</a> ( iter, 0 );</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;        axis[1]                                       = rotAxis[0];</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;        axis[2]                                       = rotAxis[1];</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;        axis[3]                                       = rotAxis[2];</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;        axis[4]                                       = ( 2.0 * M_PI ) / axis[0];</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;        axis[5]                                       = 0.0;</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;        axis[6]                                       = -1.0;</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160; </div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;        <span class="comment">//============================================ Save axis to ret</span></div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a>     ( ret, axis );</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160; </div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;        <span class="comment">//============================================ Release memory</span></div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;        <span class="keyword">delete</span>[] rotAxis;</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;    }</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160; </div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;    <span class="keyword">delete</span>[] rotMat;</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;    <span class="keyword">delete</span>[] rotMat2;</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;    <span class="keyword">delete</span>[] rotMatFin;</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;    <span class="keyword">delete</span>[] rotModelC2;</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;    <span class="keyword">delete</span>   tetAx;</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160; </div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;    return ;</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;    </div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a3e7948fd9177bd39ed3dd2320ea2b0bc"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a3e7948fd9177bd39ed3dd2320ea2b0bc">ProSHADE_settings::noIQRsFromMedianNaivePeak</a></div><div class="ttdeci">proshade_double noIQRsFromMedianNaivePeak</div><div class="ttdoc">When doing peak searching, how many IQRs from the median the threshold for peak height should be (in ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00118">ProSHADE_settings.hpp:118</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_ac96ff1a23997199af76e58885a1ee1e2"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#ac96ff1a23997199af76e58885a1ee1e2">ProSHADE_internal_distances::normaliseEMatrices</a></div><div class="ttdeci">void normaliseEMatrices(ProSHADE_internal_data::ProSHADE_data *obj1, ProSHADE_internal_data::ProSHADE_data *obj2, ProSHADE_settings *settings)</div><div class="ttdoc">This function normalises the E matrices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00572">ProSHADE_distances.cpp:572</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__symmetry_8cpp_html_afe2404666a504704a67e634c2abe186c"><div class="ttname"><a href="_pro_s_h_a_d_e__symmetry_8cpp.html#afe2404666a504704a67e634c2abe186c">sortProSHADESymmetryByPeak</a></div><div class="ttdeci">bool sortProSHADESymmetryByPeak(proshade_double *a, proshade_double *b)</div><div class="ttdoc">This function allows using std::sort to sort vectors of ProSHADE symmetry format..</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03872">ProSHADE_symmetry.cpp:3872</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a18d456057604616a7cf6b68f59b4f2d0"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a18d456057604616a7cf6b68f59b4f2d0">ProSHADE_internal_symmetry::detectOctahedralSymmetry</a></div><div class="ttdeci">bool detectOctahedralSymmetry(std::vector&lt; proshade_double * &gt; *CSymList, proshade_double axErr, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and decides whether basic requirements for octahhedral s...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02268">ProSHADE_symmetry.cpp:2268</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_ae9f376bb341b192fff008b9b4ef5c603"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#ae9f376bb341b192fff008b9b4ef5c603">ProSHADE_internal_maths::findVectorFromThreeVAndThreeD</a></div><div class="ttdeci">std::vector&lt; proshade_double &gt; findVectorFromThreeVAndThreeD(proshade_double x1, proshade_double y1, proshade_double z1, proshade_double x2, proshade_double y2, proshade_double z2, proshade_double x3, proshade_double y3, proshade_double z3, proshade_double dot1, proshade_double dot2, proshade_double dot3)</div><div class="ttdoc">Function for finding a vector which would have a given three dot products to three other vectors.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l02197">ProSHADE_maths.cpp:2197</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_af4f982fc282e8fca11b6a85f2d2069a5"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af4f982fc282e8fca11b6a85f2d2069a5">ProSHADE_internal_symmetry::findExpectedPeakRotations</a></div><div class="ttdeci">void findExpectedPeakRotations(proshade_unsign fold, std::vector&lt; proshade_double &gt; *expAngs)</div><div class="ttdoc">This function computes the expected peak rotations for given fold.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00719">ProSHADE_symmetry.cpp:719</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html">ProSHADE_internal_precomputedVals::octahedronAxes</a></div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__precomputed_values_8hpp_source.html#l00054">ProSHADE_precomputedValues.hpp:55</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_ad14d6427df4269728627fcd880abaf31"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#ad14d6427df4269728627fcd880abaf31">ProSHADE_internal_misc::sortSymInvFoldHlp</a></div><div class="ttdeci">bool sortSymInvFoldHlp(const proshade_double *a, const proshade_double *b)</div><div class="ttdoc">This function compares two arrays of two based on the first number, sorting highest first.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00296">ProSHADE_misc.cpp:296</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_af6093da290ce7b73a33e8b55f2c83491"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af6093da290ce7b73a33e8b55f2c83491">ProSHADE_internal_symmetry::findMissingAxes</a></div><div class="ttdeci">bool findMissingAxes(std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; *possibilities, std::vector&lt; proshade_double * &gt; *CSymList, proshade_unsign requiredNoAxes, proshade_double axErr, proshade_double angle, proshade_unsign fold, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_double minPeakHeight)</div><div class="ttdoc">This function tries to find an axis which would complete a particular group of axes for polyhedral sy...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01672">ProSHADE_symmetry.cpp:1672</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a81b6825a5467ac570ebe9a3167cda9e2"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a81b6825a5467ac570ebe9a3167cda9e2">ProSHADE_internal_symmetry::findIcos15C2s</a></div><div class="ttdeci">void findIcos15C2s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the fifteen C3 symmetries with correct angles ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03510">ProSHADE_symmetry.cpp:3510</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_aa3103c7b5e2dc2cbf1778705c7693334"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a></div><div class="ttdeci">void addToDblPtrVector(std::vector&lt; proshade_double * &gt; *vecToAddTo, proshade_double *elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00143">ProSHADE_misc.cpp:143</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_afcece610f52c27cadefb217f1d0c278c"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#afcece610f52c27cadefb217f1d0c278c">ProSHADE_settings::maxSymmetryFold</a></div><div class="ttdeci">proshade_unsign maxSymmetryFold</div><div class="ttdoc">The highest symmetry fold to search for.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00133">ProSHADE_settings.hpp:133</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a98538547e5bcc6192bbbea1d7b51c537"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a98538547e5bcc6192bbbea1d7b51c537">ProSHADE_internal_symmetry::groupSameAxes</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; groupSameAxes(std::vector&lt; proshade_double * &gt; &amp;peaks, proshade_double errTolerance)</div><div class="ttdoc">This function groups the peaks by their axes of rotation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00426">ProSHADE_symmetry.cpp:426</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac7cb89ed871668c57a3b5dc953c20482"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac7cb89ed871668c57a3b5dc953c20482">ProSHADE_internal_data::ProSHADE_data::computeRotationFunction</a></div><div class="ttdeci">void computeRotationFunction(ProSHADE_settings *settings)</div><div class="ttdoc">This function computes the self-rotation function for this structure.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00041">ProSHADE_symmetry.cpp:41</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a68d576f90449b7d3fcf5ae4d3114c268"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a68d576f90449b7d3fcf5ae4d3114c268">ProSHADE_internal_symmetry::sortArrVecHlp</a></div><div class="ttdeci">bool sortArrVecHlp(const proshade_double *a, const proshade_double *b)</div><div class="ttdoc">This function compares two arrays of two based on the first number.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01732">ProSHADE_symmetry.cpp:1732</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a5360c152697780177eb2676888cd5108"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5360c152697780177eb2676888cd5108">ProSHADE_internal_symmetry::testGroupAgainstGroup</a></div><div class="ttdeci">bool testGroupAgainstGroup(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_unsign &gt; *grp1, std::vector&lt; proshade_double * &gt; *RetList, std::vector&lt; proshade_unsign &gt; *grp2, proshade_double angle, proshade_double axErr)</div><div class="ttdoc">This function compares two groups of axes for a single pair having the required angle.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02156">ProSHADE_symmetry.cpp:2156</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a38ce8efbbe05220793b5f01f0fef07a6"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a38ce8efbbe05220793b5f01f0fef07a6">ProSHADE_internal_symmetry::predictOctaAxes</a></div><div class="ttdeci">void predictOctaAxes(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, proshade_double minPeakHeight)</div><div class="ttdoc">This function predicts all octahedral point group symmetry axes from the cyclic point groups list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03325">ProSHADE_symmetry.cpp:3325</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a2b3fcf4dd97e677da27192cf63dbb678"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a2b3fcf4dd97e677da27192cf63dbb678">ProSHADE_internal_symmetry::smallestDistanceBetweenAngles</a></div><div class="ttdeci">bool smallestDistanceBetweenAngles(std::vector&lt; proshade_unsign &gt; grp, std::vector&lt; proshade_double * &gt; peaks, std::vector&lt; proshade_double &gt; *tried, proshade_double *dist)</div><div class="ttdoc">This function finds the smallest distance between the rotation angles within a group.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00562">ProSHADE_symmetry.cpp:562</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_aef7a2435e9d3616d860aeee2d94dba55"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aef7a2435e9d3616d860aeee2d94dba55">ProSHADE_internal_symmetry::predictTetraAxes</a></div><div class="ttdeci">void predictTetraAxes(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, proshade_double minPeakHeight)</div><div class="ttdoc">This function predicts all tetrahedral point group symmetry axes from the cyclic point groups list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l04306">ProSHADE_symmetry.cpp:4306</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a262d9e21cd6b81b8bda35ec22eb363dd"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a></div><div class="ttdeci">proshade_signed addAxisUnlessSame(proshade_unsign fold, proshade_double axX, proshade_double axY, proshade_double axZ, proshade_double axHeight, proshade_double averageFSC, std::vector&lt; proshade_double * &gt; *prosp, proshade_double axErr)</div><div class="ttdoc">This function simply creates a new axis from information in aruments and tests if no such axis alread...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02648">ProSHADE_symmetry.cpp:2648</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a></div><div class="ttdoc">This class contains all inputed data for the rotation function angle-axis converted spheres.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8hpp_source.html#l00053">ProSHADE_maths.hpp:54</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes_html_aeec201a53ee1f3aeaf69cc956b43bb30"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html#aeec201a53ee1f3aeaf69cc956b43bb30">ProSHADE_internal_precomputedVals::icosahedronAxes::getValue</a></div><div class="ttdeci">proshade_double getValue(proshade_unsign axis, proshade_unsign element)</div><div class="ttdoc">Accessor for the icosahedronAxesVals variable.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__precomputed_values_8cpp_source.html#l00223">ProSHADE_precomputedValues.cpp:223</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a870711ceabba16c8fc79bd93d26b11a8"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a870711ceabba16c8fc79bd93d26b11a8">ProSHADE_internal_symmetry::saveAllCSymmetries</a></div><div class="ttdeci">void saveAllCSymmetries(std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; detected, std::vector&lt; proshade_double * &gt; peaks, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr)</div><div class="ttdoc">This function takes the detected symmetries indices and peaks and saves these in the main cyclic symm...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01133">ProSHADE_symmetry.cpp:1133</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a01087ea3e0db56758d1771618e2e4a45"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a01087ea3e0db56758d1771618e2e4a45">ProSHADE_internal_maths::normalDistributionValue</a></div><div class="ttdeci">proshade_double normalDistributionValue(proshade_double mean, proshade_double standardDev, proshade_double value)</div><div class="ttdoc">Function to the heiht of normal distribution given by mean and standard deviation for a given value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01756">ProSHADE_maths.cpp:1756</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a33c650c19a6954800bba6b3a8f5842e6"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a33c650c19a6954800bba6b3a8f5842e6">ProSHADE_internal_symmetry::findPredictedAxesHeights</a></div><div class="ttdeci">void findPredictedAxesHeights(std::vector&lt; proshade_double * &gt; *ret, ProSHADE_internal_data::ProSHADE_data *dataObj, ProSHADE_settings *settings)</div><div class="ttdoc">This function finds the rotation function value for all axes supplied in the ret parameter.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l04008">ProSHADE_symmetry.cpp:4008</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a618c04a2c1d7f0a506d0bb3d7a0da444"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a618c04a2c1d7f0a506d0bb3d7a0da444">ProSHADE_settings::allDetectedDAxes</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; allDetectedDAxes</div><div class="ttdoc">The vector of all detected dihedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00148">ProSHADE_settings.hpp:148</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a86e2bb172f766ab4a620df482d2fe481"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a86e2bb172f766ab4a620df482d2fe481">ProSHADE_internal_misc::addToUnsignVectorVector</a></div><div class="ttdeci">void addToUnsignVectorVector(std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; *vecToAddTo, std::vector&lt; proshade_unsign &gt; elementToAdd)</div><div class="ttdoc">Adds the element to the vector of vectors.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00211">ProSHADE_misc.cpp:211</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__peak_search_html_a9874fdfe82bd0d75958f9b250750fd56"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__peak_search.html#a9874fdfe82bd0d75958f9b250750fd56">ProSHADE_internal_peakSearch::getAllPeaksNaive</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; getAllPeaksNaive(proshade_complex *map, proshade_unsign dim, proshade_signed peakSize, proshade_double noIQRs)</div><div class="ttdoc">This function finds peaks in the 3D map using the &quot;naive&quot; approach.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__peak_search_8cpp_source.html#l00316">ProSHADE_peakSearch.cpp:316</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a></div><div class="ttdoc">This class contains all inputed and derived data for a single structure.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00048">ProSHADE_data.hpp:49</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a0a35a745745fa3db227455241bb083ae"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a0a35a745745fa3db227455241bb083ae">ProSHADE_internal_symmetry::findOcta4C3s</a></div><div class="ttdeci">void findOcta4C3s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the four C3 symmetries with correct angles req...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02390">ProSHADE_symmetry.cpp:2390</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_aac0456f55cb3bf83707cc3b493e32fb3"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aac0456f55cb3bf83707cc3b493e32fb3">ProSHADE_internal_symmetry::printSymmetryCompletion</a></div><div class="ttdeci">void printSymmetryCompletion(proshade_unsign noSyms, proshade_signed verbose)</div><div class="ttdoc">This function simply prints the summary and warnings for cyclic symmetries detection completion.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01103">ProSHADE_symmetry.cpp:1103</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a2137fa16a69fc7a8365439e322b67dc8"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a2137fa16a69fc7a8365439e322b67dc8">ProSHADE_internal_symmetry::findPeaksByHeightBoundaries</a></div><div class="ttdeci">std::vector&lt; proshade_double &gt; findPeaksByHeightBoundaries(std::vector&lt; proshade_double * &gt; allPeaks, proshade_double smoothing)</div><div class="ttdoc">This function groups the peaks by height and returns the boundaries between such groups.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00317">ProSHADE_symmetry.cpp:317</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_ad44ed609e8a3d59674b2b2256aec41f8"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad44ed609e8a3d59674b2b2256aec41f8">ProSHADE_internal_symmetry::missingAxisHeight</a></div><div class="ttdeci">proshade_double missingAxisHeight(proshade_double xVal, proshade_double yVal, proshade_double zVal, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_unsign fold, proshade_double axErr)</div><div class="ttdoc">This function searches for the highest peaks average that would produce the required axis and fold.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01753">ProSHADE_symmetry.cpp:1753</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a1ada2416687dbb0bec93603770cb4c83"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a1ada2416687dbb0bec93603770cb4c83">ProSHADE_internal_symmetry::searchMissingSymmetrySpace</a></div><div class="ttdeci">void searchMissingSymmetrySpace(ProSHADE_internal_data::ProSHADE_data *dataObj, std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_unsign &gt; *grp, std::vector&lt; proshade_double * &gt; *hlpVec, proshade_double axErr, proshade_double angle, proshade_unsign fold, proshade_double minPeakHeight)</div><div class="ttdoc">This function tests feasible axes against the missing axis criteria, returning a set of matching axes...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01964">ProSHADE_symmetry.cpp:1964</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ac914dc8b6ee2e35286beabb1b6611b74"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ac914dc8b6ee2e35286beabb1b6611b74">ProSHADE_settings::minSymPeak</a></div><div class="ttdeci">proshade_double minSymPeak</div><div class="ttdoc">Minimum average peak for symmetry axis to be considered as &quot;real&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00127">ProSHADE_settings.hpp:127</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a6d9f533a789bd5c6031fa77b9649ed3d"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a6d9f533a789bd5c6031fa77b9649ed3d">ProSHADE_internal_symmetry::findMissingAxesDual</a></div><div class="ttdeci">bool findMissingAxesDual(std::vector&lt; proshade_unsign &gt; *possibilities, std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, std::vector&lt; proshade_unsign &gt; *retGroup, proshade_unsign requiredNoAxes, proshade_double axErr, proshade_unsign noMatchesG1, proshade_double angle1, proshade_unsign noMatchesG2, proshade_double angle2, proshade_unsign fold, ProSHADE_internal_data::ProSHADE_data *dataObj)</div><div class="ttdoc">This function tries to find a particular symmetry axes which would complete a group of symmetries wit...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02553">ProSHADE_symmetry.cpp:2553</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a367d0cd13e3d7a2648488980220ca69b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a367d0cd13e3d7a2648488980220ca69b">ProSHADE_internal_data::ProSHADE_data::maxShellBand</a></div><div class="ttdeci">proshade_unsign maxShellBand</div><div class="ttdoc">The maximum band for any shell of the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00123">ProSHADE_data.hpp:123</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a43e4918d4e7d08787d47788a6dae16ba"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a43e4918d4e7d08787d47788a6dae16ba">ProSHADE_settings::symMissPeakThres</a></div><div class="ttdeci">proshade_double symMissPeakThres</div><div class="ttdoc">Percentage of peaks that could be missing that would warrant starting the missing peaks search proced...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00124">ProSHADE_settings.hpp:124</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_abd9fe573a48f499dd7d1df4f779222f1"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#abd9fe573a48f499dd7d1df4f779222f1">ProSHADE_internal_maths::getRotationMatrixFromEulerZXZAngles</a></div><div class="ttdeci">void getRotationMatrixFromEulerZXZAngles(proshade_double eulerAlpha, proshade_double eulerBeta, proshade_double eulerGamma, proshade_double *matrix)</div><div class="ttdoc">Function to find the rotation matrix from Euler angles (ZXZ convention).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01007">ProSHADE_maths.cpp:1007</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1fdc5b9df47ff8de3a5f2f6e6ce233a5"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1fdc5b9df47ff8de3a5f2f6e6ce233a5">ProSHADE_internal_data::ProSHADE_data::getDihedralSymmetriesList</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; getDihedralSymmetriesList(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSymList)</div><div class="ttdoc">This function obtains a list of all D symmetries from already computed C symmetries list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01299">ProSHADE_symmetry.cpp:1299</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_ade9b717260e86c8f24bcbe6d17fe4e06"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ade9b717260e86c8f24bcbe6d17fe4e06">ProSHADE_internal_symmetry::addZeroPeakToGroups</a></div><div class="ttdeci">void addZeroPeakToGroups(std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; &amp;grpsVec, std::vector&lt; proshade_double * &gt; &amp;peaks)</div><div class="ttdoc">This function takes the peak groups and adds zero peak to each of them.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00635">ProSHADE_symmetry.cpp:635</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__symmetry_8hpp_html"><div class="ttname"><a href="_pro_s_h_a_d_e__symmetry_8hpp.html">ProSHADE_symmetry.hpp</a></div><div class="ttdoc">This header file declares all the functions required for symmetry detection and construction.</div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_ae42ba1e294d1887c71b763f9bb5519cc"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#ae42ba1e294d1887c71b763f9bb5519cc">ProSHADE_settings::allDetectedTAxes</a></div><div class="ttdeci">std::vector&lt; proshade_unsign &gt; allDetectedTAxes</div><div class="ttdoc">The vector of all detected tetrahedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00149">ProSHADE_settings.hpp:149</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__messages_html_addbb90f2b4199441f60e241ac850daa2"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__messages.html#addbb90f2b4199441f60e241ac850daa2">ProSHADE_internal_messages::printWarningMessage</a></div><div class="ttdeci">void printWarningMessage(proshade_signed verbose, std::string message, std::string warnCode)</div><div class="ttdoc">General stderr message printing (used for warnings).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__messages_8cpp_source.html#l00101">ProSHADE_messages.cpp:101</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a648ddad98891a4d8a6af5187d994c5ec"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a648ddad98891a4d8a6af5187d994c5ec">ProSHADE_internal_symmetry::findPeaksCSymmetry</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; findPeaksCSymmetry(std::vector&lt; proshade_double * &gt; *peaks, proshade_signed verbose, proshade_unsign band, proshade_double missPeakThres, proshade_double axisErrTolerance, bool axisErrToleranceDef, ProSHADE_internal_data::ProSHADE_data *dataObj)</div><div class="ttdoc">This function searches the list of peaks for presence of cyclic symmetry.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00375">ProSHADE_symmetry.cpp:375</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a4d869a528d0af64bc3688a9a48514061"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a4d869a528d0af64bc3688a9a48514061">ProSHADE_settings::allDetectedOAxes</a></div><div class="ttdeci">std::vector&lt; proshade_unsign &gt; allDetectedOAxes</div><div class="ttdoc">The vector of all detected octahedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00150">ProSHADE_settings.hpp:150</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a89094c73ae033812d4df0bd846e03442"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">ProSHADE_settings::verbose</a></div><div class="ttdeci">proshade_signed verbose</div><div class="ttdoc">Should the software report on the progress, or just be quiet? Value between -1 (nothing) and 4 (loud)</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00142">ProSHADE_settings.hpp:142</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_ad977c265833d6466598cceb406a085db"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad977c265833d6466598cceb406a085db">ProSHADE_internal_symmetry::isSymmetrySame</a></div><div class="ttdeci">bool isSymmetrySame(std::vector&lt; proshade_double * &gt; *ret, proshade_double *sym, proshade_double simThres, proshade_signed *matchedPos)</div><div class="ttdoc">This function checks if a very similar symmetry is not already saved.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01197">ProSHADE_symmetry.cpp:1197</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_af4b044752fe0a780a3f09743e9d8d58e"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af4b044752fe0a780a3f09743e9d8d58e">ProSHADE_internal_symmetry::printSymmetryGroup</a></div><div class="ttdeci">void printSymmetryGroup(std::vector&lt; proshade_unsign &gt; grp, std::vector&lt; proshade_double * &gt; peaks, proshade_signed verbose)</div><div class="ttdoc">This function simply prints the detected symmetry and all its supporting peaks.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01077">ProSHADE_symmetry.cpp:1077</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a2b2f67cba1eea57f19fdaf062db74fde"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a2b2f67cba1eea57f19fdaf062db74fde">ProSHADE_internal_maths::vectorOrientationSimilarity</a></div><div class="ttdeci">bool vectorOrientationSimilarity(proshade_double a1, proshade_double a2, proshade_double a3, proshade_double b1, proshade_double b2, proshade_double b3, proshade_double tolerance=0.1)</div><div class="ttdoc">This function compares two vectors using cosine distance and decides if they are similar using tolera...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l02332">ProSHADE_maths.cpp:2332</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a68c3eafaeea1c1873c33525f337f9d0b"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a></div><div class="ttdeci">void addToDoubleVector(std::vector&lt; proshade_double &gt; *vecToAddTo, proshade_double elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00077">ProSHADE_misc.cpp:77</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a074d9c1d40d7491ea9f9f9639744e18d"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a074d9c1d40d7491ea9f9f9639744e18d">ProSHADE_internal_symmetry::checkExpectedAgainstFound</a></div><div class="ttdeci">proshade_unsign checkExpectedAgainstFound(std::vector&lt; proshade_unsign &gt; grp, std::vector&lt; proshade_double * &gt; peaks, std::vector&lt; proshade_double &gt; *expAngs, std::vector&lt; proshade_unsign &gt; *matchedAngs, std::vector&lt; proshade_unsign &gt; *missingAngs, proshade_double axisTol)</div><div class="ttdoc">This function computes the expected peak rotations for given fold.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00748">ProSHADE_symmetry.cpp:748</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes_html_ab357cd5b90f9f841ae7f53254f54e6d0"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html#ab357cd5b90f9f841ae7f53254f54e6d0">ProSHADE_internal_precomputedVals::octahedronAxes::getValue</a></div><div class="ttdeci">proshade_double getValue(proshade_unsign axis, proshade_unsign element)</div><div class="ttdoc">Accessor for the octahedronAxesVals variable.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__precomputed_values_8cpp_source.html#l00136">ProSHADE_precomputedValues.cpp:136</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes_html_a67427f9d7294471f06126ff7768d8b74"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html#a67427f9d7294471f06126ff7768d8b74">ProSHADE_internal_precomputedVals::tetrahedronAxes::getValue</a></div><div class="ttdeci">proshade_double getValue(proshade_unsign axis, proshade_unsign element)</div><div class="ttdoc">Accessor for the tetrahedronAxesVals variable.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__precomputed_values_8cpp_source.html#l00068">ProSHADE_precomputedValues.cpp:68</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_afb183823a47a73d459a5bae16042bf4e"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#afb183823a47a73d459a5bae16042bf4e">ProSHADE_settings::useBiCubicInterpolationOnPeaks</a></div><div class="ttdeci">bool useBiCubicInterpolationOnPeaks</div><div class="ttdoc">This variable switch decides whether best symmetry is detected from peak indices, or whether bicubic ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00132">ProSHADE_settings.hpp:132</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__symmetry_8cpp_html_af62700fc94d2901ec61928d01773ea57"><div class="ttname"><a href="_pro_s_h_a_d_e__symmetry_8cpp.html#af62700fc94d2901ec61928d01773ea57">determinePeakThreshold</a></div><div class="ttdeci">proshade_double determinePeakThreshold(std::vector&lt; proshade_double &gt; inArr, proshade_double noIQRsFromMedian)</div><div class="ttdoc">This function takes a vector of values and determines the threshold for removing noise from it.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00071">ProSHADE_symmetry.cpp:71</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a5dc4353223fc752e0007b2adec193079"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5dc4353223fc752e0007b2adec193079">ProSHADE_internal_symmetry::saveMissingAxisNewOnly</a></div><div class="ttdeci">void saveMissingAxisNewOnly(std::vector&lt; proshade_double * &gt; *axVec, proshade_double axX, proshade_double axY, proshade_double axZ, proshade_double height, proshade_unsign fold, proshade_double axErr)</div><div class="ttdoc">This function saves the recovered information about missing axis into a full symmetry,...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01895">ProSHADE_symmetry.cpp:1895</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a2ac3b534f974de25b092e9d48d9f7dea"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a></div><div class="ttdeci">proshade_double computeDotProduct(proshade_double *x1, proshade_double *y1, proshade_double *z1, proshade_double *x2, proshade_double *y2, proshade_double *z2)</div><div class="ttdoc">Simple 3D vector dot product computation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01773">ProSHADE_maths.cpp:1773</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_adac314dce30ead61ca122c991e4a9671"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#adac314dce30ead61ca122c991e4a9671">ProSHADE_internal_symmetry::findTetra3C2s</a></div><div class="ttdeci">void findTetra3C2s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the 3 C2 symmetries with correct angles requir...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02071">ProSHADE_symmetry.cpp:2071</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_aff0d8344fdd83482e5531eadedaac550"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#aff0d8344fdd83482e5531eadedaac550">ProSHADE_internal_misc::deepCopyAxisToDblPtrVector</a></div><div class="ttdeci">void deepCopyAxisToDblPtrVector(std::vector&lt; proshade_double * &gt; *dblPtrVec, proshade_double *axis)</div><div class="ttdoc">Does a deep copy of a double array to a vector of double arrays.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00310">ProSHADE_misc.cpp:310</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes_html_ac293476061c52c6f5c4b3125672e8eae"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html#ac293476061c52c6f5c4b3125672e8eae">ProSHADE_internal_precomputedVals::tetrahedronAxes::getNoAxes</a></div><div class="ttdeci">proshade_unsign getNoAxes()</div><div class="ttdoc">Accessor for the tetrahedronAxesVals variable number of axes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__precomputed_values_8cpp_source.html#l00079">ProSHADE_precomputedValues.cpp:79</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a62c8dc8fe0c14305d2d715a22c7042aa"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a62c8dc8fe0c14305d2d715a22c7042aa">ProSHADE_internal_symmetry::findOcta6C2s</a></div><div class="ttdeci">void findOcta6C2s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the six C2 symmetries with correct angles requ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02472">ProSHADE_symmetry.cpp:2472</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a39eafef902a49cc0816a2ed675c14a49"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a39eafef902a49cc0816a2ed675c14a49">ProSHADE_internal_maths::getRotationMatrixFromAngleAxis</a></div><div class="ttdeci">void getRotationMatrixFromAngleAxis(proshade_double *rotMat, proshade_double x, proshade_double y, proshade_double z, proshade_double ang)</div><div class="ttdoc">This function converts the axis-angle representation to the rotation matrix representation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01444">ProSHADE_maths.cpp:1444</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a152b43815a3d3debd4b60751d9c8afdd"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">ProSHADE_internal_data::ProSHADE_data::getMaxBand</a></div><div class="ttdeci">proshade_unsign getMaxBand(void)</div><div class="ttdoc">This function returns the maximum band value for the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03599">ProSHADE_data.cpp:3599</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a4f09b90de1f15b345ee7998ff31327f3"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a4f09b90de1f15b345ee7998ff31327f3">ProSHADE_internal_symmetry::detectIcosahedralSymmetry</a></div><div class="ttdeci">bool detectIcosahedralSymmetry(std::vector&lt; proshade_double * &gt; *CSymList, proshade_double axErr, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and decides whether basic requirements for isosahedral s...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02960">ProSHADE_symmetry.cpp:2960</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group_html_a711e11c6df8491a0b4ed3f31a33b550d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a711e11c6df8491a0b4ed3f31a33b550d">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::checkIfPeakBelongs</a></div><div class="ttdeci">bool checkIfPeakBelongs(proshade_double lat, proshade_double lon, proshade_unsign sphPos, proshade_double cosTol, proshade_signed verbose)</div><div class="ttdoc">This function takes a new prospective peak and tests if it belongs to this peak group or not.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01134">ProSHADE_spheres.cpp:1134</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a></div><div class="ttdoc">This class stores all the settings and is passed to the executive classes instead of a multitude of p...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00036">ProSHADE_settings.hpp:37</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a421d8cf46b6671857d0054cf0defe17f"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a421d8cf46b6671857d0054cf0defe17f">ProSHADE_internal_data::ProSHADE_data::getCyclicSymmetriesList</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; getCyclicSymmetriesList(ProSHADE_settings *settings)</div><div class="ttdoc">This function obtains a list of all C symmetries from already computed self-rotation map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00198">ProSHADE_symmetry.cpp:198</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a931aa4c10c426c3b8041bd4e838b0678"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a931aa4c10c426c3b8041bd4e838b0678">ProSHADE_internal_data::ProSHADE_data::getPredictedTetrahedralSymmetriesList</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; getPredictedTetrahedralSymmetriesList(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSymList)</div><div class="ttdoc">This function predicts a list of all T symmetry axes from the already computed C symmetries list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l04253">ProSHADE_symmetry.cpp:4253</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_add48230d67bd69305df058d29a588507"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#add48230d67bd69305df058d29a588507">ProSHADE_internal_distances::computeEMatrices</a></div><div class="ttdeci">void computeEMatrices(ProSHADE_internal_data::ProSHADE_data *obj1, ProSHADE_internal_data::ProSHADE_data *obj2, ProSHADE_settings *settings)</div><div class="ttdoc">This function computes the complete E matrices and their weights between any two objects.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00510">ProSHADE_distances.cpp:510</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a41150b2f8995b2ac1f144143fc83b6ee"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a41150b2f8995b2ac1f144143fc83b6ee">ProSHADE_internal_symmetry::giveOppositeAxesSameDirection</a></div><div class="ttdeci">void giveOppositeAxesSameDirection(std::vector&lt; proshade_double * &gt; peaks)</div><div class="ttdoc">This function modifiest the axes so that the highest vector element is always positive.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00498">ProSHADE_symmetry.cpp:498</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad96cd7a72fc56e7d97cfeff1086faad9"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad96cd7a72fc56e7d97cfeff1086faad9">ProSHADE_internal_data::ProSHADE_data::convertRotationFunction</a></div><div class="ttdeci">void convertRotationFunction(ProSHADE_settings *settings)</div><div class="ttdoc">This function converts the self-rotation function of this structure to angle-axis representation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00120">ProSHADE_symmetry.cpp:120</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_af9835b91e354e4615beb79b5c2a674e9"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#af9835b91e354e4615beb79b5c2a674e9">ProSHADE_internal_symmetry::printSymmetryPeaks</a></div><div class="ttdeci">void printSymmetryPeaks(std::vector&lt; proshade_unsign &gt; grp, std::vector&lt; proshade_double * &gt; peaks, proshade_signed verbose, proshade_unsign groupNo)</div><div class="ttdoc">This function simply prints the symmetry axis group supplied in the first parameter from the second p...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00529">ProSHADE_symmetry.cpp:529</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_a3cdde76bf20d9cd5d756ffde2d3dc854"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#a3cdde76bf20d9cd5d756ffde2d3dc854">ProSHADE_internal_distances::computeInverseSOFTTransform</a></div><div class="ttdeci">void computeInverseSOFTTransform(ProSHADE_internal_data::ProSHADE_data *obj1, ProSHADE_internal_data::ProSHADE_data *obj2, ProSHADE_settings *settings)</div><div class="ttdoc">This function computes the inverse SO(3) transform.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00854">ProSHADE_distances.cpp:854</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup</a></div><div class="ttdoc">This class contains peak groups detected in the rotation function mapped spheres.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spheres_8hpp_source.html#l00128">ProSHADE_spheres.hpp:129</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_aa0df823fdb0d1f187f160f884f220327"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aa0df823fdb0d1f187f160f884f220327">ProSHADE_internal_symmetry::findIcos10C3s</a></div><div class="ttdeci">void findIcos10C3s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the ten C3 symmetries with correct angles requ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03438">ProSHADE_symmetry.cpp:3438</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a2380a3710f7dbe672519c3adda30f7cd"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a2380a3710f7dbe672519c3adda30f7cd">ProSHADE_internal_maths::isAxisUnique</a></div><div class="ttdeci">bool isAxisUnique(std::vector&lt; proshade_double * &gt; *CSymList, proshade_double *axis, proshade_double tolerance=0.1, bool improve=false)</div><div class="ttdoc">This function checks if new axis is unique, or already detected.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l02717">ProSHADE_maths.cpp:2717</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_ae266053664eb7cf916aa5e2d282e35dd"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ae266053664eb7cf916aa5e2d282e35dd">ProSHADE_internal_symmetry::findMissingAxesTriple</a></div><div class="ttdeci">bool findMissingAxesTriple(std::vector&lt; proshade_unsign &gt; *possibilities, std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, std::vector&lt; proshade_unsign &gt; *retGroup, proshade_unsign requiredNoAxes, proshade_double axErr, proshade_unsign noMatchesG1, proshade_double angle1, proshade_unsign noMatchesG2, proshade_double angle2, proshade_unsign noMatchesG3, proshade_double angle3, proshade_unsign fold, ProSHADE_internal_data::ProSHADE_data *dataObj)</div><div class="ttdoc">This function tries to find a particular symmetry axis which would complete a group of symmetries wit...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03593">ProSHADE_symmetry.cpp:3593</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_aafc6f1626c7463de53c9f4f6fa11db22"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#aafc6f1626c7463de53c9f4f6fa11db22">ProSHADE_internal_maths::getAxisAngleFromRotationMatrix</a></div><div class="ttdeci">void getAxisAngleFromRotationMatrix(proshade_double *rotMat, proshade_double *x, proshade_double *y, proshade_double *z, proshade_double *ang)</div><div class="ttdoc">This function converts rotation matrix to the axis-angle representation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01124">ProSHADE_maths.cpp:1124</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a2b17617f8b3c42c5199948828cd1a57b"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a2b17617f8b3c42c5199948828cd1a57b">ProSHADE_internal_maths::findRotMatMatchingVectors</a></div><div class="ttdeci">proshade_double * findRotMatMatchingVectors(proshade_double x1, proshade_double y1, proshade_double z1, proshade_double x2, proshade_double y2, proshade_double z2)</div><div class="ttdoc">Computation of rotation matrix rotating one vector onto the other.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01975">ProSHADE_maths.cpp:1975</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__symmetry_8cpp_html_a16b3a0c170d01be9b4fad682f90025a5"><div class="ttname"><a href="_pro_s_h_a_d_e__symmetry_8cpp.html#a16b3a0c170d01be9b4fad682f90025a5">findBestIcosDihedralPair</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; proshade_unsign, proshade_unsign &gt; &gt; findBestIcosDihedralPair(std::vector&lt; proshade_double * &gt; *CSymList, proshade_double minPeakHeight, proshade_double axErr)</div><div class="ttdoc">This function finds all the pairs of axes conforming to the icosahedron dihedral angle.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03079">ProSHADE_symmetry.cpp:3079</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a26b57d39529ca69a117aceead6b12680"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a26b57d39529ca69a117aceead6b12680">ProSHADE_settings::peakNeighbours</a></div><div class="ttdeci">proshade_unsign peakNeighbours</div><div class="ttdoc">Number of points in any direction that have to be lower than the considered index in order to conside...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00117">ProSHADE_settings.hpp:117</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a9304bbd5138aaa9e4f4aed4676af6256"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a9304bbd5138aaa9e4f4aed4676af6256">ProSHADE_internal_symmetry::completeMissingCSymmetry</a></div><div class="ttdeci">bool completeMissingCSymmetry(ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_unsign fold, std::vector&lt; proshade_unsign &gt; *grp, std::vector&lt; proshade_double * &gt; *peaks, std::vector&lt; proshade_unsign &gt; *missingPeaks, std::vector&lt; proshade_double &gt; *expectedAngles, std::vector&lt; proshade_unsign &gt; *matchedPeaks, proshade_double axErrTolerance, proshade_signed verbose)</div><div class="ttdoc">This function does the complete missing peak searching and filling in the missing peaks.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00942">ProSHADE_symmetry.cpp:942</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a84e490954883961abf92b9ed5b3cae65"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a84e490954883961abf92b9ed5b3cae65">ProSHADE_settings::smoothingFactor</a></div><div class="ttdeci">proshade_double smoothingFactor</div><div class="ttdoc">This factor decides how small the group sizes should be - larger factor means more smaller groups.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00121">ProSHADE_settings.hpp:121</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a50df80b02427f9f55a2c7af033a9fb93"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a50df80b02427f9f55a2c7af033a9fb93">ProSHADE_internal_mapManip::myRound</a></div><div class="ttdeci">proshade_signed myRound(proshade_double x)</div><div class="ttdoc">Calls the appropriate version of round function depending on compiler version.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00031">ProSHADE_mapManip.cpp:31</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a2f9c7716f6ab682e8548ab77efcdc444"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a2f9c7716f6ab682e8548ab77efcdc444">ProSHADE_internal_maths::compute3x3MatrixVectorMultiplication</a></div><div class="ttdeci">proshade_double * compute3x3MatrixVectorMultiplication(proshade_double *mat, proshade_double x, proshade_double y, proshade_double z)</div><div class="ttdoc">Function for computing a 3x3 matrix to 3x1 vector multiplication.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01857">ProSHADE_maths.cpp:1857</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1tetrahedron_axes.html">ProSHADE_internal_precomputedVals::tetrahedronAxes</a></div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__precomputed_values_8hpp_source.html#l00068">ProSHADE_precomputedValues.hpp:69</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__symmetry_8cpp_html_a02e0d7dfd2961c534fa1d5ab4c3002e3"><div class="ttname"><a href="_pro_s_h_a_d_e__symmetry_8cpp.html#a02e0d7dfd2961c534fa1d5ab4c3002e3">findBestTetraDihedralPair</a></div><div class="ttdeci">std::pair&lt; proshade_unsign, proshade_unsign &gt; findBestTetraDihedralPair(std::vector&lt; proshade_double * &gt; *CSymList, proshade_double minPeakHeight, proshade_double axErr)</div><div class="ttdoc">This function finds the best pair of axes conforming to the tetrahedron dihedral angle.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l04192">ProSHADE_symmetry.cpp:4192</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_ad8c193e95c7069fafa78dccc1de1aaa4"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ad8c193e95c7069fafa78dccc1de1aaa4">ProSHADE_internal_symmetry::testGroupAgainstSymmetry</a></div><div class="ttdeci">bool testGroupAgainstSymmetry(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_unsign &gt; *grp, proshade_double *sym, proshade_double axErr, proshade_double angle, bool improve, proshade_unsign pos=0)</div><div class="ttdoc">This function tests whether a symmetry has particular angle to all members of a group.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01605">ProSHADE_symmetry.cpp:1605</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html">ProSHADE_internal_precomputedVals::icosahedronAxes</a></div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__precomputed_values_8hpp_source.html#l00040">ProSHADE_precomputedValues.hpp:41</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_af556836aa9286c1571196de442a6b493"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a></div><div class="ttdeci">void checkMemoryAllocation(chVar checkVar, std::string fileP, unsigned int lineP, std::string funcP, std::string infoP=&quot;This error may occurs when ProSHADE requests memory to be\n                    : allocated to it and this operation fails. This could\n                    : happen when not enough memory is available, either due to\n                    : other processes using a lot of memory, or when the machine\n                    : does not have sufficient memory available. Re-run to see\n                    : if this problem persists.&quot;)</div><div class="ttdoc">Checks if memory was allocated properly.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8hpp_source.html#l00067">ProSHADE_misc.hpp:67</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a5dda335a87d6c26edfd3cf2a29ff7f1f"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a5dda335a87d6c26edfd3cf2a29ff7f1f">ProSHADE_internal_symmetry::saveDetectedCSymmetry</a></div><div class="ttdeci">void saveDetectedCSymmetry(proshade_unsign fold, std::vector&lt; proshade_unsign &gt; *matchedPeaks, std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; *ret, proshade_signed verbose)</div><div class="ttdoc">This function saves a detected symmetry for reporting to the user.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00902">ProSHADE_symmetry.cpp:902</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_acf6c5376edac98e54ef0e418cd05d706"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#acf6c5376edac98e54ef0e418cd05d706">ProSHADE_internal_maths::getEulerZXZFromSOFTPosition</a></div><div class="ttdeci">void getEulerZXZFromSOFTPosition(proshade_signed band, proshade_signed x, proshade_signed y, proshade_signed z, proshade_double *eulerAlpha, proshade_double *eulerBeta, proshade_double *eulerGamma)</div><div class="ttdoc">Function to find Euler angles (ZXZ convention) from index position in the inverse SOFT map.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00963">ProSHADE_maths.cpp:963</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_ab0ac919dd609bc6bded806c0f78201fd"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ab0ac919dd609bc6bded806c0f78201fd">ProSHADE_internal_symmetry::saveDSymmetry</a></div><div class="ttdeci">void saveDSymmetry(std::vector&lt; proshade_double * &gt; *ret, std::vector&lt; proshade_double * &gt; *CSymList, proshade_unsign axisOne, proshade_unsign axisTwo)</div><div class="ttdoc">This function saves a detected dihedral symmetry to the dihedral symmetries list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01380">ProSHADE_symmetry.cpp:1380</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_af185ca14eb5d82fb126092767746e00a"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#af185ca14eb5d82fb126092767746e00a">ProSHADE_internal_maths::vectorMedianAndIQR</a></div><div class="ttdeci">void vectorMedianAndIQR(std::vector&lt; proshade_double &gt; *vec, proshade_double *&amp;ret)</div><div class="ttdoc">Function to get vector median and inter-quartile range.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00149">ProSHADE_maths.cpp:149</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes_html_a7e437518938a28a37f54c0f6fe3636ec"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1octahedron_axes.html#a7e437518938a28a37f54c0f6fe3636ec">ProSHADE_internal_precomputedVals::octahedronAxes::getNoAxes</a></div><div class="ttdeci">proshade_unsign getNoAxes()</div><div class="ttdoc">Accessor for the octahedronAxesVals variable number of axes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__precomputed_values_8cpp_source.html#l00147">ProSHADE_precomputedValues.cpp:147</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae97b54a34689c1dceae47a5e8e94bbb0"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae97b54a34689c1dceae47a5e8e94bbb0">ProSHADE_internal_data::ProSHADE_data::getPredictedOctahedralSymmetriesList</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; getPredictedOctahedralSymmetriesList(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSymList)</div><div class="ttdoc">This function predicts a list of all O symmetry axes from the already computed C symmetries list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02916">ProSHADE_symmetry.cpp:2916</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_aacced7feb8ce5251dce199505912d997"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#aacced7feb8ce5251dce199505912d997">ProSHADE_internal_symmetry::checkForMissingPeak</a></div><div class="ttdeci">proshade_double checkForMissingPeak(ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_double x, proshade_double y, proshade_double z, proshade_double angle, proshade_double heightThres, proshade_double axTol)</div><div class="ttdoc">This function checks for the high of the correlation for particular rotation angle and axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00830">ProSHADE_symmetry.cpp:830</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2eb10989a2f8d46b849cdaf8410b68be"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">ProSHADE_internal_data::ProSHADE_data::getInvSO3Coeffs</a></div><div class="ttdeci">proshade_complex * getInvSO3Coeffs(void)</div><div class="ttdoc">This function allows access to the inverse SO(3) coefficients array.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03826">ProSHADE_data.cpp:3826</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_aa4957b0a47193ef1042028dc22b350f6"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#aa4957b0a47193ef1042028dc22b350f6">ProSHADE_settings::allDetectedIAxes</a></div><div class="ttdeci">std::vector&lt; proshade_unsign &gt; allDetectedIAxes</div><div class="ttdoc">The vector of all detected icosahedral symmetry axes indices in allDetectedCAxes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00151">ProSHADE_settings.hpp:151</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a58c00659b5f6abf315fb5a426c45810c"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a58c00659b5f6abf315fb5a426c45810c">ProSHADE_internal_symmetry::findPredictedSingleAxisHeight</a></div><div class="ttdeci">proshade_double findPredictedSingleAxisHeight(proshade_double *axis, proshade_double fold, ProSHADE_internal_data::ProSHADE_data *dataObj, ProSHADE_settings *settings)</div><div class="ttdoc">This function finds the rotation function value for a single axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l04115">ProSHADE_symmetry.cpp:4115</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a16336bdf0b391c953a549d3df115d691"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a></div><div class="ttdeci">void addToUnsignVector(std::vector&lt; proshade_unsign &gt; *vecToAddTo, proshade_unsign elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00099">ProSHADE_misc.cpp:99</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a870671b74f645f535f327c397826d6c9"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a870671b74f645f535f327c397826d6c9">ProSHADE_internal_symmetry::findOcta3C4s</a></div><div class="ttdeci">void findOcta3C4s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the 3 C4 symmetries with perpendicular angles ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02324">ProSHADE_symmetry.cpp:2324</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad46b5c9a39df4faa45cc53d31aab43db"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad46b5c9a39df4faa45cc53d31aab43db">ProSHADE_internal_data::ProSHADE_data::getIcosahedralSymmetriesList</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; getIcosahedralSymmetriesList(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSymList)</div><div class="ttdoc">This function obtains a list of all I symmetry axes from the already computed C symmetries list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02799">ProSHADE_symmetry.cpp:2799</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a754f8c240a6a0bfc2dac842e4cfafb58"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a754f8c240a6a0bfc2dac842e4cfafb58">ProSHADE_internal_symmetry::findTetra4C3s</a></div><div class="ttdeci">void findTetra4C3s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the 4 C3 symmetries with correct angles requir...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01535">ProSHADE_symmetry.cpp:1535</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad9a02d8d68aac021572b764651aad0f1"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad9a02d8d68aac021572b764651aad0f1">ProSHADE_internal_data::ProSHADE_data::getPredictedIcosahedralSymmetriesList</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; proshade_double * &gt; &gt; getPredictedIcosahedralSymmetriesList(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSymList)</div><div class="ttdoc">This function predicts a list of all I symmetry axes from the already computed C symmetries list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02871">ProSHADE_symmetry.cpp:2871</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afa3b1a8ef870a606035102b5dcf1ce44"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afa3b1a8ef870a606035102b5dcf1ce44">ProSHADE_internal_data::ProSHADE_data::getCyclicSymmetriesListFromAngleAxis</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; getCyclicSymmetriesListFromAngleAxis(ProSHADE_settings *settings)</div><div class="ttdoc">This function obtains a list of all C symmetries from the angle-axis space mapped rotation function v...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03756">ProSHADE_symmetry.cpp:3756</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a194944b48a4b6b523ef251a2a03eab17"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a194944b48a4b6b523ef251a2a03eab17">ProSHADE_internal_symmetry::checkFittingAxisTripleAndSave</a></div><div class="ttdeci">void checkFittingAxisTripleAndSave(std::vector&lt; proshade_unsign &gt; *retGroup, std::vector&lt; proshade_double * &gt; *ret, proshade_unsign fold, proshade_double axX, proshade_double axY, proshade_double axZ, std::vector&lt; proshade_double * &gt; *prosp, proshade_double axErr, proshade_unsign noMatchesG1, proshade_double angle1, proshade_unsign noMatchesG2, proshade_double angle2, proshade_unsign noMatchesG3, proshade_double angle3, ProSHADE_internal_data::ProSHADE_data *dataObj)</div><div class="ttdoc">This function takes a newly detected &quot;missing&quot; axis and tests it for belonging to the group,...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03704">ProSHADE_symmetry.cpp:3704</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__symmetry_8cpp_html_a458a09071115478efb8b666b839c18f2"><div class="ttname"><a href="_pro_s_h_a_d_e__symmetry_8cpp.html#a458a09071115478efb8b666b839c18f2">findBestOctaDihedralPair</a></div><div class="ttdeci">std::pair&lt; proshade_unsign, proshade_unsign &gt; findBestOctaDihedralPair(std::vector&lt; proshade_double * &gt; *CSymList, proshade_double minPeakHeight, proshade_double axErr)</div><div class="ttdoc">This function finds the best pair of axes conforming to the octahedron dihedral angle.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03258">ProSHADE_symmetry.cpp:3258</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a85bfab9b1babe0b35e6d81f525ead29b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a85bfab9b1babe0b35e6d81f525ead29b">ProSHADE_internal_data::ProSHADE_data::getTetrahedralSymmetriesList</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; getTetrahedralSymmetriesList(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSymList)</div><div class="ttdoc">This function obtains a list of all T symmetry axes from the already computed C symmetries list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01419">ProSHADE_symmetry.cpp:1419</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group_html_a45b094d574ae0aae114d074774314556"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a45b094d574ae0aae114d074774314556">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::findCyclicPointGroupsGivenFold</a></div><div class="ttdeci">void findCyclicPointGroupsGivenFold(std::vector&lt; ProSHADE_internal_spheres::ProSHADE_rotFun_sphere * &gt; sphereVals, std::vector&lt; proshade_double * &gt; *detectedCs, bool bicubicInterp, proshade_unsign fold, proshade_signed verbose)</div><div class="ttdoc">Function detecting cyclic point groups with a particular fold in a peak group.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01362">ProSHADE_spheres.cpp:1362</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a45fbcfaeaabf9bae2fbd7d46a5fb4bc7"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a45fbcfaeaabf9bae2fbd7d46a5fb4bc7">ProSHADE_internal_maths::findVectorFromTwoVAndTwoD</a></div><div class="ttdeci">std::vector&lt; proshade_double &gt; findVectorFromTwoVAndTwoD(proshade_double x1, proshade_double y1, proshade_double z1, proshade_double x2, proshade_double y2, proshade_double z2, proshade_double dot1, proshade_double dot2)</div><div class="ttdoc">Function for finding a vector which would have a given two dot products to two other vectors.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l02051">ProSHADE_maths.cpp:2051</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_acc08b5c3e227d4671a208cdd68d5c80c"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#acc08b5c3e227d4671a208cdd68d5c80c">ProSHADE_internal_symmetry::getPeaksAngleAxisPositions</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; getPeaksAngleAxisPositions(std::vector&lt; proshade_double * &gt; allPeaks, proshade_signed verbose)</div><div class="ttdoc">This function converts peaks ZXZ Euler anles to angle-axis representation for further processing.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00263">ProSHADE_symmetry.cpp:263</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a4627b03c4064d3de15efb3ebbf57ed78"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a4627b03c4064d3de15efb3ebbf57ed78">ProSHADE_settings::axisErrTolerance</a></div><div class="ttdeci">proshade_double axisErrTolerance</div><div class="ttdoc">Allowed error on vector axis in in dot product ( acos ( 1 - axErr ) is the allowed difference in radi...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00125">ProSHADE_settings.hpp:125</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes_html_aeb51e819ae1cf2ca1a2faba0ee3782ae"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__precomputed_vals_1_1icosahedron_axes.html#aeb51e819ae1cf2ca1a2faba0ee3782ae">ProSHADE_internal_precomputedVals::icosahedronAxes::getNoAxes</a></div><div class="ttdeci">proshade_unsign getNoAxes()</div><div class="ttdoc">Accessor for the octahedronAxesVals variable number of axes.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__precomputed_values_8cpp_source.html#l00234">ProSHADE_precomputedValues.cpp:234</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_ac0a8dc71c37de02256521ebc9178c8d4"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#ac0a8dc71c37de02256521ebc9178c8d4">ProSHADE_internal_symmetry::determineFoldToTry</a></div><div class="ttdeci">bool determineFoldToTry(proshade_double dist, proshade_double *divBasis, proshade_double *divRem, proshade_double peakErr, proshade_double *symmErr, std::vector&lt; proshade_unsign &gt; *angsToTry)</div><div class="ttdoc">This function determines the symmetry fold to be searched for.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00672">ProSHADE_symmetry.cpp:672</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__distances_html_afacb5240b508ea28b64cacf395b47dba"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__distances.html#afacb5240b508ea28b64cacf395b47dba">ProSHADE_internal_distances::generateSO3CoeffsFromEMatrices</a></div><div class="ttdeci">void generateSO3CoeffsFromEMatrices(ProSHADE_internal_data::ProSHADE_data *obj1, ProSHADE_internal_data::ProSHADE_data *obj2, ProSHADE_settings *settings)</div><div class="ttdoc">This function converts the E matrices to SO(3) coefficients.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__distances_8cpp_source.html#l00701">ProSHADE_distances.cpp:701</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a8e5edd0504efb95ecf9caf51661d5aa4"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a8e5edd0504efb95ecf9caf51661d5aa4">ProSHADE_internal_symmetry::findIcos6C5s</a></div><div class="ttdeci">void findIcos6C5s(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; proshade_double * &gt; *ret, proshade_double axErr, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_signed verbose, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and finds the six C5 symmetries with given angles requir...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03020">ProSHADE_symmetry.cpp:3020</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2714fcb2c08b224ccf09d64322bd2ab2"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2714fcb2c08b224ccf09d64322bd2ab2">ProSHADE_internal_data::ProSHADE_data::findRequestedCSymmetryFromAngleAxis</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; findRequestedCSymmetryFromAngleAxis(ProSHADE_settings *settings, proshade_unsign fold, proshade_double *peakThres)</div><div class="ttdoc">This function searches the angle-axis representation of the rotation function for a cyclic point grou...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03895">ProSHADE_symmetry.cpp:3895</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a2454c19169bb38d616e52b99f1dc4495"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a2454c19169bb38d616e52b99f1dc4495">ProSHADE_internal_maths::findAllPrimes</a></div><div class="ttdeci">std::vector&lt; proshade_unsign &gt; findAllPrimes(proshade_unsign upTo)</div><div class="ttdoc">This function finds all prime numbers up to the supplied limit.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l02798">ProSHADE_maths.cpp:2798</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a14c4d6044c5174afa8a0984025c45436"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14c4d6044c5174afa8a0984025c45436">ProSHADE_internal_data::ProSHADE_data::getOctahedralSymmetriesList</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; getOctahedralSymmetriesList(ProSHADE_settings *settings, std::vector&lt; proshade_double * &gt; *CSymList)</div><div class="ttdoc">This function obtains a list of all O symmetry axes from the already computed C symmetries list.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02199">ProSHADE_symmetry.cpp:2199</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__messages_html_a6aa8cdb600cad623409802cfaed494fa"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a></div><div class="ttdeci">void printProgressMessage(proshade_signed verbose, proshade_signed messageLevel, std::string message)</div><div class="ttdoc">General stdout message printing.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__messages_8cpp_source.html#l00070">ProSHADE_messages.cpp:70</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a580f68aa45b9b4f66dff3a4d5daaa316"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a580f68aa45b9b4f66dff3a4d5daaa316">ProSHADE_internal_symmetry::findSymmetryUsingFold</a></div><div class="ttdeci">void findSymmetryUsingFold(ProSHADE_internal_data::ProSHADE_data *dataObj, std::vector&lt; proshade_unsign &gt; *angsToTry, std::vector&lt; proshade_unsign &gt; *grp, std::vector&lt; proshade_double * &gt; *peaks, std::vector&lt; std::vector&lt; proshade_unsign &gt; &gt; *ret, std::vector&lt; proshade_unsign &gt; *testedAlready, proshade_double axErrTolerance, bool axErrToleranceDefault, proshade_double missPeakThres, proshade_signed verbose)</div><div class="ttdoc">This function tests all supplied folds for being supported by the peaks (i.e. and being complete pres...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01007">ProSHADE_symmetry.cpp:1007</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a16d3cf24f73eafc1d5b8ef9e204aaf8d"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a16d3cf24f73eafc1d5b8ef9e204aaf8d">ProSHADE_internal_symmetry::predictIcosAxes</a></div><div class="ttdeci">void predictIcosAxes(std::vector&lt; proshade_double * &gt; *CSymList, std::vector&lt; std::vector&lt; proshade_double * &gt; &gt; *ret, proshade_double axErr, proshade_double minPeakHeight)</div><div class="ttdoc">This function predicts all possible icosahedral point groups symmetry axes from the cyclic point grou...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03142">ProSHADE_symmetry.cpp:3142</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a37925ac477480c718451debb01a9c74a"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a37925ac477480c718451debb01a9c74a">ProSHADE_internal_symmetry::detectTetrahedralSymmetry</a></div><div class="ttdeci">bool detectTetrahedralSymmetry(std::vector&lt; proshade_double * &gt; *CSymList, proshade_double axErr, proshade_double minPeakHeight)</div><div class="ttdoc">This function takes the list of C symmetries and decides whether basic requirements for tetrahedral s...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01485">ProSHADE_symmetry.cpp:1485</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a2e915d310892aea124046acd14db4a84"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a2e915d310892aea124046acd14db4a84">ProSHADE_internal_misc::sortSymHlpInv</a></div><div class="ttdeci">bool sortSymHlpInv(const proshade_double *a, const proshade_double *b)</div><div class="ttdoc">This function compares two arrays of two based on the fifth number, sorting highest first.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00266">ProSHADE_misc.cpp:266</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a210ee0af651d440b68168882ead71c66"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a210ee0af651d440b68168882ead71c66">ProSHADE_internal_symmetry::checkFittingAxisDualAndSave</a></div><div class="ttdeci">bool checkFittingAxisDualAndSave(std::vector&lt; proshade_unsign &gt; *retGroup, std::vector&lt; proshade_double * &gt; *ret, proshade_unsign fold, proshade_double axX, proshade_double axY, proshade_double axZ, std::vector&lt; proshade_double * &gt; *prosp, proshade_double axErr, proshade_unsign noMatchesG1, proshade_double angle1, proshade_unsign noMatchesG2, proshade_double angle2, ProSHADE_internal_data::ProSHADE_data *dataObj)</div><div class="ttdoc">This function takes a newly detected &quot;missing&quot; axis and tests it for belonging to the group,...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02747">ProSHADE_symmetry.cpp:2747</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__symmetry_html_a465606e58df7d6a2238d40c6919b2e58"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a465606e58df7d6a2238d40c6919b2e58">ProSHADE_internal_symmetry::findMissingAxisPoints</a></div><div class="ttdeci">std::vector&lt; proshade_double * &gt; findMissingAxisPoints(proshade_double xVal, proshade_double yVal, proshade_double zVal, ProSHADE_internal_data::ProSHADE_data *dataObj, proshade_double axErr)</div><div class="ttdoc">This function searches for all the self-rotation map points conforming to the axis,...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l01817">ProSHADE_symmetry.cpp:1817</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a5f2b9b9da97b52b7e5cccc08493d0e0d"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a5f2b9b9da97b52b7e5cccc08493d0e0d">ProSHADE_internal_maths::compute3x3MatrixMultiplication</a></div><div class="ttdeci">proshade_double * compute3x3MatrixMultiplication(proshade_double *mat1, proshade_double *mat2)</div><div class="ttdoc">Function for computing a 3x3 matrix multiplication.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01827">ProSHADE_maths.cpp:1827</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_fa9be34cc2c3eb9c0decdfb277595ca7.html">proshade</a></li><li class="navelem"><a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp.html">ProSHADE_symmetry.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
